POJ	eng	N	Y	B-OJ	B-OJ

1598	m	N	N	I-OJ	O

Excuses	eng	N	N	O	O
,	x	N	N	O	O

Excuses	eng	N	N	O	O
!	x	N	N	O	O

-	x	N	N	O	O

c++	nz	N	N	O	O
语言	n	N	N	O	O
程序开发	nr	N	N	O	O
技术	n	N	N	O	O
文章	n	N	N	O	O
_	x	N	N	O	O
c++	nz	N	N	O	O
编程	n	N	N	O	O

-	x	N	N	O	O

红	a	N	N	O	O
黑	a	N	N	O	O
联盟	j	N	N	O	O

Description	eng	N	N	O	O

Judge	eng	N	N	O	O

Ito	eng	N	N	O	O

is	eng	N	N	O	O

having	eng	N	N	O	O

a	x	N	N	O	O

problem	eng	N	N	O	O

with	eng	N	N	O	O

people	eng	N	N	O	O

subpoenaed	eng	N	N	O	O

for	eng	Y	N	O	O

jury	eng	N	N	O	O

duty	eng	N	N	O	O

giving	eng	N	N	O	O

rather	eng	N	N	O	O

lame	eng	N	N	O	O

excuses	eng	N	N	O	O

in	eng	Y	N	O	O

order	eng	N	N	O	O

to	eng	N	N	O	O

avoid	eng	N	N	O	O

serving	eng	N	N	O	O
.	m	N	N	O	O

In	eng	N	N	O	O

order	eng	N	N	O	O

to	eng	N	N	O	O

reduce	eng	N	N	O	O

the	eng	N	N	O	O

amount	eng	N	N	O	O

of	eng	N	N	O	O

time	eng	N	N	O	O

required	eng	N	N	O	O

listening	eng	N	N	O	O

to	eng	N	N	O	O

goofy	eng	N	N	O	O

excuses	eng	N	N	O	O
,	x	N	N	O	O

Judge	eng	N	N	O	O

Ito	eng	N	N	O	O

has	eng	Y	N	O	O

asked	eng	N	N	O	O

that	eng	N	N	O	O

you	eng	N	N	O	O

write	eng	N	N	O	O

a	x	N	N	O	O

program	eng	N	N	O	O

that	eng	N	N	O	O

will	eng	N	N	O	O

search	eng	N	N	O	O

for	eng	Y	N	O	O

a	x	N	N	O	O

list	eng	N	N	O	O

of	eng	N	N	O	O

keywords	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

list	eng	N	N	O	O

of	eng	N	N	O	O

excuses	eng	N	N	O	O

identifying	eng	N	N	O	O

lame	eng	N	N	O	O

excuses	eng	N	N	O	O
.	m	N	N	O	O

Keywords	eng	N	N	O	O

can	eng	N	N	O	O

be	eng	Y	N	O	O

matched	eng	N	N	O	O

in	eng	Y	N	O	O

an	eng	Y	N	O	O

excuse	eng	N	N	O	O

regardless	eng	N	N	O	O

of	eng	N	N	O	O

case	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

Input	eng	N	N	O	O

to	eng	N	N	O	O

your	eng	N	N	O	O

program	eng	N	N	O	O

will	eng	N	N	O	O

consist	eng	N	N	O	O

of	eng	N	N	O	O

multiple	eng	N	N	O	O

sets	eng	N	N	O	O

of	eng	N	N	O	O

data	eng	N	N	O	O
.	m	N	N	O	O

Line	eng	N	N	O	O

1	x	N	N	O	O

of	eng	N	N	O	O

each	eng	N	N	O	O

set	eng	N	N	O	O

will	eng	N	N	O	O

contain	eng	N	N	O	O

exactly	eng	N	N	O	O

two	eng	N	N	O	O

integers	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

first	eng	N	N	O	O

number	eng	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

K	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

20	m	N	N	O	O
)	x	N	N	O	O

defines	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

keywords	eng	N	N	O	O

to	eng	N	N	O	O

be	eng	Y	N	O	O

used	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

search	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

second	eng	N	N	O	O

number	eng	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

E	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

20	m	N	N	O	O
)	x	N	N	O	O

defines	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

excuses	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

set	eng	N	N	O	O

to	eng	N	N	O	O

be	eng	Y	N	O	O

searched	eng	N	N	O	O
.	m	N	N	O	O

Lines	eng	N	N	O	O

2	x	N	N	O	O

through	eng	N	N	O	O

K	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O

each	eng	N	N	O	O

contain	eng	N	N	O	O

exactly	eng	N	N	O	O

one	eng	N	N	O	O

keyword	eng	N	N	O	O
.	m	N	N	O	O

Lines	eng	N	N	O	O

K	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O

through	eng	N	N	O	O

K	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
+	x	N	N	O	O
E	eng	N	N	O	O

each	eng	N	N	O	O

contain	eng	N	N	O	O

exactly	eng	N	N	O	O

one	eng	N	N	O	O

excuse	eng	N	N	O	O
.	m	N	N	O	O

All	eng	N	N	O	O

keywords	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

keyword	eng	N	N	O	O

list	eng	N	N	O	O

will	eng	N	N	O	O

contain	eng	N	N	O	O

only	eng	N	N	O	O

contiguous	eng	N	N	O	O

lower	eng	N	N	O	O

case	eng	N	N	O	O

alphabetic	eng	N	N	O	O

characters	eng	N	N	O	O

of	eng	N	N	O	O

length	eng	N	N	O	O

L	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

L	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

20	m	N	N	O	O
)	x	N	N	O	O

and	eng	N	N	O	O

will	eng	N	N	O	O

occupy	eng	N	N	O	O

columns	eng	N	N	O	O

1	x	N	N	O	O

through	eng	N	N	O	O

L	x	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

input	eng	N	N	O	O

line	eng	N	N	O	O
.	m	N	N	O	O

All	eng	N	N	O	O

excuses	eng	N	N	O	O

can	eng	N	N	O	O

contain	eng	N	N	O	O

any	eng	N	N	O	O

upper	eng	N	N	O	O

or	eng	Y	N	O	O

lower	eng	N	N	O	O

case	eng	N	N	O	O

alphanumeric	eng	N	N	O	O

character	eng	N	N	O	O
,	x	N	N	O	O

a	x	N	N	O	O

space	eng	N	N	O	O
,	x	N	N	O	O

or	eng	Y	N	O	O

any	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

following	eng	N	N	O	O

punctuation	eng	N	N	O	O

marks	eng	N	N	O	O

[	x	N	N	O	O
"	x	N	N	O	O
.	x	N	N	O	O
,	x	N	N	O	O
!	x	N	N	O	O
?	x	N	N	O	O
]	x	N	N	O	O

not	eng	N	N	O	O

including	eng	N	N	O	O

the	eng	N	N	O	O

square	eng	N	N	O	O

brackets	eng	N	N	O	O

and	eng	N	N	O	O

will	eng	N	N	O	O

not	eng	N	N	O	O

exceed	eng	N	N	O	O

70	m	N	N	O	O

characters	eng	N	N	O	O

in	eng	Y	N	O	O

length	eng	N	N	O	O
.	m	N	N	O	O

Excuses	eng	N	N	O	O

will	eng	N	N	O	O

contain	eng	N	N	O	O

at	eng	N	N	O	O

least	eng	N	N	O	O

1	x	N	N	O	O

non	eng	N	N	O	O
-	x	N	N	O	O
space	eng	N	N	O	O

character	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

input	eng	N	N	O	O

set	eng	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

are	eng	N	N	O	O

to	eng	N	N	O	O

print	eng	N	N	O	O

the	eng	N	N	O	O

worst	eng	N	N	O	O

excuse	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

list	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

worst	eng	N	N	O	O

excuse	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O

is	eng	N	N	O	O
/	x	N	N	O	O
are	eng	N	N	O	O

defined	eng	N	N	O	O

as	eng	Y	N	O	O

the	eng	N	N	O	O

excuse	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O

which	eng	N	N	O	O

contains	eng	N	N	O	O

the	eng	N	N	O	O

largest	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

incidences	eng	N	N	O	O

of	eng	N	N	O	O

keywords	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

a	x	N	N	O	O

keyword	eng	N	N	O	O

occurs	eng	N	N	O	O

more	eng	N	N	O	O

than	eng	N	N	O	O

once	eng	N	N	O	O

in	eng	Y	N	O	O

an	eng	Y	N	O	O

excuse	eng	N	N	O	O
,	x	N	N	O	O

each	eng	N	N	O	O

occurrance	eng	N	N	O	O

is	eng	N	N	O	O

considered	eng	N	N	O	O

a	x	N	N	O	O

separate	eng	N	N	O	O

incidence	eng	N	N	O	O
.	m	N	N	O	O

A	x	N	N	O	O

keyword	eng	N	N	O	O

"	x	N	N	O	O
occurs	eng	N	N	O	O
"	x	N	N	O	O

in	eng	Y	N	O	O

an	eng	Y	N	O	O

excuse	eng	N	N	O	O

if	eng	N	N	O	O

and	eng	N	N	O	O

only	eng	N	N	O	O

if	eng	N	N	O	O

it	eng	N	N	O	O

exists	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

string	eng	N	N	O	O

in	eng	Y	N	O	O

contiguous	eng	N	N	O	O

form	eng	N	N	O	O

and	eng	N	N	O	O

is	eng	N	N	O	O

delimited	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

beginning	eng	N	N	O	O

or	eng	Y	N	O	O

end	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O

or	eng	Y	N	O	O

any	eng	N	N	O	O

non	eng	N	N	O	O
-	x	N	N	O	O
alphabetic	eng	N	N	O	O

character	eng	N	N	O	O

or	eng	Y	N	O	O

a	x	N	N	O	O

space	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

set	eng	N	N	O	O

of	eng	N	N	O	O

input	eng	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

are	eng	N	N	O	O

to	eng	N	N	O	O

print	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

line	eng	N	N	O	O

with	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

set	eng	N	N	O	O

immediately	eng	N	N	O	O

after	eng	N	N	O	O

the	eng	N	N	O	O

string	eng	N	N	O	O

"	x	N	N	O	O
Excuse	eng	N	N	O	O

Set	eng	N	N	O	O

#	x	N	N	O	O
"	x	N	N	O	O
.	x	N	N	O	O

(	x	N	N	O	O
See	eng	N	N	O	O

the	eng	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O

The	eng	N	N	O	O

following	eng	N	N	O	O

line	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O

is	eng	N	N	O	O
/	x	N	N	O	O
are	eng	N	N	O	O

to	eng	N	N	O	O

contain	eng	N	N	O	O

the	eng	N	N	O	O

worst	eng	N	N	O	O

excuse	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O

one	eng	N	N	O	O

per	eng	N	N	O	O

line	eng	N	N	O	O

exactly	eng	N	N	O	O

as	eng	Y	N	O	O

read	eng	N	N	O	O

in	eng	Y	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

there	eng	N	N	O	O

is	eng	N	N	O	O

more	eng	N	N	O	O

than	eng	N	N	O	O

one	eng	N	N	O	O

worst	eng	N	N	O	O

excuse	eng	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

may	eng	N	N	O	O

print	eng	N	N	O	O

them	eng	N	N	O	O

in	eng	Y	N	O	O

any	eng	N	N	O	O

order	eng	N	N	O	O
.	m	N	N	O	O

After	eng	N	N	O	O

each	eng	N	N	O	O

set	eng	N	N	O	O

of	eng	N	N	O	O

output	eng	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

should	eng	N	N	O	O

print	eng	N	N	O	O

a	x	N	N	O	O

blank	eng	N	N	O	O

line	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

5	x	N	N	O	O

3	x	N	N	O	O

dog	eng	N	N	O	O

ate	eng	N	N	O	O

homework	eng	N	N	O	O

canary	eng	N	N	O	O

died	eng	N	N	O	O

My	eng	N	N	O	O

dog	eng	N	N	O	O

ate	eng	N	N	O	O

my	eng	N	N	O	O

homework	eng	N	N	O	O
.	m	N	N	O	O

Can	eng	N	N	O	O

you	eng	N	N	O	O

believe	eng	N	N	O	O

my	eng	N	N	O	O

dog	eng	N	N	O	O

died	eng	N	N	O	O

after	eng	N	N	O	O

eating	eng	N	N	O	O

my	eng	N	N	O	O

canary	eng	N	N	O	O
...	m	N	N	O	O

AND	eng	N	N	O	O

MY	eng	N	N	O	O

HOMEWORK	eng	N	N	O	O
?	x	N	N	O	O

This	eng	N	N	O	O

excuse	eng	N	N	O	O

is	eng	N	N	O	O

so	eng	N	N	O	O

good	eng	N	N	O	O

that	eng	N	N	O	O

it	eng	N	N	O	O

contain	eng	N	N	O	O

0	x	N	N	O	O

keywords	eng	N	N	O	O
.	m	N	N	O	O

6	x	N	N	O	O

5	x	N	N	O	O

superhighway	eng	N	N	O	O

crazy	eng	N	N	O	O

thermonuclear	eng	N	N	O	O

bedroom	eng	N	N	O	O

war	eng	N	N	O	O

building	eng	N	N	O	O

I	x	N	N	O	O

am	eng	Y	N	O	O

having	eng	N	N	O	O

a	x	N	N	O	O

superhighway	eng	N	N	O	O

built	eng	N	N	O	O

in	eng	Y	N	O	O

my	eng	N	N	O	O

bedroom	eng	N	N	O	O
.	m	N	N	O	O

I	x	N	N	O	O

am	eng	Y	N	O	O

actually	eng	N	N	O	O

crazy	eng	N	N	O	O
.	m	N	N	O	O

1234567890.....	m	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
0987654321	m	N	N	O	O
?	x	N	N	O	O
?	x	N	N	O	O
?	x	N	N	O	O
?	x	N	N	O	O
?	x	N	N	O	O
!	x	N	N	O	O
!	x	N	N	O	O
!	x	N	N	O	O
!	x	N	N	O	O
!	x	N	N	O	O
!	x	N	N	O	O

There	eng	N	N	O	O

was	eng	N	N	O	O

a	x	N	N	O	O

thermonuclear	eng	N	N	O	O

war	eng	N	N	O	O
!	x	N	N	O	O

I	x	N	N	O	O

ate	eng	N	N	O	O

my	eng	N	N	O	O

dog	eng	N	N	O	O
,	x	N	N	O	O

my	eng	N	N	O	O

canary	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

my	eng	N	N	O	O

homework	eng	N	N	O	O

...	m	N	N	O	O

note	eng	N	N	O	O

outdated	eng	N	N	O	O

keywords	eng	N	N	O	O
?	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

Excuse	eng	N	N	O	O

Set	eng	N	N	O	O

#	x	N	N	O	O
1	m	N	N	O	O

Can	eng	N	N	O	O

you	eng	N	N	O	O

believe	eng	N	N	O	O

my	eng	N	N	O	O

dog	eng	N	N	O	O

died	eng	N	N	O	O

after	eng	N	N	O	O

eating	eng	N	N	O	O

my	eng	N	N	O	O

canary	eng	N	N	O	O
...	m	N	N	O	O

AND	eng	N	N	O	O

MY	eng	N	N	O	O

HOMEWORK	eng	N	N	O	O
?	x	N	N	O	O

Excuse	eng	N	N	O	O

Set	eng	N	N	O	O

#	x	N	N	O	O
2	m	N	N	O	O

I	x	N	N	O	O

am	eng	Y	N	O	O

having	eng	N	N	O	O

a	x	N	N	O	O

superhighway	eng	N	N	O	O

built	eng	N	N	O	O

in	eng	Y	N	O	O

my	eng	N	N	O	O

bedroom	eng	N	N	O	O
.	m	N	N	O	O

There	eng	N	N	O	O

was	eng	N	N	O	O

a	x	N	N	O	O

thermonuclear	eng	N	N	O	O

war	eng	N	N	O	O
!	x	N	N	O	O

题目	n	Y	N	O	O
大概	d	N	N	O	O
意思	n	N	N	O	O
：	x	N	N	O	O
给出	v	N	N	O	O
N	eng	N	N	O	O
个	m	N	N	O	O
关键词	n	N	N	O	O
，	x	N	N	O	O
M	eng	N	N	O	O
个	m	N	N	O	O
句子	n	N	N	O	O
，	x	N	N	O	O
打印	v	Y	N	O	O
含有	v	N	N	O	O
关键词	n	N	N	O	O
最多	a	N	N	O	O
的	uj	N	N	O	O
句子	n	N	N	O	O
,	x	N	N	O	O
如果	c	N	N	O	O
句子	n	N	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
词	n	N	N	O	O
为	p	N	N	O	O
大写	n	N	N	O	O
，	x	N	N	O	O
但	c	N	N	O	O
转换	v	Y	N	O	O
为	p	N	N	O	O
小写	n	N	N	O	O
时	ng	N	N	O	O
是	v	N	N	O	O
关键词	n	N	N	O	O
的	uj	N	N	O	O
也	d	N	N	O	O
考虑	v	N	N	O	O
进去	v	N	N	O	O
。	x	N	N	O	O

这个	r	N	N	O	O
题	n	N	N	O	O
没有	v	N	N	O	O
什么	r	N	N	O	O
井	zg	N	N	O	O
，	x	N	N	O	O
直接	ad	N	N	O	O
打	v	N	N	O	O
就	d	N	N	O	O
可以	c	N	N	O	O
。	x	N	N	O	O

代码	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
ctype	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
freopen	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
in	eng	Y	N	O	O
.	m	N	N	O	O
txt	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
r	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
stdin	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
max	eng	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
len	eng	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

word	eng	N	N	O	O
[	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
excuse	eng	N	N	O	O
[	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
71	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
ch	eng	Y	N	O	O
[	x	N	N	O	O
71	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

getchar	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
word	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

getchar	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

www	eng	N	N	O	O
.2	m	N	N	O	O
cto	eng	N	N	O	O
.	m	N	N	O	O
com	eng	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

max	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

gets	eng	N	N	O	O
(	x	N	N	O	O
excuse	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

len	eng	N	N	O	O
=	x	N	N	O	O
strlen	eng	N	N	O	O
(	x	N	N	O	O
excuse	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
<	x	N	N	O	O
len	eng	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

a	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
isalpha	eng	N	N	O	O
(	x	N	N	O	O
excuse	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ch	eng	Y	N	O	O
[	x	N	N	O	O
a	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
tolower	eng	N	N	O	O
(	x	N	N	O	O
excuse	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ch	eng	Y	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
\	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
strcmp	eng	N	N	O	O
(	x	N	N	O	O
ch	eng	Y	N	O	O
,	x	N	N	O	O
word	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

num	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

max	eng	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
?	x	N	N	O	O
max	eng	N	N	O	O
:	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
Excuse	eng	N	N	O	O

Set	eng	N	N	O	O

#	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
t	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
excuse	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

作者	n	N	N	O	O
：	x	N	N	O	O
ultimater	eng	N	N	O	O
poj	eng	N	Y	B-OJ	B-OJ

2777	m	N	N	I-OJ	O

Count	eng	N	N	O	O

Color	eng	N	N	O	O

-	x	N	N	O	O

静涛	nr	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
更新	d	N	N	O	O
区间	n	Y	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
区间	n	Y	N	O	O
数	m	N	N	O	O
的	uj	N	N	O	O
种类	n	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

max	eng	N	N	O	O
=	x	N	N	O	O
100000	m	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

flag	eng	N	N	O	O
[	x	N	N	O	O
31	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

node	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

left	eng	N	N	O	O
,	x	N	N	O	O
right	eng	N	N	O	O
,	x	N	N	O	O
color	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

id	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
这里	r	N	N	O	O
是	v	N	N	O	O
参数	n	N	N	O	O
l	x	N	N	O	O
，	x	N	N	O	O
大写	n	N	N	O	O
是	v	N	N	O	O
L	eng	N	N	O	O
，	x	N	N	O	O
而	c	N	N	O	O
不是	c	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
错	v	N	N	O	O
了	ul	N	N	O	O
几次	m	N	N	O	O

nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O

nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
color	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
这里	r	N	N	O	O
是	v	N	N	O	O
数字	n	Y	N	O	O
1	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
,	x	N	N	O	O
id	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
id	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
|	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

id	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

cc	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
l	eng	N	N	O	O
&&	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
color	eng	N	N	O	O
=	x	N	N	O	O
cc	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
color	eng	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
懒惰	a	N	N	O	O
标记	n	N	N	O	O
，	x	N	N	O	O
标记	n	N	N	O	O
父	n	N	N	O	O
节点	n	N	N	O	O
，	x	N	N	O	O
而	c	N	N	O	O
暂时	d	N	N	O	O
不	d	N	N	O	O
更新	d	N	N	O	O
子	ng	N	N	O	O
节点	n	N	N	O	O
，	x	N	N	O	O
当要	d	N	N	O	O
询问	v	N	N	O	O
时	ng	N	N	O	O
再	d	N	N	O	O
来	v	N	N	O	O
更新	d	N	N	O	O

{	x	N	N	O	O

nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
color	eng	N	N	O	O
=	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
color	eng	N	N	O	O
;	x	N	N	O	O

nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
color	eng	N	N	O	O
=	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
color	eng	N	N	O	O
;	x	N	N	O	O

nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
color	eng	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O
+	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
cc	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
<	x	N	N	O	O
l	x	N	N	O	O
)	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
cc	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
,	x	N	N	O	O
cc	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
cc	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

count	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

id	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
color	eng	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

flag	eng	N	N	O	O
[	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
color	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O
+	x	N	N	O	O
nodes	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

count	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
<	x	N	N	O	O
l	x	N	N	O	O
)	x	N	N	O	O

count	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

count	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
,	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

count	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
id	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
ee	eng	N	N	O	O
,	x	N	N	O	O
ff	eng	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

char1	eng	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
k	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

getchar	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
c	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
char1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
char1	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
C	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
b	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
c	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
>	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
ee	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
ff	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
flag	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
flag	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ee	eng	N	N	O	O
>	x	N	N	O	O
ff	eng	N	N	O	O
)	x	N	N	O	O

count	eng	N	N	O	O
(	x	N	N	O	O
ff	eng	N	N	O	O
,	x	N	N	O	O
ee	eng	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

count	eng	N	N	O	O
(	x	N	N	O	O
ee	eng	N	N	O	O
,	x	N	N	O	O
ff	eng	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
flag	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
sum	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

pku	eng	N	Y	B-OJ	B-OJ

3140	m	N	N	I-OJ	I-OJ
_	x	N	N	O	O
chenjiang	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

题意	n	N	N	O	O
：	x	N	N	O	O
有	v	N	N	O	O
一棵树	ns	N	N	O	O
，	x	N	N	O	O
数	m	N	N	O	O
的	uj	N	N	O	O
每个	r	N	N	O	O
节点	n	N	N	O	O
有	v	N	N	O	O
一个	m	N	N	O	O
权值	n	N	N	O	O
，	x	N	N	O	O
删去	v	N	N	O	O
树中	s	N	N	O	O
的	uj	N	N	O	O
一条	m	N	N	O	O
边	d	N	N	O	O
，	x	N	N	O	O
得到	v	N	N	O	O
两	m	N	N	O	O
部分	n	Y	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
这	r	N	N	O	O
两	m	N	N	O	O
部分	n	Y	N	O	O
权值	n	N	N	O	O
和	c	N	N	O	O
的	uj	N	N	O	O
差	n	N	N	O	O
最少	d	N	N	O	O
是	v	N	N	O	O
多少	m	N	N	O	O

思路	n	N	N	O	O
：	x	N	N	O	O
树形	n	Y	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
，	x	N	N	O	O
递归	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
建树	n	Y	N	O	O
并	c	N	N	O	O
求出	v	N	N	O	O
树中	s	N	N	O	O
每个	r	N	N	O	O
节点	n	N	N	O	O
root	eng	N	N	O	O
所属	b	N	N	O	O
子树	n	N	N	O	O
的	uj	N	N	O	O
权值	n	N	N	O	O
和	c	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
求	v	N	N	O	O
每个	r	N	N	O	O
节点	n	N	N	O	O
删除	v	N	N	O	O
他	r	N	N	O	O
和	c	N	N	O	O
孩子	n	N	N	O	O
节点	n	N	N	O	O
后	f	N	N	O	O
分成	v	N	N	O	O
的	uj	N	N	O	O
两	m	N	N	O	O
部分	n	Y	N	O	O
的	uj	N	N	O	O
权值	n	N	N	O	O
差	n	N	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
的	uj	N	N	O	O
最小	a	Y	N	O	O
那个	r	N	N	O	O
就行了	l	N	N	O	O

const	eng	N	N	O	O

double	eng	N	N	O	O

PI	eng	N	N	O	O

=	x	N	N	O	O

acos	eng	N	N	O	O
(	x	N	N	O	O
-	x	N	N	O	O
1.0	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

double	eng	N	N	O	O

eps	eng	N	N	O	O

=	x	N	N	O	O

1	m	N	N	O	O
e	eng	N	N	O	O
-	x	N	N	O	O
11	m	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

_	x	N	N	O	O
max	eng	N	N	O	O

100005	m	N	N	O	O

int	eng	N	N	O	O

head	eng	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

head0	eng	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

node	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

to	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

next	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
max	eng	N	N	O	O
*	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
edge0	eng	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

e	eng	N	N	O	O
_	x	N	N	O	O
num0	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

e	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

num	eng	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

ans	eng	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

visited	eng	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

labs	eng	N	N	O	O
(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O

k	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

return	eng	N	N	O	O

-	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

add	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

from	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

to	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

e	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
e	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
;	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
=	x	N	N	O	O
to	eng	N	N	O	O
;	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
next	eng	N	N	O	O
=	x	N	N	O	O
head	eng	N	N	O	O
[	x	N	N	O	O
from	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

head	eng	N	N	O	O
[	x	N	N	O	O
from	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

add0	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

from	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

to	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

e	eng	N	N	O	O
_	x	N	N	O	O
num0	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
e	eng	N	N	O	O
_	x	N	N	O	O
num0	eng	N	N	O	O
;	x	N	N	O	O

edge0	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
=	x	N	N	O	O
to	eng	N	N	O	O
;	x	N	N	O	O

edge0	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
next	eng	N	N	O	O
=	x	N	N	O	O
head0	eng	N	N	O	O
[	x	N	N	O	O
from	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

head0	eng	N	N	O	O
[	x	N	N	O	O
from	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

Build	eng	N	N	O	O
_	x	N	N	O	O
Tree	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

root	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
head	eng	N	N	O	O
[	x	N	N	O	O
root	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
next	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

son	eng	N	N	O	O
=	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
visited	eng	N	N	O	O
[	x	N	N	O	O
son	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
continue	eng	N	N	O	O
;	x	N	N	O	O

visited	eng	N	N	O	O
[	x	N	N	O	O
son	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

add0	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
,	x	N	N	O	O
son	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

Build	eng	N	N	O	O
_	x	N	N	O	O
Tree	eng	N	N	O	O
(	x	N	N	O	O
son	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
root	eng	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
son	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

root	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
head0	eng	N	N	O	O
[	x	N	N	O	O
root	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
edge0	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
next	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

son	eng	N	N	O	O
=	x	N	N	O	O
edge0	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
,	x	N	N	O	O
labs	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O
-	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
son	eng	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
son	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
son	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

argc	eng	N	N	O	O
,	x	N	N	O	O

char	eng	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O

argv	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ca	eng	Y	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	m	N	N	O	O
&&	x	N	N	O	O
m	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

num	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

num	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

e	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
head	eng	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
head	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

from	eng	N	N	O	O
,	x	N	N	O	O
to	eng	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
from	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
to	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

add	eng	N	N	O	O
(	x	N	N	O	O
from	eng	N	N	O	O
,	x	N	N	O	O
to	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

add	eng	N	N	O	O
(	x	N	N	O	O
to	eng	N	N	O	O
,	x	N	N	O	O
from	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
Case	eng	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
:	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
++	x	N	N	O	O
ca	eng	Y	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
visited	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
visited	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

visited	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
head0	eng	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
head0	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

e	eng	N	N	O	O
_	x	N	N	O	O
num0	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

Build	eng	N	N	O	O
_	x	N	N	O	O
Tree	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
long	eng	N	N	O	O

long	eng	N	N	O	O
)	x	N	N	O	O

INT	eng	N	N	O	O
_	x	N	N	O	O
MAX	eng	N	N	O	O

*	x	N	N	O	O

(	x	N	N	O	O
long	eng	N	N	O	O

long	eng	N	N	O	O
)	x	N	N	O	O

10000	m	N	N	O	O
;	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
Case	eng	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
:	x	N	N	O	O

%	x	N	N	O	O
I64d	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
++	x	N	N	O	O
ca	eng	Y	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
EXIT	eng	N	N	O	O
_	x	N	N	O	O
SUCCESS	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

pku1160	eng	N	Y	B-OJ	B-OJ

Post	eng	N	N	O	O

Office	eng	N	N	O	O

解题	n	N	N	O	O
报告	n	N	N	O	O

-	x	N	N	O	O

xxm137164869	eng	N	N	O	O
的	uj	N	N	O	O
专栏	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

思路	n	N	N	O	O
：	x	N	N	O	O
用	p	N	N	O	O
opt	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
记录	n	Y	N	O	O
把	p	N	N	O	O
前	f	N	N	O	O
i	eng	N	N	O	O
个	m	N	N	O	O
邮局	n	N	N	O	O
建到	v	N	N	O	O
前	f	N	N	O	O
j	eng	N	N	O	O
个	m	N	N	O	O
村庄	n	N	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
最优	d	N	N	O	O
解	v	N	N	O	O
，	x	N	N	O	O
用	p	N	N	O	O
cost	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
记录	n	Y	N	O	O
所有	b	N	N	O	O
在	p	N	N	O	O
i	eng	N	N	O	O
到	v	N	N	O	O
j	eng	N	N	O	O
村庄	n	N	N	O	O
中	f	N	N	O	O
，	x	N	N	O	O
建	n	N	N	O	O
1	m	N	N	O	O
个	m	N	N	O	O
邮局	n	N	N	O	O
的	uj	N	N	O	O
最小	a	Y	N	O	O
代价	n	N	N	O	O
。	x	N	N	O	O

显然	ad	N	N	O	O
邮局	n	N	N	O	O
应该	v	N	N	O	O
设到	v	N	N	O	O
中点	n	N	N	O	O
。	x	N	N	O	O

让	v	N	N	O	O
前	f	N	N	O	O
i	eng	N	N	O	O
个	m	N	N	O	O
邮局	n	N	N	O	O
覆盖	v	Y	N	O	O
前	f	N	N	O	O
j	eng	N	N	O	O
个	m	N	N	O	O
村庄	n	N	N	O	O
，	x	N	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
个	m	N	N	O	O
邮局	n	N	N	O	O
覆盖	v	Y	N	O	O
第	m	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
至	p	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
个	m	N	N	O	O
村庄	n	N	N	O	O
(	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
状态	n	Y	N	O	O
转移	v	N	N	O	O
方程	n	Y	N	O	O
为	p	N	N	O	O

opt	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
{	x	N	N	O	O
opt	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
cost	eng	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

(	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
j	eng	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

代码	n	N	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O

Code	eng	N	N	O	O
:	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

Max	eng	N	N	O	O
(	x	N	N	O	O
305	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

data	eng	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

op	eng	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cost	eng	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
;	x	N	N	O	O

cost	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

cost	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
mid	eng	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
?	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
mid	eng	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
:	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
mid	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

op	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
3000000	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

op	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
op	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
3000000	m	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
op	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
op	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
cost	eng	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

op	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
op	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
cost	eng	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
op	eng	N	N	O	O
[	x	N	N	O	O
m	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

1091	m	N	N	I-OJ	O

跳蚤	n	N	N	O	O

-	x	N	N	O	O

bobten2008	eng	N	N	O	O
的	uj	N	N	O	O
专栏	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

跳蚤	n	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

10000	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

3977	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

1002	m	N	N	O	O

Description	eng	N	N	O	O

Z	x	N	N	O	O
城市	ns	N	N	O	O
居住	v	N	N	O	O
着	uz	N	N	O	O
很多	m	N	N	O	O
只	d	N	N	O	O
跳蚤	n	N	N	O	O
。	x	N	N	O	O

在	p	N	N	O	O
Z	eng	N	N	O	O
城市	ns	N	N	O	O
周六	t	N	N	O	O
生活	vn	N	N	O	O
频道	n	N	N	O	O
有	v	N	N	O	O
一个	m	N	N	O	O
娱乐节目	n	N	N	O	O
。	x	N	N	O	O

一只	m	N	N	O	O
跳蚤	n	N	N	O	O
将	d	N	N	O	O
被	p	N	N	O	O
请	v	N	N	O	O
上	f	N	N	O	O
一个	m	N	N	O	O
高空	n	N	N	O	O
钢丝	n	N	N	O	O
的	uj	N	N	O	O
正	a	N	N	O	O
中央	n	N	N	O	O
。	x	N	N	O	O

钢丝	n	N	N	O	O
很	d	N	N	O	O
长	a	N	N	O	O
，	x	N	N	O	O
可以	c	N	N	O	O
看作	v	N	N	O	O
是	v	N	N	O	O
无限	v	Y	N	O	O
长	a	N	N	O	O
。	x	N	N	O	O

节目	n	N	N	O	O
主持人	n	N	N	O	O
会	v	N	N	O	O
给	p	N	N	O	O
该	r	N	N	O	O
跳蚤	n	N	N	O	O
发	v	N	N	O	O
一张	m	N	N	O	O
卡片	nz	N	N	O	O
。	x	N	N	O	O

卡片	nz	N	N	O	O
上	f	N	N	O	O
写有	v	N	N	O	O
N	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
个	m	N	N	O	O
自然数	l	N	N	O	O
。	x	N	N	O	O

其中	r	N	N	O	O
最后	f	N	N	O	O
一个	m	N	N	O	O
是	v	N	N	O	O
M	eng	N	N	O	O
，	x	N	N	O	O
而前	t	N	N	O	O
N	eng	N	N	O	O
个数	n	Y	N	O	O
都	d	N	N	O	O
不	d	N	N	O	O
超过	v	N	N	O	O
M	x	N	N	O	O
，	x	N	N	O	O
卡片	nz	N	N	O	O
上	f	N	N	O	O
允许	v	N	N	O	O
有	v	N	N	O	O
相同	d	N	N	O	O
的	uj	N	N	O	O
数字	n	Y	N	O	O
。	x	N	N	O	O

跳蚤	n	N	N	O	O
每次	r	N	N	O	O
可以	c	N	N	O	O
从	p	N	N	O	O
卡片	nz	N	N	O	O
上	f	N	N	O	O
任意	v	Y	N	O	O
选择	v	N	N	O	O
一个	m	N	N	O	O
自然数	l	N	N	O	O
S	x	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
向	p	N	N	O	O
左	m	N	N	O	O
，	x	N	N	O	O
或	c	N	N	O	O
向	p	N	N	O	O
右	f	N	N	O	O
跳	v	N	N	O	O
S	eng	N	N	O	O
个	m	N	N	O	O
单位	n	N	N	O	O
长度	ns	Y	N	O	O
。	x	N	N	O	O

而	c	N	N	O	O
他	r	N	N	O	O
最终	d	N	N	O	O
的	uj	N	N	O	O
任务	n	N	N	O	O
是	v	N	N	O	O
跳	v	N	N	O	O
到	v	N	N	O	O
距离	n	Y	N	O	O
他	r	N	N	O	O
左边	f	N	N	O	O
一个	m	N	N	O	O
单位	n	N	N	O	O
长度	ns	Y	N	O	O
的	uj	N	N	O	O
地方	n	N	N	O	O
，	x	N	N	O	O
并	c	N	N	O	O
捡起	v	N	N	O	O
位于	v	N	N	O	O
那里	r	N	N	O	O
的	uj	N	N	O	O
礼物	n	N	N	O	O
。	x	N	N	O	O

比如	v	N	N	O	O
当	t	N	N	O	O
N	eng	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
，	x	N	N	O	O
M	x	N	N	O	O
=	x	N	N	O	O
18	m	N	N	O	O
时	n	N	N	O	O
，	x	N	N	O	O
持有	v	N	N	O	O
卡片	nz	N	N	O	O
(	x	N	N	O	O
10	m	N	N	O	O
,	x	N	N	O	O

15	m	N	N	O	O
,	x	N	N	O	O

18	m	N	N	O	O
)	x	N	N	O	O
的	uj	N	N	O	O
跳蚤	n	N	N	O	O
，	x	N	N	O	O
就	d	N	N	O	O
可以	c	N	N	O	O
完成	v	N	N	O	O
任务	n	N	N	O	O
：	x	N	N	O	O
他	r	N	N	O	O
可以	c	N	N	O	O
先向	n	N	N	O	O
左	f	N	N	O	O
跳	v	N	N	O	O
10	m	N	N	O	O
个	m	N	N	O	O
单位	n	N	N	O	O
长度	ns	Y	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
再连	d	N	N	O	O
向	p	N	N	O	O
左	f	N	N	O	O
跳	v	N	N	O	O
3	m	N	N	O	O
次	t	N	N	O	O
，	x	N	N	O	O
每次	r	N	N	O	O
15	m	N	N	O	O
个	m	N	N	O	O
单位	n	N	N	O	O
长度	ns	Y	N	O	O
，	x	N	N	O	O
最后	f	N	N	O	O
再	d	N	N	O	O
向	p	N	N	O	O
右	f	N	N	O	O
连	u	N	N	O	O
跳	v	N	N	O	O
3	m	N	N	O	O
次	t	N	N	O	O
，	x	N	N	O	O
每次	r	N	N	O	O
18	m	N	N	O	O
个	m	N	N	O	O
单位	n	N	N	O	O
长度	ns	Y	N	O	O
。	x	N	N	O	O

而	c	N	N	O	O
持有	v	N	N	O	O
卡片	nz	N	N	O	O
(	x	N	N	O	O
12	m	N	N	O	O
,	x	N	N	O	O

15	m	N	N	O	O
,	x	N	N	O	O

18	m	N	N	O	O
)	x	N	N	O	O
的	uj	N	N	O	O
跳蚤	n	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
怎么	r	N	N	O	O
也	d	N	N	O	O
不	d	N	N	O	O
可能	v	N	N	O	O
跳到	v	N	N	O	O
距	p	N	N	O	O
他	r	N	N	O	O
左边	f	N	N	O	O
一个	m	N	N	O	O
单位	n	N	N	O	O
长度	ns	Y	N	O	O
的	uj	N	N	O	O
地方	n	N	N	O	O
。	x	N	N	O	O

当	t	N	N	O	O
确定	v	N	N	O	O
N	eng	N	N	O	O
和	c	N	N	O	O
M	eng	N	N	O	O
后	t	N	N	O	O
，	x	N	N	O	O
显然	ad	N	N	O	O
一共	j	N	N	O	O
有	v	N	N	O	O
M	eng	N	N	O	O
^	x	N	N	O	O
N	eng	N	N	O	O
张	nr	N	N	O	O
不同	a	N	N	O	O
的	uj	N	N	O	O
卡片	nz	N	N	O	O
。	x	N	N	O	O

现在	t	N	N	O	O
的	uj	N	N	O	O
问题	n	N	N	O	O
是	v	N	N	O	O
，	x	N	N	O	O
在	p	N	N	O	O
这	r	N	N	O	O
所有	b	N	N	O	O
的	uj	N	N	O	O
卡片	nz	N	N	O	O
中	f	N	N	O	O
，	x	N	N	O	O
有	v	N	N	O	O
多少	m	N	N	O	O
张	q	N	N	O	O
可以	c	N	N	O	O
完成	v	N	N	O	O
任务	n	N	N	O	O
。	x	N	N	O	O

Input	eng	N	N	O	O

两个	m	N	N	O	O
整数	n	Y	N	O	O
N	eng	N	N	O	O
和	c	N	N	O	O
M	eng	N	N	O	O
(	x	N	N	O	O
N	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

15	m	N	N	O	O

,	x	N	N	O	O

M	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

100000000	m	N	N	O	O
)	x	N	N	O	O
。	x	N	N	O	O

Output	eng	N	N	O	O

可以	c	N	N	O	O
完成	v	N	N	O	O
任务	n	N	N	O	O
的	uj	N	N	O	O
卡片	nz	N	N	O	O
数	n	N	N	O	O
。	x	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

2	x	N	N	O	O

4	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

12	m	N	N	O	O

Hint	eng	N	N	O	O

这	r	N	N	O	O
12	m	N	N	O	O
张	nr	N	N	O	O
卡片	nz	N	N	O	O
分别	d	N	N	O	O
是	v	N	N	O	O
：	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

2	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

3	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O

3	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
3	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
3	x	N	N	O	O
,	x	N	N	O	O

2	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
3	x	N	N	O	O
,	x	N	N	O	O

3	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
3	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
4	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
4	x	N	N	O	O
,	x	N	N	O	O

3	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O

Source	eng	N	N	O	O

HNOI	eng	N	N	B-OJ	O

2001	m	N	N	I-OJ	O

/	x	N	N	O	O
*	x	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
pku	eng	N	Y	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
JudgeOnline	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
1091	m	N	N	O	O

这	r	N	N	O	O
题	n	N	N	O	O
考虑	v	N	N	O	O
到	v	N	N	O	O
了	ul	N	N	O	O
数论	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
和	c	N	N	O	O
组合	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
数学	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
的	uj	N	N	O	O
相关	v	N	N	O	O
知识	v	N	N	O	O
，	x	N	N	O	O
题目	n	Y	N	O	O
大意	d	N	N	O	O
是	v	N	N	O	O
给定	v	N	N	O	O
给定	v	N	N	O	O
两个	m	N	N	O	O
整数	n	Y	N	O	O
n	eng	N	N	O	O
和	c	N	N	O	O
m	eng	N	N	O	O
,	x	N	N	O	O

求	v	N	N	O	O
出	v	N	N	O	O
长度	ns	Y	N	O	O
为	p	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
满足条件	l	N	N	O	O
的	uj	N	N	O	O
数列	m	Y	N	O	O
data	eng	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
，	x	N	N	O	O
数列	m	Y	N	O	O
要求	v	N	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

data	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O

for	eng	Y	N	O	O

1	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

3	x	N	N	O	O
)	x	N	N	O	O
这个	r	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
个数	n	Y	N	O	O
满足	v	N	N	O	O
:	x	N	N	O	O

存在	v	N	N	O	O
整数	n	Y	N	O	O

x1	eng	N	N	O	O
,	x	N	N	O	O

x2	eng	N	N	O	O
,	x	N	N	O	O

...	m	N	N	O	O
,	x	N	N	O	O

xn	eng	N	N	O	O
,	x	N	N	O	O

xn	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

满足	v	N	N	O	O

x1	eng	N	N	O	O

*	x	N	N	O	O

data	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

x2	eng	N	N	O	O

*	x	N	N	O	O

data	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

...	m	N	N	O	O

+	x	N	N	O	O

xn	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O

*	x	N	N	O	O

data	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

根据	p	N	N	O	O
数论	n	Y	N	B-KNOWLEDGE	O
的	uj	N	N	O	O
知识	v	N	N	O	O
，	x	N	N	O	O
n	x	N	N	O	O
个数	n	Y	N	O	O
的	uj	N	N	O	O
最大公约数	n	N	N	O	O
规定	n	N	N	O	O
为	p	N	N	O	O
这	r	N	N	O	O
n	eng	N	N	O	O
个数	n	Y	N	O	O
线性	n	Y	N	O	O
和	c	N	N	O	O
的	uj	N	N	O	O
最小	a	Y	N	O	O
自然数	l	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
此	r	N	N	O	O
题	n	N	N	O	O
就是	d	N	N	O	O
要求	v	N	N	O	O
最大公约数	n	N	N	O	O
为	p	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
数列	m	Y	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O

由于	c	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O

是	v	N	N	O	O
已知	v	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
这	r	N	N	O	O
题	n	N	N	O	O
可以	c	N	N	O	O
用	p	N	N	O	O
组合	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
数学	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
鸽巢	n	Y	N	O	O
原理	n	Y	N	O	O
的	uj	N	N	O	O
知识	v	N	N	O	O
来解	v	N	N	O	O
，	x	N	N	O	O
步骤	n	N	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O

1	x	N	N	O	O
）	x	N	N	O	O
求出	v	N	N	O	O
m	eng	N	N	O	O
的	uj	N	N	O	O
所有	b	N	N	O	O
质	ng	N	N	O	O
约数	n	N	N	O	O
，	x	N	N	O	O
假设	vn	N	N	O	O
有	v	N	N	O	O
k	eng	N	N	O	O
个	m	N	N	O	O
如果	c	N	N	O	O
这	r	N	N	O	O
n	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
个数	n	Y	N	O	O
的	uj	N	N	O	O
最大公约数	n	N	N	O	O
不是	c	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
m	x	N	N	O	O
至少	d	N	N	O	O
含有	v	N	N	O	O
一个	m	N	N	O	O
质	ng	N	N	O	O
约数	n	N	N	O	O
，	x	N	N	O	O
这个	r	N	N	O	O
质	ng	N	N	O	O
约数	n	N	N	O	O
也	d	N	N	O	O
是	v	N	N	O	O
前	f	N	N	O	O
n	eng	N	N	O	O
个数	n	Y	N	O	O
的	uj	N	N	O	O
约数	n	N	N	O	O

2	x	N	N	O	O
）	x	N	N	O	O
序列	n	Y	N	O	O
的	uj	N	N	O	O
总	n	N	N	O	O
个数	n	Y	N	O	O
为	p	N	N	O	O

m	x	N	N	O	O

^	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

3	x	N	N	O	O
）	x	N	N	O	O
设	n	N	N	O	O
t	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
表示	v	Y	N	O	O

能够	v	N	N	O	O
整除	v	N	N	O	O

任意	v	Y	N	O	O
n	eng	N	N	O	O
个	m	N	N	O	O
m	eng	N	N	O	O
的	uj	N	N	O	O
质	n	N	N	O	O
约数	n	N	N	O	O
且	zg	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	eng	N	N	O	O
的	uj	N	N	O	O
数	m	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O

利用	n	N	N	O	O
容斥	v	Y	N	O	O
原理	n	Y	N	O	O
可知	v	N	N	O	O
公约数	n	N	N	O	O
不为	c	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
数列	m	Y	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
为	p	N	N	O	O

f	x	N	N	O	O

=	x	N	N	O	O

t	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

-	x	N	N	O	O

t	x	N	N	O	O
(	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

+	x	N	N	O	O

t	x	N	N	O	O
(	x	N	N	O	O
3	x	N	N	O	O
)	x	N	N	O	O

-	x	N	N	O	O

...	m	N	N	O	O

+	x	N	N	O	O

(	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

^	x	N	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

t	x	N	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O

符合要求	n	N	N	O	O
的	uj	N	N	O	O
序列	n	Y	N	O	O
个数	n	Y	N	O	O
为	p	N	N	O	O

m	x	N	N	O	O

^	x	N	N	O	O

n	x	N	N	O	O

-	x	N	N	O	O

f	x	N	N	O	O

代码	n	N	N	O	O
如下	t	N	N	O	O
:	x	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAX	eng	N	N	O	O
_	x	N	N	O	O
T	eng	N	N	O	O

120000	m	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

mCDSeq	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
_	x	N	N	O	O
T	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

curCDSeq	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
_	x	N	N	O	O
T	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

curRes	eng	N	N	O	O
,	x	N	N	O	O

totalCDNum	eng	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

myPow	eng	N	N	O	O
(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

y	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

res	eng	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

res	eng	N	N	O	O

*	x	N	N	O	O
=	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

res	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

getCurVal	eng	N	N	O	O
(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O

curPos	eng	N	N	O	O
,	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

curNum	eng	N	N	O	O
,	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

totalNum	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
curNum	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

totalNum	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

tempVal	eng	N	N	O	O

=	x	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

totalNum	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

tempVal	eng	N	N	O	O

/	x	N	N	O	O
=	x	N	N	O	O

curCDSeq	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

curRes	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

myPow	eng	N	N	O	O
(	x	N	N	O	O
tempVal	eng	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

curPos	eng	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

totalCDNum	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

curCDSeq	eng	N	N	O	O
[	x	N	N	O	O
curNum	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

mCDSeq	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

getCurVal	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

curNum	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

totalNum	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
寻找	v	N	N	O	O
质	ng	N	N	O	O
约数	n	N	N	O	O

void	eng	N	N	O	O

getDivisor	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

tempM	eng	N	N	O	O

=	x	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

totalCDNum	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

*	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

tempM	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tempM	eng	N	N	O	O

%	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
tempM	eng	N	N	O	O

%	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

tempM	eng	N	N	O	O

/	x	N	N	O	O
=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

mCDSeq	eng	N	N	O	O
[	x	N	N	O	O
totalCDNum	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tempM	eng	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

mCDSeq	eng	N	N	O	O
[	x	N	N	O	O
totalCDNum	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

tempM	eng	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

res	eng	N	N	O	O

=	x	N	N	O	O

myPow	eng	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

totalCDNum	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

curRes	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

getCurVal	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

%	x	N	N	O	O

2	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

res	eng	N	N	O	O

-	x	N	N	O	O
=	x	N	N	O	O

curRes	eng	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

res	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

curRes	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

res	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
res	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

getDivisor	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

PKU	eng	N	Y	B-OJ	B-OJ

1090	m	N	N	I-OJ	O

Chain	eng	N	N	O	O
_	x	N	N	O	O
Thinker	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

paradise	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

Chain	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

10000	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

1759	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

597	m	N	N	O	O

Description	eng	N	N	O	O

Byteland	eng	N	N	O	O

had	eng	N	N	O	O

not	eng	N	N	O	O

always	eng	N	N	O	O

been	eng	N	N	O	O

a	x	N	N	O	O

democratic	eng	N	N	O	O

country	eng	N	N	O	O
.	m	N	N	O	O

There	eng	N	N	O	O

were	eng	N	N	O	O

also	eng	N	N	O	O

black	eng	N	N	O	O

pages	eng	N	N	O	O

in	eng	Y	N	O	O

its	eng	N	N	O	O

book	eng	N	N	O	O

of	eng	N	N	O	O

history	eng	N	N	O	O
.	m	N	N	O	O

One	eng	N	N	O	O

lovely	eng	N	N	O	O

day	eng	N	N	O	O

general	eng	N	N	O	O

Bytel	eng	N	N	O	O

−	x	N	N	O	O

commander	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

junta	eng	N	N	O	O

which	eng	N	N	O	O

had	eng	N	N	O	O

power	eng	N	N	O	O

over	eng	N	N	O	O

Byteland	eng	N	N	O	O

−	x	N	N	O	O
−	x	N	N	O	O

decided	eng	N	N	O	O

to	eng	N	N	O	O

finish	eng	N	N	O	O

the	eng	N	N	O	O

long	eng	N	N	O	O
−	x	N	N	O	O
lasting	eng	N	N	O	O

time	eng	N	N	O	O

of	eng	N	N	O	O

war	eng	N	N	O	O

and	eng	N	N	O	O

released	eng	N	N	O	O

imprisoned	eng	N	N	O	O

activists	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

opposition	eng	N	N	O	O
.	m	N	N	O	O

However	eng	N	N	O	O
,	x	N	N	O	O

he	eng	Y	N	O	O

had	eng	N	N	O	O

no	eng	N	N	O	O

intention	eng	N	N	O	O

to	eng	N	N	O	O

let	eng	N	N	O	O

the	eng	N	N	O	O

leader	eng	N	N	O	O

Bytesar	eng	N	N	O	O

free	eng	N	N	O	O
.	m	N	N	O	O

He	eng	N	N	O	O

decided	eng	N	N	O	O

to	eng	N	N	O	O

chain	eng	N	N	O	O

him	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

wall	eng	N	N	O	O

with	eng	N	N	O	O

the	eng	N	N	O	O

bytish	eng	N	N	O	O

chain	eng	N	N	O	O
.	m	N	N	O	O

It	eng	N	N	O	O

consists	eng	N	N	O	O

of	eng	N	N	O	O

joined	eng	N	N	O	O

rings	eng	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

bar	eng	N	N	O	O

fixed	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

wall	eng	N	N	O	O
.	m	N	N	O	O

Although	eng	N	N	O	O

the	eng	N	N	O	O

rings	eng	N	N	O	O

are	eng	N	N	O	O

not	eng	N	N	O	O

joined	eng	N	N	O	O

with	eng	N	N	O	O

the	eng	N	N	O	O

bar	eng	N	N	O	O
,	x	N	N	O	O

it	eng	N	N	O	O

is	eng	N	N	O	O

hard	eng	N	N	O	O

to	eng	N	N	O	O

take	eng	N	N	O	O

them	eng	N	N	O	O

off	eng	N	N	O	O
.	m	N	N	O	O

'	x	N	N	O	O
General	eng	N	N	O	O
,	x	N	N	O	O

why	eng	N	N	O	O

have	eng	N	N	O	O

you	eng	N	N	O	O

chained	eng	N	N	O	O

me	eng	Y	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

prison	eng	N	N	O	O

walls	eng	N	N	O	O

and	eng	N	N	O	O

did	eng	N	N	O	O

not	eng	N	N	O	O

let	eng	N	N	O	O

rejoice	eng	N	N	O	O

at	eng	N	N	O	O

freedom	eng	N	N	O	O
!	x	N	N	O	O
'	x	N	N	O	O

cried	eng	N	N	O	O

Bytesar	eng	N	N	O	O
.	m	N	N	O	O

'	x	N	N	O	O
But	eng	N	N	O	O

Bytesar	eng	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

are	eng	N	N	O	O

not	eng	N	N	O	O

chained	eng	N	N	O	O

at	eng	N	N	O	O

all	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

I	x	N	N	O	O

am	eng	Y	N	O	O

certain	eng	N	N	O	O

you	eng	N	N	O	O

are	eng	N	N	O	O

able	eng	N	N	O	O

to	eng	N	N	O	O

take	eng	N	N	O	O

off	eng	N	N	O	O

the	eng	N	N	O	O

rings	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

bar	eng	N	N	O	O

by	eng	N	N	O	O

yourself	eng	N	N	O	O
.	m	N	N	O	O
'	x	N	N	O	O

perfidiously	eng	N	N	O	O

answered	eng	N	N	O	O

general	eng	N	N	O	O

Bytel	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

he	eng	Y	N	O	O

added	eng	N	N	O	O

'	x	N	N	O	O
But	eng	N	N	O	O

deal	eng	N	N	O	O

with	eng	N	N	O	O

that	eng	N	N	O	O

before	eng	N	N	O	O

a	x	N	N	O	O

clock	eng	N	N	O	O

strikes	eng	N	N	O	O

the	eng	N	N	O	O

cyber	eng	N	N	O	O

hour	eng	N	N	O	O

and	eng	N	N	O	O

do	eng	N	N	O	O

not	eng	N	N	O	O

make	eng	N	N	O	O

a	x	N	N	O	O

noise	eng	N	N	O	O

at	eng	N	N	O	O

night	eng	N	N	O	O
,	x	N	N	O	O

otherwise	eng	N	N	O	O

I	x	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

forced	eng	N	N	O	O

to	eng	N	N	O	O

call	eng	N	N	O	O

Civil	eng	N	N	O	O

Cyber	eng	N	N	O	O

Police	eng	N	N	O	O
.	m	N	N	O	O
'	x	N	N	O	O

Help	eng	N	N	O	O

Bytesar	eng	N	N	O	O
!	x	N	N	O	O

Number	eng	N	N	O	O

the	eng	N	N	O	O

following	eng	N	N	O	O

rings	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

chain	eng	N	N	O	O

with	eng	N	N	O	O

integers	eng	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
...	m	N	N	O	O
,	x	N	N	O	O
n	eng	N	N	O	O
.	m	N	N	O	O

We	eng	N	N	O	O

may	eng	N	N	O	O

put	eng	N	N	O	O

on	eng	N	N	O	O

and	eng	N	N	O	O

take	eng	N	N	O	O

off	eng	N	N	O	O

these	eng	N	N	O	O

rings	eng	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

following	eng	N	N	O	O

rules	eng	N	N	O	O
:	x	N	N	O	O

.	m	N	N	O	O
only	eng	N	N	O	O

one	eng	N	N	O	O

ring	eng	N	N	O	O

can	eng	N	N	O	O

be	eng	Y	N	O	O

put	eng	N	N	O	O

on	eng	N	N	O	O

or	eng	Y	N	O	O

taken	eng	N	N	O	O

off	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

bar	eng	N	N	O	O

in	eng	Y	N	O	O

one	eng	N	N	O	O

move	eng	N	N	O	O
,	x	N	N	O	O

.	m	N	N	O	O
the	eng	N	N	O	O

ring	eng	N	N	O	O

number	eng	N	N	O	O

1	x	N	N	O	O

can	eng	N	N	O	O

be	eng	Y	N	O	O

always	eng	N	N	O	O

put	eng	N	N	O	O

on	eng	N	N	O	O

or	eng	Y	N	O	O

taken	eng	N	N	O	O

off	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

bar	eng	N	N	O	O
,	x	N	N	O	O

.	m	N	N	O	O
if	eng	N	N	O	O

the	eng	N	N	O	O

rings	eng	N	N	O	O

with	eng	N	N	O	O

the	eng	N	N	O	O

numbers	eng	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O
...	m	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
−	x	N	N	O	O
1	x	N	N	O	O

(	x	N	N	O	O
for	eng	Y	N	O	O

1	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O

k	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

are	eng	N	N	O	O

taken	eng	N	N	O	O

off	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

bar	eng	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

ring	eng	N	N	O	O

number	eng	N	N	O	O

k	x	N	N	O	O

is	eng	N	N	O	O

put	eng	N	N	O	O

on	eng	N	N	O	O
,	x	N	N	O	O

we	eng	N	N	O	O

can	eng	N	N	O	O

put	eng	N	N	O	O

on	eng	N	N	O	O

or	eng	Y	N	O	O

take	eng	N	N	O	O

off	eng	N	N	O	O

the	eng	N	N	O	O

ring	eng	N	N	O	O

number	eng	N	N	O	O

k	eng	N	N	O	O
+	x	N	N	O	O
1.	m	N	N	O	O

Write	eng	N	N	O	O

a	x	N	N	O	O

program	eng	N	N	O	O

which	eng	N	N	O	O
:	x	N	N	O	O

.	m	N	N	O	O
reads	eng	N	N	O	O

from	eng	N	N	O	O

std	eng	N	N	O	O

input	eng	N	N	O	O

the	eng	N	N	O	O

description	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

bytish	eng	N	N	O	O

chain	eng	N	N	O	O
,	x	N	N	O	O

.	m	N	N	O	O
computes	eng	N	N	O	O

minimal	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

moves	eng	N	N	O	O

necessary	eng	N	N	O	O

to	eng	N	N	O	O

take	eng	N	N	O	O

off	eng	N	N	O	O

all	eng	N	N	O	O

rings	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

bytish	eng	N	N	O	O

chain	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

bar	eng	N	N	O	O
,	x	N	N	O	O

.	m	N	N	O	O
writes	eng	N	N	O	O

the	eng	N	N	O	O

result	eng	N	N	O	O

to	eng	N	N	O	O

std	eng	N	N	O	O

output	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

In	eng	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

input	eng	N	N	O	O

there	eng	N	N	O	O

is	eng	N	N	O	O

written	eng	N	N	O	O

one	eng	N	N	O	O

integer	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

1000.	m	N	N	O	O

In	eng	N	N	O	O

the	eng	N	N	O	O

second	eng	N	N	O	O

line	eng	N	N	O	O

there	eng	N	N	O	O

are	eng	N	N	O	O

written	eng	N	N	O	O

n	x	N	N	O	O

integers	eng	N	N	O	O

o1	eng	N	N	O	O
,	x	N	N	O	O
o2	eng	N	N	O	O
,	x	N	N	O	O
...	m	N	N	O	O
,	x	N	N	O	O
on	eng	N	N	O	O

(	x	N	N	O	O
each	eng	N	N	O	O

of	eng	N	N	O	O

them	eng	N	N	O	O

is	eng	N	N	O	O

either	eng	N	N	O	O

0	x	N	N	O	O

or	eng	Y	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

separated	eng	N	N	O	O

by	eng	N	N	O	O

single	eng	N	N	O	O

spaces	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

oi	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

then	eng	N	N	O	O

the	eng	N	N	O	O

i	x	N	N	O	O
−	x	N	N	O	O
th	eng	N	N	O	O

ring	eng	N	N	O	O

is	eng	N	N	O	O

put	eng	N	N	O	O

on	eng	N	N	O	O

the	eng	N	N	O	O

bar	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

if	eng	N	N	O	O

oi	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

then	eng	N	N	O	O

the	eng	N	N	O	O

i	x	N	N	O	O
−	x	N	N	O	O
th	eng	N	N	O	O

ring	eng	N	N	O	O

is	eng	N	N	O	O

taken	eng	N	N	O	O

off	eng	N	N	O	O

the	eng	N	N	O	O

bar	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

The	eng	N	N	O	O

output	eng	N	N	O	O

should	eng	N	N	O	O

contain	eng	N	N	O	O

exactly	eng	N	N	O	O

one	eng	N	N	O	O

integer	eng	N	N	O	O

equal	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

minimal	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

moves	eng	N	N	O	O

necessary	eng	N	N	O	O

to	eng	N	N	O	O

take	eng	N	N	O	O

off	eng	N	N	O	O

all	eng	N	N	O	O

the	eng	N	N	O	O

rings	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

bytish	eng	N	N	O	O

chain	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

bar	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

41	m	N	N	O	O

0	x	N	N	O	O

1	x	N	N	O	O

0	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

6	x	N	N	O	O

Source	eng	N	N	O	O

POI	eng	N	N	O	O

2001	m	N	N	O	O

Source	eng	N	N	O	O

Code	eng	N	N	O	O

Problem	eng	N	N	O	O
:	x	N	N	O	O

1090	m	N	N	O	O

User	eng	N	N	O	O
:	x	N	N	O	O

*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O

Memory	eng	N	N	O	O
:	x	N	N	O	O

220	m	N	N	O	O
K	eng	N	N	O	O

Time	eng	N	N	O	O
:	x	N	N	O	O

47	m	N	N	O	O
MS	eng	N	N	O	O

Language	eng	N	N	O	O
:	x	N	N	O	O

C++	nz	N	N	O	O

Result	eng	N	N	O	O
:	x	N	N	O	O

Accepted	eng	N	N	O	O

Source	eng	N	N	O	O

Code	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O
using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O
int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

short	eng	N	N	O	O

link	eng	N	N	O	O
[	x	N	N	O	O
1001	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

short	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
340	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
340	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

N	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
N	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
N	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
link	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
link	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

N	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
N	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

link	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
link	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
link	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O
以下	f	N	N	O	O
为	p	N	N	O	O
大数	n	Y	N	O	O
运算	vn	Y	N	O	O
，	x	N	N	O	O
效率	n	N	N	O	O
不	d	N	N	O	O
高	a	N	N	O	O
，	x	N	N	O	O
但	c	N	N	O	O
较易	a	N	N	O	O
编写	v	N	N	O	O
*	x	N	N	O	O
/	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

u	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

v	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
N	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
u	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
n	eng	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
%	x	N	N	O	O
10	m	N	N	O	O
;	x	N	N	O	O

n	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
/	x	N	N	O	O
10	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

u	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
link	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

v	x	N	N	O	O
=	x	N	N	O	O
v	x	N	N	O	O
>	x	N	N	O	O
u	x	N	N	O	O
?	x	N	N	O	O
v	x	N	N	O	O
:	x	N	N	O	O
u	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
b	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
n	eng	N	N	O	O
;	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
%	x	N	N	O	O
10	m	N	N	O	O
;	x	N	N	O	O

n	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
/	x	N	N	O	O
10	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

v	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
v	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

PKU	eng	N	Y	B-OJ	B-OJ
_	x	N	N	I-OJ	O
1200	m	N	N	I-OJ	O
_	x	N	N	O	O
唐武	nr	N	N	O	O
的	uj	N	N	O	O
空间	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
hash	eng	Y	N	B-KNOWLEDGE	O
,	x	N	N	O	O
是	v	N	N	O	O
每个	r	N	N	O	O
串	v	N	N	O	O
能够	v	N	N	O	O
对应	vn	N	N	O	O
一个	m	N	N	O	O
关键码	n	N	N	O	O
,	x	N	N	O	O

如果	c	N	N	O	O
这样的话	l	N	N	O	O
，	x	N	N	O	O
内存	n	N	N	O	O
可能	v	N	N	O	O
会	v	N	N	O	O
很大	a	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
memory	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cmath	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

NUM	eng	N	N	O	O

=	x	N	N	O	O

16000010	m	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

Exit	eng	N	N	O	O
[	x	N	N	O	O
NUM	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

{	x	N	N	O	O
false	eng	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

hash	eng	Y	N	O	O
[	x	N	N	O	O
250	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
hash	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
表示	v	Y	N	O	O
字母	n	Y	N	O	O
char	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

+	x	N	N	O	O

'	x	N	N	O	O
a	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O
对应	vn	N	N	O	O
的	uj	N	N	O	O
hash	eng	Y	N	B-KNOWLEDGE	O
值	n	N	N	O	O

char	eng	N	N	O	O

input	eng	N	N	O	O
[	x	N	N	O	O
20000000	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
存储	j	N	N	O	O
输入	v	N	N	O	O
，	x	N	N	O	O
内存	n	N	N	O	O
也许	d	N	N	O	O
还	d	N	N	O	O
需要	v	N	N	O	O
大	a	N	N	O	O
一些	m	N	N	O	O

int	eng	N	N	O	O

N	x	N	N	O	O
,	x	N	N	O	O

NC	eng	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

initial	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

Ans	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
N	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
NC	eng	N	N	O	O
,	x	N	N	O	O

input	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

initial	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

Ans	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

initial	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
hash	eng	Y	N	O	O
,	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
hash	eng	Y	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

counter	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

size	eng	N	N	O	O

=	x	N	N	O	O

strlen	eng	N	N	O	O
(	x	N	N	O	O
input	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

size	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
hash	eng	Y	N	O	O
[	x	N	N	O	O
int	eng	N	N	O	O
(	x	N	N	O	O
input	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
input	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
如果	c	N	N	O	O
尚未	d	N	N	O	O
出现	v	N	N	O	O

{	x	N	N	O	O

hash	eng	Y	N	O	O
[	x	N	N	O	O
int	eng	N	N	O	O
(	x	N	N	O	O
input	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

counter	eng	N	N	O	O
;	x	N	N	O	O

counter	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
counter	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

NC	eng	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

Ans	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

size	eng	N	N	O	O

=	x	N	N	O	O

strlen	eng	N	N	O	O
(	x	N	N	O	O
input	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

temp	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

end	eng	N	N	O	O

=	x	N	N	O	O

size	eng	N	N	O	O

-	x	N	N	O	O

N	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
,	x	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

temp	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O

<	x	N	N	O	O

N	x	N	N	O	O
;	x	N	N	O	O

k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O

+	x	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O

temp	eng	N	N	O	O

=	x	N	N	O	O

temp	eng	N	N	O	O

*	x	N	N	O	O

NC	eng	N	N	O	O

+	x	N	N	O	O

hash	eng	Y	N	O	O
[	x	N	N	O	O
input	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
Exit	eng	N	N	O	O
[	x	N	N	O	O
temp	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

Exit	eng	N	N	O	O
[	x	N	N	O	O
temp	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

ans	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

PKU	eng	N	Y	B-OJ	B-OJ
_	x	N	N	I-OJ	O
1112	m	N	N	I-OJ	O
(	x	N	N	O	O
补图	v	N	N	O	O
，	x	N	N	O	O
背包	n	Y	N	B-KNOWLEDGE	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
)	x	N	N	O	O
_	x	N	N	O	O
Otaku	eng	N	N	O	O
_	x	N	N	O	O
geek	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

PKU	eng	N	Y	B-OJ	B-OJ

1112	m	N	N	O	I-OJ
:	x	N	N	O	O
PKU	eng	N	Y	B-OJ	B-OJ
上	ns	N	N	O	O
一道	m	N	N	O	O
比较	d	N	N	O	O
经典	n	N	N	O	O
的	uj	N	N	O	O
题	n	N	N	O	O
，	x	N	N	O	O
以前	f	N	N	O	O
一直	d	N	N	O	O
做不来	v	N	N	O	O
，	x	N	N	O	O
今天	t	N	N	O	O
总算	n	N	N	O	O
把	p	N	N	O	O
它	r	N	N	O	O
过掉	v	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
分析	vn	N	N	O	O
题目	n	Y	N	O	O
的	uj	N	N	O	O
条件	n	N	N	O	O
可以	c	N	N	O	O
建立	v	N	N	O	O
这样	r	N	N	O	O
一个	m	N	N	O	O
无向	v	Y	N	B-KNOWLEDGE	O
图	n	N	N	I-KNOWLEDGE	O
：	x	N	N	O	O
如果	c	N	N	O	O
A	eng	N	N	O	O
不	c	N	N	O	O
认识	v	N	N	O	O
B	x	N	N	O	O
或者	c	N	N	O	O
B	eng	N	N	O	O
不	c	N	N	O	O
认识	v	N	N	O	O
A	x	N	N	O	O
，	x	N	N	O	O
那么	r	N	N	O	O
这	r	N	N	O	O
两个	m	N	N	O	O
必然	d	N	N	O	O
是	v	N	N	O	O
两个	m	N	N	O	O
组	q	N	N	O	O
的	uj	N	N	O	O
人	n	N	N	O	O
，	x	N	N	O	O
因为	c	N	N	O	O
题目	n	Y	N	O	O
要求	v	N	N	O	O
一个组	m	N	N	O	O
的	uj	N	N	O	O
所有人	n	N	N	O	O
都	d	N	N	O	O
必须	d	N	N	O	O
两	m	N	N	O	O
两	m	N	N	O	O
认识	v	N	N	O	O
，	x	N	N	O	O
这样	r	N	N	O	O
就	d	N	N	O	O
可以	c	N	N	O	O
在	p	N	N	O	O
原图	n	N	N	O	O
的	uj	N	N	O	O
基础	n	N	N	O	O
上	f	N	N	O	O
建立	v	N	N	O	O
一个	m	N	N	O	O
补图	v	N	N	O	O
，	x	N	N	O	O
对于	p	N	N	O	O
每	zg	N	N	O	O
一个点	m	N	N	O	O
我们	r	N	N	O	O
可以	c	N	N	O	O
进行	v	N	N	O	O
这样	r	N	N	O	O
一个	m	N	N	O	O
操作	v	Y	N	O	O
，	x	N	N	O	O
把	p	N	N	O	O
它	r	N	N	O	O
自己	r	N	N	O	O
标记	n	N	N	O	O
为	p	N	N	O	O
1	m	N	N	O	O
，	x	N	N	O	O
并且	c	N	N	O	O
把	p	N	N	O	O
与	p	N	N	O	O
他	r	N	N	O	O
相邻	v	N	N	O	O
的点	d	Y	N	O	O
都	d	N	N	O	O
标记	n	N	N	O	O
为	p	N	N	O	O
2	m	N	N	O	O
，	x	N	N	O	O
相同	d	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
不能	v	N	N	O	O
重复	d	Y	N	O	O
标记	n	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
在	p	N	N	O	O
标记	n	N	N	O	O
的	uj	N	N	O	O
过程	n	N	N	O	O
中	f	N	N	O	O
发现	v	N	N	O	O
某个	r	N	N	O	O
点	m	N	N	O	O
即	v	N	N	O	O
可以	c	N	N	O	O
标记	n	N	N	O	O
为	p	N	N	O	O
1	m	N	N	O	O
又	d	N	N	O	O
可以	c	N	N	O	O
标记	n	N	N	O	O
为	p	N	N	O	O
2	m	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
不	d	N	N	O	O
存在	v	N	N	O	O
解	v	N	N	O	O
，	x	N	N	O	O
这样	r	N	N	O	O
一个	m	N	N	O	O
标记	n	N	N	O	O
的	uj	N	N	O	O
过程	n	N	N	O	O
可以	c	N	N	O	O
用	p	N	N	O	O
简单	a	N	N	O	O
的	uj	N	N	O	O
DFS	eng	N	N	O	B-KNOWLEDGE
完成	v	N	N	O	O
，	x	N	N	O	O
完成	v	N	N	O	O
这样	r	N	N	O	O
一个	m	N	N	O	O
操作	v	Y	N	O	O
后	f	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
对于	p	N	N	O	O
每次	r	N	N	O	O
DFS	eng	N	N	O	O
的	uj	N	N	O	O
过程	n	N	N	O	O
都	d	N	N	O	O
可以	c	N	N	O	O
得到	v	N	N	O	O
两个	m	N	N	O	O
数	n	N	N	O	O
，	x	N	N	O	O
一个	m	N	N	O	O
数	m	N	N	O	O
是	v	N	N	O	O
标记	n	N	N	O	O
为	p	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
的	uj	N	N	O	O
数量	n	N	N	O	O
，	x	N	N	O	O
另	r	N	N	O	O
一个	m	N	N	O	O
则	d	N	N	O	O
是	v	N	N	O	O
标记	n	N	N	O	O
为	p	N	N	O	O
2	m	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
的	uj	N	N	O	O
数量	n	N	N	O	O
，	x	N	N	O	O
假如	c	N	N	O	O
图	n	N	N	O	O
中	f	N	N	O	O
存在	v	N	N	O	O
n	eng	N	N	O	O
个	m	N	N	O	O
连通	a	Y	N	O	O
分量	n	Y	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
我们	r	N	N	O	O
就	d	N	N	O	O
可以	c	N	N	O	O
得到	v	N	N	O	O
n	eng	N	N	O	O
组	v	N	N	O	O
这样	r	N	N	O	O
的	uj	N	N	O	O
数据	n	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
就是	d	N	N	O	O
背包	n	Y	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
了	ul	N	N	O	O
，	x	N	N	O	O
每次	r	N	N	O	O
都	d	N	N	O	O
在	p	N	N	O	O
上	f	N	N	O	O
一次	m	N	N	O	O
的	uj	N	N	O	O
基础	n	N	N	O	O
上	f	N	N	O	O
选择	v	N	N	O	O
放入	v	N	N	O	O
第一个	m	N	N	O	O
或者	c	N	N	O	O
第二个	m	N	N	O	O
数	n	N	N	O	O
，	x	N	N	O	O
注意	v	N	N	O	O
这	r	N	N	O	O
两个	m	N	N	O	O
DP	eng	N	N	O	B-KNOWLEDGE
是	v	N	N	O	O
互相	d	N	N	O	O
独立	v	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
即	v	N	N	O	O
他们	r	N	N	O	O
不会	v	N	N	O	O
互相	d	N	N	O	O
影响	vn	N	N	O	O
，	x	N	N	O	O
最后	f	N	N	O	O
再	d	N	N	O	O
进行	v	N	N	O	O
一下	m	N	N	O	O
路	n	N	N	O	O
劲	n	N	N	O	O
压缩	v	Y	N	O	O
就	d	N	N	O	O
可以	c	N	N	O	O
得到	v	N	N	O	O
最后	f	N	N	O	O
的	uj	N	N	O	O
答案	n	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
AC	eng	N	N	O	O
了	ul	N	N	O	O
之后	f	N	N	O	O
发现	v	N	N	O	O
速度	n	N	N	O	O
很	zg	N	N	O	O
慢	a	N	N	O	O
，	x	N	N	O	O
感觉	n	N	N	O	O
我	r	N	N	O	O
的	uj	N	N	O	O
方法	n	Y	N	O	O
复杂度	n	N	N	O	O
也	d	N	N	O	O
就是	d	N	N	O	O
100	m	N	N	O	O
*	x	N	N	O	O
100	m	N	N	O	O
，	x	N	N	O	O
怎么	r	N	N	O	O
会	v	N	N	O	O
这么	r	N	N	O	O
慢	a	N	N	O	O
呢	y	N	N	O	O
，	x	N	N	O	O
忘	v	N	N	O	O
大	a	N	N	O	O
牛	n	N	N	O	O
指教	n	N	N	O	O
～	x	N	N	O	O
～	x	N	N	O	O
～	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cmath	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
vector	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

N	x	N	N	O	O

=	x	N	N	O	O

105	m	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

_	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
原图	n	N	N	O	O

vector	eng	N	N	O	O
<	x	N	N	O	O
int	eng	N	N	O	O
>	x	N	N	O	O

_	x	N	N	O	O
revMap	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
补图	v	N	N	O	O

bool	eng	N	N	O	O

_	x	N	N	O	O
visited	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

_	x	N	N	O	O
n	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

_	x	N	N	O	O
cnt	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

_	x	N	N	O	O
col	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

_	x	N	N	O	O
now	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

_	x	N	N	O	O
sumOne	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

_	x	N	N	O	O
sumTwo	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

_	x	N	N	O	O
peo	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

_	x	N	N	O	O
res	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

_	x	N	N	O	O
min	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

_	x	N	N	O	O
path	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

_	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

_	x	N	N	O	O
flg	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

_	x	N	N	O	O
noSol	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ABS	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

x	x	N	N	O	O

*	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

CreateRevMap	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
_	x	N	N	O	O
n	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
_	x	N	N	O	O
n	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

j	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
_	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

_	x	N	N	O	O
revMap	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
revMap	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

_	x	N	N	O	O
visited	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
_	x	N	N	O	O
col	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

_	x	N	N	O	O
sumOne	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
peo	eng	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
now	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
sumOne	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

_	x	N	N	O	O
sumTwo	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
peo	eng	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
now	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
sumTwo	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

size	eng	N	N	O	O

=	x	N	N	O	O

_	x	N	N	O	O
revMap	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
size	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

u	x	N	N	O	O

=	x	N	N	O	O

_	x	N	N	O	O
revMap	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
_	x	N	N	O	O
col	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

_	x	N	N	O	O
col	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

_	x	N	N	O	O
noSol	eng	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
_	x	N	N	O	O
visited	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
_	x	N	N	O	O
col	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

_	x	N	N	O	O
col	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

_	x	N	N	O	O
col	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O
u	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

DP	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
,	x	N	N	O	O

id	eng	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
_	x	N	N	O	O
now	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

id	eng	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
id	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
_	x	N	N	O	O
n	eng	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
_	x	N	N	O	O
cnt	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
_	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O

j	x	N	N	O	O

-	x	N	N	O	O

_	x	N	N	O	O
cnt	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O

]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

_	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
path	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

id	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

_	x	N	N	O	O
now	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
ABS	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O

-	x	N	N	O	O

_	x	N	N	O	O
n	eng	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

<	x	N	N	O	O

ABS	eng	N	N	O	O
(	x	N	N	O	O
_	x	N	N	O	O
min	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

_	x	N	N	O	O
min	eng	N	N	O	O

=	x	N	N	O	O

j	x	N	N	O	O

-	x	N	N	O	O

_	x	N	N	O	O
n	eng	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

Print	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

_	x	N	N	O	O
min	eng	N	N	O	O

+	x	N	N	O	O

_	x	N	N	O	O
n	eng	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O

tmp	eng	N	N	O	O

=	x	N	N	O	O

ans	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
,	x	N	N	O	O

tag	eng	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

ans	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
_	x	N	N	O	O
now	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

tag	eng	N	N	O	O

=	x	N	N	O	O

_	x	N	N	O	O
path	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
_	x	N	N	O	O
cnt	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
tag	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

_	x	N	N	O	O
peo	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
tag	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
flg	eng	N	N	O	O
[	x	N	N	O	O

_	x	N	N	O	O
peo	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
tag	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

tmp	eng	N	N	O	O

-	x	N	N	O	O
=	x	N	N	O	O

_	x	N	N	O	O
cnt	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
tag	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

_	x	N	N	O	O
n	eng	N	N	O	O

-	x	N	N	O	O

ans	eng	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

ans	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
_	x	N	N	O	O
n	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
_	x	N	N	O	O
flg	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

putchar	eng	N	N	O	O
(	x	N	N	O	O
'	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&_	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
_	x	N	N	O	O
n	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

p	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
p	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

p	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

_	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

CreateRevMap	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
now	eng	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
noSol	eng	N	N	O	O

=	x	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
_	x	N	N	O	O
n	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
_	x	N	N	O	O
visited	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
sumOne	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
sumTwo	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
col	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
_	x	N	N	O	O
noSol	eng	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
cnt	eng	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
now	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

_	x	N	N	O	O
sumOne	eng	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
cnt	eng	N	N	O	O
[	x	N	N	O	O
_	x	N	N	O	O
now	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

_	x	N	N	O	O
sumTwo	eng	N	N	O	O
;	x	N	N	O	O

_	x	N	N	O	O
now	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
_	x	N	N	O	O
noSol	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

puts	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
No	eng	N	N	O	O

solution	eng	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

_	x	N	N	O	O
min	eng	N	N	O	O

=	x	N	N	O	O

1000	m	N	N	O	O
;	x	N	N	O	O

DP	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

Print	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

3544	m	N	N	I-OJ	O

Journey	eng	N	N	O	O

with	eng	N	N	O	O

Pigs	eng	N	N	O	O

贪心	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE

-	x	N	N	O	O

水	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

首先	d	N	N	O	O
根据	p	N	N	O	O
村庄	n	N	N	O	O
离	v	N	N	O	O
A	eng	N	N	O	O
的	uj	N	N	O	O
距离	n	Y	N	O	O
和	c	N	N	O	O
单位	n	N	N	O	O
路程	n	N	N	O	O
的	uj	N	N	O	O
花费	n	N	N	O	O
，	x	N	N	O	O
以及	c	N	N	O	O
当地	s	N	N	O	O
猪肉	n	N	N	O	O
的	uj	N	N	O	O
价格	n	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
可以	c	N	N	O	O
把	p	N	N	O	O
到达	v	N	N	O	O
每	zg	N	N	O	O
一个	m	N	N	O	O
村庄	n	N	N	O	O
卖	v	N	N	O	O
猪	n	N	N	O	O
单位	n	N	N	O	O
重量	n	N	N	O	O
赚	v	N	N	O	O
的	uj	N	N	O	O
钱	n	N	N	O	O
算	v	N	N	O	O
出来	v	N	N	O	O
。	x	N	N	O	O

然后	c	N	N	O	O
，	x	N	N	O	O
按	p	N	N	O	O
收益	n	N	N	O	O
降序	n	N	N	O	O
排列	v	Y	N	O	O
，	x	N	N	O	O
再	d	N	N	O	O
把	p	N	N	O	O
猪	n	N	N	O	O
的	uj	N	N	O	O
重量	n	N	N	O	O
降序	n	N	N	O	O
排序	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
，	x	N	N	O	O
这时	r	N	N	O	O
，	x	N	N	O	O
根据	p	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE
不等式	l	Y	N	O	O
，	x	N	N	O	O
就	d	N	N	O	O
可以	c	N	N	O	O
达到	v	N	N	O	O
最大	a	Y	N	O	O
盈利	n	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

所谓	b	N	N	O	O
排序	n	Y	N	B-KNOWLEDGE	O
不等式	l	Y	N	I-KNOWLEDGE	O
：	x	N	N	O	O

排序	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
不等式	l	Y	N	I-KNOWLEDGE	O
（	x	N	N	O	O
sequence	eng	N	N	O	O

inequality	eng	N	N	O	O
,	x	N	N	O	O
又称	n	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE
原理	n	Y	N	O	O

设有	v	N	N	O	O
两组	m	N	N	O	O
数	n	N	N	O	O

a1	eng	N	N	O	O

,	x	N	N	O	O

a2	eng	N	N	O	O

,	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O

an	eng	Y	N	O	O
;	x	N	N	O	O

b1	eng	N	N	O	O

,	x	N	N	O	O

b2	eng	N	N	O	O

,	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O

bn	eng	N	N	O	O

满足	v	N	N	O	O

a1	eng	N	N	O	O

≤	x	N	N	O	O

a2	eng	N	N	O	O

≤	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
≤	x	N	N	O	O

an	eng	Y	N	O	O
,	x	N	N	O	O

b1	eng	N	N	O	O

≤	x	N	N	O	O

b2	eng	N	N	O	O

≤	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
≤	x	N	N	O	O

bn	eng	N	N	O	O

，	x	N	N	O	O
其中	r	N	N	O	O
c1	eng	N	N	O	O
,	x	N	N	O	O
c2	eng	N	N	O	O
,	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
,	x	N	N	O	O
cn	eng	N	N	O	O
是	v	N	N	O	O
b1	eng	N	N	O	O
,	x	N	N	O	O
b2	eng	N	N	O	O
,	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
，	x	N	N	O	O
bn	eng	N	N	O	O
的	uj	N	N	O	O
任一	r	N	N	O	O
排列	v	Y	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
有	v	N	N	O	O

a1	eng	N	N	O	O
*	x	N	N	O	O

bn	eng	N	N	O	O

+	x	N	N	O	O

a2	eng	N	N	O	O

*	x	N	N	O	O
b	x	N	N	O	O
{	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O
+	x	N	N	O	O

...	m	N	N	O	O

+	x	N	N	O	O

an	eng	Y	N	O	O

*	x	N	N	O	O
b1	eng	N	N	O	O

≤	x	N	N	O	O

a1	eng	N	N	O	O

*	x	N	N	O	O
c1	eng	N	N	O	O

+	x	N	N	O	O

a2	eng	N	N	O	O
*	x	N	N	O	O

c2	eng	N	N	O	O

+	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
+	x	N	N	O	O

an	eng	Y	N	O	O

*	x	N	N	O	O
cn	eng	N	N	O	O

≤	x	N	N	O	O

a1	eng	N	N	O	O

*	x	N	N	O	O
b1	eng	N	N	O	O

+	x	N	N	O	O

a2	eng	N	N	O	O

*	x	N	N	O	O
b2	eng	N	N	O	O

+	x	N	N	O	O

…	x	N	N	O	O
…	x	N	N	O	O
+	x	N	N	O	O
an	eng	Y	N	O	O
*	x	N	N	O	O

bn	eng	N	N	O	O
.	m	N	N	O	O

当	p	N	N	O	O
且仅	c	N	N	O	O
当	t	N	N	O	O

a1	eng	N	N	O	O

=	x	N	N	O	O

a2	eng	N	N	O	O

=	x	N	N	O	O

...	m	N	N	O	O

=	x	N	N	O	O

an	eng	Y	N	O	O

或	c	N	N	O	O

b1	eng	N	N	O	O

=	x	N	N	O	O

b2	eng	N	N	O	O

=	x	N	N	O	O

...	m	N	N	O	O

=	x	N	N	O	O

bn	eng	N	N	O	O

时	ng	N	N	O	O
等	u	N	N	O	O
号	q	N	N	O	O
成立	v	N	N	O	O
，	x	N	N	O	O
即	v	N	N	O	O
反序	n	N	N	O	O
和	c	N	N	O	O
等于	v	N	N	O	O
顺序	n	N	N	O	O
和	c	N	N	O	O
。	x	N	N	O	O

以上	f	N	N	O	O
排序	n	Y	N	B-KNOWLEDGE	O
不等式	l	Y	N	I-KNOWLEDGE	O
也	d	N	N	O	O
可	v	N	N	O	O
简记	v	N	N	O	O
为	p	N	N	O	O
：	x	N	N	O	O

反序	n	N	N	O	O
和	c	N	N	O	O
≤	x	N	N	O	O
乱序	n	N	N	O	O
和	c	N	N	O	O
≤	x	N	N	O	O
同序	n	N	N	O	O
和	c	N	N	O	O
.	m	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

ID	eng	N	N	O	O
:	x	N	N	O	O

sdj22251	eng	N	N	O	O

PROG	eng	N	N	O	O
:	x	N	N	O	O

calfflac	eng	N	N	O	O

LANG	eng	N	N	O	O
:	x	N	N	O	O

C++	nz	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
vector	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
list	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
map	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
set	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
deque	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stack	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
bitset	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
functional	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
numeric	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
utility	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
sstream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iomanip	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cmath	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdlib	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cctype	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cmath	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
ctime	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

LOCA	eng	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

PI	eng	N	N	O	O

acos	eng	N	N	O	O
(	x	N	N	O	O
-	x	N	N	O	O
1.0	m	N	N	O	O
)	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

village	eng	N	N	O	O

{	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

price	eng	N	N	O	O
,	x	N	N	O	O

dis	eng	N	N	O	O
,	x	N	N	O	O

profit	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

id	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
1001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

zhu	eng	N	N	O	O

{	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

weight	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

id	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
pig	eng	N	N	O	O
[	x	N	N	O	O
1001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

cmp1	eng	N	N	O	O
(	x	N	N	O	O
village	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O

village	eng	N	N	O	O

b	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

a	eng	N	N	O	O
.	m	N	N	O	O
profit	eng	N	N	O	O

>	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
profit	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

cmp2	eng	N	N	O	O
(	x	N	N	O	O
zhu	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O

zhu	eng	N	N	O	O

b	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

a	eng	N	N	O	O
.	m	N	N	O	O
weight	eng	N	N	O	O

>	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
weight	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

#	x	N	N	O	O
ifdef	eng	N	N	O	O

LOCAL	eng	N	N	O	O

freopen	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
calfflac	eng	N	N	O	O
.	m	N	N	O	O
in	eng	Y	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
r	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
stdin	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

freopen	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
calfflac	eng	N	N	O	O
.	m	N	N	O	O
out	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
w	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
stdout	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
endif	eng	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

t	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
pig	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
weight	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

pig	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
id	eng	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
pig	eng	N	N	O	O
,	x	N	N	O	O

pig	eng	N	N	O	O

+	x	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

cmp2	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
p	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
dis	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
p	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
price	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
id	eng	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
profit	eng	N	N	O	O

=	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
price	eng	N	N	O	O

-	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
dis	eng	N	N	O	O

*	x	N	N	O	O

t	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O

p	x	N	N	O	O

+	x	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

cmp1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
1001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

pig	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
id	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

"	x	N	N	O	O
,	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ1273	eng	N	Y	B-OJ	B-OJ

Drainage	eng	N	N	O	O

Ditches	eng	N	N	O	O

-	x	N	N	O	O

Zsys	eng	N	N	O	O

Algorithm	eng	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

Drainage	eng	N	N	O	O

Ditches	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

10000	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

25097	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

9168	m	N	N	O	O

Description	eng	N	N	O	O

Every	eng	N	N	O	O

time	eng	N	N	O	O

it	eng	N	N	O	O

rains	eng	N	N	O	O

on	eng	N	N	O	O

Farmer	eng	N	N	O	O

John	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

fields	eng	N	N	O	O
,	x	N	N	O	O

a	x	N	N	O	O

pond	eng	N	N	O	O

forms	eng	N	N	O	O

over	eng	N	N	O	O

Bessie	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

favorite	eng	N	N	O	O

clover	eng	N	N	O	O

patch	eng	N	N	O	O
.	m	N	N	O	O

This	eng	N	N	O	O

means	eng	N	N	O	O

that	eng	N	N	O	O

the	eng	N	N	O	O

clover	eng	N	N	O	O

is	eng	N	N	O	O

covered	eng	N	N	O	O

by	eng	N	N	O	O

water	eng	N	N	O	O

for	eng	Y	N	O	O

awhile	eng	N	N	O	O

and	eng	N	N	O	O

takes	eng	N	N	O	O

quite	eng	N	N	O	O

a	x	N	N	O	O

long	eng	N	N	O	O

time	eng	N	N	O	O

to	eng	N	N	O	O

regrow	eng	N	N	O	O
.	m	N	N	O	O

Thus	eng	N	N	O	O
,	x	N	N	O	O

Farmer	eng	N	N	O	O

John	eng	N	N	O	O

has	eng	Y	N	O	O

built	eng	N	N	O	O

a	x	N	N	O	O

set	eng	N	N	O	O

of	eng	N	N	O	O

drainage	eng	N	N	O	O

ditches	eng	N	N	O	O

so	eng	N	N	O	O

that	eng	N	N	O	O

Bessie	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

clover	eng	N	N	O	O

patch	eng	N	N	O	O

is	eng	N	N	O	O

never	eng	N	N	O	O

covered	eng	N	N	O	O

in	eng	Y	N	O	O

water	eng	N	N	O	O
.	m	N	N	O	O

Instead	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

water	eng	N	N	O	O

is	eng	N	N	O	O

drained	eng	N	N	O	O

to	eng	N	N	O	O

a	x	N	N	O	O

nearby	eng	N	N	O	O

stream	eng	N	N	O	O
.	m	N	N	O	O

Being	eng	N	N	O	O

an	eng	Y	N	O	O

ace	eng	N	N	O	O

engineer	eng	N	N	O	O
,	x	N	N	O	O

Farmer	eng	N	N	O	O

John	eng	N	N	O	O

has	eng	Y	N	O	O

also	eng	N	N	O	O

installed	eng	N	N	O	O

regulators	eng	N	N	O	O

at	eng	N	N	O	O

the	eng	N	N	O	O

beginning	eng	N	N	O	O

of	eng	N	N	O	O

each	eng	N	N	O	O

ditch	eng	N	N	O	O
,	x	N	N	O	O

so	eng	N	N	O	O

he	eng	Y	N	O	O

can	eng	N	N	O	O

control	eng	N	N	O	O

at	eng	N	N	O	O

what	eng	N	N	O	O

rate	eng	N	N	O	O

water	eng	N	N	O	O

flows	eng	N	N	O	O

into	eng	N	N	O	O

that	eng	N	N	O	O

ditch	eng	N	N	O	O
.	m	N	N	O	O

Farmer	eng	N	N	O	O

John	eng	N	N	O	O

knows	eng	N	N	O	O

not	eng	N	N	O	O

only	eng	N	N	O	O

how	eng	N	N	O	O

many	eng	N	N	O	O

gallons	eng	N	N	O	O

of	eng	N	N	O	O

water	eng	N	N	O	O

each	eng	N	N	O	O

ditch	eng	N	N	O	O

can	eng	N	N	O	O

transport	eng	N	N	O	O

per	eng	N	N	O	O

minute	eng	N	N	O	O

but	eng	N	N	O	O

also	eng	N	N	O	O

the	eng	N	N	O	O

exact	eng	N	N	O	O

layout	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

ditches	eng	N	N	O	O
,	x	N	N	O	O

which	eng	N	N	O	O

feed	eng	N	N	O	O

out	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

pond	eng	N	N	O	O

and	eng	N	N	O	O

into	eng	N	N	O	O

each	eng	N	N	O	O

other	eng	N	N	O	O

and	eng	N	N	O	O

stream	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

potentially	eng	N	N	O	O

complex	eng	N	N	O	O

network	eng	N	N	O	O
.	m	N	N	O	O

Given	eng	N	N	O	O

all	eng	N	N	O	O

this	eng	N	N	O	O

information	eng	N	N	O	O
,	x	N	N	O	O

determine	eng	N	N	O	O

the	eng	N	N	O	O

maximum	eng	N	N	O	O

rate	eng	N	N	O	O

at	eng	N	N	O	O

which	eng	N	N	O	O

water	eng	N	N	O	O

can	eng	N	N	O	O

be	eng	Y	N	O	O

transported	eng	N	N	O	O

out	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

pond	eng	N	N	O	O

and	eng	N	N	O	O

into	eng	N	N	O	O

the	eng	N	N	O	O

stream	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

any	eng	N	N	O	O

given	eng	N	N	O	O

ditch	eng	N	N	O	O
,	x	N	N	O	O

water	eng	N	N	O	O

flows	eng	N	N	O	O

in	eng	Y	N	O	O

only	eng	N	N	O	O

one	eng	N	N	O	O

direction	eng	N	N	O	O
,	x	N	N	O	O

but	eng	N	N	O	O

there	eng	N	N	O	O

might	eng	N	N	O	O

be	eng	Y	N	O	O

a	x	N	N	O	O

way	eng	N	N	O	O

that	eng	N	N	O	O

water	eng	N	N	O	O

can	eng	N	N	O	O

flow	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

circle	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

The	eng	N	N	O	O

input	eng	N	N	O	O

includes	eng	N	N	O	O

several	eng	N	N	O	O

cases	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

case	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O

contains	eng	N	N	O	O

two	eng	N	N	O	O

space	eng	N	N	O	O
-	x	N	N	O	O
separated	eng	N	N	O	O

integers	eng	N	N	O	O
,	x	N	N	O	O

N	x	N	N	O	O

(	x	N	N	O	O
0	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

N	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

200	m	N	N	O	O
)	x	N	N	O	O

and	eng	N	N	O	O

M	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

M	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

200	m	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O

N	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

ditches	eng	N	N	O	O

that	eng	N	N	O	O

Farmer	eng	N	N	O	O

John	eng	N	N	O	O

has	eng	Y	N	O	O

dug	eng	N	N	O	O
.	m	N	N	O	O

M	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

intersections	eng	N	N	O	O

points	eng	N	N	O	O

for	eng	Y	N	O	O

those	eng	N	N	O	O

ditches	eng	N	N	O	O
.	m	N	N	O	O

Intersection	eng	N	N	O	O

1	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

pond	eng	N	N	O	O
.	m	N	N	O	O

Intersection	eng	N	N	O	O

point	eng	N	N	O	O

M	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

stream	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

following	eng	N	N	O	O

N	x	N	N	O	O

lines	eng	N	N	O	O

contains	eng	N	N	O	O

three	eng	N	N	O	O

integers	eng	N	N	O	O
,	x	N	N	O	O

Si	eng	N	N	O	O
,	x	N	N	O	O

Ei	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

Ci	eng	N	N	O	O
.	m	N	N	O	O

Si	eng	N	N	O	O

and	eng	N	N	O	O

Ei	eng	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

Si	eng	N	N	O	O
,	x	N	N	O	O

Ei	eng	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

M	x	N	N	O	O
)	x	N	N	O	O

designate	eng	N	N	O	O

the	eng	N	N	O	O

intersections	eng	N	N	O	O

between	eng	N	N	O	O

which	eng	N	N	O	O

this	eng	N	N	O	O

ditch	eng	N	N	O	O

flows	eng	N	N	O	O
.	m	N	N	O	O

Water	eng	N	N	O	O

will	eng	N	N	O	O

flow	eng	N	N	O	O

through	eng	N	N	O	O

this	eng	N	N	O	O

ditch	eng	N	N	O	O

from	eng	N	N	O	O

Si	eng	N	N	O	O

to	eng	N	N	O	O

Ei	eng	N	N	O	O
.	m	N	N	O	O

Ci	eng	N	N	O	O

(	x	N	N	O	O
0	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

Ci	eng	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

10	m	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
)	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

maximum	eng	N	N	O	O

rate	eng	N	N	O	O

at	eng	N	N	O	O

which	eng	N	N	O	O

water	eng	N	N	O	O

will	eng	N	N	O	O

flow	eng	N	N	O	O

through	eng	N	N	O	O

the	eng	N	N	O	O

ditch	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

case	eng	N	N	O	O
,	x	N	N	O	O

output	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

integer	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

maximum	eng	N	N	O	O

rate	eng	N	N	O	O

at	eng	N	N	O	O

which	eng	N	N	O	O

water	eng	N	N	O	O

may	eng	N	N	O	O

emptied	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

pond	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

5	x	N	N	O	O

4	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

40	m	N	N	O	O

1	x	N	N	O	O

4	x	N	N	O	O

20	m	N	N	O	O

2	x	N	N	O	O

4	x	N	N	O	O

20	m	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

30	m	N	N	O	O

3	x	N	N	O	O

4	x	N	N	O	O

10	m	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

50	m	N	N	O	O

Source	eng	N	N	O	O

USACO	eng	N	Y	B-OJ	B-OJ

93	m	N	N	I-OJ	O

很	zg	N	N	O	O
单纯	a	N	N	O	O
的	uj	N	N	O	O
最大	a	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
流	n	N	N	I-KNOWLEDGE	I-KNOWLEDGE
问题	n	N	N	O	O
，	x	N	N	O	O
比较简单	l	N	N	O	O
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
graph	eng	N	N	O	O
[	x	N	N	O	O
205	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
205	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

maxflow	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

sum	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
;	x	N	N	O	O
;	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

min	eng	N	N	O	O
(	x	N	N	O	O
2100000000	m	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
205	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
qf	eng	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
qr	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

visited	eng	N	N	O	O
[	x	N	N	O	O
205	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

queue	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

visited	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
;	x	N	N	O	O
qr	eng	N	N	O	O
<	x	N	N	O	O
qf	eng	N	N	O	O
;	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
not	eng	N	N	O	O

visited	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

and	eng	N	N	O	O

graph	eng	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
qr	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
qf	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O

queue	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
qf	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
qr	eng	N	N	O	O
,	x	N	N	O	O

visited	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

qr	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
qf	eng	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

sum	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

t	x	N	N	O	O
(	x	N	N	O	O
qf	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
t	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
graph	eng	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
min	eng	N	N	O	O

and	eng	N	N	O	O

graph	eng	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
graph	eng	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

t	x	N	N	O	O
=	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
;	x	N	N	O	O
qf	eng	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

graph	eng	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
qf	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
qf	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
;	x	N	N	O	O

graph	eng	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
qf	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
qf	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
;	x	N	N	O	O

qf	eng	N	N	O	O
=	x	N	N	O	O
queue	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
qf	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

sum	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

argc	eng	N	N	O	O
,	x	N	N	O	O

char	eng	N	N	O	O
*	x	N	N	O	O

argv	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
m	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

graph	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
j	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

graph	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
maxflow	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

1002	m	N	N	I-OJ	O

487	m	N	N	O	O
-	x	N	N	O	O
3279	m	N	N	O	O

-	x	N	N	O	O

ZZB	eng	N	N	O	O
的	uj	N	N	O	O
日志	ns	N	N	O	O

-	x	N	N	O	O

网易	n	N	N	O	O
博客	nr	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

2000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

65536	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

151338	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

25810	m	N	N	O	O

Description	eng	N	N	O	O

Businesses	eng	N	N	O	O

like	eng	N	N	O	O

to	eng	N	N	O	O

have	eng	N	N	O	O

memorable	eng	N	N	O	O

telephone	eng	N	N	O	O

numbers	eng	N	N	O	O
.	m	N	N	O	O

One	eng	N	N	O	O

way	eng	N	N	O	O

to	eng	N	N	O	O

make	eng	N	N	O	O

a	x	N	N	O	O

telephone	eng	N	N	O	O

number	eng	N	N	O	O

memorable	eng	N	N	O	O

is	eng	N	N	O	O

to	eng	N	N	O	O

have	eng	N	N	O	O

it	eng	N	N	O	O

spell	eng	N	N	O	O

a	x	N	N	O	O

memorable	eng	N	N	O	O

word	eng	N	N	O	O

or	eng	Y	N	O	O

phrase	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

example	eng	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

can	eng	N	N	O	O

call	eng	N	N	O	O

the	eng	N	N	O	O

University	eng	N	N	O	O

of	eng	N	N	O	O

Waterloo	eng	N	N	O	O

by	eng	N	N	O	O

dialing	eng	N	N	O	O

the	eng	N	N	O	O

memorable	eng	N	N	O	O

TUT	eng	N	N	O	O
-	x	N	N	O	O
GLOP	eng	N	N	O	O
.	m	N	N	O	O

Sometimes	eng	N	N	O	O

only	eng	N	N	O	O

part	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

is	eng	N	N	O	O

used	eng	N	N	O	O

to	eng	N	N	O	O

spell	eng	N	N	O	O

a	x	N	N	O	O

word	eng	N	N	O	O
.	m	N	N	O	O

When	eng	N	N	O	O

you	eng	N	N	O	O

get	eng	N	N	O	O

back	eng	N	N	O	O

to	eng	N	N	O	O

your	eng	N	N	O	O

hotel	eng	N	N	O	O

tonight	eng	N	N	O	O

you	eng	N	N	O	O

can	eng	N	N	O	O

order	eng	N	N	O	O

a	x	N	N	O	O

pizza	eng	N	N	O	O

from	eng	N	N	O	O

Gino	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

by	eng	N	N	O	O

dialing	eng	N	N	O	O

310	m	N	N	O	O
-	x	N	N	O	O
GINO	eng	N	N	O	O
.	m	N	N	O	O

Another	eng	N	N	O	O

way	eng	N	N	O	O

to	eng	N	N	O	O

make	eng	N	N	O	O

a	x	N	N	O	O

telephone	eng	N	N	O	O

number	eng	N	N	O	O

memorable	eng	N	N	O	O

is	eng	N	N	O	O

to	eng	N	N	O	O

group	eng	N	N	O	O

the	eng	N	N	O	O

digits	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

memorable	eng	N	N	O	O

way	eng	N	N	O	O
.	m	N	N	O	O

You	eng	N	N	O	O

could	eng	N	N	O	O

order	eng	N	N	O	O

your	eng	N	N	O	O

pizza	eng	N	N	O	O

from	eng	N	N	O	O

Pizza	eng	N	N	O	O

Hut	eng	N	N	O	O

by	eng	N	N	O	O

calling	eng	N	N	O	O

their	eng	N	N	O	O

`	x	N	N	O	O
`	x	N	N	O	O
three	eng	N	N	O	O

tens	eng	N	N	O	O
'	x	N	N	O	O
'	x	N	N	O	O

number	eng	N	N	O	O

3	x	N	N	O	O
-	x	N	N	O	O
10	m	N	N	O	O
-	x	N	N	O	O
10	m	N	N	O	O
-	x	N	N	O	O
10.	m	N	N	O	O

The	eng	N	N	O	O

standard	eng	N	N	O	O

form	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

telephone	eng	N	N	O	O

number	eng	N	N	O	O

is	eng	N	N	O	O

seven	eng	N	N	O	O

decimal	eng	N	N	O	O

digits	eng	N	N	O	O

with	eng	N	N	O	O

a	x	N	N	O	O

hyphen	eng	N	N	O	O

between	eng	N	N	O	O

the	eng	N	N	O	O

third	eng	N	N	O	O

and	eng	N	N	O	O

fourth	eng	N	N	O	O

digits	eng	N	N	O	O

(	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
g	eng	N	N	O	O
.	m	N	N	O	O

888	m	N	N	O	O
-	x	N	N	O	O
1200	m	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O

The	eng	N	N	O	O

keypad	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

phone	eng	N	N	O	O

supplies	eng	N	N	O	O

the	eng	N	N	O	O

mapping	eng	N	N	O	O

of	eng	N	N	O	O

letters	eng	N	N	O	O

to	eng	N	N	O	O

numbers	eng	N	N	O	O
,	x	N	N	O	O

as	eng	Y	N	O	O

follows	eng	N	N	O	O
:	x	N	N	O	O

A	x	N	N	O	O
,	x	N	N	O	O

B	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

C	x	N	N	O	O

map	eng	N	N	O	O

to	eng	N	N	O	O

2	x	N	N	O	O

D	x	N	N	O	O
,	x	N	N	O	O

E	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

F	x	N	N	O	O

map	eng	N	N	O	O

to	eng	N	N	O	O

3	x	N	N	O	O

G	x	N	N	O	O
,	x	N	N	O	O

H	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

I	x	N	N	O	O

map	eng	N	N	O	O

to	eng	N	N	O	O

4	x	N	N	O	O

J	x	N	N	O	O
,	x	N	N	O	O

K	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

L	x	N	N	O	O

map	eng	N	N	O	O

to	eng	N	N	O	O

5	x	N	N	O	O

M	x	N	N	O	O
,	x	N	N	O	O

N	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

O	x	N	N	O	O

map	eng	N	N	O	O

to	eng	N	N	O	O

6	x	N	N	O	O

P	x	N	N	O	O
,	x	N	N	O	O

R	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

S	x	N	N	O	O

map	eng	N	N	O	O

to	eng	N	N	O	O

7	x	N	N	O	O

T	x	N	N	O	O
,	x	N	N	O	O

U	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

V	x	N	N	O	O

map	eng	N	N	O	O

to	eng	N	N	O	O

8	x	N	N	O	O

W	x	N	N	O	O
,	x	N	N	O	O

X	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

Y	x	N	N	O	O

map	eng	N	N	O	O

to	eng	N	N	O	O

9	x	N	N	O	O

There	eng	N	N	O	O

is	eng	N	N	O	O

no	eng	N	N	O	O

mapping	eng	N	N	O	O

for	eng	Y	N	O	O

Q	x	N	N	O	O

or	eng	Y	N	O	O

Z	eng	N	N	O	O
.	m	N	N	O	O

Hyphens	eng	N	N	O	O

are	eng	N	N	O	O

not	eng	N	N	O	O

dialed	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

can	eng	N	N	O	O

be	eng	Y	N	O	O

added	eng	N	N	O	O

and	eng	N	N	O	O

removed	eng	N	N	O	O

as	eng	Y	N	O	O

necessary	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

standard	eng	N	N	O	O

form	eng	N	N	O	O

of	eng	N	N	O	O

TUT	eng	N	N	O	O
-	x	N	N	O	O
GLOP	eng	N	N	O	O

is	eng	N	N	O	O

888	m	N	N	O	O
-	x	N	N	O	O
4567	m	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

standard	eng	N	N	O	O

form	eng	N	N	O	O

of	eng	N	N	O	O

310	m	N	N	O	O
-	x	N	N	O	O
GINO	eng	N	N	O	O

is	eng	N	N	O	O

310	m	N	N	O	O
-	x	N	N	O	O
4466	m	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

standard	eng	N	N	O	O

form	eng	N	N	O	O

of	eng	N	N	O	O

3	x	N	N	O	O
-	x	N	N	O	O
10	m	N	N	O	O
-	x	N	N	O	O
10	m	N	N	O	O
-	x	N	N	O	O
10	m	N	N	O	O

is	eng	N	N	O	O

310	m	N	N	O	O
-	x	N	N	O	O
1010.	m	N	N	O	O

Two	eng	N	N	O	O

telephone	eng	N	N	O	O

numbers	eng	N	N	O	O

are	eng	N	N	O	O

equivalent	eng	N	N	O	O

if	eng	N	N	O	O

they	eng	N	N	O	O

have	eng	N	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

standard	eng	N	N	O	O

form	eng	N	N	O	O
.	m	N	N	O	O

(	x	N	N	O	O
They	eng	N	N	O	O

dial	eng	N	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

number	eng	N	N	O	O
.	m	N	N	O	O
)	x	N	N	O	O

Your	eng	N	N	O	O

company	eng	N	N	O	O

is	eng	N	N	O	O

compiling	eng	N	N	O	O

a	x	N	N	O	O

directory	eng	N	N	O	O

of	eng	N	N	O	O

telephone	eng	N	N	O	O

numbers	eng	N	N	O	O

from	eng	N	N	O	O

local	eng	N	N	O	O

businesses	eng	N	N	O	O
.	m	N	N	O	O

As	eng	N	N	O	O

part	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

quality	eng	N	N	O	O

control	eng	N	N	O	O

process	eng	N	N	O	O

you	eng	N	N	O	O

want	eng	N	N	O	O

to	eng	N	N	O	O

check	eng	N	N	O	O

that	eng	N	N	O	O

no	eng	N	N	O	O

two	eng	N	N	O	O

(	x	N	N	O	O
or	eng	Y	N	O	O

more	eng	N	N	O	O
)	x	N	N	O	O

businesses	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

directory	eng	N	N	O	O

have	eng	N	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

telephone	eng	N	N	O	O

number	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

The	eng	N	N	O	O

input	eng	N	N	O	O

will	eng	N	N	O	O

consist	eng	N	N	O	O

of	eng	N	N	O	O

one	eng	N	N	O	O

case	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

input	eng	N	N	O	O

specifies	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

telephone	eng	N	N	O	O

numbers	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

directory	eng	N	N	O	O

(	x	N	N	O	O
up	eng	N	N	O	O

to	eng	N	N	O	O

100	m	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
)	x	N	N	O	O

as	eng	Y	N	O	O

a	x	N	N	O	O

positive	eng	N	N	O	O

integer	eng	N	N	O	O

alone	eng	N	N	O	O

on	eng	N	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

remaining	eng	N	N	O	O

lines	eng	N	N	O	O

list	eng	N	N	O	O

the	eng	N	N	O	O

telephone	eng	N	N	O	O

numbers	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

directory	eng	N	N	O	O
,	x	N	N	O	O

with	eng	N	N	O	O

each	eng	N	N	O	O

number	eng	N	N	O	O

alone	eng	N	N	O	O

on	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

telephone	eng	N	N	O	O

number	eng	N	N	O	O

consists	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

string	eng	N	N	O	O

composed	eng	N	N	O	O

of	eng	N	N	O	O

decimal	eng	N	N	O	O

digits	eng	N	N	O	O
,	x	N	N	O	O

uppercase	eng	N	N	O	O

letters	eng	N	N	O	O

(	x	N	N	O	O
excluding	eng	N	N	O	O

Q	x	N	N	O	O

and	eng	N	N	O	O

Z	x	N	N	O	O
)	x	N	N	O	O

and	eng	N	N	O	O

hyphens	eng	N	N	O	O
.	m	N	N	O	O

Exactly	eng	N	N	O	O

seven	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

characters	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

string	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

digits	eng	N	N	O	O

or	eng	Y	N	O	O

letters	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

Generate	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

output	eng	N	N	O	O

for	eng	Y	N	O	O

each	eng	N	N	O	O

telephone	eng	N	N	O	O

number	eng	N	N	O	O

that	eng	N	N	O	O

appears	eng	N	N	O	O

more	eng	N	N	O	O

than	eng	N	N	O	O

once	eng	N	N	O	O

in	eng	Y	N	O	O

any	eng	N	N	O	O

form	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

line	eng	N	N	O	O

should	eng	N	N	O	O

give	eng	N	N	O	O

the	eng	N	N	O	O

telephone	eng	N	N	O	O

number	eng	N	N	O	O

in	eng	Y	N	O	O

standard	eng	N	N	O	O

form	eng	N	N	O	O
,	x	N	N	O	O

followed	eng	N	N	O	O

by	eng	N	N	O	O

a	x	N	N	O	O

space	eng	N	N	O	O
,	x	N	N	O	O

followed	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

times	eng	N	N	O	O

the	eng	N	N	O	O

telephone	eng	N	N	O	O

number	eng	N	N	O	O

appears	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

directory	eng	N	N	O	O
.	m	N	N	O	O

Arrange	eng	N	N	O	O

the	eng	N	N	O	O

output	eng	N	N	O	O

lines	eng	N	N	O	O

by	eng	N	N	O	O

telephone	eng	N	N	O	O

number	eng	N	N	O	O

in	eng	Y	N	O	O

ascending	eng	N	N	O	O

lexicographical	eng	N	N	O	O

order	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

there	eng	N	N	O	O

are	eng	N	N	O	O

no	eng	N	N	O	O

duplicates	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

input	eng	N	N	O	O

print	eng	N	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O
:	x	N	N	O	O

No	eng	N	N	O	O

duplicates	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

12	m	N	N	O	O

4873279	m	N	N	O	O

ITS	eng	N	N	O	O
-	x	N	N	O	O
EASY	eng	N	N	O	O

888	m	N	N	O	O
-	x	N	N	O	O
4567	m	N	N	O	O

3	x	N	N	O	O
-	x	N	N	O	O
10	m	N	N	O	O
-	x	N	N	O	O
10	m	N	N	O	O
-	x	N	N	O	O
10	m	N	N	O	O

888	m	N	N	O	O
-	x	N	N	O	O
GLOP	eng	N	N	O	O

TUT	eng	N	N	O	O
-	x	N	N	O	O
GLOP	eng	N	N	O	O

967	m	N	N	O	O
-	x	N	N	O	O
11	m	N	N	O	O
-	x	N	N	O	O
11	m	N	N	O	O

310	m	N	N	O	O
-	x	N	N	O	O
GINO	eng	N	N	O	O

F101010	eng	N	N	O	O

888	m	N	N	O	O
-	x	N	N	O	O
1200	m	N	N	O	O

-	x	N	N	O	O
4	x	N	N	O	O
-	x	N	N	O	O
8	x	N	N	O	O
-	x	N	N	O	O
7	x	N	N	O	O
-	x	N	N	O	O
3	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
-	x	N	N	O	O
7	x	N	N	O	O
-	x	N	N	O	O
9	x	N	N	O	O
-	x	N	N	O	O

487	m	N	N	O	O
-	x	N	N	O	O
3279	m	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

310	m	N	N	O	O
-	x	N	N	O	O
1010	m	N	N	O	O

2	x	N	N	O	O

487	m	N	N	O	O
-	x	N	N	O	O
3279	m	N	N	O	O

4	x	N	N	O	O

888	m	N	N	O	O
-	x	N	N	O	O
4567	m	N	N	O	O

3	x	N	N	O	O

Source	eng	N	N	O	O

East	eng	N	N	O	O

Central	eng	N	N	O	O

North	eng	N	N	O	O

America	eng	N	N	O	O

1999	m	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
字符串	n	Y	N	B-KNOWLEDGE	O
处理	v	N	N	I-KNOWLEDGE	O

/	x	N	N	O	O
/	x	N	N	O	O
题意	n	N	N	O	O
：	x	N	N	O	O
主要	b	N	N	O	O
是	v	N	N	O	O
输入	v	N	N	O	O
若干	m	N	N	O	O
字符串	n	Y	N	O	O
，	x	N	N	O	O
转化	v	Y	N	O	O
为	p	N	N	O	O
XXX	eng	N	N	O	O
-	x	N	N	O	O
XXXX	eng	N	N	O	O
这样	r	N	N	O	O
的	uj	N	N	O	O
标准	n	N	N	O	O
格式	n	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
查看	v	N	N	O	O
那些	r	N	N	O	O
是	v	N	N	O	O
相同	d	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
并	c	N	N	O	O
按	p	N	N	O	O
字典	n	N	N	O	O
序	n	N	N	O	O
输出	v	Y	N	O	O
这些	r	N	N	O	O
串及	v	N	N	O	O
重复	d	Y	N	O	O
个数	n	Y	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
程序	n	N	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
set	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
map	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

set	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O
s1	eng	N	N	O	O
,	x	N	N	O	O
s2	eng	N	N	O	O
;	x	N	N	O	O

set	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
iterator	eng	N	N	O	O

it	eng	N	N	O	O
;	x	N	N	O	O

map	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O
>	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

string	eng	N	N	O	O

s	x	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

str	eng	Y	N	O	O
[	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
ch	eng	Y	N	O	O
[	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

getchar	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

gets	eng	N	N	O	O
(	x	N	N	O	O
ch	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
ch	eng	Y	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
\	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

switch	eng	N	N	O	O
(	x	N	N	O	O
ch	eng	Y	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

case	eng	N	N	O	O
'	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
Z	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
Q	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

case	eng	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
B	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
C	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
2	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

case	eng	N	N	O	O
'	x	N	N	O	O
D	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
E	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
F	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
3	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

case	eng	N	N	O	O
'	x	N	N	O	O
G	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
H	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
I	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
4	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

case	eng	N	N	O	O
'	x	N	N	O	O
J	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
K	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
L	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
5	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

case	eng	N	N	O	O
'	x	N	N	O	O
M	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
N	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
O	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
6	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

case	eng	N	N	O	O
'	x	N	N	O	O
P	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
R	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
S	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
7	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

case	eng	N	N	O	O
'	x	N	N	O	O
T	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
U	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
V	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
8	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

case	eng	N	N	O	O
'	x	N	N	O	O
W	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
X	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
case	eng	N	N	O	O
'	x	N	N	O	O
Y	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
9	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

default	eng	N	N	O	O
:	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
ch	eng	Y	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
3	x	N	N	O	O
)	x	N	N	O	O

str	eng	Y	N	O	O
[	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

str	eng	Y	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
\	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
=	x	N	N	O	O
str	eng	Y	N	O	O
;	x	N	N	O	O

it	eng	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
.	m	N	N	O	O
find	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
it	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
.	m	N	N	O	O
end	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

m	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

s2	eng	N	N	O	O
.	m	N	N	O	O
insert	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

s1	eng	N	N	O	O
.	m	N	N	O	O
insert	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
s2	eng	N	N	O	O
.	m	N	N	O	O
empty	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
it	eng	N	N	O	O
=	x	N	N	O	O
s2	eng	N	N	O	O
.	m	N	N	O	O
begin	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
it	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
s2	eng	N	N	O	O
.	m	N	N	O	O
end	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
it	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
*	x	N	N	O	O
it	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
'	x	N	N	O	O

'	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
[	x	N	N	O	O
*	x	N	N	O	O
it	eng	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
"	x	N	N	O	O
No	eng	N	N	O	O

duplicates	eng	N	N	O	O
.	m	N	N	O	O
"	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

s1	eng	N	N	O	O
.	m	N	N	O	O
clear	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

s2	eng	N	N	O	O
.	m	N	N	O	O
clear	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

m	eng	N	N	O	O
.	m	N	N	O	O
clear	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
PKU	eng	N	Y	B-OJ	B-OJ

3174	m	N	N	I-OJ	O

Alignment	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

Planets	eng	N	N	O	O
_	x	N	N	O	O
Somethings	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

看	v	N	N	O	O
懂	v	N	N	O	O
题目	n	Y	N	O	O
直接	ad	N	N	O	O
暴力	n	Y	N	O	O
，	x	N	N	O	O
O	x	N	N	O	O

N3	eng	N	N	O	O
的	uj	N	N	O	O
算法	n	Y	N	O	O
也	d	N	N	O	O
可以	c	N	N	O	O
过	ug	N	N	O	O
得	ud	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

不过	c	N	N	O	O
精度	n	Y	N	O	O
上	f	N	N	O	O
可能	v	N	N	O	O
有点	n	N	N	O	O
问题	n	N	N	O	O

学习	v	N	N	O	O
了	ul	N	N	O	O
一下	m	N	N	O	O
别人	r	N	N	O	O
的	uj	N	N	O	O

用	p	N	N	O	O
数学	n	Y	N	O	O
变换	v	Y	N	O	O
就	d	N	N	O	O
可以	c	N	N	O	O
得到	v	N	N	O	O
一个	m	N	N	O	O
不用	v	N	N	O	O
做	v	N	N	O	O
除法	v	Y	N	O	O
的	uj	N	N	O	O
式子	n	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

小	a	N	N	O	O
技巧	n	N	N	O	O

又	d	N	N	O	O
学	v	N	N	O	O
了	ul	N	N	O	O
一招	m	N	N	O	O

哈哈	o	N	N	O	O

哎	e	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

如果	c	N	N	O	O
昨天	t	N	N	O	O
能	v	N	N	O	O
做到	v	N	N	O	O
这个	r	N	N	O	O
，	x	N	N	O	O
可能	v	N	N	O	O
又	d	N	N	O	O
不	d	N	N	O	O
一样	r	N	N	O	O
了	ul	N	N	O	O

不过	c	N	N	O	O
还是	c	N	N	O	O
要	v	N	N	O	O
感谢	v	N	N	O	O
PIP	eng	N	N	O	O
，	x	N	N	O	O
因为	c	N	N	O	O
昨天	t	N	N	O	O
发现	v	N	N	O	O
一个	m	N	N	O	O
人	n	N	N	O	O
在	p	N	N	O	O
真的	d	N	N	O	O
很	zg	N	N	O	O
低落	v	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
，	x	N	N	O	O
一句	m	N	N	O	O
短短的	z	N	N	O	O
鼓励	v	N	N	O	O
，	x	N	N	O	O
确实	ad	N	N	O	O
能	v	N	N	O	O
让	v	N	N	O	O
人	n	N	N	O	O
感到	v	N	N	O	O
很	zg	N	N	O	O
温暖	an	N	N	O	O
~	x	N	N	O	O

谢谢	nr	N	N	O	O
PIP	eng	N	N	O	O
，	x	N	N	O	O
虽然	c	N	N	O	O
你	r	N	N	O	O
依然	d	N	N	O	O
很	zg	N	N	O	O
猥琐	an	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
math	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

node	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
800	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

list	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n1	eng	N	N	O	O
,	x	N	N	O	O
n2	eng	N	N	O	O
,	x	N	N	O	O
n3	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
list	eng	N	N	O	O
[	x	N	N	O	O
800	m	N	N	O	O
*	x	N	N	O	O
800	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
count	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
scanf	eng	N	N	O	O

(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

count	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O

(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
b	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
;	x	N	N	O	O

node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
,	x	N	N	O	O
node	eng	N	N	O	O
+	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
cmp	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

printf	eng	N	N	O	O

(	x	N	N	O	O
"	x	N	N	O	O
go	eng	N	N	O	O

to	eng	N	N	O	O

se1	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

xl1	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
xl2	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O

xl1	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
-	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
-	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

xl2	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
-	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
-	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
xl1	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
xl2	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

list	eng	N	N	O	O
[	x	N	N	O	O
count	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
n1	eng	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

list	eng	N	N	O	O
[	x	N	N	O	O
count	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
n2	eng	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

list	eng	N	N	O	O
[	x	N	N	O	O
count	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
n3	eng	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

count	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O

(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
count	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
count	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O

(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
list	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
n1	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
list	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
n2	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
list	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
n3	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

2440	m	N	N	I-OJ	I-OJ
_	x	N	N	O	O
志	n	N	N	O	O
当存	v	N	N	O	O
高远	d	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O
Description	eng	N	N	O	O

A	x	N	N	O	O

kind	eng	N	N	O	O

of	eng	N	N	O	O

virus	eng	N	N	O	O

has	eng	Y	N	O	O

attacked	eng	N	N	O	O

the	eng	N	N	O	O

X	x	N	N	O	O

planet	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

many	eng	N	N	O	O

lives	eng	N	N	O	O

are	eng	N	N	O	O

infected	eng	N	N	O	O
.	m	N	N	O	O

After	eng	N	N	O	O

weeks	eng	N	N	O	O

of	eng	N	N	O	O

study	eng	N	N	O	O
,	x	N	N	O	O

The	eng	N	N	O	O

CHO	eng	N	N	O	O

(	x	N	N	O	O
Creature	eng	N	N	O	O

Healthy	eng	N	N	O	O

Organization	eng	N	N	O	O
)	x	N	N	O	O

of	eng	N	N	O	O

X	x	N	N	O	O

planet	eng	N	N	O	O

finally	eng	N	N	O	O

finds	eng	N	N	O	O

out	eng	N	N	O	O

that	eng	N	N	O	O

this	eng	N	N	O	O

kind	eng	N	N	O	O

of	eng	N	N	O	O

virus	eng	N	N	O	O

has	eng	Y	N	O	O

two	eng	N	N	O	O

kind	eng	N	N	O	O

of	eng	N	N	O	O

very	eng	N	N	O	O

simple	eng	N	N	O	O

DNA	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

can	eng	N	N	O	O

be	eng	Y	N	O	O

represented	eng	N	N	O	O

by	eng	N	N	O	O

101	m	N	N	O	O

and	eng	N	N	O	O

111.	m	N	N	O	O

Unfortunately	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

lives	eng	N	N	O	O

on	eng	N	N	O	O

the	eng	N	N	O	O

planet	eng	N	N	O	O

also	eng	N	N	O	O

have	eng	N	N	O	O

DNA	eng	N	N	O	O

formed	eng	N	N	O	O

by	eng	N	N	O	O

0	m	N	N	O	O
s	eng	N	N	O	O

and	eng	N	N	O	O

1	m	N	N	O	O
s	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

a	x	N	N	O	O

creature	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

DNA	eng	N	N	O	O

contains	eng	N	N	O	O

the	eng	N	N	O	O

virus	eng	N	N	O	O
'	x	N	N	O	O

DNA	eng	N	N	O	O
,	x	N	N	O	O

it	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

affected	eng	N	N	O	O
;	x	N	N	O	O

otherwise	eng	N	N	O	O

it	eng	N	N	O	O

will	eng	N	N	O	O

not	eng	N	N	O	O
.	m	N	N	O	O

Given	eng	N	N	O	O

an	eng	Y	N	O	O

integer	eng	N	N	O	O

L	x	N	N	O	O
,	x	N	N	O	O

it	eng	N	N	O	O

is	eng	N	N	O	O

clear	eng	N	N	O	O

that	eng	N	N	O	O

there	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

2	x	N	N	O	O

^	x	N	N	O	O

L	x	N	N	O	O

different	eng	N	N	O	O

lives	eng	N	N	O	O
,	x	N	N	O	O

of	eng	N	N	O	O

which	eng	N	N	O	O

the	eng	N	N	O	O

length	eng	N	N	O	O

of	eng	N	N	O	O

DNA	eng	N	N	O	O

is	eng	N	N	O	O

L	eng	N	N	O	O
.	m	N	N	O	O

Your	eng	N	N	O	O

job	eng	N	N	O	O

is	eng	N	N	O	O

to	eng	N	N	O	O

find	eng	N	N	O	O

out	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

2	x	N	N	O	O

^	x	N	N	O	O

L	x	N	N	O	O

lives	eng	N	N	O	O

how	eng	N	N	O	O

many	eng	N	N	O	O

won	eng	N	N	O	O
'	x	N	N	O	O
t	x	N	N	O	O

be	eng	Y	N	O	O

affected	eng	N	N	O	O
?	x	N	N	O	O

Input	eng	N	N	O	O

The	eng	N	N	O	O

input	eng	N	N	O	O

contains	eng	N	N	O	O

several	eng	N	N	O	O

test	eng	N	N	O	O

cases	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O

it	eng	N	N	O	O

contains	eng	N	N	O	O

a	x	N	N	O	O

positive	eng	N	N	O	O

integer	eng	N	N	O	O

L	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

L	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

10	m	N	N	O	O

^	x	N	N	O	O

8	x	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O

The	eng	N	N	O	O

end	eng	N	N	O	O

of	eng	N	N	O	O

input	eng	N	N	O	O

is	eng	N	N	O	O

indicated	eng	N	N	O	O

by	eng	N	N	O	O

end	eng	N	N	O	O
-	x	N	N	O	O
of	eng	N	N	O	O
-	x	N	N	O	O
file	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O
,	x	N	N	O	O

output	eng	N	N	O	O

K	x	N	N	O	O

mod	eng	N	N	O	O

2005	m	N	N	O	O
,	x	N	N	O	O

here	eng	N	N	O	O

K	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

lives	eng	N	N	O	O

that	eng	N	N	O	O

will	eng	N	N	O	O

not	eng	N	N	O	O

be	eng	Y	N	O	O

affected	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

4	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

9	x	N	N	O	O

解题	n	N	N	O	O
思路	n	N	N	O	O

可以	c	N	N	O	O
推出	v	N	N	O	O
递推	v	Y	N	O	B-KNOWLEDGE
公式	n	Y	N	O	O
f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
=	x	N	N	O	O
f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
f	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
3	x	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
f	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
4	x	N	N	O	O
)	x	N	N	O	O
。	x	N	N	O	O

然后	c	N	N	O	O
输出	v	Y	N	O	O
1000	m	N	N	O	O
结果	n	N	N	O	O
查看	v	N	N	O	O
结果	n	N	N	O	O
的	uj	N	N	O	O
循环	vn	N	N	O	O
规律	n	Y	N	O	O
，	x	N	N	O	O
得到	v	N	N	O	O
200	m	N	N	O	O
。	x	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
205	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

Cal	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
4	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
6	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
9	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
5	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
15	m	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
6	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
200	m	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
%	x	N	N	O	O
=	x	N	N	O	O
2005	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

getNum	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

n	x	N	N	O	O
%	x	N	N	O	O
=	x	N	N	O	O
200	m	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
freopen	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
car	eng	N	N	O	O
.	m	N	N	O	O
in	eng	Y	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
r	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
stdin	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
freopen	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
car	eng	N	N	O	O
.	m	N	N	O	O
out	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
w	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
stdout	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

Cal	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
getNum	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj1085	eng	N	Y	B-OJ	B-OJ

Triangle	eng	N	N	O	O

War	eng	N	N	O	O

极大	a	N	N	O	O
极小	d	N	N	O	O

-	x	N	N	O	O

qiqijianglu	eng	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

Triangle	eng	N	N	O	O

War	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

65536	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

2171	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

831	m	N	N	O	O

Description	eng	N	N	O	O

Triangle	eng	N	N	O	O

War	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

two	eng	N	N	O	O
-	x	N	N	O	O
player	eng	N	N	O	O

game	eng	N	N	O	O

played	eng	N	N	O	O

on	eng	N	N	O	O

the	eng	N	N	O	O

following	eng	N	N	O	O

triangular	eng	N	N	O	O

grid	eng	N	N	O	O
:	x	N	N	O	O

Two	eng	N	N	O	O

players	eng	N	N	O	O
,	x	N	N	O	O

A	x	N	N	O	O

and	eng	N	N	O	O

B	x	N	N	O	O
,	x	N	N	O	O

take	eng	N	N	O	O

turns	eng	N	N	O	O

filling	eng	N	N	O	O

in	eng	Y	N	O	O

any	eng	N	N	O	O

dotted	eng	N	N	O	O

line	eng	N	N	O	O

connecting	eng	N	N	O	O

two	eng	N	N	O	O

dots	eng	N	N	O	O
,	x	N	N	O	O

with	eng	N	N	O	O

A	x	N	N	O	O

starting	eng	N	N	O	O

first	eng	N	N	O	O
.	m	N	N	O	O

Once	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

is	eng	N	N	O	O

filled	eng	N	N	O	O
,	x	N	N	O	O

it	eng	N	N	O	O

cannot	eng	N	N	O	O

be	eng	Y	N	O	O

filled	eng	N	N	O	O

again	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O

filled	eng	N	N	O	O

by	eng	N	N	O	O

a	x	N	N	O	O

player	eng	N	N	O	O

completes	eng	N	N	O	O

one	eng	N	N	O	O

or	eng	Y	N	O	O

more	eng	N	N	O	O

triangles	eng	N	N	O	O
,	x	N	N	O	O

she	eng	N	N	O	O

owns	eng	N	N	O	O

the	eng	N	N	O	O

completed	eng	N	N	O	O

triangles	eng	N	N	O	O

and	eng	N	N	O	O

she	eng	N	N	O	O

is	eng	N	N	O	O

awarded	eng	N	N	O	O

another	eng	N	N	O	O

turn	eng	N	N	O	O

(	x	N	N	O	O
i	eng	N	N	O	O
.	m	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O

the	eng	N	N	O	O

opponent	eng	N	N	O	O

skips	eng	N	N	O	O

a	x	N	N	O	O

turn	eng	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O

The	eng	N	N	O	O

game	eng	N	N	O	O

ends	eng	N	N	O	O

after	eng	N	N	O	O

all	eng	N	N	O	O

dotted	eng	N	N	O	O

lines	eng	N	N	O	O

are	eng	N	N	O	O

filled	eng	N	N	O	O

in	eng	Y	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

player	eng	N	N	O	O

with	eng	N	N	O	O

the	eng	N	N	O	O

most	eng	N	N	O	O

triangles	eng	N	N	O	O

wins	eng	N	N	O	O

the	eng	N	N	O	O

game	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

difference	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

triangles	eng	N	N	O	O

owned	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

two	eng	N	N	O	O

players	eng	N	N	O	O

is	eng	N	N	O	O

not	eng	N	N	O	O

important	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

example	eng	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

A	x	N	N	O	O

fills	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O

between	eng	N	N	O	O

2	x	N	N	O	O

and	eng	N	N	O	O

5	x	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

partial	eng	N	N	O	O

game	eng	N	N	O	O

on	eng	N	N	O	O

the	eng	N	N	O	O

left	eng	N	N	O	O

below	eng	N	N	O	O
:	x	N	N	O	O

Then	eng	N	N	O	O
,	x	N	N	O	O

she	eng	N	N	O	O

owns	eng	N	N	O	O

the	eng	N	N	O	O

triangle	eng	N	N	O	O

labelled	eng	N	N	O	O

A	x	N	N	O	O

and	eng	N	N	O	O

takes	eng	N	N	O	O

another	eng	N	N	O	O

turn	eng	N	N	O	O

to	eng	N	N	O	O

fill	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O

between	eng	N	N	O	O

3	x	N	N	O	O

and	eng	N	N	O	O

5.	m	N	N	O	O

B	x	N	N	O	O

can	eng	N	N	O	O

now	eng	N	N	O	O

own	eng	N	N	O	O

3	x	N	N	O	O

triangles	eng	N	N	O	O

(	x	N	N	O	O
if	eng	N	N	O	O

he	eng	Y	N	O	O

wishes	eng	N	N	O	O
)	x	N	N	O	O

by	eng	N	N	O	O

filling	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O

between	eng	N	N	O	O

2	x	N	N	O	O

and	eng	N	N	O	O

3	x	N	N	O	O
,	x	N	N	O	O

then	eng	N	N	O	O

the	eng	N	N	O	O

one	eng	N	N	O	O

between	eng	N	N	O	O

5	x	N	N	O	O

and	eng	N	N	O	O

6	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

finally	eng	N	N	O	O

the	eng	N	N	O	O

one	eng	N	N	O	O

between	eng	N	N	O	O

6	x	N	N	O	O

and	eng	N	N	O	O

9.	m	N	N	O	O

B	x	N	N	O	O

would	eng	N	N	O	O

then	eng	N	N	O	O

make	eng	N	N	O	O

one	eng	N	N	O	O

more	eng	N	N	O	O

move	eng	N	N	O	O

before	eng	N	N	O	O

it	eng	N	N	O	O

is	eng	N	N	O	O

A	x	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

turn	eng	N	N	O	O

again	eng	N	N	O	O
.	m	N	N	O	O

In	eng	N	N	O	O

this	eng	N	N	O	O

problem	eng	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

are	eng	N	N	O	O

given	eng	N	N	O	O

a	x	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

moves	eng	N	N	O	O

that	eng	N	N	O	O

have	eng	N	N	O	O

already	eng	N	N	O	O

been	eng	N	N	O	O

made	eng	N	N	O	O
.	m	N	N	O	O

From	eng	N	N	O	O

the	eng	N	N	O	O

partial	eng	N	N	O	O

game	eng	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

should	eng	N	N	O	O

determine	eng	N	N	O	O

which	eng	N	N	O	O

player	eng	N	N	O	O

will	eng	N	N	O	O

win	eng	N	N	O	O

assuming	eng	N	N	O	O

that	eng	N	N	O	O

each	eng	N	N	O	O

player	eng	N	N	O	O

plays	eng	N	N	O	O

a	x	N	N	O	O

perfect	eng	N	N	O	O

game	eng	N	N	O	O

from	eng	N	N	O	O

that	eng	N	N	O	O

point	eng	N	N	O	O

on	eng	N	N	O	O
.	m	N	N	O	O

That	eng	N	N	O	O

is	eng	N	N	O	O
,	x	N	N	O	O

assume	eng	N	N	O	O

that	eng	N	N	O	O

each	eng	N	N	O	O

player	eng	N	N	O	O

always	eng	N	N	O	O

chooses	eng	N	N	O	O

the	eng	N	N	O	O

play	eng	N	N	O	O

that	eng	N	N	O	O

leads	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

best	eng	N	N	O	O

possible	eng	N	N	O	O

outcome	eng	N	N	O	O

for	eng	Y	N	O	O

himself	eng	N	N	O	O
/	x	N	N	O	O
herself	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

You	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

given	eng	N	N	O	O

a	x	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

games	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

input	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

input	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

positive	eng	N	N	O	O

integer	eng	N	N	O	O

indicating	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

games	eng	N	N	O	O

to	eng	N	N	O	O

follow	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

game	eng	N	N	O	O

starts	eng	N	N	O	O

with	eng	N	N	O	O

an	eng	Y	N	O	O

integer	eng	N	N	O	O

6	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

m	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

18	m	N	N	O	O

indicating	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

moves	eng	N	N	O	O

that	eng	N	N	O	O

have	eng	N	N	O	O

been	eng	N	N	O	O

made	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

game	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

next	eng	N	N	O	O

m	x	N	N	O	O

lines	eng	N	N	O	O

indicate	eng	N	N	O	O

the	eng	N	N	O	O

moves	eng	N	N	O	O

made	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

two	eng	N	N	O	O

players	eng	N	N	O	O

in	eng	Y	N	O	O

order	eng	N	N	O	O
,	x	N	N	O	O

each	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

form	eng	N	N	O	O

i	x	N	N	O	O

j	x	N	N	O	O

(	x	N	N	O	O
with	eng	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

j	x	N	N	O	O
)	x	N	N	O	O

indicating	eng	N	N	O	O

that	eng	N	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O

between	eng	N	N	O	O

i	x	N	N	O	O

and	eng	N	N	O	O

j	x	N	N	O	O

is	eng	N	N	O	O

filled	eng	N	N	O	O

in	eng	Y	N	O	O

that	eng	N	N	O	O

move	eng	N	N	O	O
.	m	N	N	O	O

You	eng	N	N	O	O

may	eng	N	N	O	O

assume	eng	N	N	O	O

that	eng	N	N	O	O

all	eng	N	N	O	O

given	eng	N	N	O	O

moves	eng	N	N	O	O

are	eng	N	N	O	O

legal	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

game	eng	N	N	O	O
,	x	N	N	O	O

print	eng	N	N	O	O

the	eng	N	N	O	O

game	eng	N	N	O	O

number	eng	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

result	eng	N	N	O	O

on	eng	N	N	O	O

one	eng	N	N	O	O

line	eng	N	N	O	O

as	eng	Y	N	O	O

shown	eng	N	N	O	O

below	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

A	x	N	N	O	O

wins	eng	N	N	O	O
,	x	N	N	O	O

print	eng	N	N	O	O

the	eng	N	N	O	O

sentence	eng	N	N	O	O

"	x	N	N	O	O
A	x	N	N	O	O

wins	eng	N	N	O	O
.	m	N	N	O	O
"	x	N	N	O	O

If	eng	N	N	O	O

B	x	N	N	O	O

wins	eng	N	N	O	O
,	x	N	N	O	O

print	eng	N	N	O	O

"	x	N	N	O	O
B	x	N	N	O	O

wins	eng	N	N	O	O
.	m	N	N	O	O
"	x	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

4	x	N	N	O	O

6	x	N	N	O	O

2	x	N	N	O	O

4	x	N	N	O	O

4	x	N	N	O	O

5	x	N	N	O	O

5	x	N	N	O	O

9	x	N	N	O	O

3	x	N	N	O	O

6	x	N	N	O	O

2	x	N	N	O	O

5	x	N	N	O	O

3	x	N	N	O	O

5	x	N	N	O	O

7	x	N	N	O	O

2	x	N	N	O	O

4	x	N	N	O	O

4	x	N	N	O	O

5	x	N	N	O	O

5	x	N	N	O	O

9	x	N	N	O	O

3	x	N	N	O	O

6	x	N	N	O	O

2	x	N	N	O	O

5	x	N	N	O	O

3	x	N	N	O	O

5	x	N	N	O	O

7	x	N	N	O	O

8	x	N	N	O	O

6	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

1	x	N	N	O	O

3	x	N	N	O	O

2	x	N	N	O	O

4	x	N	N	O	O

2	x	N	N	O	O

5	x	N	N	O	O

4	x	N	N	O	O

5	x	N	N	O	O

10	m	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

2	x	N	N	O	O

5	x	N	N	O	O

3	x	N	N	O	O

6	x	N	N	O	O

5	x	N	N	O	O

8	x	N	N	O	O

4	x	N	N	O	O

7	x	N	N	O	O

6	x	N	N	O	O

10	m	N	N	O	O

2	x	N	N	O	O

4	x	N	N	O	O

4	x	N	N	O	O

5	x	N	N	O	O

4	x	N	N	O	O

8	x	N	N	O	O

7	x	N	N	O	O

8	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

Game	eng	N	N	O	O

1	x	N	N	O	O
:	x	N	N	O	O

B	x	N	N	O	O

wins	eng	N	N	O	O
.	m	N	N	O	O

Game	eng	N	N	O	O

2	x	N	N	O	O
:	x	N	N	O	O

A	x	N	N	O	O

wins	eng	N	N	O	O
.	m	N	N	O	O

Game	eng	N	N	O	O

3	x	N	N	O	O
:	x	N	N	O	O

A	x	N	N	O	O

wins	eng	N	N	O	O
.	m	N	N	O	O

Game	eng	N	N	O	O

4	x	N	N	O	O
:	x	N	N	O	O

B	x	N	N	O	O

wins	eng	N	N	O	O
.	m	N	N	O	O

Source	eng	N	N	O	O

East	eng	N	N	O	O

Central	eng	N	N	O	O

North	eng	N	N	O	O

America	eng	N	N	O	O

1999	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
time	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

M	x	N	N	O	O

11	m	N	N	O	O

int	eng	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
M	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
M	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O

{	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
3	x	N	N	O	O
,	x	N	N	O	O
4	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
5	x	N	N	O	O
,	x	N	N	O	O
6	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
3	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
7	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
9	x	N	N	O	O
,	x	N	N	O	O
10	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
4	x	N	N	O	O
,	x	N	N	O	O
5	x	N	N	O	O
,	x	N	N	O	O
7	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
8	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
11	m	N	N	O	O
,	x	N	N	O	O
12	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
6	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
8	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
13	m	N	N	O	O
,	x	N	N	O	O
14	m	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
9	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
15	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
10	m	N	N	O	O
,	x	N	N	O	O
11	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
15	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
16	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
12	m	N	N	O	O
,	x	N	N	O	O
13	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
16	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
17	m	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
14	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
17	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

tri	eng	N	N	O	O
[	x	N	N	O	O
9	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
7	x	N	N	O	O
,	x	N	N	O	O
152	m	N	N	O	O
,	x	N	N	O	O
52	m	N	N	O	O
,	x	N	N	O	O
352	m	N	N	O	O
,	x	N	N	O	O
34304	m	N	N	O	O
,	x	N	N	O	O
3200	m	N	N	O	O
,	x	N	N	O	O
71680	m	N	N	O	O
,	x	N	N	O	O
12544	m	N	N	O	O
,	x	N	N	O	O
155648	m	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
3	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
4	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
7	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
4	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
5	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tri	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
5	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
6	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
8	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
9	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
10	m	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
15	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
5	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
7	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
10	m	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
11	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tri	eng	N	N	O	O
[	x	N	N	O	O
6	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
11	m	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
12	m	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
16	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
7	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
8	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
12	m	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
13	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
8	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
13	m	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
14	m	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
17	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
*	x	N	N	O	O
/	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

mirror	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
18	m	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

MinSearch	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

,	x	N	N	O	O
int	eng	N	N	O	O

,	x	N	N	O	O
int	eng	N	N	O	O

,	x	N	N	O	O
int	eng	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

MaxSearch	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

,	x	N	N	O	O
int	eng	N	N	O	O

,	x	N	N	O	O
int	eng	N	N	O	O

,	x	N	N	O	O
int	eng	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

Place	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

s	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

seg	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

&	x	N	N	O	O
of	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

r	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
|	x	N	N	O	O
seg	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
9	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
&	x	N	N	O	O
s	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
&&	x	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
&	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
tri	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

of	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

r	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

MaxSearch	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

statu	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

alpha	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

as	eng	Y	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

bs	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

bit	eng	N	N	O	O
,	x	N	N	O	O
seg	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cs	eng	Y	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

max	eng	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
tmp	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
as	eng	Y	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
5	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
bs	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
5	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
statu	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
mirror	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

as	eng	Y	N	O	O
>	x	N	N	O	O
bs	eng	N	N	O	O
?	x	N	N	O	O
1	x	N	N	O	O
:	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

bit	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
~	x	N	N	O	O
statu	eng	N	N	O	O
)	x	N	N	O	O
&	x	N	N	O	O
mirror	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
bit	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

seg	eng	N	N	O	O
=	x	N	N	O	O
bit	eng	N	N	O	O
&	x	N	N	O	O
(	x	N	N	O	O
-	x	N	N	O	O
bit	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cs	eng	Y	N	O	O
=	x	N	N	O	O
as	eng	Y	N	O	O
;	x	N	N	O	O

r	x	N	N	O	O
=	x	N	N	O	O
Place	eng	N	N	O	O
(	x	N	N	O	O
statu	eng	N	N	O	O
,	x	N	N	O	O
seg	eng	N	N	O	O
,	x	N	N	O	O
cs	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
cs	eng	Y	N	O	O
>	x	N	N	O	O
as	eng	Y	N	O	O
)	x	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
MaxSearch	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
alpha	eng	N	N	O	O
,	x	N	N	O	O
cs	eng	Y	N	O	O
,	x	N	N	O	O
bs	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
MinSearch	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
max	eng	N	N	O	O
,	x	N	N	O	O
cs	eng	Y	N	O	O
,	x	N	N	O	O
bs	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
>	x	N	N	O	O
max	eng	N	N	O	O
)	x	N	N	O	O

max	eng	N	N	O	O
=	x	N	N	O	O
tmp	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
max	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
alpha	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O

return	eng	N	N	O	O

max	eng	N	N	O	O
;	x	N	N	O	O

bit	eng	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
seg	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

max	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

MinSearch	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

statu	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

beta	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

as	eng	Y	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

bs	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

bit	eng	N	N	O	O
,	x	N	N	O	O
seg	eng	N	N	O	O
,	x	N	N	O	O
cs	eng	Y	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
tmp	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
as	eng	Y	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
5	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
bs	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
5	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
statu	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
mirror	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

as	eng	Y	N	O	O
>	x	N	N	O	O
bs	eng	N	N	O	O
?	x	N	N	O	O
1	x	N	N	O	O
:	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

bit	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
~	x	N	N	O	O
statu	eng	N	N	O	O
)	x	N	N	O	O
&	x	N	N	O	O
mirror	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
bit	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

seg	eng	N	N	O	O
=	x	N	N	O	O
bit	eng	N	N	O	O
&	x	N	N	O	O
(	x	N	N	O	O
-	x	N	N	O	O
bit	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
最	d	N	N	O	O
右边	f	N	N	O	O
的	uj	N	N	O	O
1	m	N	N	O	O

cs	eng	Y	N	O	O
=	x	N	N	O	O
bs	eng	N	N	O	O
;	x	N	N	O	O

r	x	N	N	O	O
=	x	N	N	O	O
Place	eng	N	N	O	O
(	x	N	N	O	O
statu	eng	N	N	O	O
,	x	N	N	O	O
seg	eng	N	N	O	O
,	x	N	N	O	O
cs	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
cs	eng	Y	N	O	O
>	x	N	N	O	O
bs	eng	N	N	O	O
)	x	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
MinSearch	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
beta	eng	N	N	O	O
,	x	N	N	O	O
as	eng	Y	N	O	O
,	x	N	N	O	O
cs	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
MaxSearch	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
min	eng	N	N	O	O
,	x	N	N	O	O
as	eng	Y	N	O	O
,	x	N	N	O	O
cs	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
<	x	N	N	O	O
min	eng	N	N	O	O
)	x	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
tmp	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
beta	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O

return	eng	N	N	O	O

min	eng	N	N	O	O
;	x	N	N	O	O

bit	eng	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
seg	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

min	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
turn	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

res	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ofa	eng	N	N	O	O
,	x	N	N	O	O
ofb	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ta	eng	Y	N	O	O
,	x	N	N	O	O
tb	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

status	eng	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
t	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

status	eng	N	N	O	O
=	x	N	N	O	O
ofa	eng	N	N	O	O
=	x	N	N	O	O
ofb	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
turn	eng	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
b	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

ta	eng	Y	N	O	O
=	x	N	N	O	O
ofa	eng	N	N	O	O
,	x	N	N	O	O
tb	eng	N	N	O	O
=	x	N	N	O	O
ofb	eng	N	N	O	O
;	x	N	N	O	O

status	eng	N	N	O	O
=	x	N	N	O	O
Place	eng	N	N	O	O
(	x	N	N	O	O
status	eng	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
b	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
(	x	N	N	O	O
turn	eng	N	N	O	O
&	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
?	x	N	N	O	O
ofb	eng	N	N	O	O
:	x	N	N	O	O
ofa	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ta	eng	Y	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
ofa	eng	N	N	O	O
&&	x	N	N	O	O
tb	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
ofb	eng	N	N	O	O
)	x	N	N	O	O

turn	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
turn	eng	N	N	O	O
&	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O

res	eng	N	N	O	O
=	x	N	N	O	O
MinSearch	eng	N	N	O	O
(	x	N	N	O	O
status	eng	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
ofa	eng	N	N	O	O
,	x	N	N	O	O
ofb	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

res	eng	N	N	O	O
=	x	N	N	O	O
MaxSearch	eng	N	N	O	O
(	x	N	N	O	O
status	eng	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
ofa	eng	N	N	O	O
,	x	N	N	O	O
ofb	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
Game	eng	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
:	x	N	N	O	O

%	x	N	N	O	O
c	x	N	N	O	O

wins	eng	N	N	O	O
.	m	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
++	x	N	N	O	O
k	eng	N	N	O	O
,	x	N	N	O	O
res	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
?	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
:	x	N	N	O	O
'	x	N	N	O	O
B	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

3279	m	N	N	I-OJ	O

Fliptile	eng	N	N	O	O
_	x	N	N	O	O
chenwenwen0210	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

题目	n	Y	N	O	O
大意	d	N	N	O	O
：	x	N	N	O	O
老	a	N	N	O	O
题目	n	Y	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
就是	d	N	N	O	O
给	p	N	N	O	O
你	r	N	N	O	O
N	eng	N	N	O	O
*	x	N	N	O	O
M	eng	N	N	O	O
的	uj	N	N	O	O
0	m	N	N	O	O
，	x	N	N	O	O
1	x	N	N	O	O
矩阵	n	Y	N	O	O
，	x	N	N	O	O
要求	v	N	N	O	O
对	p	N	N	O	O
其中	r	N	N	O	O
的	uj	N	N	O	O
某些	r	N	N	O	O
格子	n	N	N	O	O
进行	v	N	N	O	O
操作	v	Y	N	O	O
，	x	N	N	O	O
使得	v	N	N	O	O
所有	b	N	N	O	O
的	uj	N	N	O	O
格子	n	N	N	O	O
变成	v	N	N	O	O
0	x	N	N	O	O
，	x	N	N	O	O

解题	n	N	N	O	O
报告	n	N	N	O	O
：	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
比较	d	N	N	O	O
小	a	N	N	O	O
，	x	N	N	O	O
可以	c	N	N	O	O
通过	p	N	N	O	O
枚举	nz	Y	N	O	O
第一行	m	N	N	O	O
的	uj	N	N	O	O
操作	v	Y	N	O	O
情况	n	N	N	O	O
，	x	N	N	O	O
因为	c	N	N	O	O
第一行	m	N	N	O	O
操作	v	Y	N	O	O
完	v	N	N	O	O
之后	f	N	N	O	O
，	x	N	N	O	O
某些	r	N	N	O	O
不是	c	N	N	O	O
0	x	N	N	O	O
，	x	N	N	O	O
必须	d	N	N	O	O
要	v	N	N	O	O
通过	p	N	N	O	O
第二行	m	N	N	O	O
的	uj	N	N	O	O
来	v	N	N	O	O
操作	v	Y	N	O	O
，	x	N	N	O	O
这样	r	N	N	O	O
就	d	N	N	O	O
可以	c	N	N	O	O
确定	v	N	N	O	O
了	ul	N	N	O	O
第二行	m	N	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O
，	x	N	N	O	O
这样	r	N	N	O	O
一行	m	N	N	O	O
一行	m	N	N	O	O
推	v	N	N	O	O
。	x	N	N	O	O

复杂度	n	N	N	O	O
2	x	N	N	O	O
^	x	N	N	O	O
m	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
*	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
math	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

typedef	eng	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

lld	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

MAX	eng	N	N	O	O
=	x	N	N	O	O
16	m	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

lld	eng	N	N	O	O

MOD	eng	N	N	O	O
=	x	N	N	O	O
1000007	m	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

INF	eng	N	N	O	O
=	x	N	N	O	O
1000000001	m	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

double	eng	N	N	O	O

PI	eng	N	N	O	O
=	x	N	N	O	O
acos	eng	N	N	O	O
(	x	N	N	O	O
-	x	N	N	O	O
1.0	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

double	eng	N	N	O	O

EPS	eng	N	N	O	O
=	x	N	N	O	O
1.0	m	N	N	O	O
e	eng	N	N	O	O
-	x	N	N	O	O
8	x	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

dir	eng	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O
{	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

tmp	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

save	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cur	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

count	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

m	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

cnt	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
cnt	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

cnt	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

cmp	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

m	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cb	eng	N	N	O	O
=	x	N	N	O	O
count	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ca	eng	Y	N	O	O
=	x	N	N	O	O
count	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ca	eng	Y	N	O	O
<	x	N	N	O	O
cb	eng	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ca	eng	Y	N	O	O
>	x	N	N	O	O
cb	eng	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

tmp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

cpy	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

m	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

flip	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

s	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
&	x	N	N	O	O
s	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

tmp	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

cur	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

cur	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

tmp	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

tmp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

tmp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
if	eng	N	N	O	O
(	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
save	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

flag	eng	N	N	O	O
=	x	N	N	O	O
false	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cpy	eng	N	N	O	O
(	x	N	N	O	O
cur	eng	N	N	O	O
,	x	N	N	O	O
save	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
flip	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

flag	eng	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
cmp	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
<	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cpy	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
,	x	N	N	O	O
tmp	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
flag	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
putchar	eng	N	N	O	O
(	x	N	N	O	O
'	x	N	N	O	O

'	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

putchar	eng	N	N	O	O
(	x	N	N	O	O
'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
+	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

puts	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

puts	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
IMPOSSIBLE	eng	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

100	m	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

100	m	N	N	O	O

22	m	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

100	m	N	N	O	O

35	m	N	N	O	O

25	m	N	N	O	O

-	x	N	N	O	O
10.5	m	N	N	O	O

10	m	N	N	O	O

90	m	N	N	O	O

25	m	N	N	O	O

-	x	N	N	O	O
28	m	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

zoj	eng	N	Y	B-OJ	B-OJ

1024	m	N	N	I-OJ	O

Calendar	eng	N	N	O	O

Game	eng	N	N	O	O

-	x	N	N	O	O

I	x	N	N	O	O

am	eng	Y	N	O	O

coming	eng	N	N	O	O
！	x	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

zoj	eng	N	Y	B-OJ	B-OJ
_	x	N	N	I-OJ	I-OJ
1024	m	N	N	I-OJ	O

博弈	v	Y	N	B-KNOWLEDGE	O

引用	v	N	N	O	O
别人	r	N	N	O	O
解释	v	N	N	O	O
：	x	N	N	O	O

Tips	eng	N	N	O	O
:	x	N	N	O	O

这	r	N	N	O	O
是	v	N	N	O	O
一道	m	N	N	O	O
博弈	v	Y	N	B-KNOWLEDGE	O
题	n	N	N	O	O
，	x	N	N	O	O
活	n	N	N	O	O
的	uj	N	N	O	O
胜利	vn	N	N	O	O
的	uj	N	N	O	O
一方	m	N	N	O	O
必须	d	N	N	O	O
翻倒	v	N	N	O	O
2001	m	N	N	O	O
年	m	N	N	O	O
11	m	N	N	O	O
月	m	N	N	O	O
4	m	N	N	O	O
日	m	N	N	O	O
；	x	N	N	O	O

下面	f	N	N	O	O
是	v	N	N	O	O
观察	v	N	N	O	O
推论	v	N	N	O	O
结果	n	N	N	O	O
，	x	N	N	O	O
11	m	N	N	O	O
月	m	N	N	O	O
4	m	N	N	O	O
日	m	N	N	O	O
，	x	N	N	O	O
11	m	N	N	O	O
+	x	N	N	O	O
4	m	N	N	O	O
=	x	N	N	O	O
15	m	N	N	O	O
是	v	N	N	O	O
奇数	n	Y	N	O	O
。	x	N	N	O	O

由于	c	N	N	O	O
无论是	c	N	N	O	O
加	v	N	N	O	O

一天	m	N	N	O	O
还是	c	N	N	O	O
加	v	N	N	O	O
一个月	m	N	N	O	O
都	d	N	N	O	O
会	v	N	N	O	O
改变	v	N	N	O	O
m	eng	N	N	O	O
+	x	N	N	O	O
d	eng	N	N	O	O
的	uj	N	N	O	O
奇偶性	n	N	N	O	O
，	x	N	N	O	O
除了	p	N	N	O	O
下面	f	N	N	O	O
几个	m	N	N	O	O
特例	n	N	N	O	O

2	m	N	N	O	O
月	m	N	N	O	O
28	m	N	N	O	O
日	m	N	N	O	O
、	x	N	N	O	O
9	m	N	N	O	O
月	m	N	N	O	O
30	m	N	N	O	O
日	m	N	N	O	O
和	c	N	N	O	O
11	m	N	N	O	O
月	m	N	N	O	O
30	m	N	N	O	O
日	m	N	N	O	O
，	x	N	N	O	O
显然	ad	N	N	O	O
如果	c	N	N	O	O
m	eng	N	N	O	O
和	c	N	N	O	O
d	eng	N	N	O	O
是	v	N	N	O	O
这	r	N	N	O	O
三个	m	N	N	O	O
日子	n	N	N	O	O
的话	u	N	N	O	O

则	d	N	N	O	O
先行者	n	N	N	O	O
必胜	v	N	N	O	O
：	x	N	N	O	O

2	m	N	N	O	O
月	m	N	N	O	O
28	m	N	N	O	O
日	m	N	N	O	O
到	v	N	N	O	O
3	m	N	N	O	O
月	m	N	N	O	O
28	m	N	N	O	O
日	m	N	N	O	O

9	m	N	N	O	O
月	m	N	N	O	O
30	m	N	N	O	O
日	m	N	N	O	O
到	v	N	N	O	O
10	m	N	N	O	O
月	m	N	N	O	O
1	m	N	N	O	O
日	m	N	N	O	O

11	m	N	N	O	O
月	m	N	N	O	O
30	m	N	N	O	O
日	m	N	N	O	O
到	v	N	N	O	O
12	m	N	N	O	O
月	m	N	N	O	O
1	m	N	N	O	O
日	m	N	N	O	O

剩下	v	N	N	O	O
的	uj	N	N	O	O
只有	c	N	N	O	O
当	t	N	N	O	O
m	eng	N	N	O	O
+	x	N	N	O	O
d	eng	N	N	O	O
为	p	N	N	O	O
偶数	n	N	N	O	O
时	n	N	N	O	O
先行者	n	N	N	O	O
必胜	v	N	N	O	O
。	x	N	N	O	O

这里	r	N	N	O	O
还要	c	N	N	O	O
说明	v	N	N	O	O
的	uj	N	N	O	O
是	v	N	N	O	O
在	p	N	N	O	O
中间	f	N	N	O	O
的	uj	N	N	O	O
过程	n	N	N	O	O
中	f	N	N	O	O
会	v	N	N	O	O
不会	v	N	N	O	O
遇到	v	N	N	O	O
这	r	N	N	O	O
几个	m	N	N	O	O
特殊	a	N	N	O	O
情况	n	N	N	O	O
，	x	N	N	O	O
答案	n	N	N	O	O

是	v	N	N	O	O
否定	v	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
认真	ad	N	N	O	O
想	v	N	N	O	O
一下	m	N	N	O	O
就	d	N	N	O	O
很快	d	N	N	O	O
能	v	N	N	O	O
明白	nr	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

这个	r	N	N	O	O
MS	eng	N	N	O	O
是	v	N	N	O	O
01	m	N	N	O	O
年	m	N	N	O	O
韩国	ns	N	N	O	O
亚洲	ns	N	N	O	O
赛	v	N	N	O	O
的	uj	N	N	O	O
题目	n	Y	N	O	O
，	x	N	N	O	O
看来	v	N	N	O	O
数学	n	Y	N	O	O
还是	c	N	N	O	O
王道	nr	N	N	O	O
的	uj	N	N	O	O
啊	y	N	N	O	O
！	x	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
year	eng	N	N	O	O
,	x	N	N	O	O
month	eng	N	N	O	O
,	x	N	N	O	O
day	eng	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
year	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
month	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
day	eng	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

month	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
9	x	N	N	O	O

&&	x	N	N	O	O

day	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
30	m	N	N	O	O

)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
YES	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

month	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
11	m	N	N	O	O

&&	x	N	N	O	O

day	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
30	m	N	N	O	O

)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
YES	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

(	x	N	N	O	O
month	eng	N	N	O	O
+	x	N	N	O	O
day	eng	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O

)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
YES	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
NO	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj1135	eng	N	Y	B-OJ	B-OJ

Domino	eng	N	N	O	O

Effect	eng	N	N	O	O
(	x	N	N	O	O
最	d	N	N	B-KNOWLEDGE	O
短	a	N	N	I-KNOWLEDGE	O
路径	n	Y	N	I-KNOWLEDGE	O
)	x	N	N	O	O
_	x	N	N	O	O
chenhuang	eng	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

题目	n	Y	N	O	O
：	x	N	N	O	O
http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
pku	eng	N	Y	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
JudgeOnline	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
1135	m	N	N	O	O

思路	n	N	N	O	O
：	x	N	N	O	O
达到	v	N	N	O	O
每个	r	N	N	O	O
关键	n	N	N	O	O
多米诺	nrt	N	N	O	O
的	uj	N	N	O	O
时间	n	N	N	O	O
就是	d	N	N	O	O
与	p	N	N	O	O
第一个	m	N	N	O	O
关键	n	N	N	O	O
多米诺骨牌	nz	N	N	O	O
的	uj	N	N	O	O
最	a	N	N	O	O
短距离	n	N	N	O	O

与	p	N	N	O	O
第一个	m	N	N	O	O
关键	n	N	N	O	O
多米诺骨牌	nz	N	N	O	O
距离	n	Y	N	O	O
最远	a	Y	N	O	O
的	uj	N	N	O	O
关键	n	N	N	O	O
多米诺骨牌	nz	N	N	O	O
必定	d	N	N	O	O
最	d	N	N	O	O
晚	tg	N	N	O	O
倒下	v	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O

穷举	n	N	N	O	O
每个	r	N	N	O	O
关键	n	N	N	O	O
多米诺骨牌	nz	N	N	O	O
和	c	N	N	O	O
它	r	N	N	O	O
的	uj	N	N	O	O
相邻	v	N	N	O	O
多米诺骨牌	nz	N	N	O	O
，	x	N	N	O	O
查找	v	Y	N	O	O
最	d	N	N	O	O
晚	tg	N	N	O	O
倒下	v	N	N	O	O
的	uj	N	N	O	O
多米诺骨牌	nz	N	N	O	O

源代码	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
vector	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

INF	eng	N	N	O	O

=	x	N	N	O	O

100000000	m	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

MAXN	eng	N	N	O	O

=	x	N	N	O	O

501	m	N	N	O	O
;	x	N	N	O	O

typedef	eng	N	N	O	O

struct	eng	N	N	O	O

node	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

to	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

time	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
Edge	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
多米诺骨牌	nz	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
骨牌	n	N	N	O	O
的	uj	N	N	O	O
排数	n	N	N	O	O
，	x	N	N	O	O
即	v	N	N	O	O
边数	n	N	N	O	O

vector	eng	N	N	O	O
<	x	N	N	O	O
Edge	eng	N	N	O	O
>	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
MAXN	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
存放	v	N	N	O	O
图	n	N	N	O	O
的	uj	N	N	O	O
邻接	v	Y	N	O	O
表	v	N	N	O	O

priority	eng	N	N	O	O
_	x	N	N	O	O
queue	eng	N	N	O	O
<	x	N	N	O	O
Edge	eng	N	N	O	O
>	x	N	N	O	O

pq	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
MAXN	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
存放	v	N	N	O	O
每个	r	N	N	O	O
关键	n	N	N	O	O
多米诺骨牌	nz	N	N	O	O
到	v	N	N	O	O
1	m	N	N	O	O
号	m	N	N	O	O
多米诺骨牌	nz	N	N	O	O
的	uj	N	N	O	O
最短	a	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
路径	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE

/	x	N	N	O	O
/	x	N	N	O	O
比较	d	N	N	O	O
器	n	N	N	O	O

bool	eng	N	N	O	O

operator	eng	N	N	O	O

<	x	N	N	O	O

(	x	N	N	O	O
const	eng	N	N	O	O

Edge	eng	N	N	O	O
&	x	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
const	eng	N	N	O	O

Edge	eng	N	N	O	O
&	x	N	N	O	O

b	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

a	eng	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

>	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

Init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

++	x	N	N	O	O
)	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
clear	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

Dijkstra	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

bool	eng	N	N	O	O

flag	eng	N	N	O	O
[	x	N	N	O	O
MAXN	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
ct	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

Edge	eng	N	N	O	O

e	x	N	N	O	O
,	x	N	N	O	O
e1	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

flag	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

INF	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
pq	eng	N	N	O	O
.	m	N	N	O	O
empty	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

pq	eng	N	N	O	O
.	m	N	N	O	O
pop	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

e	eng	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

pq	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
e	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
ct	eng	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O

&&	x	N	N	O	O

!	x	N	N	O	O
pq	eng	N	N	O	O
.	m	N	N	O	O
empty	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

do	eng	N	N	O	O
{	x	N	N	O	O

e	x	N	N	O	O

=	x	N	N	O	O

pq	eng	N	N	O	O
.	m	N	N	O	O
top	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

pq	eng	N	N	O	O
.	m	N	N	O	O
pop	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
while	eng	N	N	O	O

(	x	N	N	O	O
flag	eng	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

!	x	N	N	O	O
pq	eng	N	N	O	O
.	m	N	N	O	O
empty	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
flag	eng	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

flag	eng	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

ct	eng	N	N	O	O

++	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
flag	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

<	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O
;	x	N	N	O	O

e1	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O

=	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
;	x	N	N	O	O

e1	eng	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

=	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

pq	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
e1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

GetAns	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
p1	eng	N	N	O	O
,	x	N	N	O	O
p2	eng	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

p1	eng	N	N	O	O

=	x	N	N	O	O

p2	eng	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
j	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O

>	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

>	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
double	eng	N	N	O	O
)	x	N	N	O	O
(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

+	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O

>	x	N	N	O	O

ans	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

p1	eng	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

p2	eng	N	N	O	O

=	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
double	eng	N	N	O	O
)	x	N	N	O	O
(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

+	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O

>	x	N	N	O	O

ans	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

p1	eng	N	N	O	O

=	x	N	N	O	O

p2	eng	N	N	O	O

=	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

>	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

>	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

(	x	N	N	O	O
double	eng	N	N	O	O
)	x	N	N	O	O
(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

+	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O

2	x	N	N	O	O

>	x	N	N	O	O

ans	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

p1	eng	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

p2	eng	N	N	O	O

=	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
double	eng	N	N	O	O
)	x	N	N	O	O
(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

+	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
dist	eng	N	N	O	O
[	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

>	x	N	N	O	O

ans	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

p1	eng	N	N	O	O

=	x	N	N	O	O

p2	eng	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
p1	eng	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

p2	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
p1	eng	N	N	O	O

>	x	N	N	O	O

p2	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

p1	eng	N	N	O	O

^	x	N	N	O	O
=	x	N	N	O	O

p2	eng	N	N	O	O
;	x	N	N	O	O

p2	eng	N	N	O	O

^	x	N	N	O	O
=	x	N	N	O	O

p1	eng	N	N	O	O
;	x	N	N	O	O

p1	eng	N	N	O	O

^	x	N	N	O	O
=	x	N	N	O	O

p2	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
The	eng	N	N	O	O

last	eng	N	N	O	O

domino	eng	N	N	O	O

falls	eng	N	N	O	O

after	eng	N	N	O	O

%	x	N	N	O	O
.1	m	N	N	O	O
f	eng	N	N	O	O

seconds	eng	N	N	O	O
,	x	N	N	O	O

between	eng	N	N	O	O

key	eng	N	N	O	O

dominoes	eng	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O

and	eng	N	N	O	O

%	x	N	N	O	O
d	eng	N	N	O	O
.	m	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
,	x	N	N	O	O
p1	eng	N	N	O	O
,	x	N	N	O	O
p2	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
The	eng	N	N	O	O

last	eng	N	N	O	O

domino	eng	N	N	O	O

falls	eng	N	N	O	O

after	eng	N	N	O	O

%	x	N	N	O	O
.1	m	N	N	O	O
f	eng	N	N	O	O

seconds	eng	N	N	O	O
,	x	N	N	O	O

at	eng	N	N	O	O

key	eng	N	N	O	O

domino	eng	N	N	O	O

%	x	N	N	O	O
d	eng	N	N	O	O
.	m	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
,	x	N	N	O	O
p1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
void	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

ct	eng	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
z	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

Edge	eng	N	N	O	O

e	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

n	x	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O

|	x	N	N	O	O
|	x	N	N	O	O

m	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

Init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
建图	n	Y	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

x	x	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

y	x	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

z	x	N	N	O	O
;	x	N	N	O	O

e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O

=	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

e	eng	N	N	O	O
.	m	N	N	O	O
time	eng	N	N	O	O

=	x	N	N	O	O

z	x	N	N	O	O
;	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
e	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

e	eng	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O

=	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
e	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

Dijkstra	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

"	x	N	N	O	O
System	eng	N	N	O	O

#	x	N	N	O	O
"	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
ct	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

endl	eng	N	N	O	O
;	x	N	N	O	O

GetAns	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

Poj1164	eng	N	Y	B-OJ	B-OJ
_	x	N	N	O	O
Abalone	eng	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

我	r	N	N	O	O
的	uj	N	N	O	O
思路	n	N	N	O	O
是	v	N	N	O	O
广度	ns	Y	N	B-KNOWLEDGE	O
优先	vn	Y	N	I-KNOWLEDGE	O
搜索算法	n	N	N	I-KNOWLEDGE	O

BFS	eng	N	N	B-KNOWLEDGE	O

WA	eng	N	N	O	O
了	ul	N	N	O	O
好	a	N	N	O	O
几次	m	N	N	O	O
，	x	N	N	O	O
原来	d	N	N	O	O
没有	v	N	N	O	O
考虑	v	N	N	O	O
到	v	N	N	O	O
重复	d	Y	N	O	O
进队	n	N	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O
，	x	N	N	O	O
哎	e	N	N	O	O
，	x	N	N	O	O
好久	m	N	N	O	O
不	d	N	N	O	O
写	v	N	N	O	O
程序	n	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
悲剧	n	N	N	O	O
啊	zg	N	N	O	O

就是	d	N	N	O	O
这种	r	N	N	O	O
情况	n	N	N	O	O
啊	zg	N	N	O	O

3	x	N	N	O	O

3	x	N	N	O	O

3	x	N	N	O	O

2	x	N	N	O	O

6	x	N	N	O	O

1	x	N	N	O	O

0	x	N	N	O	O

4	x	N	N	O	O

9	x	N	N	O	O

8	x	N	N	O	O

12	m	N	N	O	O

那个	r	N	N	O	O
0	m	N	N	O	O
会	v	N	N	O	O
重复	d	Y	N	O	O
进队	n	N	N	O	O
啊	y	N	N	O	O
，	x	N	N	O	O
呵呵	v	N	N	O	O

没什么	l	N	N	O	O
好	a	N	N	O	O
说	v	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
一道	m	N	N	O	O
水	n	N	N	O	O
题目	n	Y	N	O	O
，	x	N	N	O	O
上	f	N	N	O	O
代码	n	N	N	O	O
了	ul	N	N	O	O

*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

dir	eng	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

{	x	N	N	O	O

8	x	N	N	O	O
,	x	N	N	O	O

4	x	N	N	O	O
,	x	N	N	O	O

2	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

move	eng	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

{	x	N	N	O	O

{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

Node	eng	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

wallSum	eng	N	N	O	O
;	x	N	N	O	O

Node	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

y	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

wallSum	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

this	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
x	x	N	N	O	O

=	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

this	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
y	x	N	N	O	O

=	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

this	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
wallSum	eng	N	N	O	O

=	x	N	N	O	O

wallSum	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

class	eng	N	N	O	O

Castle	eng	N	N	O	O
{	x	N	N	O	O

public	eng	N	N	O	O
:	x	N	N	O	O

Castle	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
}	x	N	N	O	O

void	eng	N	N	O	O

calculate	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

private	eng	N	N	O	O
:	x	N	N	O	O

void	eng	N	N	O	O

BFS	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

initial	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

R	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

C	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

maxRoom	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

roomNum	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
50	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
50	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

Castle	eng	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
calculate	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

this	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
initial	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

this	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
BFS	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
roomNum	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
maxRoom	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

Castle	eng	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
BFS	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
R	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
<	x	N	N	O	O
C	x	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

<	x	N	N	O	O

16	m	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

roomNum	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

capacity	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

queue	eng	N	N	O	O
<	x	N	N	O	O
Node	eng	N	N	O	O
*	x	N	N	O	O
>	x	N	N	O	O

roomQueue	eng	N	N	O	O
;	x	N	N	O	O

Node	eng	N	N	O	O
*	x	N	N	O	O

np	eng	N	N	O	O

=	x	N	N	O	O

new	eng	N	N	O	O

Node	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
,	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

16	m	N	N	O	O
;	x	N	N	O	O

roomQueue	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
np	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
roomQueue	eng	N	N	O	O
.	m	N	N	O	O
empty	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

Node	eng	N	N	O	O
*	x	N	N	O	O

npre	eng	N	N	O	O

=	x	N	N	O	O

roomQueue	eng	N	N	O	O
.	m	N	N	O	O
front	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

roomQueue	eng	N	N	O	O
.	m	N	N	O	O
pop	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

capacity	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

sum	eng	N	N	O	O

=	x	N	N	O	O

npre	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
wallSum	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

n	x	N	N	O	O
<	x	N	N	O	O
4	x	N	N	O	O
;	x	N	N	O	O

n	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
sum	eng	N	N	O	O
/	x	N	N	O	O
dir	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O

&&	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
npre	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
move	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
npre	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
move	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
16	m	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O

=	x	N	N	O	O

npre	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
move	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

y	x	N	N	O	O

=	x	N	N	O	O

npre	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
move	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

np	eng	N	N	O	O

=	x	N	N	O	O

new	eng	N	N	O	O

Node	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
,	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

16	m	N	N	O	O
;	x	N	N	O	O

roomQueue	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
np	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

sum	eng	N	N	O	O

%	x	N	N	O	O
=	x	N	N	O	O

dir	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

maxRoom	eng	N	N	O	O

=	x	N	N	O	O

maxRoom	eng	N	N	O	O

>	x	N	N	O	O

capacity	eng	N	N	O	O

?	x	N	N	O	O

maxRoom	eng	N	N	O	O

:	x	N	N	O	O

capacity	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

Castle	eng	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
initial	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

maxRoom	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

roomNum	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
R	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
C	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
R	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
<	x	N	N	O	O
C	x	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

Castle	eng	N	N	O	O

castle	eng	N	N	O	O
;	x	N	N	O	O

castle	eng	N	N	O	O
.	m	N	N	O	O
calculate	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj1426	eng	N	Y	B-OJ	B-OJ

-	x	N	N	O	O

Find	eng	N	N	O	O

The	eng	N	N	O	O

Multiple	eng	N	N	O	O

-	x	N	N	O	O

贰	m	N	N	O	O
圣	j	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

想	v	N	N	O	O
看	v	N	N	O	O
更	d	N	N	O	O
多	m	N	N	O	O
的	uj	N	N	O	O
解题	n	N	N	O	O
报告	n	N	N	O	O
:	x	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
blog	eng	N	N	O	O
.	m	N	N	O	O
csdn	eng	N	N	O	O
.	m	N	N	O	O
net	eng	N	N	O	O
/	x	N	N	O	O
wangjian8006	eng	N	N	O	O
/	x	N	N	O	O
article	eng	N	N	O	O
/	x	N	N	O	O
details	eng	N	N	O	O
/	x	N	N	O	O
7870410	m	N	N	O	O

转载	v	N	N	O	O
请	v	N	N	O	O
注明	v	N	N	O	O
出处	v	N	N	O	O
：	x	N	N	O	O
http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
blog	eng	N	N	O	O
.	m	N	N	O	O
csdn	eng	N	N	O	O
.	m	N	N	O	O
net	eng	N	N	O	O
/	x	N	N	O	O
wangjian8006	eng	N	N	O	O

题目	n	Y	N	O	O
大意	d	N	N	O	O
：	x	N	N	O	O

对于	p	N	N	O	O
一个	m	N	N	O	O
整数	n	Y	N	O	O
，	x	N	N	O	O
问	n	N	N	O	O
大于	d	N	N	O	O
等于	v	N	N	O	O
这个	r	N	N	O	O
整数	n	Y	N	O	O
的	uj	N	N	O	O
一个	m	N	N	O	O
整数	n	Y	N	O	O
能够	v	N	N	O	O
被	p	N	N	O	O
其	r	N	N	O	O
整除	v	N	N	O	O
的	uj	N	N	O	O
整数	n	Y	N	O	O
，	x	N	N	O	O
且	zg	N	N	O	O
这个	r	N	N	O	O
整数	n	Y	N	O	O
只能	v	N	N	O	O
包括	v	N	N	O	O
0	m	N	N	O	O
和	c	N	N	O	O
1	m	N	N	O	O

解题	n	N	N	O	O
思路	n	N	N	O	O
：	x	N	N	O	O

一位	m	N	N	O	O
一位	m	N	N	O	O
的	uj	N	N	O	O
确定	v	N	N	O	O
，	x	N	N	O	O
比如	v	N	N	O	O
求	v	N	N	O	O
被	p	N	N	O	O
6	m	N	N	O	O
整除	v	N	N	O	O
的	uj	N	N	O	O
不为	v	N	N	O	O
零	n	N	N	O	O
整数	n	Y	N	O	O
，	x	N	N	O	O
且	zg	N	N	O	O
整数	n	Y	N	O	O
的	uj	N	N	O	O
每位	r	N	N	O	O
上	f	N	N	O	O
是	v	N	N	O	O
0	m	N	N	O	O
或	c	N	N	O	O
1	m	N	N	O	O

从	p	N	N	O	O
个位	n	N	N	O	O
，	x	N	N	O	O
十位	m	N	N	O	O
，	x	N	N	O	O
百位	m	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

一直	d	N	N	O	O
确定	v	N	N	O	O
上去	t	N	N	O	O
，	x	N	N	O	O
即	v	N	N	O	O
每次	r	N	N	O	O
扩展	v	N	N	O	O
都	d	N	N	O	O
在	p	N	N	O	O
末尾	n	N	N	O	O
加上	v	N	N	O	O
0	x	N	N	O	O
或者	c	N	N	O	O
1	x	N	N	O	O

首先	d	N	N	O	O
初始	v	N	N	O	O
为	p	N	N	O	O
1	m	N	N	O	O
，	x	N	N	O	O
因为	c	N	N	O	O
倍数	n	N	N	O	O
的	uj	N	N	O	O
最高	a	N	N	O	O
位	q	N	N	O	O
必为	d	N	N	O	O
1	m	N	N	O	O

当	t	N	N	O	O
倍数	n	N	N	O	O
很大	a	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
我们	r	N	N	O	O
可以	c	N	N	O	O
利用	n	N	N	O	O
同	p	N	N	O	O
余模	n	N	N	O	O
定理	vn	Y	N	O	O
对	p	N	N	O	O
得到	v	N	N	O	O
的	uj	N	N	O	O
余数	m	N	N	O	O
进行	v	N	N	O	O
优化	vn	Y	N	O	O
，	x	N	N	O	O
字符串	n	Y	N	O	O
可以	c	N	N	O	O
保存起来	l	N	N	O	O
，	x	N	N	O	O
而	c	N	N	O	O
倍数	n	N	N	O	O
可以	c	N	N	O	O
对	p	N	N	O	O
n	eng	N	N	O	O
取模	n	Y	N	O	O
。	x	N	N	O	O

（	x	N	N	O	O
a	x	N	N	O	O
*	x	N	N	O	O
b	x	N	N	O	O
）	x	N	N	O	O
%	x	N	N	O	O
n	x	N	N	O	O

=	x	N	N	O	O

（	x	N	N	O	O
a	x	N	N	O	O
%	x	N	N	O	O
n	x	N	N	O	O

*	x	N	N	O	O
b	x	N	N	O	O
%	x	N	N	O	O
n	x	N	N	O	O
）	x	N	N	O	O
%	x	N	N	O	O
n	x	N	N	O	O

（	x	N	N	O	O
a	eng	N	N	O	O
+	x	N	N	O	O
b	eng	N	N	O	O
）	x	N	N	O	O
%	x	N	N	O	O
n	x	N	N	O	O

=	x	N	N	O	O

（	x	N	N	O	O
a	x	N	N	O	O
%	x	N	N	O	O
n	x	N	N	O	O

+	x	N	N	O	O
b	eng	N	N	O	O
%	x	N	N	O	O
n	x	N	N	O	O
）	x	N	N	O	O
%	x	N	N	O	O
n	x	N	N	O	O

值得注意	l	N	N	O	O
的	uj	N	N	O	O
是	v	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
n	eng	N	N	O	O
是	v	N	N	O	O
偶数	n	N	N	O	O
,	x	N	N	O	O
则	d	N	N	O	O
不用	v	N	N	O	O
进行	v	N	N	O	O
计算	v	Y	N	O	O
，	x	N	N	O	O
直接	ad	N	N	O	O
=	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
"	x	N	N	O	O
0	x	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

详解	v	N	N	O	O
：	x	N	N	O	O
http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
archive	eng	N	N	O	O
.	m	N	N	O	O
cnblogs	eng	N	N	O	O
.	m	N	N	O	O
com	eng	N	N	O	O
/	x	N	N	O	O
a	x	N	N	O	O
/	x	N	N	O	O
2122513	m	N	N	O	O
/	x	N	N	O	O

代码	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

typedef	eng	N	N	O	O

struct	eng	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

mod	eng	N	N	O	O
;	x	N	N	O	O

string	eng	N	N	O	O

ans	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
Node	eng	N	N	O	O
;	x	N	N	O	O

Node	eng	N	N	O	O

node	eng	N	N	O	O
[	x	N	N	O	O
210	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
temp	eng	N	N	O	O
,	x	N	N	O	O
now	eng	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
210	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

bfs	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

queue	eng	N	N	O	O

<	x	N	N	O	O
Node	eng	N	N	O	O
>	x	N	N	O	O
q	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
dis	eng	N	N	O	O
,	x	N	N	O	O
false	eng	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
dis	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
"	x	N	N	O	O
1	x	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
mod	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
q	eng	N	N	O	O
.	m	N	N	O	O
empty	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

now	eng	N	N	O	O
=	x	N	N	O	O
temp	eng	N	N	O	O
=	x	N	N	O	O
q	eng	N	N	O	O
.	m	N	N	O	O
front	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
pop	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
.	m	N	N	O	O
mod	eng	N	N	O	O
*	x	N	N	O	O
10	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
.	m	N	N	O	O
mod	eng	N	N	O	O
*	x	N	N	O	O
10	m	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
temp	eng	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
+	x	N	N	O	O
"	x	N	N	O	O
1	x	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
temp	eng	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
+	x	N	N	O	O
"	x	N	N	O	O
0	x	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
temp	eng	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
+	x	N	N	O	O
"	x	N	N	O	O
1	x	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
mod	eng	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

now	eng	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
now	eng	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
+	x	N	N	O	O
"	x	N	N	O	O
0	x	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

now	eng	N	N	O	O
.	m	N	N	O	O
mod	eng	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
now	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

node	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
"	x	N	N	O	O
1	x	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
200	m	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
+	x	N	N	O	O
"	x	N	N	O	O
0	x	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

bfs	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
ans	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

[	x	N	N	O	O
后缀	n	Y	N	B-KNOWLEDGE	O
数组	n	Y	N	I-KNOWLEDGE	O
、	x	N	N	O	O
出现	v	N	N	O	O
k	eng	N	N	O	O
次	m	N	N	O	O
的	uj	N	N	O	O
重复	d	Y	N	O	O
子串	n	Y	N	O	O
]	x	N	N	O	O
Pku3261	eng	N	Y	B-OJ	B-OJ

-	x	N	N	O	O
-	x	N	N	O	O

Milk	eng	N	N	O	O

Patterns	eng	N	N	O	O
_	x	N	N	O	O
Fstephen	eng	N	N	O	O
的	uj	N	N	O	O
茶几	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
pku	eng	N	Y	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
JudgeOnline	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
3261	m	N	N	O	O

题目	n	Y	N	O	O
大意	d	N	N	O	O
：	x	N	N	O	O
给出	v	N	N	O	O
n	eng	N	N	O	O
个	m	N	N	O	O
数字	n	Y	N	O	O
组成	v	N	N	O	O
的	uj	N	N	O	O
一个	m	N	N	O	O
字符串	n	Y	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
最长	a	Y	N	O	O
的	uj	N	N	O	O
恰好	d	N	N	O	O
出现	v	N	N	O	O
k	eng	N	N	O	O
次	m	N	N	O	O
的	uj	N	N	O	O
重复	d	Y	N	O	O
子串	n	Y	N	O	O
（	x	N	N	O	O
可	v	N	N	O	O
重叠	v	N	N	O	O
）	x	N	N	O	O
的	uj	N	N	O	O
字符串	n	Y	N	O	O
的	uj	N	N	O	O
长度	ns	Y	N	O	O
。	x	N	N	O	O

分析	vn	N	N	O	O
：	x	N	N	O	O
后缀	n	Y	N	B-KNOWLEDGE	O
数组	n	Y	N	I-KNOWLEDGE	O
一个	m	N	N	O	O
经典	n	N	N	O	O
的	uj	N	N	O	O
应用	v	N	N	O	O
。	x	N	N	O	O

先	d	N	N	O	O
二分	m	Y	N	B-KNOWLEDGE	O
答案	n	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
分组	vn	Y	N	O	O
。	x	N	N	O	O

只要	c	N	N	O	O
某	r	N	N	O	O
一组	m	N	N	O	O
包含	v	N	N	O	O
的	uj	N	N	O	O
后缀	n	Y	N	O	O
数量	n	N	N	O	O
大于	d	N	N	O	O
等于	v	N	N	O	O
k	x	N	N	O	O
，	x	N	N	O	O
表示	v	Y	N	O	O
有	v	N	N	O	O
解	v	N	N	O	O
。	x	N	N	O	O

这个	r	N	N	O	O
不难理解	l	N	N	O	O
。	x	N	N	O	O

等	u	N	N	O	O
完成	v	N	N	O	O
了	ul	N	N	O	O
论文	nz	N	N	O	O
里面	f	N	N	O	O
的	uj	N	N	O	O
练习	v	N	N	O	O
之后	f	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
再	d	N	N	O	O
写	v	N	N	O	O
个	q	N	N	O	O
总结	n	N	N	O	O
笔记	n	N	N	O	O
吧	y	N	N	O	O
。	x	N	N	O	O

深刻	d	N	N	O	O
体会	n	N	N	O	O
到	v	N	N	O	O
后缀	n	Y	N	B-KNOWLEDGE	O
数组	n	Y	N	I-KNOWLEDGE	O
的	uj	N	N	O	O
强大	a	N	N	O	O
....	m	N	N	O	O

note	eng	N	N	O	O
：	x	N	N	O	O
1	x	N	N	O	O
、	x	N	N	O	O
分组	vn	Y	N	O	O
时	n	N	N	O	O
，	x	N	N	O	O
每次	r	N	N	O	O
height	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
k	eng	N	N	O	O
时	n	N	N	O	O
，	x	N	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
个	m	N	N	O	O
后缀	n	Y	N	O	O
是	v	N	N	O	O
归到	v	N	N	O	O
下	f	N	N	O	O
一个组	m	N	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

2	x	N	N	O	O
、	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
返回	v	N	N	O	O
的	uj	N	N	O	O
值	n	N	N	O	O
是	v	N	N	O	O
成功	a	N	N	O	O
读取	v	N	N	O	O
了	ul	N	N	O	O
多少	m	N	N	O	O
个	q	N	N	O	O
数据	n	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
文件	n	N	N	O	O
结束	v	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
返回	v	N	N	O	O
EOF	eng	N	N	O	O
。	x	N	N	O	O

一	m	N	N	O	O
开始	v	N	N	O	O
不	d	N	N	O	O
知道	v	N	N	O	O
这个	r	N	N	O	O
，	x	N	N	O	O
结果	n	N	N	O	O
OLE	eng	N	N	O	O
=	x	N	N	O	O

=	x	N	N	O	O

codes	eng	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

maxn	eng	N	N	O	O
=	x	N	N	O	O
20010	m	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
wa	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
wb	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
wv	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
rank	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
height	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cmp	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

b	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

return	eng	N	N	O	O

r	x	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
b	x	N	N	O	O
]	x	N	N	O	O
&&	x	N	N	O	O
r	eng	N	N	O	O
[	x	N	N	O	O
a	eng	N	N	O	O
+	x	N	N	O	O
l	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
b	eng	N	N	O	O
+	x	N	N	O	O
l	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

da	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
sa	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

m	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
wa	eng	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
y	x	N	N	O	O
=	x	N	N	O	O
wb	eng	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

sa	eng	N	N	O	O
[	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
p	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
*	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
p	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
p	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
wv	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

sa	eng	N	N	O	O
[	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
wv	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
t	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
=	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
[	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

x	x	N	N	O	O
[	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
cmp	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
?	x	N	N	O	O
p	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
:	x	N	N	O	O
p	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

cal	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
sa	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

rank	eng	N	N	O	O
[	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
height	eng	N	N	O	O
[	x	N	N	O	O
rank	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
?	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
:	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
rank	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

check	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
cnt	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
height	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O

cnt	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
++	x	N	N	O	O
cnt	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
cnt	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

bin	eng	N	N	O	O
_	x	N	N	O	O
search	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
r	eng	N	N	O	O
+	x	N	N	O	O
l	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
l	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O
mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
r	eng	N	N	O	O
+	x	N	N	O	O
l	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
check	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

l	x	N	N	O	O
=	x	N	N	O	O
mid	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

r	x	N	N	O	O
=	x	N	N	O	O
mid	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

mid	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
k	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
>	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
?	x	N	N	O	O
m	x	N	N	O	O
:	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

m	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

da	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
sa	eng	N	N	O	O
,	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cal	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
sa	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
bin	eng	N	N	O	O
_	x	N	N	O	O
search	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

2914	m	N	N	I-OJ	O

Minimum	eng	N	N	O	O

Cut	eng	N	N	O	O

-	x	N	N	O	O

scorpiocj	eng	N	N	O	O
的	uj	N	N	O	O
专栏	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

无向	v	Y	N	B-KNOWLEDGE	O
图	n	N	N	I-KNOWLEDGE	O
，	x	N	N	O	O
每	r	N	N	O	O
对	p	N	N	O	O
顶点	n	Y	N	O	O
间	f	N	N	O	O
可能	v	N	N	O	O
有	v	N	N	O	O
多条	m	Y	N	O	O
边	d	N	N	O	O
，	x	N	N	O	O
问	n	N	N	O	O
最少	d	N	N	O	O
删除	v	N	N	O	O
多少	m	N	N	O	O
条边	n	N	N	O	O
才能	v	N	N	O	O
将图	n	N	N	O	O
分为	v	N	N	O	O
两个	m	N	N	O	O
子图	nr	N	N	O	O

把	p	N	N	O	O
两点	m	N	N	O	O
间	f	N	N	O	O
的	uj	N	N	O	O
边数	n	N	N	O	O
看成	v	N	N	O	O
权重	n	N	N	O	O
，	x	N	N	O	O
就	d	N	N	O	O
变成	v	N	N	O	O
了求	v	N	N	O	O
带权	v	Y	N	B-KNOWLEDGE	O
无向	v	Y	N	I-KNOWLEDGE	O
图	n	N	N	I-KNOWLEDGE	O
的	uj	N	N	O	O
最小	a	Y	N	B-KNOWLEDGE	O
割	v	N	N	I-KNOWLEDGE	O
了	ul	N	N	O	O
，	x	N	N	O	O
采用	v	N	N	O	O
Stoer	eng	N	N	B-KNOWLEDGE	O
-	x	N	N	I-KNOWLEDGE	O
Wagner	eng	N	N	I-KNOWLEDGE	O
算法	n	Y	N	O	O

代码	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

inf	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
30	m	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

MAX	eng	N	N	O	O
=	x	N	N	O	O
510	m	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

MinCut	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
vis	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
表示	v	Y	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
点	m	N	N	O	O
到	v	N	N	O	O
A	eng	N	N	O	O
的	uj	N	N	O	O
距离	n	Y	N	O	O
，	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
表示	v	Y	N	O	O
i	eng	N	N	O	O
号	m	N	N	O	O
节点	n	N	N	O	O
属于	v	N	N	O	O
哪个	r	N	N	O	O
点	m	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
prev	eng	N	N	O	O
,	x	N	N	O	O
maxj	eng	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
inf	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

maxj	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
初始化	l	N	N	O	O
A	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
与	p	N	N	O	O
各	r	N	N	O	O
点	q	N	N	O	O
的	uj	N	N	O	O
距离	n	Y	N	O	O
,	x	N	N	O	O
即	c	N	N	O	O
W	eng	N	N	O	O
(	x	N	N	O	O
A	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
maxj	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
选出	v	N	N	O	O
第二个	m	N	N	O	O
加入	v	N	N	O	O
A	eng	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O

maxj	eng	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

prev	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
第一个	m	N	N	O	O
加入	v	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
是	v	N	N	O	O
0	m	N	N	O	O
号	m	N	N	O	O
点	m	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
vis	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
vis	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

vis	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
A	x	N	N	O	O
=	x	N	N	O	O
V	x	N	N	O	O

{	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
,	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
maxj	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
将	d	N	N	O	O
prev	eng	N	N	O	O
和	c	N	N	O	O
maxj	eng	N	N	O	O
两个	m	N	N	O	O
点	m	N	N	O	O
缩为	v	N	N	O	O
一个点	m	N	N	O	O

,	x	N	N	O	O
prev	eng	N	N	O	O

{	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
maxj	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

node	eng	N	N	O	O
[	x	N	N	O	O
maxj	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
删除	v	N	N	O	O
顶点	n	Y	N	O	O
maxj	eng	N	N	O	O

}	x	N	N	O	O

vis	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
maxj	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

prev	eng	N	N	O	O
=	x	N	N	O	O
maxj	eng	N	N	O	O
;	x	N	N	O	O

maxj	eng	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
找	v	N	N	O	O
点	q	N	N	O	O
加入	v	N	N	O	O
A	x	N	N	O	O
，	x	N	N	O	O
同时	c	N	N	O	O
更新	d	N	N	O	O
W	x	N	N	O	O
(	x	N	N	O	O
A	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
)	x	N	N	O	O

,	x	N	N	O	O
因为	c	N	N	O	O
A	eng	N	N	O	O
新	a	N	N	O	O
加入	v	N	N	O	O
了	ul	N	N	O	O
节点	n	N	N	O	O
prev	eng	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
vis	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
maxj	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
maxj	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

maxj	eng	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

ans	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
w	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
g	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
g	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
b	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
w	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
b	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
w	x	N	N	O	O
;	x	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
b	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
w	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
MinCut	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ1859	eng	N	Y	B-OJ	B-OJ
_	x	N	N	O	O
oi111	eng	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

The	eng	N	N	O	O

Perfect	eng	N	N	O	O

Symmetry	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

30000	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

1164	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

438	m	N	N	O	O

Description	eng	N	N	O	O

The	eng	N	N	O	O

representatives	eng	N	N	O	O

of	eng	N	N	O	O

NATO	eng	N	N	O	O

countries	eng	N	N	O	O

must	eng	N	N	O	O

be	eng	Y	N	O	O

guarded	eng	N	N	O	O

by	eng	N	N	O	O

many	eng	N	N	O	O

bodyguards	eng	N	N	O	O

during	eng	N	N	O	O

the	eng	N	N	O	O

Summit	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

V	eng	N	N	O	O
.	m	N	N	O	O
I	eng	N	N	O	O
.	m	N	N	O	O
P	eng	N	N	O	O
.	m	N	N	O	O

is	eng	N	N	O	O

accompanied	eng	N	N	O	O

by	eng	N	N	O	O

his	eng	N	N	O	O

own	eng	N	N	O	O

bodyguards	eng	N	N	O	O

but	eng	N	N	O	O

is	eng	N	N	O	O

also	eng	N	N	O	O

assigned	eng	N	N	O	O

many	eng	N	N	O	O

other	eng	N	N	O	O

specialists	eng	N	N	O	O
,	x	N	N	O	O

snipers	eng	N	N	O	O
,	x	N	N	O	O

etc	eng	N	N	O	O
.	m	N	N	O	O

To	eng	N	N	O	O

make	eng	N	N	O	O

their	eng	N	N	O	O

work	eng	N	N	O	O

efficient	eng	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

guarded	eng	N	N	O	O

person	eng	N	N	O	O

secure	eng	N	N	O	O

as	eng	Y	N	O	O

much	eng	N	N	O	O

as	eng	Y	N	O	O

possible	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

bodyguards	eng	N	N	O	O

must	eng	N	N	O	O

be	eng	Y	N	O	O

distributed	eng	N	N	O	O

to	eng	N	N	O	O

various	eng	N	N	O	O

directions	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

person	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

optimal	eng	N	N	O	O

placement	eng	N	N	O	O

of	eng	N	N	O	O

bodyguards	eng	N	N	O	O

is	eng	N	N	O	O

such	eng	N	N	O	O

that	eng	N	N	O	O

the	eng	N	N	O	O

V	eng	N	N	O	O
.	m	N	N	O	O
I	eng	N	N	O	O
.	m	N	N	O	O
P	eng	N	N	O	O
.	m	N	N	O	O

stands	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

center	eng	N	N	O	O

of	eng	N	N	O	O

symmetry	eng	N	N	O	O

of	eng	N	N	O	O

all	eng	N	N	O	O

guards	eng	N	N	O	O
.	m	N	N	O	O

Unfortunately	eng	N	N	O	O
,	x	N	N	O	O

when	eng	N	N	O	O

the	eng	N	N	O	O

V	eng	N	N	O	O
.	m	N	N	O	O
I	eng	N	N	O	O
.	m	N	N	O	O
P	eng	N	N	O	O
.	m	N	N	O	O

moves	eng	N	N	O	O
,	x	N	N	O	O

it	eng	N	N	O	O

is	eng	N	N	O	O

very	eng	N	N	O	O

hard	eng	N	N	O	O

to	eng	N	N	O	O

reconfigure	eng	N	N	O	O

the	eng	N	N	O	O

bodyguards	eng	N	N	O	O
'	x	N	N	O	O

positions	eng	N	N	O	O

to	eng	N	N	O	O

reflect	eng	N	N	O	O

the	eng	N	N	O	O

new	eng	N	N	O	O

situation	eng	N	N	O	O
.	m	N	N	O	O

Most	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

Czech	eng	N	N	O	O

specialists	eng	N	N	O	O

are	eng	N	N	O	O

not	eng	N	N	O	O

able	eng	N	N	O	O

to	eng	N	N	O	O

do	eng	N	N	O	O

such	eng	N	N	O	O

reconfigurations	eng	N	N	O	O

in	eng	Y	N	O	O

real	eng	N	N	O	O
-	x	N	N	O	O
time	eng	N	N	O	O
.	m	N	N	O	O

Therefore	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

Home	eng	N	N	O	O

Affairs	eng	N	N	O	O

Minister	eng	N	N	O	O

Sobeslav	eng	N	N	O	O

Gros	eng	N	N	O	O

has	eng	Y	N	O	O

decided	eng	N	N	O	O

to	eng	N	N	O	O

reverse	eng	N	N	O	O

this	eng	N	N	O	O

procedure	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

bodyguards	eng	N	N	O	O

take	eng	N	N	O	O

their	eng	N	N	O	O

places	eng	N	N	O	O

first	eng	N	N	O	O
.	m	N	N	O	O

Then	eng	N	N	O	O
,	x	N	N	O	O

it	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

responsibility	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

V	eng	N	N	O	O
.	m	N	N	O	O
I	eng	N	N	O	O
.	m	N	N	O	O
P	eng	N	N	O	O
.	m	N	N	O	O

to	eng	N	N	O	O

find	eng	N	N	O	O

the	eng	N	N	O	O

proper	eng	N	N	O	O

position	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

center	eng	N	N	O	O

of	eng	N	N	O	O

symmetry	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

the	eng	N	N	O	O

person	eng	N	N	O	O

appears	eng	N	N	O	O

anywhere	eng	N	N	O	O

else	eng	N	N	O	O
,	x	N	N	O	O

we	eng	N	N	O	O

take	eng	N	N	O	O

no	eng	N	N	O	O

responsibility	eng	N	N	O	O

for	eng	Y	N	O	O

his	eng	N	N	O	O
/	x	N	N	O	O
her	eng	Y	N	O	O

security	eng	N	N	O	O
.	m	N	N	O	O

Your	eng	N	N	O	O

task	eng	N	N	O	O

is	eng	N	N	O	O

to	eng	N	N	O	O

automate	eng	N	N	O	O

the	eng	N	N	O	O

process	eng	N	N	O	O
.	m	N	N	O	O

Given	eng	N	N	O	O

a	x	N	N	O	O

set	eng	N	N	O	O

of	eng	N	N	O	O

N	x	N	N	O	O

points	eng	N	N	O	O

(	x	N	N	O	O
bodyguard	eng	N	N	O	O

positions	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

are	eng	N	N	O	O

to	eng	N	N	O	O

find	eng	N	N	O	O

its	eng	N	N	O	O

center	eng	N	N	O	O

of	eng	N	N	O	O

symmetry	eng	N	N	O	O

S	x	N	N	O	O
,	x	N	N	O	O

where	eng	N	N	O	O

the	eng	N	N	O	O

V	eng	N	N	O	O
.	m	N	N	O	O
I	eng	N	N	O	O
.	m	N	N	O	O
P	eng	N	N	O	O
.	m	N	N	O	O

is	eng	N	N	O	O

relatively	eng	N	N	O	O

safe	eng	N	N	O	O
.	m	N	N	O	O

More	eng	N	N	O	O

formal	eng	N	N	O	O

description	eng	N	N	O	O

follows	eng	N	N	O	O
.	m	N	N	O	O

Let	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

have	eng	N	N	O	O

a	x	N	N	O	O

point	eng	N	N	O	O

A	x	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

center	eng	N	N	O	O

of	eng	N	N	O	O

symmetry	eng	N	N	O	O

S	eng	N	N	O	O
.	m	N	N	O	O

We	eng	N	N	O	O

say	eng	N	N	O	O

that	eng	N	N	O	O

another	eng	N	N	O	O

point	eng	N	N	O	O

A	x	N	N	O	O
'	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

image	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

point	eng	N	N	O	O

A	x	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

center	eng	N	N	O	O

of	eng	N	N	O	O

symmetry	eng	N	N	O	O

S	x	N	N	O	O

iff	eng	N	N	O	O

S	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

center	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O

joining	eng	N	N	O	O

points	eng	N	N	O	O

A	x	N	N	O	O

and	eng	N	N	O	O

A	x	N	N	O	O
'	x	N	N	O	O
.	x	N	N	O	O

The	eng	N	N	O	O

image	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

set	eng	N	N	O	O

of	eng	N	N	O	O

points	eng	N	N	O	O

(	x	N	N	O	O
X	x	N	N	O	O
)	x	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

center	eng	N	N	O	O

S	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

set	eng	N	N	O	O

of	eng	N	N	O	O

all	eng	N	N	O	O

images	eng	N	N	O	O

of	eng	N	N	O	O

individual	eng	N	N	O	O

points	eng	N	N	O	O

in	eng	Y	N	O	O

that	eng	N	N	O	O

set	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

set	eng	N	N	O	O

X	x	N	N	O	O

is	eng	N	N	O	O

said	eng	N	N	O	O

to	eng	N	N	O	O

possess	eng	N	N	O	O

a	x	N	N	O	O

center	eng	N	N	O	O

of	eng	N	N	O	O

symmetry	eng	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

there	eng	N	N	O	O

exists	eng	N	N	O	O

a	x	N	N	O	O

point	eng	N	N	O	O

S	x	N	N	O	O

such	eng	N	N	O	O

that	eng	N	N	O	O

the	eng	N	N	O	O

image	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

set	eng	N	N	O	O

X	x	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

center	eng	N	N	O	O

S	x	N	N	O	O

is	eng	N	N	O	O

equal	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

set	eng	N	N	O	O

X	x	N	N	O	O

itself	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

The	eng	N	N	O	O

input	eng	N	N	O	O

consists	eng	N	N	O	O

of	eng	N	N	O	O

several	eng	N	N	O	O

assignments	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

assignment	eng	N	N	O	O

begins	eng	N	N	O	O

with	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

containing	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

integer	eng	N	N	O	O

number	eng	N	N	O	O

N	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

N	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

20000.	m	N	N	O	O

It	eng	N	N	O	O

is	eng	N	N	O	O

followed	eng	N	N	O	O

by	eng	N	N	O	O

N	x	N	N	O	O

lines	eng	N	N	O	O
,	x	N	N	O	O

each	eng	N	N	O	O

containing	eng	N	N	O	O

two	eng	N	N	O	O

integer	eng	N	N	O	O

numbers	eng	N	N	O	O

Xi	eng	N	N	O	O

and	eng	N	N	O	O

Yi	eng	N	N	O	O

separated	eng	N	N	O	O

with	eng	N	N	O	O

a	x	N	N	O	O

space	eng	N	N	O	O
,	x	N	N	O	O

-	x	N	N	O	O
10	m	N	N	O	O

5	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

|	x	N	N	O	O
Xi	eng	N	N	O	O
,	x	N	N	O	O
Yi	eng	N	N	O	O
|	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

10	m	N	N	O	O

5.	m	N	N	O	O

These	eng	N	N	O	O

are	eng	N	N	O	O

the	eng	N	N	O	O

Cartesian	eng	N	N	O	O

coordinates	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

i	x	N	N	O	O
-	x	N	N	O	O
th	eng	N	N	O	O

point	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

set	eng	N	N	O	O
.	m	N	N	O	O

Since	eng	N	N	O	O

no	eng	N	N	O	O

two	eng	N	N	O	O

bodyguards	eng	N	N	O	O

occupy	eng	N	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

place	eng	N	N	O	O
,	x	N	N	O	O

no	eng	N	N	O	O

point	eng	N	N	O	O

will	eng	N	N	O	O

appear	eng	N	N	O	O

twice	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

assignment	eng	N	N	O	O
.	m	N	N	O	O

However	eng	N	N	O	O
,	x	N	N	O	O

note	eng	N	N	O	O

that	eng	N	N	O	O

a	x	N	N	O	O

bodyguard	eng	N	N	O	O

can	eng	N	N	O	O

be	eng	Y	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

place	eng	N	N	O	O

as	eng	Y	N	O	O

the	eng	N	N	O	O

V	eng	N	N	O	O
.	m	N	N	O	O
I	eng	N	N	O	O
.	m	N	N	O	O
P	eng	N	N	O	O
.	m	N	N	O	O

After	eng	N	N	O	O

the	eng	N	N	O	O

last	eng	N	N	O	O

assignment	eng	N	N	O	O
,	x	N	N	O	O

there	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

containing	eng	N	N	O	O

zero	eng	N	N	O	O

instead	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

points	eng	N	N	O	O
.	m	N	N	O	O

This	eng	N	N	O	O

line	eng	N	N	O	O

should	eng	N	N	O	O

not	eng	N	N	O	O

be	eng	Y	N	O	O

processed	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

assignment	eng	N	N	O	O
,	x	N	N	O	O

output	eng	N	N	O	O

exactly	eng	N	N	O	O

one	eng	N	N	O	O

line	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

the	eng	N	N	O	O

given	eng	N	N	O	O

set	eng	N	N	O	O

possesses	eng	N	N	O	O

a	x	N	N	O	O

center	eng	N	N	O	O

of	eng	N	N	O	O

symmetry	eng	N	N	O	O
,	x	N	N	O	O

print	eng	N	N	O	O

the	eng	N	N	O	O

text	eng	N	N	O	O

"	x	N	N	O	O
V	eng	N	N	O	O
.	m	N	N	O	O
I	eng	N	N	O	O
.	m	N	N	O	O
P	eng	N	N	O	O
.	m	N	N	O	O

should	eng	N	N	O	O

stay	eng	N	N	O	O

at	eng	N	N	O	O

(	x	N	N	O	O
X	x	N	N	O	O
,	x	N	N	O	O
Y	x	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O
"	x	N	N	O	O

where	eng	N	N	O	O

X	x	N	N	O	O

and	eng	N	N	O	O

Y	x	N	N	O	O

are	eng	N	N	O	O

the	eng	N	N	O	O

Cartesian	eng	N	N	O	O

coordinates	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

center	eng	N	N	O	O

rounded	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

nearest	eng	N	N	O	O

number	eng	N	N	O	O

with	eng	N	N	O	O

exactly	eng	N	N	O	O

one	eng	N	N	O	O

digit	eng	N	N	O	O

after	eng	N	N	O	O

the	eng	N	N	O	O

decimal	eng	N	N	O	O

point	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

there	eng	N	N	O	O

is	eng	N	N	O	O

no	eng	N	N	O	O

center	eng	N	N	O	O

of	eng	N	N	O	O

symmetry	eng	N	N	O	O
,	x	N	N	O	O

output	eng	N	N	O	O

the	eng	N	N	O	O

text	eng	N	N	O	O
:	x	N	N	O	O

"	x	N	N	O	O
This	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

dangerous	eng	N	N	O	O

situation	eng	N	N	O	O
!	x	N	N	O	O
"	x	N	N	O	O
.	x	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

8	x	N	N	O	O

1	x	N	N	O	O

10	m	N	N	O	O

3	x	N	N	O	O

6	x	N	N	O	O

6	x	N	N	O	O

8	x	N	N	O	O

6	x	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

-	x	N	N	O	O
4	x	N	N	O	O

1	x	N	N	O	O

0	x	N	N	O	O

-	x	N	N	O	O
2	x	N	N	O	O

-	x	N	N	O	O
2	x	N	N	O	O

-	x	N	N	O	O
2	x	N	N	O	O

4	x	N	N	O	O

4	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

4	x	N	N	O	O

1	x	N	N	O	O

5	x	N	N	O	O

1	x	N	N	O	O

6	x	N	N	O	O

1	x	N	N	O	O

0	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

V	eng	N	N	O	O
.	m	N	N	O	O
I	eng	N	N	O	O
.	m	N	N	O	O
P	eng	N	N	O	O
.	m	N	N	O	O

should	eng	N	N	O	O

stay	eng	N	N	O	O

at	eng	N	N	O	O

(	x	N	N	O	O
2.0	m	N	N	O	O
,	x	N	N	O	O
3.0	m	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O

This	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

dangerous	eng	N	N	O	O

situation	eng	N	N	O	O
!	x	N	N	O	O

Source	eng	N	N	O	O

CTU	eng	N	N	O	O

Open	eng	N	N	O	O

2002	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
math	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

point	eng	N	N	O	O
{	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

point	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
30000	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

pig	eng	N	N	O	O
(	x	N	N	O	O
point	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
point	eng	N	N	O	O

b	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
<	x	N	N	O	O
b	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
b	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
&&	x	N	N	O	O
a	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
<	x	N	N	O	O
b	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

swap	eng	N	N	O	O
(	x	N	N	O	O
point	eng	N	N	O	O

&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
point	eng	N	N	O	O

&	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

point	eng	N	N	O	O

t	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

dog	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

y	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

x1	eng	N	N	O	O
,	x	N	N	O	O
y1	eng	N	N	O	O
;	x	N	N	O	O

point	eng	N	N	O	O

mid	eng	N	N	O	O
;	x	N	N	O	O

x1	eng	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

y1	eng	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
(	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

do	eng	N	N	O	O

{	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
pig	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

x	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
pig	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

y	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

swap	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

x	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
y1	eng	N	N	O	O
)	x	N	N	O	O

dog	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
x1	eng	N	N	O	O
<	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O

dog	eng	N	N	O	O
(	x	N	N	O	O
x1	eng	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
tx	eng	N	N	O	O
,	x	N	N	O	O
ty	eng	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

d	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
n	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

dog	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
"	x	N	N	O	O

"	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
n	x	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

tx	eng	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
;	x	N	N	O	O

ty	eng	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
;	x	N	N	O	O

d	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
tx	eng	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
ty	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
d	x	N	N	O	O
=	x	N	N	O	O
false	eng	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
d	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
V	eng	N	N	O	O
.	m	N	N	O	O
I	eng	N	N	O	O
.	m	N	N	O	O
P	eng	N	N	O	O
.	m	N	N	O	O

should	eng	N	N	O	O

stay	eng	N	N	O	O

at	eng	N	N	O	O

(	x	N	N	O	O
%	x	N	N	O	O
.1	m	N	N	O	O
lf	eng	N	N	O	O
,	x	N	N	O	O
%	x	N	N	O	O
.1	m	N	N	O	O
lf	eng	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
tx	eng	N	N	O	O
/	x	N	N	O	O
2.0	m	N	N	O	O
,	x	N	N	O	O
ty	eng	N	N	O	O
/	x	N	N	O	O
2.0	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
This	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

dangerous	eng	N	N	O	O

situation	eng	N	N	O	O
!	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

tx	eng	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
(	x	N	N	O	O
1	m	N	N	O	O
+	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

ty	eng	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
(	x	N	N	O	O
1	m	N	N	O	O
+	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

d	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
tx	eng	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
ty	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
d	x	N	N	O	O
=	x	N	N	O	O
false	eng	N	N	O	O
;	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
d	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
V	eng	N	N	O	O
.	m	N	N	O	O
I	eng	N	N	O	O
.	m	N	N	O	O
P	eng	N	N	O	O
.	m	N	N	O	O

should	eng	N	N	O	O

stay	eng	N	N	O	O

at	eng	N	N	O	O

(	x	N	N	O	O
%	x	N	N	O	O
.1	m	N	N	O	O
lf	eng	N	N	O	O
,	x	N	N	O	O
%	x	N	N	O	O
.1	m	N	N	O	O
lf	eng	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
tx	eng	N	N	O	O
/	x	N	N	O	O
2.0	m	N	N	O	O
,	x	N	N	O	O
ty	eng	N	N	O	O
/	x	N	N	O	O
2.0	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
This	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

dangerous	eng	N	N	O	O

situation	eng	N	N	O	O
!	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ
：	x	N	N	I-OJ	O
2713	m	N	N	I-OJ	O

肿瘤	n	N	N	O	O
面积	n	Y	N	O	O
_	x	N	N	O	O
小	a	N	N	O	O
_	x	N	N	O	O
船	n	N	N	O	O
__	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

肿瘤	n	N	N	O	O
面积	n	Y	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O
1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O
65536	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submit	eng	N	N	O	O
:	x	N	N	O	O
445	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O
189	m	N	N	O	O

Description	eng	N	N	O	O

在	p	N	N	O	O
一个	m	N	N	O	O
正方形	n	N	N	O	O
的	uj	N	N	O	O
灰度	n	N	N	O	O
图片	n	N	N	O	O
上	f	N	N	O	O
，	x	N	N	O	O
肿瘤	n	N	N	O	O
是	v	N	N	O	O
一块	m	N	N	O	O
矩形	n	Y	N	O	O
的	uj	N	N	O	O
区域	n	N	N	O	O
，	x	N	N	O	O
肿瘤	n	N	N	O	O
的	uj	N	N	O	O
边缘	n	N	N	O	O
所在	b	N	N	O	O
的	uj	N	N	O	O
像素点	n	N	N	O	O
在	p	N	N	O	O
图片	n	N	N	O	O
中用	n	N	N	O	O
0	m	N	N	O	O
表示	v	Y	N	O	O
。	x	N	N	O	O

其它	r	N	N	O	O
肿瘤	n	N	N	O	O
内	f	N	N	O	O
和	c	N	N	O	O
肿瘤	n	N	N	O	O
外	f	N	N	O	O
的	uj	N	N	O	O
点	q	N	N	O	O
都	d	N	N	O	O
用	p	N	N	O	O
255	m	N	N	O	O
表示	v	Y	N	O	O
。	x	N	N	O	O

现在	t	N	N	O	O
要求	v	N	N	O	O
你	r	N	N	O	O
编写	v	N	N	O	O
一个	m	N	N	O	O
程序	n	N	N	O	O
，	x	N	N	O	O
计算	v	Y	N	O	O
肿瘤	n	N	N	O	O
内部	f	Y	N	O	O
的	uj	N	N	O	O
像素点	n	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
（	x	N	N	O	O
不	d	N	N	O	O
包括	v	N	N	O	O
肿瘤	n	N	N	O	O
边缘	n	N	N	O	O
上	f	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
）	x	N	N	O	O
。	x	N	N	O	O

已知	v	N	N	O	O
肿瘤	n	N	N	O	O
的	uj	N	N	O	O
边缘	n	N	N	O	O
平行	n	N	N	O	O
于	p	N	N	O	O
图像	n	N	N	O	O
的	uj	N	N	O	O
边缘	n	N	N	O	O
。	x	N	N	O	O

Input	eng	N	N	O	O

只有	c	N	N	O	O
一个	m	N	N	O	O
测试	vn	N	N	O	O
样例	n	N	N	O	O
。	x	N	N	O	O

第一行	m	N	N	O	O
有	v	N	N	O	O
一个	m	N	N	O	O
整数	n	Y	N	O	O
n	x	N	N	O	O
，	x	N	N	O	O
表示	v	Y	N	O	O
正方形	n	N	N	O	O
图像	n	N	N	O	O
的	uj	N	N	O	O
边长	n	N	N	O	O
。	x	N	N	O	O

其后	c	N	N	O	O
n	eng	N	N	O	O
行	n	N	N	O	O
每行	r	N	N	O	O
有	v	N	N	O	O
n	eng	N	N	O	O
个	m	N	N	O	O
整数	n	Y	N	O	O
，	x	N	N	O	O
取值	v	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
或	c	N	N	O	O
255	m	N	N	O	O
。	x	N	N	O	O

整数	n	Y	N	O	O
之间	f	N	N	O	O
用	p	N	N	O	O
一个	m	N	N	O	O
空格	n	N	N	O	O
隔开	v	N	N	O	O
。	x	N	N	O	O

已知	v	N	N	O	O
n	eng	N	N	O	O
不	c	N	N	O	O
大于	d	N	N	O	O
100	m	N	N	O	O
。	x	N	N	O	O

Output	eng	N	N	O	O

输出	v	Y	N	O	O
一行	m	N	N	O	O
，	x	N	N	O	O
该行	r	N	N	O	O
包含	v	N	N	O	O
一个	m	N	N	O	O
整数	n	Y	N	O	O
，	x	N	N	O	O
为	p	N	N	O	O
要求	v	N	N	O	O
的	uj	N	N	O	O
肿瘤	n	N	N	O	O
内	f	N	N	O	O
的	uj	N	N	O	O
像素点	n	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
。	x	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

Source	eng	N	N	O	O

POJ	eng	N	Y	O	B-OJ
：	x	N	N	O	O
2713	m	N	N	O	O

C语言	n	N	N	O	O
代码	n	N	N	O	O
：	x	N	N	O	O

1	x	N	N	O	O

Sample	eng	N	N	O	O

Result	eng	N	N	O	O
:	x	N	N	O	O

5255	m	N	N	O	O

255	m	N	N	O	O

255	m	N	N	O	O

255	m	N	N	O	O

255255	m	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

255255	m	N	N	O	O

0	x	N	N	O	O

255	m	N	N	O	O

0	x	N	N	O	O

255255	m	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

255255	m	N	N	O	O

255	m	N	N	O	O

255	m	N	N	O	O

255	m	N	N	O	O

255	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O
int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sum1	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
n	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
m	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
x	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
x	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
计算	v	Y	N	O	O
出宽	v	N	N	O	O
/	x	N	N	O	O

else	eng	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
y	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
y	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

sum1	eng	N	N	O	O
=	x	N	N	O	O
sum1	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
计算	v	Y	N	O	O
出长	v	N	N	O	O
/	x	N	N	O	O

else	eng	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
*	x	N	N	O	O
sum1	eng	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
sum	eng	N	N	O	O
+	x	N	N	O	O
sum1	eng	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O
pku	eng	N	Y	B-OJ	B-OJ

1324	m	N	N	I-OJ	I-OJ

Holedox	eng	N	N	O	O

Moving	eng	N	N	O	O
_	x	N	N	O	O
lywdx	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

首先	d	N	N	O	O
声明	n	N	N	O	O
我	r	N	N	O	O
的	uj	N	N	O	O
程序	n	N	N	O	O
写	v	N	N	O	O
的	uj	N	N	O	O
很烂	a	N	N	O	O
，	x	N	N	O	O
限时	n	N	N	O	O
5	m	N	N	O	O
秒	m	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
的	uj	N	N	O	O
程序	n	N	N	O	O
4.5	m	N	N	O	O
秒	m	N	N	O	O
水	n	N	N	O	O
过去	t	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O

我	r	N	N	O	O
的	uj	N	N	O	O
思想	n	Y	N	O	O
应该	v	N	N	O	O
是	v	N	N	O	O
正确	ad	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
肯定	v	N	N	O	O
还有	v	N	N	O	O
剪枝	n	Y	N	B-KNOWLEDGE	O
的	uj	N	N	O	O
地方	n	N	N	O	O
没	v	N	N	O	O
注意	v	N	N	O	O
到	v	N	N	O	O
！	x	N	N	O	O

先	d	N	N	O	O
说	v	N	N	O	O
一下	m	N	N	O	O
题目	n	Y	N	O	O
大意	d	N	N	O	O
：	x	N	N	O	O
给	p	N	N	O	O
你	r	N	N	O	O
一个	m	N	N	O	O
用	p	N	N	O	O
二维	m	N	N	O	O
数组	n	Y	N	O	O
，	x	N	N	O	O
告诉	v	N	N	O	O
你	r	N	N	O	O
蛇	n	N	N	O	O
的	uj	N	N	O	O
初始	v	N	N	O	O
位置	v	N	N	O	O
，	x	N	N	O	O
并	c	N	N	O	O
告诉	v	N	N	O	O
你	r	N	N	O	O
那些	r	N	N	O	O
坐标	v	Y	N	O	O
点	m	N	N	O	O
是	v	N	N	O	O
石头	n	Y	N	O	O
，	x	N	N	O	O

是	v	N	N	O	O
石头	n	Y	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
蛇	n	N	N	O	O
不能	v	N	N	O	O
通过	p	N	N	O	O
，	x	N	N	O	O
问	v	N	N	O	O
你	r	N	N	O	O
蛇	n	N	N	O	O
从	p	N	N	O	O
起始	v	N	N	O	O
点	m	N	N	O	O
到	v	N	N	O	O
（	x	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
1	x	N	N	O	O
）	x	N	N	O	O
这点	mq	N	N	O	O
用	p	N	N	O	O
的	uj	N	N	O	O
最少	d	N	N	O	O
步数	n	N	N	O	O
！	x	N	N	O	O

思路	n	N	N	O	O
：	x	N	N	O	O
广	a	N	N	B-KNOWLEDGE	O
搜	v	N	N	I-KNOWLEDGE	O
，	x	N	N	O	O
关键	n	N	N	O	O
是	v	N	N	O	O
怎么	r	N	N	O	O
设置	vn	N	N	O	O
状态	n	Y	N	O	O
，	x	N	N	O	O
首先	d	N	N	O	O
头	n	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
必须	d	N	N	O	O
清楚	a	N	N	O	O
，	x	N	N	O	O
之后	f	N	N	O	O
是	v	N	N	O	O
身体	n	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
，	x	N	N	O	O
身体	n	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
我们	r	N	N	O	O

可以	c	N	N	O	O
用	p	N	N	O	O
一个	m	N	N	O	O
int	eng	N	N	O	O
类型	n	Y	N	O	O
的	uj	N	N	O	O
整数	n	Y	N	O	O
（	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
（	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
）	x	N	N	O	O
位	q	N	N	O	O
的	uj	N	N	O	O
二进制	n	N	N	O	O
数	n	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
设	v	N	N	O	O
4	m	N	N	O	O
个	m	N	N	O	O
方向	n	N	N	O	O
为	p	N	N	O	O
上下左右	m	N	N	O	O
，	x	N	N	O	O

其中	r	N	N	O	O
上	f	N	N	O	O
（	x	N	N	O	O
00	m	N	N	O	O
也	d	N	N	O	O
就是	d	N	N	O	O
十进制	j	N	N	O	O
的	uj	N	N	O	O
0	m	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
右	f	N	N	O	O
（	x	N	N	O	O
01	m	N	N	O	O
也	d	N	N	O	O
就是	d	N	N	O	O
十进制	j	N	N	O	O
的	uj	N	N	O	O
1	m	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
下	f	N	N	O	O
（	x	N	N	O	O
10	m	N	N	O	O
也	d	N	N	O	O
就是	d	N	N	O	O
十进制	j	N	N	O	O
的	uj	N	N	O	O
2	m	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O

左	m	N	N	O	O
（	x	N	N	O	O
11	m	N	N	O	O
也	d	N	N	O	O
就是	d	N	N	O	O
十进制	j	N	N	O	O
的	uj	N	N	O	O
3	m	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
记录	n	Y	N	O	O
身体	n	N	N	O	O
的	uj	N	N	O	O
方法	n	Y	N	O	O
就是	d	N	N	O	O
，	x	N	N	O	O
看	v	N	N	O	O
蛇	n	N	N	O	O
的	uj	N	N	O	O
颈部	n	N	N	O	O
在	p	N	N	O	O
头	n	N	N	O	O
的	uj	N	N	O	O
什么	r	N	N	O	O
方向	n	N	N	O	O
，	x	N	N	O	O
得到	v	N	N	O	O
颈部	n	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
，	x	N	N	O	O
再	d	N	N	O	O
看	v	N	N	O	O

通过	p	N	N	O	O
颈部	n	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
，	x	N	N	O	O
看	v	N	N	O	O
身体	n	N	N	O	O
在	p	N	N	O	O
颈部	n	N	N	O	O
的	uj	N	N	O	O
什么	r	N	N	O	O
方向	n	N	N	O	O
，	x	N	N	O	O
得到	v	N	N	O	O
身体	n	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
.....	m	N	N	O	O
这样	r	N	N	O	O
进行	v	N	N	O	O
直到	v	N	N	O	O
找到	v	N	N	O	O
尾部	n	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
！	x	N	N	O	O

这样	r	N	N	O	O
，	x	N	N	O	O
一个	m	N	N	O	O
状态	n	Y	N	O	O
怎么	r	N	N	O	O
表示	v	Y	N	O	O
就	d	N	N	O	O
出来	v	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
它	r	N	N	O	O
包含	v	N	N	O	O
：	x	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
头	n	N	N	O	O
的	uj	N	N	O	O
坐标	v	Y	N	O	O
，	x	N	N	O	O
2	x	N	N	O	O
，	x	N	N	O	O
身体	n	N	N	O	O
的	uj	N	N	O	O
状态	n	Y	N	O	O
，	x	N	N	O	O
3	x	N	N	O	O
，	x	N	N	O	O
到	v	N	N	O	O
该	r	N	N	O	O
状态	n	Y	N	O	O
走	v	N	N	O	O
了	ul	N	N	O	O
多少	m	N	N	O	O
步	n	N	N	O	O
！	x	N	N	O	O

如果	c	N	N	O	O
用	p	N	N	O	O
结构	n	Y	N	O	O
体	n	N	N	O	O
表示	v	Y	N	O	O
一个	m	N	N	O	O
状态	n	Y	N	O	O
，	x	N	N	O	O
就	d	N	N	O	O
应该	v	N	N	O	O
是	v	N	N	O	O

struct	eng	N	N	O	O

Node	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

s	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
头	n	N	N	O	O
坐标	v	Y	N	O	O

int	eng	N	N	O	O

state	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
改	v	N	N	O	O
状态	n	Y	N	O	O
身体	n	N	N	O	O
情况	n	N	N	O	O

int	eng	N	N	O	O

steps	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
当前	t	N	N	O	O
用	p	N	N	O	O
了	ul	N	N	O	O
多少	m	N	N	O	O
步	n	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

怎么	r	N	N	O	O
把	p	N	N	O	O
状态	n	Y	N	O	O
转换成	i	N	N	O	O
int	eng	N	N	O	O
类型	n	Y	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
是	v	N	N	O	O
这样	r	N	N	O	O
做	v	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
比如	v	N	N	O	O
，	x	N	N	O	O
题目	n	Y	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
测试数据	n	N	N	O	O
，	x	N	N	O	O
state	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
；	x	N	N	O	O

4	x	N	N	O	O

1	x	N	N	O	O

4	x	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

1	x	N	N	O	O

头	n	N	N	O	O
坐标	v	Y	N	O	O
4	x	N	N	O	O

1	x	N	N	O	O

则	d	N	N	O	O

（	x	N	N	O	O
4	x	N	N	O	O
，	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O

头	n	N	N	O	O
的	uj	N	N	O	O
右边	f	N	N	O	O
，	x	N	N	O	O
state	eng	N	N	O	O

|	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
其中	r	N	N	O	O
的	uj	N	N	O	O

i	x	N	N	O	O

是	v	N	N	O	O
表示	v	Y	N	O	O

头	n	N	N	O	O
后面	f	N	N	O	O
的	uj	N	N	O	O
第几个	m	N	N	O	O
节点	n	N	N	O	O
，	x	N	N	O	O
因为	c	N	N	O	O
我	r	N	N	O	O
的	uj	N	N	O	O
二进制	n	N	N	O	O
是	v	N	N	O	O
位高	v	N	N	O	O
—	x	N	N	O	O
—	x	N	N	O	O
>	x	N	N	O	O
低	a	N	N	O	O

表示	v	Y	N	O	O
蛇	n	N	N	O	O
的	uj	N	N	O	O

颈	ng	N	N	O	O
—	x	N	N	O	O
—	x	N	N	O	O
>	x	N	N	O	O
尾	n	N	N	O	O

（	x	N	N	O	O
3	x	N	N	O	O
，	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O
又	d	N	N	O	O
在	p	N	N	O	O
（	x	N	N	O	O
4	x	N	N	O	O
，	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O
的	uj	N	N	O	O
上边	f	N	N	O	O
，	x	N	N	O	O
上边	f	N	N	O	O
不用	v	N	N	O	O
管	vn	N	N	O	O
，	x	N	N	O	O
因为	c	N	N	O	O

state	eng	N	N	O	O

｜	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
没	v	N	N	O	O
变化	vn	N	N	O	O

（	x	N	N	O	O
3	x	N	N	O	O
，	x	N	N	O	O
1	x	N	N	O	O
）	x	N	N	O	O
在	p	N	N	O	O
（	x	N	N	O	O
3	x	N	N	O	O
，	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O

的	uj	N	N	O	O
左边	f	N	N	O	O

state	eng	N	N	O	O

｜	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
；	x	N	N	O	O
state	eng	N	N	O	O

｜	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

这里	r	N	N	O	O
有	v	N	N	O	O
两个	m	N	N	O	O
式子	n	N	N	O	O
，	x	N	N	O	O
因为	c	N	N	O	O
左边	f	N	N	O	O
是	v	N	N	O	O
二进制	n	N	N	O	O
11	m	N	N	O	O
，	x	N	N	O	O
两个	m	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
都	d	N	N	O	O
要	v	N	N	O	O
处理	v	N	N	O	O
，	x	N	N	O	O

这样	r	N	N	O	O
就	d	N	N	O	O
得到	v	N	N	O	O
了	ul	N	N	O	O
初始状态	l	N	N	O	O
，	x	N	N	O	O
在	p	N	N	O	O
后面	f	N	N	O	O
的	uj	N	N	O	O
蛇头	n	N	N	O	O
移动	vn	N	N	O	O
后	f	N	N	O	O
，	x	N	N	O	O
要	v	N	N	O	O
找	v	N	N	O	O
身体	n	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
的	uj	N	N	O	O
状态	n	Y	N	O	O

也	d	N	N	O	O
是	v	N	N	O	O
这种	r	N	N	O	O
方法	n	Y	N	O	O
，	x	N	N	O	O
但是	c	N	N	O	O
在	p	N	N	O	O
那里	r	N	N	O	O
既	c	N	N	O	O
要	v	N	N	O	O

注意	v	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
蛇头	n	N	N	O	O
往	zg	N	N	O	O
上	f	N	N	O	O
运动	vn	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
颈部	n	N	N	O	O
在	p	N	N	O	O
它	r	N	N	O	O
的	uj	N	N	O	O
下边	f	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
蛇头	n	N	N	O	O
往左边	z	N	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
颈部	n	N	N	O	O
在	p	N	N	O	O
它	r	N	N	O	O
的	uj	N	N	O	O
右边	f	N	N	O	O
，	x	N	N	O	O
这里	r	N	N	O	O
别	d	N	N	O	O
弄	v	N	N	O	O

混	v	N	N	O	O
了	ul	N	N	O	O
！	x	N	N	O	O

这个	r	N	N	O	O
题	n	N	N	O	O
的	uj	N	N	O	O
标记	n	N	N	O	O
要	v	N	N	O	O
用	p	N	N	O	O
三维	m	Y	N	O	O
的	uj	N	N	O	O
数组	n	Y	N	O	O
，	x	N	N	O	O

状态	n	Y	N	O	O
都	d	N	N	O	O
设计	vn	N	N	O	O
出来	v	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
这个	r	N	N	O	O
题	n	N	N	O	O
就	d	N	N	O	O
简单	a	N	N	O	O
了	ul	N	N	O	O
！	x	N	N	O	O

直接	ad	N	N	O	O
bfs	eng	N	N	B-KNOWLEDGE	O
；	x	N	N	O	O

可是	c	N	N	O	O
我	r	N	N	O	O
没	d	N	N	O	O
找出	v	Y	N	O	O
哪里	r	N	N	O	O
还	d	N	N	O	O
可以	c	N	N	O	O
剪枝	n	Y	N	B-KNOWLEDGE	O
的	uj	N	N	O	O
地方	n	N	N	O	O
！	x	N	N	O	O
！	x	N	N	O	O
！	x	N	N	O	O
继续	v	N	N	O	O
调试	vn	N	N	O	O
中	ns	N	N	O	O
..............	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

Max	eng	N	N	O	O

25	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

Maxn	eng	N	N	O	O

10010	m	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

Node	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

steps	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

state	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

Node1	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

G	x	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

move	eng	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

{	x	N	N	O	O
{	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O
{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

visit	eng	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
Maxn	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O

c	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

bfs	eng	N	N	O	O
(	x	N	N	O	O
Node	eng	N	N	O	O

fir	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

queue	eng	N	N	O	O
<	x	N	N	O	O
Node	eng	N	N	O	O
>	x	N	N	O	O

q	x	N	N	O	O
;	x	N	N	O	O

Node	eng	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

sum	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

juge	eng	N	N	O	O

=	x	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

Node1	eng	N	N	O	O

parent	eng	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
parent	eng	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O

,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
parent	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

parent	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O

fir	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
;	x	N	N	O	O

parent	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

=	x	N	N	O	O

fir	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
;	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
fir	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
q	eng	N	N	O	O
.	m	N	N	O	O
empty	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

fir	eng	N	N	O	O

=	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
front	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
pop	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O

fir	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
y	eng	N	N	O	O

=	x	N	N	O	O

fir	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
计算	v	Y	N	O	O
蛇	n	N	N	O	O
在	p	N	N	O	O
上	f	N	N	O	O
一	m	N	N	O	O
状态	n	Y	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
身体	n	N	N	O	O
的	uj	N	N	O	O
坐标	v	Y	N	O	O
，	x	N	N	O	O
并	c	N	N	O	O
记录	n	Y	N	O	O
在	p	N	N	O	O
parent	eng	N	N	O	O
中	ns	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

index	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

rez	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

index	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

|	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

&	x	N	N	O	O

fir	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O
)	x	N	N	O	O

;	x	N	N	O	O

int	eng	N	N	O	O

index1	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
index	eng	N	N	O	O

&	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

rez	eng	N	N	O	O

=	x	N	N	O	O

index1	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

index2	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
index	eng	N	N	O	O

&	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

rez	eng	N	N	O	O

|	x	N	N	O	O
=	x	N	N	O	O

index2	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

xnow	eng	N	N	O	O

=	x	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
x	eng	N	N	O	O

+	x	N	N	O	O

move	eng	N	N	O	O
[	x	N	N	O	O
rez	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ynow	eng	N	N	O	O

=	x	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
y	eng	N	N	O	O

+	x	N	N	O	O

move	eng	N	N	O	O
[	x	N	N	O	O
rez	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

parent	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O

xnow	eng	N	N	O	O
;	x	N	N	O	O

parent	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

=	x	N	N	O	O

ynow	eng	N	N	O	O
;	x	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O

xnow	eng	N	N	O	O
;	x	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
y	eng	N	N	O	O

=	x	N	N	O	O

ynow	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

4	x	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
蛇头	n	N	N	O	O
向	p	N	N	O	O
4	m	N	N	O	O
个	m	N	N	O	O
方向	n	N	N	O	O
移动	vn	N	N	O	O

{	x	N	N	O	O

Node	eng	N	N	O	O

media	eng	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

flag	eng	N	N	O	O

=	x	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O

fir	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

+	x	N	N	O	O

move	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

=	x	N	N	O	O

fir	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

+	x	N	N	O	O

move	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O

|	x	N	N	O	O
|	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

>	x	N	N	O	O

r	x	N	N	O	O

|	x	N	N	O	O
|	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O

|	x	N	N	O	O
|	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

>	x	N	N	O	O

c	x	N	N	O	O

|	x	N	N	O	O
|	x	N	N	O	O

G	x	N	N	O	O
[	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O

&&	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
到达	v	N	N	O	O
（	x	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
1	x	N	N	O	O
）	x	N	N	O	O
退出	v	N	N	O	O

{	x	N	N	O	O

sum	eng	N	N	O	O

=	x	N	N	O	O

fir	eng	N	N	O	O
.	m	N	N	O	O
steps	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

juge	eng	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
上边	f	N	N	O	O
条件	n	N	N	O	O
全部	n	N	N	O	O
满足	v	N	N	O	O
后	f	N	N	O	O
，	x	N	N	O	O
计算	v	Y	N	O	O
蛇头	n	N	N	O	O
移动	vn	N	N	O	O
一步	m	N	N	O	O
后	f	N	N	O	O
，	x	N	N	O	O
当前	t	N	N	O	O
蛇	n	N	N	O	O
身体	n	N	N	O	O
状态	n	Y	N	O	O

{	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
fir	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O

|	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
fir	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O

|	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

|	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O

=	x	N	N	O	O

fir	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

3	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
fir	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O

|	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
visit	eng	N	N	O	O
[	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O
]	x	N	N	O	O

)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
假如	c	N	N	O	O
这个	r	N	N	O	O
状态	n	Y	N	O	O
没有	v	N	N	O	O
出现	v	N	N	O	O
过	ug	N	N	O	O
，	x	N	N	O	O
入	v	N	N	O	O
队列	n	Y	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O

j	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

parent	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

&&	x	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

parent	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

flag	eng	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
flag	eng	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

visit	eng	N	N	O	O
[	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
media	eng	N	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
标记	n	N	N	O	O

media	eng	N	N	O	O
.	m	N	N	O	O
steps	eng	N	N	O	O

=	x	N	N	O	O

fir	eng	N	N	O	O
.	m	N	N	O	O
steps	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
media	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
juge	eng	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
juge	eng	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
q	eng	N	N	O	O
.	m	N	N	O	O
empty	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
pop	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
juge	eng	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

test	eng	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
r	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
c	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

r	x	N	N	O	O

&&	x	N	N	O	O

c	x	N	N	O	O

&&	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

Node	eng	N	N	O	O

str	eng	Y	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
,	x	N	N	O	O

index	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

rez	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
Case	eng	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

test	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
:	x	N	N	O	O

"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

test	eng	N	N	O	O

++	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

x1	eng	N	N	O	O
,	x	N	N	O	O

y1	eng	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
str	eng	Y	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
str	eng	Y	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

x1	eng	N	N	O	O

=	x	N	N	O	O

str	eng	Y	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
;	x	N	N	O	O

y1	eng	N	N	O	O

=	x	N	N	O	O

str	eng	Y	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

计算	v	Y	N	O	O
蛇	n	N	N	O	O
的	uj	N	N	O	O
初始状态	l	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x1	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O

>	x	N	N	O	O

y1	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

index	eng	N	N	O	O

|	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

index	eng	N	N	O	O

|	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

index	eng	N	N	O	O

|	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

y1	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O

>	x	N	N	O	O

x1	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

index	eng	N	N	O	O

|	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

x1	eng	N	N	O	O

=	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

y1	eng	N	N	O	O

=	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

str	eng	Y	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O

=	x	N	N	O	O

index	eng	N	N	O	O
;	x	N	N	O	O

str	eng	Y	N	O	O
.	m	N	N	O	O
steps	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

Max	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O

Max	eng	N	N	O	O

;	x	N	N	O	O

++	x	N	N	O	O

j	x	N	N	O	O
)	x	N	N	O	O

G	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

m	x	N	N	O	O

;	x	N	N	O	O

++	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

G	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
str	eng	Y	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O

&&	x	N	N	O	O

str	eng	Y	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
0	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
visit	eng	N	N	O	O
,	x	N	N	O	O

false	eng	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
visit	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

visit	eng	N	N	O	O
[	x	N	N	O	O
str	eng	Y	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
str	eng	Y	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
str	eng	Y	N	O	O
.	m	N	N	O	O
state	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

bfs	eng	N	N	O	O
(	x	N	N	O	O
str	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
PKU	eng	N	Y	B-OJ	B-OJ

2027	m	N	N	I-OJ	O

No	eng	N	N	O	O

Brainer	eng	N	N	O	O
(	x	N	N	O	O
简单	a	N	N	O	O
题	n	N	N	O	O
)	x	N	N	O	O
_	x	N	N	O	O
双	m	N	N	O	O
月	m	N	N	O	O
鸟	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

No	eng	N	N	O	O

Brainer	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

30000	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

8953	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

6298	m	N	N	O	O

Description	eng	N	N	O	O

Zombies	eng	N	N	O	O

love	eng	N	N	O	O

to	eng	N	N	O	O

eat	eng	N	N	O	O

brains	eng	N	N	O	O
.	m	N	N	O	O

Yum	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

The	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O

contains	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

integer	eng	N	N	O	O

n	x	N	N	O	O

indicating	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

data	eng	N	N	O	O

sets	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

following	eng	N	N	O	O

n	x	N	N	O	O

lines	eng	N	N	O	O

each	eng	N	N	O	O

represent	eng	N	N	O	O

a	x	N	N	O	O

data	eng	N	N	O	O

set	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

data	eng	N	N	O	O

set	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

formatted	eng	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

following	eng	N	N	O	O

description	eng	N	N	O	O
:	x	N	N	O	O

A	x	N	N	O	O

single	eng	N	N	O	O

data	eng	N	N	O	O

set	eng	N	N	O	O

consists	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

"	x	N	N	O	O
X	x	N	N	O	O

Y	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

where	eng	N	N	O	O

X	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

brains	eng	N	N	O	O

the	eng	N	N	O	O

zombie	eng	N	N	O	O

eats	eng	N	N	O	O

and	eng	N	N	O	O

Y	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

brains	eng	N	N	O	O

the	eng	N	N	O	O

zombie	eng	N	N	O	O

requires	eng	N	N	O	O

to	eng	N	N	O	O

stay	eng	N	N	O	O

alive	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

data	eng	N	N	O	O

set	eng	N	N	O	O
,	x	N	N	O	O

there	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

exactly	eng	N	N	O	O

one	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

output	eng	N	N	O	O
.	m	N	N	O	O

This	eng	N	N	O	O

line	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

"	x	N	N	O	O
MMM	eng	N	N	O	O

BRAINS	eng	N	N	O	O
"	x	N	N	O	O

if	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

brains	eng	N	N	O	O

the	eng	N	N	O	O

zombie	eng	N	N	O	O

eats	eng	N	N	O	O

is	eng	N	N	O	O

greater	eng	N	N	O	O

than	eng	N	N	O	O

or	eng	Y	N	O	O

equal	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

brains	eng	N	N	O	O

the	eng	N	N	O	O

zombie	eng	N	N	O	O

requires	eng	N	N	O	O

to	eng	N	N	O	O

stay	eng	N	N	O	O

alive	eng	N	N	O	O
.	m	N	N	O	O

Otherwise	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

"	x	N	N	O	O
NO	eng	N	N	O	O

BRAINS	eng	N	N	O	O
"	x	N	N	O	O
.	x	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

34	m	N	N	O	O

53	m	N	N	O	O

34	m	N	N	O	O

3	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

NO	eng	N	N	O	O

BRAINSMMM	eng	N	N	O	O

BRAINSMMM	eng	N	N	O	O

BRAINS	eng	N	N	O	O

Source	eng	N	N	O	O

South	eng	N	N	O	O

Central	eng	N	N	O	O

USA	eng	N	N	O	O

2004	m	N	N	O	O

Source	eng	N	N	O	O

Code	eng	N	N	O	O

Problem	eng	N	N	O	O
:	x	N	N	O	O

2027	m	N	N	O	O

User	eng	N	N	O	O
:	x	N	N	O	O

LXpeng	eng	N	N	O	O

Memory	eng	N	N	O	O
:	x	N	N	O	O

204	m	N	N	O	O
K	eng	N	N	O	O

Time	eng	N	N	O	O
:	x	N	N	O	O

0	m	N	N	O	O
MS	eng	N	N	O	O

Language	eng	N	N	O	O
:	x	N	N	O	O

C++	nz	N	N	O	O

Result	eng	N	N	O	O
:	x	N	N	O	O

Accepted	eng	N	N	O	O

Source	eng	N	N	O	O

Code	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O
using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O
int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
MMM	eng	N	N	O	O

BRAINS	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
NO	eng	N	N	O	O

BRAINS	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

2275	m	N	N	I-OJ	I-OJ
_	x	N	N	O	O
wegnahz	eng	N	N	O	O
的	uj	N	N	O	O
空间	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

我	r	N	N	O	O
发现	v	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

一边	d	N	N	O	O
看	v	N	N	O	O
电视剧	n	N	N	O	O
一边	d	N	N	O	O
写	v	N	N	O	O
代码	n	N	N	O	O
效率	n	N	N	O	O
的确	d	N	N	O	O
太	d	N	N	O	O
低	a	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

这	r	N	N	O	O
题	n	N	N	O	O
从	p	N	N	O	O
8	m	N	N	O	O
点	m	N	N	O	O
多	m	N	N	O	O
一直	d	N	N	O	O
写到	v	N	N	O	O
10	m	N	N	O	O
点	m	N	N	O	O
，	x	N	N	O	O
题目	n	Y	N	O	O
并	c	N	N	O	O
不难	d	N	N	O	O
，	x	N	N	O	O
就是	d	N	N	O	O
给你个	n	N	N	O	O
二叉树	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
，	x	N	N	O	O
问	v	N	N	O	O
有	v	N	N	O	O
多少	m	N	N	O	O
种	m	N	N	O	O
不同	a	N	N	O	O
顺序	n	N	N	O	O
的	uj	N	N	O	O
输入	v	N	N	O	O
序列	n	Y	N	O	O
也	d	N	N	O	O
能	v	N	N	O	O
构造	v	Y	N	O	O
出	v	N	N	O	O
相同	d	N	N	O	O
结构	n	Y	N	O	O
的	uj	N	N	O	O
二叉树	n	Y	N	B-KNOWLEDGE	O
。	x	N	N	O	O

其实	d	N	N	O	O
只要	c	N	N	O	O
构造	v	Y	N	O	O
出树	n	N	N	O	O
的	uj	N	N	O	O
形状	n	N	N	O	O
，	x	N	N	O	O
那么	r	N	N	O	O
设	n	N	N	O	O
f	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
为	p	N	N	O	O
以	f	N	N	O	O
i	eng	N	N	O	O
为	p	N	N	O	O
根	q	N	N	O	O
的	uj	N	N	O	O
子树	n	N	N	O	O
的	uj	N	N	O	O
答案	n	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
的	uj	N	N	O	O
孩子	n	N	N	O	O
数	n	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
的	uj	N	N	O	O
左	m	N	N	O	O
（	x	N	N	O	O
右	f	N	N	O	O
）	x	N	N	O	O
孩子	n	N	N	O	O
数	n	N	N	O	O
]	x	N	N	O	O
×	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
左	m	N	N	O	O
孩子	n	N	N	O	O
]	x	N	N	O	O
×	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
右	f	N	N	O	O
孩子	n	N	N	O	O
]	x	N	N	O	O
，	x	N	N	O	O
输出	v	Y	N	O	O
根	p	N	N	O	O
节点	n	N	N	O	O
的	uj	N	N	O	O
答案	n	N	N	O	O
即可	d	N	N	O	O
。	x	N	N	O	O

因为	c	N	N	O	O
我	r	N	N	O	O
半	m	N	N	O	O
秃	a	N	N	O	O
，	x	N	N	O	O
秃然想	n	N	N	O	O
写	v	N	N	O	O
个	q	N	N	O	O
完全	ad	Y	N	O	O
非	h	N	N	O	O
递归	v	Y	N	B-KNOWLEDGE	O
的	uj	N	N	O	O
，	x	N	N	O	O
于是	c	N	N	O	O
插入	v	N	N	O	O
节点	n	N	N	O	O
和	c	N	N	O	O
递推	v	Y	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
都	d	N	N	O	O
用	p	N	N	O	O
非	h	N	N	O	O
递归	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
，	x	N	N	O	O
拿	v	N	N	O	O
栈	ng	N	N	O	B-KNOWLEDGE
模拟	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
了	ul	N	N	O	O
个	q	N	N	O	O
，	x	N	N	O	O
结果	n	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

不管怎么	l	N	N	O	O
说	v	N	N	O	O
，	x	N	N	O	O
好歹	n	N	N	O	O
ac	eng	Y	N	O	O
了	ul	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

pku2775	eng	N	Y	B-OJ	B-OJ

*	x	N	N	O	O
/	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

produced	eng	N	N	O	O

by	eng	N	N	O	O

wegnahz	eng	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
math	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
ctype	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

inf	eng	N	N	O	O
=	x	N	N	O	O
100000000	m	N	N	O	O
,	x	N	N	O	O
mm	eng	N	N	O	O
=	x	N	N	O	O
9901	m	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

double	eng	N	N	O	O

pi	eng	N	N	O	O
=	x	N	N	O	O
acos	eng	N	N	O	O
(	x	N	N	O	O
-	x	N	N	O	O
1.0	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

double	eng	N	N	O	O

eps	eng	N	N	O	O
=	x	N	N	O	O
1	m	N	N	O	O
e	eng	N	N	O	O
-	x	N	N	O	O
8	x	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

maxn	eng	N	N	O	O
=	x	N	N	O	O
101	m	N	N	O	O
;	x	N	N	O	O

template	eng	N	N	O	O
<	x	N	N	O	O
class	eng	N	N	O	O

T	x	N	N	O	O
>	x	N	N	O	O

inline	eng	N	N	O	O

void	eng	N	N	O	O

checkmin	eng	N	N	O	O
(	x	N	N	O	O
T	x	N	N	O	O

&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
T	x	N	N	O	O

b	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O
if	eng	N	N	O	O
(	x	N	N	O	O
b	x	N	N	O	O
<	x	N	N	O	O
a	x	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

template	eng	N	N	O	O
<	x	N	N	O	O
class	eng	N	N	O	O

T	x	N	N	O	O
>	x	N	N	O	O

inline	eng	N	N	O	O

void	eng	N	N	O	O

checkmax	eng	N	N	O	O
(	x	N	N	O	O
T	x	N	N	O	O

&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
T	x	N	N	O	O

b	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O
if	eng	N	N	O	O
(	x	N	N	O	O
b	x	N	N	O	O
>	x	N	N	O	O
a	x	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

inline	eng	N	N	O	O

void	eng	N	N	O	O

fill	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

b	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

c	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
c	x	N	N	O	O
/	x	N	N	O	O
4	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
,	x	N	N	O	O
a	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

*	x	N	N	O	O
a	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
nl	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
nr	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

freopen	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
pku2775	eng	N	Y	O	O
.	m	N	N	O	O
in	eng	Y	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
r	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
stdin	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

freopen	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
pku2775	eng	N	Y	O	O
.	m	N	N	O	O
out	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
w	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
stdout	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
100	m	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
c	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O

mm	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
nl	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
nl	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
nr	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
nr	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

nl	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
l	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

l	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

nr	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

r	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
f	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
f	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
nl	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
nr	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
nl	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
t	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
t	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

t	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
t	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

t	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
t	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
mm	eng	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

}	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ2886	eng	N	Y	B-OJ	B-OJ

Who	eng	N	N	O	O

Gets	eng	N	N	O	O

the	eng	N	N	O	O

Most	eng	N	N	O	O

Candies	eng	N	N	O	O
?	x	N	N	O	O

线段	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
树	n	N	N	I-KNOWLEDGE	I-KNOWLEDGE
+	x	N	N	O	O
约瑟夫	nrt	Y	N	B-KNOWLEDGE	O
+	x	N	N	O	O
反	v	N	N	B-KNOWLEDGE	O
素数	n	Y	N	I-KNOWLEDGE	O

-	x	N	N	O	O

Albafica	eng	N	N	O	O
_	x	N	N	O	O
iCpc	eng	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

线段	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
树	n	N	N	I-KNOWLEDGE	I-KNOWLEDGE
+	x	N	N	O	O
约瑟夫	nrt	Y	N	B-KNOWLEDGE	O
+	x	N	N	O	O
反	v	N	N	B-KNOWLEDGE	O
素数	n	Y	N	I-KNOWLEDGE	O
。	x	N	N	O	O

用	p	N	N	O	O
线段	n	Y	N	O	O
数	m	N	N	O	O
跟	p	N	N	O	O
新	a	N	N	O	O
队伍	n	N	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
人数	n	N	N	O	O
。	x	N	N	O	O

每次	r	N	N	O	O
查询	v	N	N	O	O
将要	d	N	N	O	O
出队	n	N	N	O	O
的	uj	N	N	O	O
人	n	N	N	O	O
在	p	N	N	O	O
当前	t	N	N	O	O
队伍	n	N	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
。	x	N	N	O	O

在	p	N	N	O	O
通过	p	N	N	O	O
将要	d	N	N	O	O
移动	vn	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
，	x	N	N	O	O
找出	v	Y	N	O	O
下	f	N	N	O	O
一个	m	N	N	O	O
位置	v	N	N	O	O
。	x	N	N	O	O

通过	p	N	N	O	O
这一	r	N	N	O	O
题	n	N	N	O	O
知道	v	N	N	O	O
了反	v	N	N	O	O
素数	n	Y	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

ORZ	eng	N	N	O	O

膜拜	v	N	N	O	O
众	ng	N	N	O	O
神	n	N	N	O	O
犇	zg	N	N	O	O

Who	eng	N	N	O	O

Gets	eng	N	N	O	O

the	eng	N	N	O	O

Most	eng	N	N	O	O

Candies	eng	N	N	O	O
?	x	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

5000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

131072	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

6075	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

1752	m	N	N	O	O

Case	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

2000	m	N	N	O	O
MS	eng	N	N	O	O

Description	eng	N	N	O	O

N	x	N	N	O	O

children	eng	N	N	O	O

are	eng	N	N	O	O

sitting	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

circle	eng	N	N	O	O

to	eng	N	N	O	O

play	eng	N	N	O	O

a	x	N	N	O	O

game	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

children	eng	N	N	O	O

are	eng	N	N	O	O

numbered	eng	N	N	O	O

from	eng	N	N	O	O

1	x	N	N	O	O

to	eng	N	N	O	O

N	x	N	N	O	O

in	eng	Y	N	O	O

clockwise	eng	N	N	O	O

order	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

of	eng	N	N	O	O

them	eng	N	N	O	O

has	eng	Y	N	O	O

a	x	N	N	O	O

card	eng	N	N	O	O

with	eng	N	N	O	O

a	x	N	N	O	O

non	eng	N	N	O	O
-	x	N	N	O	O
zero	eng	N	N	O	O

integer	eng	N	N	O	O

on	eng	N	N	O	O

it	eng	N	N	O	O

in	eng	Y	N	O	O

his	eng	N	N	O	O
/	x	N	N	O	O
her	eng	Y	N	O	O

hand	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

game	eng	N	N	O	O

starts	eng	N	N	O	O

from	eng	N	N	O	O

theK	eng	N	N	O	O
-	x	N	N	O	O
th	eng	N	N	O	O

child	eng	N	N	O	O
,	x	N	N	O	O

who	eng	N	N	O	O

tells	eng	N	N	O	O

all	eng	N	N	O	O

the	eng	N	N	O	O

others	eng	N	N	O	O

the	eng	N	N	O	O

integer	eng	N	N	O	O

on	eng	N	N	O	O

his	eng	N	N	O	O

card	eng	N	N	O	O

and	eng	N	N	O	O

jumps	eng	N	N	O	O

out	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

circle	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

integer	eng	N	N	O	O

on	eng	N	N	O	O

his	eng	N	N	O	O

card	eng	N	N	O	O

tells	eng	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

child	eng	N	N	O	O

to	eng	N	N	O	O

jump	eng	N	N	O	O

out	eng	N	N	O	O
.	m	N	N	O	O

LetA	eng	N	N	O	O

denote	eng	N	N	O	O

the	eng	N	N	O	O

integer	eng	N	N	O	O
.	m	N	N	O	O

IfA	eng	N	N	O	O

is	eng	N	N	O	O

positive	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

child	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

theA	eng	N	N	O	O
-	x	N	N	O	O
th	eng	N	N	O	O

child	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

left	eng	N	N	O	O
.	m	N	N	O	O

IfA	eng	N	N	O	O

is	eng	N	N	O	O

negative	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

child	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

the	eng	N	N	O	O

(	x	N	N	O	O
?	x	N	N	O	O
A	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
th	eng	N	N	O	O

child	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

right	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

game	eng	N	N	O	O

lasts	eng	N	N	O	O

until	eng	N	N	O	O

all	eng	N	N	O	O

children	eng	N	N	O	O

have	eng	N	N	O	O

jumped	eng	N	N	O	O

out	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

circle	eng	N	N	O	O
.	m	N	N	O	O

During	eng	N	N	O	O

the	eng	N	N	O	O

game	eng	N	N	O	O
,	x	N	N	O	O

thep	eng	N	N	O	O
-	x	N	N	O	O
th	eng	N	N	O	O

child	eng	N	N	O	O

jumping	eng	N	N	O	O

out	eng	N	N	O	O

will	eng	N	N	O	O

getF	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
)	x	N	N	O	O

candies	eng	N	N	O	O

where	eng	N	N	O	O

F	x	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
)	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

positive	eng	N	N	O	O

integers	eng	N	N	O	O

that	eng	N	N	O	O

perfectly	eng	N	N	O	O

dividep	eng	N	N	O	O
.	m	N	N	O	O

Who	eng	N	N	O	O

gets	eng	N	N	O	O

the	eng	N	N	O	O

most	eng	N	N	O	O

candies	eng	N	N	O	O
?	x	N	N	O	O

Input	eng	N	N	O	O

There	eng	N	N	O	O

are	eng	N	N	O	O

several	eng	N	N	O	O

test	eng	N	N	O	O

cases	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

input	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O

starts	eng	N	N	O	O

with	eng	N	N	O	O

two	eng	N	N	O	O

integers	eng	N	N	O	O

N	x	N	N	O	O

(	x	N	N	O	O
0	x	N	N	O	O

<	x	N	N	O	O

N	x	N	N	O	O

≤	x	N	N	O	O

500	m	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
)	x	N	N	O	O

and	eng	N	N	O	O

K	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

≤	x	N	N	O	O

K	x	N	N	O	O

≤	x	N	N	O	O

N	x	N	N	O	O
)	x	N	N	O	O

on	eng	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

nextN	eng	N	N	O	O

lines	eng	N	N	O	O

contains	eng	N	N	O	O

the	eng	N	N	O	O

names	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

children	eng	N	N	O	O

(	x	N	N	O	O
consisting	eng	N	N	O	O

of	eng	N	N	O	O

at	eng	N	N	O	O

most	eng	N	N	O	O

10	m	N	N	O	O

letters	eng	N	N	O	O
)	x	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

integers	eng	N	N	O	O

(	x	N	N	O	O
non	eng	N	N	O	O
-	x	N	N	O	O
zero	eng	N	N	O	O

with	eng	N	N	O	O

magnitudes	eng	N	N	O	O

within	eng	N	N	O	O

108	m	N	N	O	O
)	x	N	N	O	O

on	eng	N	N	O	O

their	eng	N	N	O	O

cards	eng	N	N	O	O

in	eng	Y	N	O	O

increasing	eng	N	N	O	O

order	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

children	eng	N	N	O	O
’	x	N	N	O	O
s	x	N	N	O	O

numbers	eng	N	N	O	O
,	x	N	N	O	O

a	x	N	N	O	O

name	eng	N	N	O	O

and	eng	N	N	O	O

an	eng	Y	N	O	O

integer	eng	N	N	O	O

separated	eng	N	N	O	O

by	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

space	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

with	eng	N	N	O	O

no	eng	N	N	O	O

leading	eng	N	N	O	O

or	eng	Y	N	O	O

trailing	eng	N	N	O	O

spaces	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

Output	eng	N	N	O	O

one	eng	N	N	O	O

line	eng	N	N	O	O

for	eng	Y	N	O	O

each	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O

containing	eng	N	N	O	O

the	eng	N	N	O	O

name	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

luckiest	eng	N	N	O	O

child	eng	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

candies	eng	N	N	O	O

he	eng	Y	N	O	O
/	x	N	N	O	O
she	eng	N	N	O	O

gets	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

ties	eng	N	N	O	O

occur	eng	N	N	O	O
,	x	N	N	O	O

always	eng	N	N	O	O

choose	eng	N	N	O	O

the	eng	N	N	O	O

child	eng	N	N	O	O

who	eng	N	N	O	O

jumps	eng	N	N	O	O

out	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

circle	eng	N	N	O	O

first	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

4	x	N	N	O	O

2	x	N	N	O	O

Tom	eng	N	N	O	O

2	x	N	N	O	O

Jack	eng	N	N	O	O

4	x	N	N	O	O

Mary	eng	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O

Sam	eng	N	N	O	O

1	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

Sam	eng	N	N	O	O

3	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iterator	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

lson	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
root	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

rson	eng	N	N	O	O

m	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
root	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
|	x	N	N	O	O
1	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAXN	eng	N	N	O	O

600020	m	N	N	O	O

int	eng	N	N	O	O

num	eng	N	N	O	O
[	x	N	N	O	O
MAXN	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
step	eng	N	N	O	O
[	x	N	N	O	O
MAXN	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
37	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
4	x	N	N	O	O
,	x	N	N	O	O
6	x	N	N	O	O
,	x	N	N	O	O
12	m	N	N	O	O
,	x	N	N	O	O
24	m	N	N	O	O
,	x	N	N	O	O
36	m	N	N	O	O
,	x	N	N	O	O
48	m	N	N	O	O
,	x	N	N	O	O
60	m	N	N	O	O
,	x	N	N	O	O
120	m	N	N	O	O
,	x	N	N	O	O
180	m	N	N	O	O
,	x	N	N	O	O
240	m	N	N	O	O
,	x	N	N	O	O
360	m	N	N	O	O
,	x	N	N	O	O
720	m	N	N	O	O
,	x	N	N	O	O
840	m	N	N	O	O
,	x	N	N	O	O
1260	m	N	N	O	O
,	x	N	N	O	O
1680	m	N	N	O	O
,	x	N	N	O	O
2520	m	N	N	O	O
,	x	N	N	O	O
5040	m	N	N	O	O
,	x	N	N	O	O
7560	m	N	N	O	O
,	x	N	N	O	O
10080	m	N	N	O	O
,	x	N	N	O	O
15120	m	N	N	O	O
,	x	N	N	O	O
20160	m	N	N	O	O
,	x	N	N	O	O
25200	m	N	N	O	O
,	x	N	N	O	O
27720	m	N	N	O	O
,	x	N	N	O	O
45360	m	N	N	O	O
,	x	N	N	O	O
50400	m	N	N	O	O
,	x	N	N	O	O
55440	m	N	N	O	O
,	x	N	N	O	O
83160	m	N	N	O	O
,	x	N	N	O	O
110880	m	N	N	O	O
,	x	N	N	O	O
166320	m	N	N	O	O
,	x	N	N	O	O
221760	m	N	N	O	O
,	x	N	N	O	O
277200	m	N	N	O	O
,	x	N	N	O	O
332640	m	N	N	O	O
,	x	N	N	O	O
498960	m	N	N	O	O
,	x	N	N	O	O
500001	m	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
37	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
3	x	N	N	O	O
,	x	N	N	O	O
4	x	N	N	O	O
,	x	N	N	O	O
6	x	N	N	O	O
,	x	N	N	O	O
8	x	N	N	O	O
,	x	N	N	O	O
9	x	N	N	O	O
,	x	N	N	O	O
10	m	N	N	O	O
,	x	N	N	O	O
12	m	N	N	O	O
,	x	N	N	O	O
16	m	N	N	O	O
,	x	N	N	O	O
18	m	N	N	O	O
,	x	N	N	O	O
20	m	N	N	O	O
,	x	N	N	O	O
24	m	N	N	O	O
,	x	N	N	O	O
30	m	N	N	O	O
,	x	N	N	O	O
32	m	N	N	O	O
,	x	N	N	O	O
36	m	N	N	O	O
,	x	N	N	O	O
40	m	N	N	O	O
,	x	N	N	O	O
48	m	N	N	O	O
,	x	N	N	O	O
60	m	N	N	O	O
,	x	N	N	O	O
64	m	N	N	O	O
,	x	N	N	O	O
72	m	N	N	O	O
,	x	N	N	O	O
80	m	N	N	O	O
,	x	N	N	O	O
84	m	N	N	O	O
,	x	N	N	O	O
90	m	N	N	O	O
,	x	N	N	O	O
96	m	N	N	O	O
,	x	N	N	O	O
100	m	N	N	O	O
,	x	N	N	O	O
108	m	N	N	O	O
,	x	N	N	O	O
120	m	N	N	O	O
,	x	N	N	O	O
128	m	N	N	O	O
,	x	N	N	O	O
144	m	N	N	O	O
,	x	N	N	O	O
160	m	N	N	O	O
,	x	N	N	O	O
168	m	N	N	O	O
,	x	N	N	O	O
180	m	N	N	O	O
,	x	N	N	O	O
192	m	N	N	O	O
,	x	N	N	O	O
200	m	N	N	O	O
,	x	N	N	O	O
1314521	m	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

m2	eng	N	N	O	O
[	x	N	N	O	O
MAXN	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

push	eng	N	N	O	O
_	x	N	N	O	O
up	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

root	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

num	eng	N	N	O	O
[	x	N	N	O	O
root	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
root	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
root	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
|	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

root	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
m2	eng	N	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
step	eng	N	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

num	eng	N	N	O	O
[	x	N	N	O	O
root	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
lson	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
rson	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

push	eng	N	N	O	O
_	x	N	N	O	O
up	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

query	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

p	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

root	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

l	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
root	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

query	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O
lson	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

p	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
-	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
root	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

query	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O
rson	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

p	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

root	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

num	eng	N	N	O	O
[	x	N	N	O	O
root	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O
lson	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O
rson	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

push	eng	N	N	O	O
_	x	N	N	O	O
up	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

search	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

l	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
h	x	N	N	O	O
=	x	N	N	O	O
37	m	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
h	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
h	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
m	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

h	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

l	x	N	N	O	O
=	x	N	N	O	O
m	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
m	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

h	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

solve	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

tag	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

num	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

pos	eng	N	N	O	O
,	x	N	N	O	O
temp	eng	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
位置	v	N	N	O	O
为	p	N	N	O	O
s	eng	N	N	O	O

的	uj	N	N	O	O
人	n	N	N	O	O
出队	v	N	N	O	O

，	x	N	N	O	O
更新	d	N	N	O	O
线段	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE	I-KNOWLEDGE

temp	eng	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
num	eng	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
判断	v	Y	N	O	O
当前	t	N	N	O	O
出队	n	N	N	O	O
数	n	N	N	O	O
是否	v	N	N	O	O
为	p	N	N	O	O
目标	n	N	N	O	O
的	uj	N	N	O	O
反	vn	N	N	B-KNOWLEDGE	O
素数	n	Y	N	I-KNOWLEDGE	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
m2	eng	N	N	O	O
[	x	N	N	O	O
temp	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
tag	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

pos	eng	N	N	O	O
=	x	N	N	O	O
step	eng	N	N	O	O
[	x	N	N	O	O
temp	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
pos	eng	N	N	O	O
<	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
利用	n	N	N	O	O
取模	n	Y	N	O	O
运算	vn	Y	N	O	O
，	x	N	N	O	O
找出	v	Y	N	O	O
下	f	N	N	O	O
一个	m	N	N	O	O
出队	n	N	N	O	O
的	uj	N	N	O	O
人	n	N	N	O	O
是	v	N	N	O	O
当前	t	N	N	O	O
队伍	n	N	N	O	O
中	f	N	N	O	O
第几个	m	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
pos	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
pos	eng	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
注意	v	N	N	O	O
负数	n	N	N	O	O

x	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

x	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

temp	eng	N	N	O	O
=	x	N	N	O	O
query	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
查找	v	Y	N	O	O
位置	v	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
出队	n	N	N	O	O
，	x	N	N	O	O
更新	d	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
s	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

tag	eng	N	N	O	O
=	x	N	N	O	O
search	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
用	p	N	N	O	O
二分	m	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
找出	v	Y	N	O	O
目标	n	N	N	O	O
的	uj	N	N	O	O
反	vn	N	N	B-KNOWLEDGE	O
素数	n	Y	N	I-KNOWLEDGE	O

solve	eng	N	N	O	O
(	x	N	N	O	O
tag	eng	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
tag	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj1006	eng	N	Y	B-OJ	B-OJ

-	x	N	N	O	O

地平线	n	N	N	O	O
的	uj	N	N	O	O
日志	ns	N	N	O	O

-	x	N	N	O	O

网易	n	N	N	O	O
博客	nr	N	N	O	O

Biorhythms	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

10000	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

68666	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

20234	m	N	N	O	O

Description	eng	N	N	O	O

Some	eng	N	N	O	O

people	eng	N	N	O	O

believe	eng	N	N	O	O

that	eng	N	N	O	O

there	eng	N	N	O	O

are	eng	N	N	O	O

three	eng	N	N	O	O

cycles	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

person	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

life	eng	N	N	O	O

that	eng	N	N	O	O

start	eng	N	N	O	O

the	eng	N	N	O	O

day	eng	N	N	O	O

he	eng	Y	N	O	O

or	eng	Y	N	O	O

she	eng	N	N	O	O

is	eng	N	N	O	O

born	eng	N	N	O	O
.	m	N	N	O	O

These	eng	N	N	O	O

three	eng	N	N	O	O

cycles	eng	N	N	O	O

are	eng	N	N	O	O

the	eng	N	N	O	O

physical	eng	N	N	O	O
,	x	N	N	O	O

emotional	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

intellectual	eng	N	N	O	O

cycles	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

they	eng	N	N	O	O

have	eng	N	N	O	O

periods	eng	N	N	O	O

of	eng	N	N	O	O

lengths	eng	N	N	O	O

23	m	N	N	O	O
,	x	N	N	O	O

28	m	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

33	m	N	N	O	O

days	eng	N	N	O	O
,	x	N	N	O	O

respectively	eng	N	N	O	O
.	m	N	N	O	O

There	eng	N	N	O	O

is	eng	N	N	O	O

one	eng	N	N	O	O

peak	eng	N	N	O	O

in	eng	Y	N	O	O

each	eng	N	N	O	O

period	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

cycle	eng	N	N	O	O
.	m	N	N	O	O

At	eng	N	N	O	O

the	eng	N	N	O	O

peak	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

cycle	eng	N	N	O	O
,	x	N	N	O	O

a	x	N	N	O	O

person	eng	N	N	O	O

performs	eng	N	N	O	O

at	eng	N	N	O	O

his	eng	N	N	O	O

or	eng	Y	N	O	O

her	eng	Y	N	O	O

best	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

corresponding	eng	N	N	O	O

field	eng	N	N	O	O

(	x	N	N	O	O
physical	eng	N	N	O	O
,	x	N	N	O	O

emotional	eng	N	N	O	O

or	eng	Y	N	O	O

mental	eng	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O

For	eng	N	N	O	O

example	eng	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

it	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

mental	eng	N	N	O	O

curve	eng	N	N	O	O
,	x	N	N	O	O

thought	eng	N	N	O	O

processes	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

sharper	eng	N	N	O	O

and	eng	N	N	O	O

concentration	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

easier	eng	N	N	O	O
.	m	N	N	O	O

Since	eng	N	N	O	O

the	eng	N	N	O	O

three	eng	N	N	O	O

cycles	eng	N	N	O	O

have	eng	N	N	O	O

different	eng	N	N	O	O

periods	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

peaks	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

three	eng	N	N	O	O

cycles	eng	N	N	O	O

generally	eng	N	N	O	O

occur	eng	N	N	O	O

at	eng	N	N	O	O

different	eng	N	N	O	O

times	eng	N	N	O	O
.	m	N	N	O	O

We	eng	N	N	O	O

would	eng	N	N	O	O

like	eng	N	N	O	O

to	eng	N	N	O	O

determine	eng	N	N	O	O

when	eng	N	N	O	O

a	x	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

(	x	N	N	O	O
the	eng	N	N	O	O

peaks	eng	N	N	O	O

of	eng	N	N	O	O

all	eng	N	N	O	O

three	eng	N	N	O	O

cycles	eng	N	N	O	O

occur	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

day	eng	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O

any	eng	N	N	O	O

person	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

cycle	eng	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

given	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

days	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

beginning	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

current	eng	N	N	O	O

year	eng	N	N	O	O

at	eng	N	N	O	O

which	eng	N	N	O	O

one	eng	N	N	O	O

of	eng	N	N	O	O

its	eng	N	N	O	O

peaks	eng	N	N	O	O

(	x	N	N	O	O
not	eng	N	N	O	O

necessarily	eng	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O
)	x	N	N	O	O

occurs	eng	N	N	O	O
.	m	N	N	O	O

You	eng	N	N	O	O

will	eng	N	N	O	O

also	eng	N	N	O	O

be	eng	Y	N	O	O

given	eng	N	N	O	O

a	x	N	N	O	O

date	eng	N	N	O	O

expressed	eng	N	N	O	O

as	eng	Y	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

days	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

beginning	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

current	eng	N	N	O	O

year	eng	N	N	O	O
.	m	N	N	O	O

You	eng	N	N	O	O

task	eng	N	N	O	O

is	eng	N	N	O	O

to	eng	N	N	O	O

determine	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

days	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

given	eng	N	N	O	O

date	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

given	eng	N	N	O	O

date	eng	N	N	O	O

is	eng	N	N	O	O

not	eng	N	N	O	O

counted	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

example	eng	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

the	eng	N	N	O	O

given	eng	N	N	O	O

date	eng	N	N	O	O

is	eng	N	N	O	O

10	m	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

on	eng	N	N	O	O

day	eng	N	N	O	O

12	m	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

answer	eng	N	N	O	O

is	eng	N	N	O	O

2	x	N	N	O	O
,	x	N	N	O	O

not	eng	N	N	O	O

3.	m	N	N	O	O

If	eng	N	N	O	O

a	x	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

on	eng	N	N	O	O

the	eng	N	N	O	O

given	eng	N	N	O	O

date	eng	N	N	O	O
,	x	N	N	O	O

you	eng	N	N	O	O

should	eng	N	N	O	O

give	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

days	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

occurrence	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

You	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

given	eng	N	N	O	O

a	x	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

cases	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

input	eng	N	N	O	O

for	eng	Y	N	O	O

each	eng	N	N	O	O

case	eng	N	N	O	O

consists	eng	N	N	O	O

of	eng	N	N	O	O

one	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

four	eng	N	N	O	O

integers	eng	N	N	O	O

p	x	N	N	O	O
,	x	N	N	O	O

e	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

d	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

values	eng	N	N	O	O

p	x	N	N	O	O
,	x	N	N	O	O

e	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

i	x	N	N	O	O

are	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

days	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

beginning	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

current	eng	N	N	O	O

year	eng	N	N	O	O

at	eng	N	N	O	O

which	eng	N	N	O	O

the	eng	N	N	O	O

physical	eng	N	N	O	O
,	x	N	N	O	O

emotional	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

intellectual	eng	N	N	O	O

cycles	eng	N	N	O	O

peak	eng	N	N	O	O
,	x	N	N	O	O

respectively	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

value	eng	N	N	O	O

d	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

given	eng	N	N	O	O

date	eng	N	N	O	O

and	eng	N	N	O	O

may	eng	N	N	O	O

be	eng	Y	N	O	O

smaller	eng	N	N	O	O

than	eng	N	N	O	O

any	eng	N	N	O	O

of	eng	N	N	O	O

p	x	N	N	O	O
,	x	N	N	O	O

e	x	N	N	O	O
,	x	N	N	O	O

or	eng	Y	N	O	O

i	eng	N	N	O	O
.	m	N	N	O	O

All	eng	N	N	O	O

values	eng	N	N	O	O

are	eng	N	N	O	O

non	eng	N	N	O	O
-	x	N	N	O	O
negative	eng	N	N	O	O

and	eng	N	N	O	O

at	eng	N	N	O	O

most	eng	N	N	O	O

365	m	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

you	eng	N	N	O	O

may	eng	N	N	O	O

assume	eng	N	N	O	O

that	eng	N	N	O	O

a	x	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

will	eng	N	N	O	O

occur	eng	N	N	O	O

within	eng	N	N	O	O

21252	m	N	N	O	O

days	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

given	eng	N	N	O	O

date	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

end	eng	N	N	O	O

of	eng	N	N	O	O

input	eng	N	N	O	O

is	eng	N	N	O	O

indicated	eng	N	N	O	O

by	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

in	eng	Y	N	O	O

which	eng	N	N	O	O

p	x	N	N	O	O

=	x	N	N	O	O

e	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

d	x	N	N	O	O

=	x	N	N	O	O

-	x	N	N	O	O
1.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O
,	x	N	N	O	O

print	eng	N	N	O	O

the	eng	N	N	O	O

case	eng	N	N	O	O

number	eng	N	N	O	O

followed	eng	N	N	O	O

by	eng	N	N	O	O

a	x	N	N	O	O

message	eng	N	N	O	O

indicating	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

days	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O
,	x	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

form	eng	N	N	O	O
:	x	N	N	O	O

Case	eng	N	N	O	O

1	x	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

in	eng	Y	N	O	O

1234	m	N	N	O	O

days	eng	N	N	O	O
.	m	N	N	O	O

Use	eng	N	N	O	O

the	eng	N	N	O	O

plural	eng	N	N	O	O

form	eng	N	N	O	O

`	x	N	N	O	O
`	x	N	N	O	O
days	eng	N	N	O	O
'	x	N	N	O	O
'	x	N	N	O	O

even	eng	N	N	O	O

if	eng	N	N	O	O

the	eng	N	N	O	O

answer	eng	N	N	O	O

is	eng	N	N	O	O

1.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

00	m	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

1005	m	N	N	O	I-OJ

20	m	N	N	O	O

34	m	N	N	O	O

3254	m	N	N	O	O

5	x	N	N	O	O

6	x	N	N	O	O

7283	m	N	N	O	O

102	m	N	N	O	O

23	m	N	N	O	O

320203	m	N	N	O	O

301	m	N	N	O	O

203	m	N	N	O	O

40	m	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

Case	eng	N	N	O	O

1	x	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

in	eng	Y	N	O	O

21252	m	N	N	O	O

days	eng	N	N	O	O
.	m	N	N	O	O
Case	eng	N	N	O	O

2	x	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

in	eng	Y	N	O	O

21152	m	N	N	O	O

days	eng	N	N	O	O
.	m	N	N	O	O
Case	eng	N	N	O	O

3	x	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

in	eng	Y	N	O	O

19575	m	N	N	O	O

days	eng	N	N	O	O
.	m	N	N	O	O
Case	eng	N	N	O	O

4	x	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

in	eng	Y	N	O	O

16994	m	N	N	O	O

days	eng	N	N	O	O
.	m	N	N	O	O
Case	eng	N	N	O	O

5	x	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

in	eng	Y	N	O	O

8910	m	N	N	O	O

days	eng	N	N	O	O
.	m	N	N	O	O
Case	eng	N	N	O	O

6	x	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

in	eng	Y	N	O	O

10789	m	N	N	O	O

days	eng	N	N	O	O
.	m	N	N	O	O

Source	eng	N	N	O	O

East	eng	N	N	O	O

Central	eng	N	N	O	O

North	eng	N	N	O	O

America	eng	N	N	O	O

1999	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdlib	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

argc	eng	N	N	O	O
,	x	N	N	O	O

char	eng	N	N	O	O

*	x	N	N	O	O
argv	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

long	eng	N	N	O	O

int	eng	N	N	O	O

p	x	N	N	O	O
,	x	N	N	O	O
e	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
d	x	N	N	O	O
;	x	N	N	O	O

long	eng	N	N	O	O

int	eng	N	N	O	O

c	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
p	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
e	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
d	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

c++	nz	N	N	O	O
;	x	N	N	O	O

long	eng	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
28	m	N	N	O	O
*	x	N	N	O	O
33	m	N	N	O	O
*	x	N	N	O	O
23	m	N	N	O	O
;	x	N	N	O	O

long	eng	N	N	O	O

int	eng	N	N	O	O

s	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
28	m	N	N	O	O
*	x	N	N	O	O
33	m	N	N	O	O
*	x	N	N	O	O
6	x	N	N	O	O
*	x	N	N	O	O
p	x	N	N	O	O
%	x	N	N	O	O
m	eng	N	N	O	O
+	x	N	N	O	O
23	m	N	N	O	O
*	x	N	N	O	O
33	m	N	N	O	O
*	x	N	N	O	O
19	m	N	N	O	O
*	x	N	N	O	O
e	x	N	N	O	O
%	x	N	N	O	O
m	eng	N	N	O	O
+	x	N	N	O	O
23	m	N	N	O	O
*	x	N	N	O	O
28	m	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
%	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
>	x	N	N	O	O
d	x	N	N	O	O
)	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
"	x	N	N	O	O
Case	eng	N	N	O	O

"	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
c	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
"	x	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

in	eng	Y	N	O	O

"	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
s	x	N	N	O	O
-	x	N	N	O	O
d	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
"	x	N	N	O	O

days	eng	N	N	O	O
.	m	N	N	O	O
"	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

long	eng	N	N	O	O

int	eng	N	N	O	O

sum	eng	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
s	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
/	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
sum	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
m	eng	N	N	O	O
+	x	N	N	O	O
s	eng	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
d	x	N	N	O	O
;	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
"	x	N	N	O	O
Case	eng	N	N	O	O

"	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
c	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
"	x	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

next	eng	N	N	O	O

triple	eng	N	N	O	O

peak	eng	N	N	O	O

occurs	eng	N	N	O	O

in	eng	Y	N	O	O

"	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
sum	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
"	x	N	N	O	O

days	eng	N	N	O	O
.	m	N	N	O	O
"	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

system	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
PAUSE	eng	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

EXIT	eng	N	N	O	O
_	x	N	N	O	O
SUCCESS	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
PKU	eng	N	Y	B-OJ	B-OJ
_	x	N	N	I-OJ	O
1147	m	N	N	I-OJ	O
_	x	N	N	O	O
唐武	nr	N	N	O	O
的	uj	N	N	O	O
空间	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
虽然	c	N	N	O	O
在	p	N	N	O	O
网上	s	N	N	O	O
找到	v	N	N	O	O
不少	d	N	N	O	O
代码	n	N	N	O	O
，	x	N	N	O	O
但	c	N	N	O	O
的确	d	N	N	O	O
看	v	N	N	O	O
的	uj	N	N	O	O
不是	c	N	N	O	O
很	zg	N	N	O	O
明白	nr	N	N	O	O
，	x	N	N	O	O
只好	d	N	N	O	O
自己	r	N	N	O	O
再	d	N	N	O	O
摸索	v	N	N	O	O
规律	n	Y	N	O	O
。	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
假设	vn	N	N	O	O
最后	f	N	N	O	O
一列	m	N	N	O	O
有	v	N	N	O	O
n	eng	N	N	O	O
个	m	N	N	O	O
0	m	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
可以	c	N	N	O	O
确定	v	N	N	O	O
第	m	N	N	O	O
1	m	N	N	O	O
列	v	N	N	O	O
的	uj	N	N	O	O
前	n	N	N	O	O
n	eng	N	N	O	O
个	m	N	N	O	O
也	d	N	N	O	O
是	v	N	N	O	O
0	m	N	N	O	O
，	x	N	N	O	O
后面	f	N	N	O	O
的	uj	N	N	O	O
全为	n	N	N	O	O
1	m	N	N	O	O
，	x	N	N	O	O
第	m	N	N	O	O
1	m	N	N	O	O
列	v	N	N	O	O
的	uj	N	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
个	m	N	N	O	O
0	m	N	N	O	O
和	c	N	N	O	O
最后	f	N	N	O	O
一列	m	N	N	O	O
0	x	N	N	O	O
相对	d	N	N	O	O
应	v	N	N	O	O
，	x	N	N	O	O
第	m	N	N	O	O
j	eng	N	N	O	O
个	m	N	N	O	O
1	m	N	N	O	O
和	c	N	N	O	O
最后	f	N	N	O	O
一列	m	N	N	O	O
的	uj	N	N	O	O
第	m	N	N	O	O
j	eng	N	N	O	O
个	m	N	N	O	O
1	m	N	N	O	O
相对	d	N	N	O	O
应	v	N	N	O	O
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

NUM	eng	N	N	O	O

=	x	N	N	O	O

3001	m	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

input	eng	N	N	O	O
[	x	N	N	O	O
NUM	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

zero	eng	N	N	O	O
[	x	N	N	O	O
NUM	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
zero	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
表示	v	Y	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
个	m	N	N	O	O
0	m	N	N	O	O
在	p	N	N	O	O
input	eng	N	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O

int	eng	N	N	O	O

one	eng	N	N	O	O
[	x	N	N	O	O
NUM	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
one	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
表示	v	Y	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
个	m	N	N	O	O
1	m	N	N	O	O
在	p	N	N	O	O
input	eng	N	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O

int	eng	N	N	O	O

output	eng	N	N	O	O
[	x	N	N	O	O
NUM	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

N	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
输入	v	N	N	O	O
的	uj	N	N	O	O
0	m	N	N	O	O
、	x	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O

int	eng	N	N	O	O

zero	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O

int	eng	N	N	O	O

one	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

Ans	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
N	eng	N	N	O	O
)	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

zero	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O

=	x	N	N	O	O

one	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

N	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
input	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
input	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

zero	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

zero	eng	N	N	O	O
[	x	N	N	O	O
zero	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

one	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

one	eng	N	N	O	O
[	x	N	N	O	O
one	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

Ans	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

N	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

"	x	N	N	O	O
,	x	N	N	O	O

output	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

Ans	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
zero	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O

>	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

output	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
第一个	m	N	N	O	O
一定	d	N	N	O	O
是	v	N	N	O	O
0	m	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

N	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

output	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

k	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

h	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

c	x	N	N	O	O

=	x	N	N	O	O

zero	eng	N	N	O	O
[	x	N	N	O	O
h	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
k	x	N	N	O	O
表示	v	Y	N	O	O
是	v	N	N	O	O
0	m	N	N	O	O
还是	c	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
h	x	N	N	O	O
表示	v	Y	N	O	O
是	v	N	N	O	O
第几个	m	N	N	O	O
0	m	N	N	O	O
或	c	N	N	O	O
第几个	m	N	N	O	O
1	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

N	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O

>	x	N	N	O	O

zero	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

k	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

h	x	N	N	O	O

=	x	N	N	O	O

c	x	N	N	O	O

-	x	N	N	O	O

zero	eng	N	N	O	O
_	x	N	N	O	O
num	eng	N	N	O	O
;	x	N	N	O	O

output	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O

=	x	N	N	O	O

one	eng	N	N	O	O
[	x	N	N	O	O
h	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

output	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

h	x	N	N	O	O

=	x	N	N	O	O

c	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O

=	x	N	N	O	O

zero	eng	N	N	O	O
[	x	N	N	O	O
h	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

2506	m	N	N	I-OJ	O

递推	v	Y	N	O	O
_	x	N	N	O	O
石家庄	nr	N	N	O	O
二中	nrt	N	N	O	O
2011	m	N	N	O	O
级	q	N	N	O	O
OI	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

好像	v	N	N	O	O
状压	n	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
啊	y	N	N	O	O
，	x	N	N	O	O
可惜	v	N	N	O	O
不是	c	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

题意	n	N	N	O	O
：	x	N	N	O	O
你	r	N	N	O	O
这	r	N	N	O	O
题	n	N	N	O	O
看不懂	v	N	N	O	O
就	d	N	N	O	O
回去	v	N	N	O	O
读	v	N	N	O	O
小学	n	N	N	O	O
英语	nz	N	N	O	O
去	v	N	N	O	O
吧	y	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

递推	v	Y	N	O	O
：	x	N	N	O	O
由于	c	N	N	O	O
当前	t	N	N	O	O
状态	n	Y	N	O	O
根	p	N	N	O	O
i	eng	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
之前	f	N	N	O	O
的	uj	N	N	O	O
无关	v	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
只	d	N	N	O	O
需	v	N	N	O	O
考虑	v	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	m	N	N	O	O
和	c	N	N	O	O
i	eng	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
。	x	N	N	O	O

假设	vn	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
方案	n	N	N	O	O
数	n	N	N	O	O
已经	d	N	N	O	O
算	v	N	N	O	O
好	a	N	N	O	O
，	x	N	N	O	O
此时	c	N	N	O	O
只能	v	N	N	O	O
添加	v	N	N	O	O
1	m	N	N	O	O
个	m	N	N	O	O
竖	v	N	N	O	O
着	uz	N	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

假设	vn	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
方案	n	N	N	O	O
数	n	N	N	O	O
已经	d	N	N	O	O
算	v	N	N	O	O
好	a	N	N	O	O
，	x	N	N	O	O
此时	c	N	N	O	O
能	v	N	N	O	O
添加	v	N	N	O	O
两个	m	N	N	O	O
横	v	N	N	O	O
着	uz	N	N	O	O
的	uj	N	N	O	O
和	c	N	N	O	O
一个	m	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
为什么	r	N	N	O	O
没有	v	N	N	O	O
两个	m	N	N	O	O
竖	v	N	N	O	O
着	uz	N	N	O	O
的	uj	N	N	O	O
？	x	N	N	O	O
因为	c	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
已经	d	N	N	O	O
算	v	N	N	O	O
过	ug	N	N	O	O
竖	v	N	N	O	O
着	uz	N	N	O	O
的	uj	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

注意	v	N	N	O	O
N	eng	N	N	O	O
有	v	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
，	x	N	N	O	O
要	v	N	N	O	O
输出	v	Y	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
因为	c	N	N	O	O
这	r	N	N	O	O
WA	eng	N	N	O	O
了	ul	N	N	O	O
两次	m	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

配	v	N	N	O	O
上	f	N	N	O	O
高精度	n	Y	N	O	O
计算	v	Y	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

（	x	N	N	O	O
代码	n	N	N	O	O
仅供参考	l	N	N	O	O
和	c	N	N	O	O
学习	v	N	N	O	O
，	x	N	N	O	O
请	v	N	N	O	O
不要	df	N	N	O	O
直接	ad	N	N	O	O
粘贴	n	N	N	O	O
刷	v	N	N	O	O
AC	eng	N	N	O	O
数	n	N	N	O	O
，	x	N	N	O	O
期待	v	N	N	O	O
你	r	N	N	O	O
写出	v	N	N	O	O
更好	d	N	N	O	O
的	uj	N	N	O	O
代码	n	N	N	O	O
）	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

H	x	N	N	O	O

{	x	N	N	O	O
int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
len	eng	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
310	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

inline	eng	N	N	O	O

H	x	N	N	O	O

operator	eng	N	N	O	O

+	x	N	N	O	O

(	x	N	N	O	O
const	eng	N	N	O	O

H	x	N	N	O	O

&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
const	eng	N	N	O	O

H	x	N	N	O	O

&	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

l	x	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
(	x	N	N	O	O
x	eng	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
,	x	N	N	O	O
y	eng	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

H	x	N	N	O	O

z	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
z	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O

z	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

z	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
x	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
y	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

z	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
z	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
/	x	N	N	O	O
10	m	N	N	O	O
;	x	N	N	O	O

z	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
%	x	N	N	O	O
=	x	N	N	O	O
10	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
z	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

l	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

z	eng	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

z	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

inline	eng	N	N	O	O

H	x	N	N	O	O

mut	eng	N	N	O	O
(	x	N	N	O	O
H	x	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
x	eng	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

x	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
x	eng	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

x	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
x	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
/	x	N	N	O	O
10	m	N	N	O	O
;	x	N	N	O	O

x	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
%	x	N	N	O	O
=	x	N	N	O	O
10	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	eng	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
x	eng	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

x	eng	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
250	m	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
mut	eng	N	N	O	O
(	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

2893	m	N	N	I-OJ	O

M	x	N	N	O	O

×	x	N	N	O	O

N	x	N	N	O	O

Puzzle	eng	N	N	O	O

(	x	N	N	O	O
由	p	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
求解	v	N	N	O	O
8	x	N	N	O	O
数码	n	Y	N	O	O
问题	n	N	N	O	O
的	uj	N	N	O	O
推广	v	N	N	O	O
)	x	N	N	O	O
_	x	N	N	O	O
answerme11	eng	N	N	O	O
的	uj	N	N	O	O
空间	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

这	r	N	N	O	O
是	v	N	N	O	O
一道	m	N	N	O	O
8	x	N	N	O	O
数码	n	Y	N	O	O
问题	n	N	N	O	O
推广	v	N	N	O	O
的	uj	N	N	O	O
题目	n	Y	N	O	O
，	x	N	N	O	O
可	v	N	N	O	O
通过	p	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
个数	n	Y	N	O	O
判定	v	Y	N	O	O
问题	n	N	N	O	O
是否	v	N	N	O	O
可解	v	N	N	O	O
。	x	N	N	O	O

解决	v	N	N	O	O
这个	r	N	N	O	O
问题	n	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
可以	c	N	N	O	O
首先	d	N	N	O	O
把	p	N	N	O	O
初始	v	N	N	O	O
矩阵	n	Y	N	O	O
按	p	N	N	O	O
从上到下	l	N	N	O	O
，	x	N	N	O	O
从左到右	l	N	N	O	O
顺序排列	l	N	N	O	O
成	n	N	N	O	O
一个	m	N	N	O	O
一维	m	N	N	O	O
数组	n	Y	N	O	O
的	uj	N	N	O	O
数列	m	Y	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
将	d	N	N	O	O
问题	n	N	N	O	O
化成	v	N	N	O	O
求解	v	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
的	uj	N	N	O	O
问题	n	N	N	O	O
。	x	N	N	O	O

若	c	N	N	O	O
初始	v	N	N	O	O
矩阵	n	Y	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O
与	p	N	N	O	O
目标	n	N	N	O	O
矩阵	n	Y	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O
奇偶性	n	N	N	O	O
一致	d	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
问题	n	N	N	O	O
可解	v	N	N	O	O
。	x	N	N	O	O

（	x	N	N	O	O
其中	r	N	N	O	O
两个	m	N	N	O	O
矩阵	n	Y	N	O	O
都	d	N	N	O	O
要	v	N	N	O	O
扣除	v	N	N	O	O
数字	n	Y	N	O	O
0	m	N	N	O	O
对	p	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O
的	uj	N	N	O	O
影响	vn	N	N	O	O
）	x	N	N	O	O
。	x	N	N	O	O

至于	p	N	N	O	O
为什么	r	N	N	O	O
这样	r	N	N	O	O
求解	v	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
也	d	N	N	O	O
无法	n	N	N	O	O
完全	ad	Y	N	O	O
解释	v	N	N	O	O
，	x	N	N	O	O
但是	c	N	N	O	O
可以	c	N	N	O	O
提供	v	N	N	O	O
一些	m	N	N	O	O
参考	v	N	N	O	O
知识	v	N	N	O	O
：	x	N	N	O	O

假设	vn	N	N	O	O
这个	r	N	N	O	O
矩阵	n	Y	N	O	O
有	v	N	N	O	O
3	m	N	N	O	O
列	nr	N	N	O	O
，	x	N	N	O	O
且	zg	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
设为	v	N	N	O	O
N	eng	N	N	O	O

（	x	N	N	O	O
1	x	N	N	O	O
）	x	N	N	O	O
首先	d	N	N	O	O
，	x	N	N	O	O
对于	p	N	N	O	O
可	v	N	N	O	O
左右	m	N	N	O	O
移动	vn	N	N	O	O
的	uj	N	N	O	O
数字	n	Y	N	O	O
，	x	N	N	O	O
它	r	N	N	O	O
左右	m	N	N	O	O
移动	vn	N	N	O	O
是	v	N	N	O	O
不会	v	N	N	O	O
对	p	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
产生	n	N	N	O	O
影响	vn	N	N	O	O
；	x	N	N	O	O

（	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O
若	c	N	N	O	O
数字	n	Y	N	O	O
a0	eng	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
的话	u	N	N	O	O
会	v	N	N	O	O
移到	v	N	N	O	O
它	r	N	N	O	O
之前	f	N	N	O	O
或	c	N	N	O	O
之后	f	N	N	O	O
的	uj	N	N	O	O
两个	m	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
，	x	N	N	O	O
假设	vn	N	N	O	O
是	v	N	N	O	O
向上	d	N	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
且	c	N	N	O	O
这	r	N	N	O	O
两个	m	N	N	O	O
数字	n	Y	N	O	O
为	p	N	N	O	O
a1	eng	N	N	O	O
，	x	N	N	O	O
a2	eng	N	N	O	O
：	x	N	N	O	O
(	x	N	N	O	O
3	m	N	N	O	O
个	m	N	N	O	O
数字	n	Y	N	O	O
肯定	v	N	N	O	O
是	v	N	N	O	O
不同	a	N	N	O	O
数字	n	Y	N	O	O
)	x	N	N	O	O

若	c	N	N	O	O
a0	eng	N	N	O	O

<	x	N	N	O	O

a1	eng	N	N	O	O

<	x	N	N	O	O

a2	eng	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
新	a	N	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
为	p	N	N	O	O
N	eng	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
，	x	N	N	O	O

若	c	N	N	O	O
a1	eng	N	N	O	O

<	x	N	N	O	O

a0	eng	N	N	O	O

<	x	N	N	O	O

a2	eng	N	N	O	O
,	x	N	N	O	O

则	d	N	N	O	O
新	a	N	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
为	p	N	N	O	O
N	eng	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O

=	x	N	N	O	O

N	x	N	N	O	O
，	x	N	N	O	O

若	c	N	N	O	O
a1	eng	N	N	O	O

<	x	N	N	O	O

a2	eng	N	N	O	O

<	x	N	N	O	O

a0	eng	N	N	O	O
,	x	N	N	O	O

则	d	N	N	O	O
新	a	N	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
为	p	N	N	O	O
N	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O
，	x	N	N	O	O

由此可见	c	N	N	O	O
，	x	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
移动	vn	N	N	O	O
是	v	N	N	O	O
不	d	N	N	O	O
影响	vn	N	N	O	O
矩阵	n	Y	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
的	uj	N	N	O	O
奇偶性	n	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
推广	v	N	N	O	O
到	v	N	N	O	O
列数	n	N	N	O	O
为	p	N	N	O	O
奇数	n	Y	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O
也	d	N	N	O	O
是	v	N	N	O	O
一样	r	N	N	O	O
。	x	N	N	O	O

那么	r	N	N	O	O
若	c	N	N	O	O
判定	v	Y	N	O	O
初始	v	N	N	O	O
矩阵	n	Y	N	O	O
与	p	N	N	O	O
目标	n	N	N	O	O
矩阵	n	Y	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
是否	v	N	N	O	O
相同	d	N	N	O	O
，	x	N	N	O	O
即可	d	N	N	O	O
判定	v	Y	N	O	O
问题	n	N	N	O	O
是否	v	N	N	O	O
可解	v	N	N	O	O
，	x	N	N	O	O
若同则	c	N	N	O	O
可解	v	N	N	O	O
，	x	N	N	O	O
否则	c	N	N	O	O
不可	v	N	N	O	O
解	v	N	N	O	O
。	x	N	N	O	O

若列	m	N	N	O	O
数为	n	N	N	O	O
偶数	n	N	N	O	O
的话	u	N	N	O	O
，	x	N	N	O	O
数字	n	Y	N	O	O
左右	m	N	N	O	O
移动	vn	N	N	O	O
同理	n	N	N	O	O
不	d	N	N	O	O
影响	vn	N	N	O	O
，	x	N	N	O	O
但是	c	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
一次	m	N	N	O	O
会	v	N	N	O	O
改变	v	N	N	O	O
一次	m	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
的	uj	N	N	O	O
奇偶性	n	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
对于	p	N	N	O	O
这种	r	N	N	O	O
情况	n	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
可以	c	N	N	O	O
计算	v	Y	N	O	O
初始	v	N	N	O	O
矩阵	n	Y	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
到	v	N	N	O	O
目标	n	N	N	O	O
矩阵	n	Y	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
的	uj	N	N	O	O
差值	n	N	N	O	O

S	x	N	N	O	O

，	x	N	N	O	O
这样	r	N	N	O	O
可以	c	N	N	O	O
判定	v	Y	N	O	O
奇偶性	n	N	N	O	O
被	p	N	N	O	O
如何	r	N	N	O	O
改变	v	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

由于	c	N	N	O	O
0	x	N	N	O	O
最终	d	N	N	O	O
是	v	N	N	O	O
要	v	N	N	O	O
到	v	N	N	O	O
目标	n	N	N	O	O
位置	v	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
无论	c	N	N	O	O
0	m	N	N	O	O
在	p	N	N	O	O
工程	n	N	N	O	O
中	f	N	N	O	O
如何	r	N	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
的	uj	N	N	O	O
奇偶性	n	N	N	O	O
只	m	N	N	O	O
和	c	N	N	O	O
S	eng	N	N	O	O
有关	vn	N	N	O	O
。	x	N	N	O	O

那	r	N	N	O	O
有些	r	N	N	O	O
人	n	N	N	O	O
可能	v	N	N	O	O
会	v	N	N	O	O
想	v	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
怎么	r	N	N	O	O
只	d	N	N	O	O
考虑	v	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
不	d	N	N	O	O
考虑	v	N	N	O	O
其他	r	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
可以	c	N	N	O	O
这样	r	N	N	O	O
想	v	N	N	O	O
，	x	N	N	O	O
无论	c	N	N	O	O
那个	r	N	N	O	O
数字	n	Y	N	O	O
要	v	N	N	O	O
移动	vn	N	N	O	O
都	d	N	N	O	O
是	v	N	N	O	O
要	v	N	N	O	O
和	c	N	N	O	O
0	m	N	N	O	O
交换	v	N	N	O	O
位置	v	N	N	O	O
，	x	N	N	O	O
也就是说	l	N	N	O	O
无论	c	N	N	O	O
那个	r	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
移动	vn	N	N	O	O
都	d	N	N	O	O
是	v	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
在	p	N	N	O	O
这里	r	N	N	O	O
我们	r	N	N	O	O
就	d	N	N	O	O
只	d	N	N	O	O
分析	vn	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
即可	d	N	N	O	O
。	x	N	N	O	O

以下	f	N	N	O	O
是	v	N	N	O	O
本题	n	N	N	O	O
的	uj	N	N	O	O
代码	n	N	N	O	O
，	x	N	N	O	O
求解	v	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O
用	p	N	N	O	O
的	uj	N	N	O	O
是	v	N	N	O	O
归并	v	Y	N	B-KNOWLEDGE	O
法	j	N	N	I-KNOWLEDGE	O
的	uj	N	N	O	O
模板	n	Y	N	O	O
，	x	N	N	O	O
其实	d	N	N	O	O
用	p	N	N	O	O
树状	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
数组	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
也	d	N	N	O	O
可以	c	N	N	O	O
求解	v	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O
。	x	N	N	O	O

但	c	N	N	O	O
自己	r	N	N	O	O
写嫌	v	N	N	O	O
麻烦	an	N	N	O	O
，	x	N	N	O	O
就用	v	N	N	O	O
了	ul	N	N	O	O
USO	eng	N	N	O	O
同学	n	N	N	O	O
的	uj	N	N	O	O
归并	v	Y	N	B-KNOWLEDGE	O
法	j	N	N	I-KNOWLEDGE	O
的	uj	N	N	O	O
模板	n	Y	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAXN	eng	N	N	O	O

1000005	m	N	N	O	O

int	eng	N	N	O	O

cnt	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
MAXN	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
MAXN	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
0...	m	N	N	O	O
n	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

初始化	l	N	N	O	O
cnt	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

call	eng	N	N	O	O
:	x	N	N	O	O
MergeSort	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

MergeSort	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
归并	v	Y	N	B-KNOWLEDGE	O
求	v	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
tmp	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
>	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

MergeSort	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

MergeSort	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
mid	eng	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
mid	eng	N	N	O	O
&&	x	N	N	O	O
j	eng	N	N	O	O
<	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

cnt	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
mid	eng	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
pl	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O

|	x	N	N	O	O
|	x	N	N	O	O

m	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

cnt	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

pl	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
loc0	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
*	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
pl	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
pl	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

x	x	N	N	O	O

=	x	N	N	O	O

pl	eng	N	N	O	O
/	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

loc0	eng	N	N	O	O

=	x	N	N	O	O

pl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

pl	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

MergeSort	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
pl	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cnt	eng	N	N	O	O

-	x	N	N	O	O
=	x	N	N	O	O

loc0	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
扣除	v	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
逆	n	N	N	O	O
序数	n	Y	N	O	O

int	eng	N	N	O	O

step	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
若列	m	N	N	O	O
数为	n	N	N	O	O
奇数	n	Y	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
上下左右	m	N	N	O	O
移动	vn	N	N	O	O
都	d	N	N	O	O
不	d	N	N	O	O
影响	vn	N	N	O	O
最终	d	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
的	uj	N	N	O	O
总数	n	N	N	O	O

step	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

step	eng	N	N	O	O

=	x	N	N	O	O

n	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O

-	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
若列	m	N	N	O	O
数为	n	N	N	O	O
偶数	n	N	N	O	O
，	x	N	N	O	O
左右	m	N	N	O	O
移动	vn	N	N	O	O
不	d	N	N	O	O
影响	vn	N	N	O	O
，	x	N	N	O	O
但	c	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
一次	m	N	N	O	O
，	x	N	N	O	O
会	v	N	N	O	O
改变	v	N	N	O	O
一次	m	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
的	uj	N	N	O	O
奇偶性	n	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
step	eng	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

cnt	eng	N	N	O	O

%	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
初始	v	N	N	O	O
，	x	N	N	O	O
结束	v	N	N	O	O
状态	n	Y	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
奇偶性	n	N	N	O	O
一致	d	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
问题	n	N	N	O	O
可解	v	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
YES	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
NO	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

1063	m	N	N	I-OJ	O

-	x	N	N	O	O

ACM	eng	N	N	O	O
-	x	N	N	O	O
King	eng	N	N	O	O
伟	nr	N	N	O	O
的	uj	N	N	O	O
日志	ns	N	N	O	O

-	x	N	N	O	O

网易	n	N	N	O	O
博客	nr	N	N	O	O

又	d	N	N	O	O
是	v	N	N	O	O
一道	m	N	N	O	O
经典	n	N	N	O	O
题	n	N	N	O	O
，	x	N	N	O	O
数塔	n	N	N	O	O
的	uj	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
思想	n	Y	N	O	O
极容易	d	N	N	O	O
理解	v	N	N	O	O
，	x	N	N	O	O
是	v	N	N	O	O
一个	m	N	N	O	O
学	n	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
很好	a	N	N	O	O
的	uj	N	N	O	O
开端	n	N	N	O	O
例子	n	N	N	O	O
，	x	N	N	O	O
毕竟	d	N	N	O	O
不是	c	N	N	O	O
每个	r	N	N	O	O
人	n	N	N	O	O
都	d	N	N	O	O
可以	c	N	N	O	O
马上	d	N	N	O	O
理解	v	N	N	O	O
投	vn	N	N	O	O
0	m	N	N	B-KNOWLEDGE	O
-	x	N	N	I-KNOWLEDGE	O
1	x	N	N	I-KNOWLEDGE	O
背包	n	Y	N	I-KNOWLEDGE	B-KNOWLEDGE
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdlib	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

t	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
t	x	N	N	O	O
>	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

system	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
pause	eng	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

代码	n	N	N	O	O
短	a	N	N	O	O
，	x	N	N	O	O
记得	v	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
自下而上	l	N	N	O	O
，	x	N	N	O	O
有点	n	N	N	O	O
把	p	N	N	O	O
平常	a	N	N	O	O
思维	n	N	N	O	O
倒	v	N	N	O	O
过来	t	N	N	O	O
的	uj	N	N	O	O
味道	n	N	N	O	O
，	x	N	N	O	O
逆	vg	N	N	O	O
着想	v	N	N	O	O
就	d	N	N	O	O
差不多	l	N	N	O	O
可以	c	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

例如	v	N	N	O	O
先	d	N	N	O	O
假设	vn	N	N	O	O
当	t	N	N	O	O
问题	n	N	N	O	O
的	uj	N	N	O	O
最优	d	N	N	O	O
解得	v	N	N	O	O
出来	v	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
那么	r	N	N	O	O
得出	v	N	N	O	O
最优	d	N	N	O	O
解的	nz	N	N	O	O
上	f	N	N	O	O
一步	m	N	N	O	O
也	d	N	N	O	O
必须	d	N	N	O	O
是	v	N	N	O	O
最优	d	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
一步步	m	N	N	O	O
向上	d	N	N	O	O
找	v	N	N	O	O
，	x	N	N	O	O
那个	r	N	N	O	O
专业	n	N	N	O	O
一点	m	N	N	O	O
的	uj	N	N	O	O
名词	n	N	N	O	O
叫	v	N	N	O	O
什么	r	N	N	O	O
来	v	N	N	O	O
的	uj	N	N	O	O
?	x	N	N	O	O
?	x	N	N	O	O
?	x	N	N	O	O
貌似	v	N	N	O	O
是	v	N	N	O	O
“	x	N	N	O	O
最优	d	N	N	O	O
子结构	n	N	N	O	O
”	x	N	N	O	O
。	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

3517	m	N	N	I-OJ	O

-	x	N	N	O	O

Missa	eng	N	N	O	O

-	x	N	N	O	O

博客园	nr	N	N	O	O

约瑟夫	nrt	Y	N	B-KNOWLEDGE	O
环	v	N	N	I-KNOWLEDGE	O
问题	n	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
www	eng	N	N	O	O
.	m	N	N	O	O
cnblogs	eng	N	N	O	O
.	m	N	N	O	O
com	eng	N	N	O	O
/	x	N	N	O	O
alex4814	eng	N	N	O	O
/	x	N	N	O	O
archive	eng	N	N	O	O
/	x	N	N	O	O
2011	m	N	N	O	O
/	x	N	N	O	O
09	m	N	N	O	O
/	x	N	N	O	O
11	m	N	N	O	O
/	x	N	N	O	O
2173739.	m	N	N	O	O
html	eng	N	N	O	O

约瑟夫	nrt	Y	N	O	O
问题	n	N	N	O	O
：	x	N	N	O	O

用	p	N	N	O	O
数学方法	n	N	N	O	O
解	v	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
需要	v	N	N	O	O
注意	v	N	N	O	O
应当	v	N	N	O	O
从	p	N	N	O	O
0	m	N	N	O	O
开始	v	N	N	O	O
编号	n	N	N	O	O
，	x	N	N	O	O
因为	c	N	N	O	O
取余	v	N	N	O	O
会	v	N	N	O	O
等到	v	N	N	O	O
0	m	N	N	O	O
解	v	N	N	O	O
。	x	N	N	O	O

实质	n	N	N	O	O
是	v	N	N	O	O
一个	m	N	N	O	O
递推	v	Y	N	O	O
，	x	N	N	O	O
n	x	N	N	O	O
个人	n	N	N	O	O
中	f	N	N	O	O
最终	d	N	N	O	O
存活	vn	N	N	O	O
下来	t	N	N	O	O
的	uj	N	N	O	O
序号	n	N	N	O	O
与	p	N	N	O	O
n	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
个人	n	N	N	O	O
中	f	N	N	O	O
存活	vn	N	N	O	O
的	uj	N	N	O	O
人	n	N	N	O	O
的	uj	N	N	O	O
序号	n	N	N	O	O
有	v	N	N	O	O
一个	m	N	N	O	O
递推	v	Y	N	O	O
关系式	n	N	N	O	O
。	x	N	N	O	O

分析	vn	N	N	O	O
：	x	N	N	O	O

假设	vn	N	N	O	O
除去	t	N	N	O	O
第	m	N	N	O	O
k	eng	N	N	O	O
个人	n	N	N	O	O
。	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

2	x	N	N	O	O
,	x	N	N	O	O

3	x	N	N	O	O
,	x	N	N	O	O

...	m	N	N	O	O
,	x	N	N	O	O

k	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O

k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

k	x	N	N	O	O
,	x	N	N	O	O

...	m	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
original	eng	N	N	O	O

sequence	eng	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

2	x	N	N	O	O
,	x	N	N	O	O

3	x	N	N	O	O
,	x	N	N	O	O

...	m	N	N	O	O
,	x	N	N	O	O

k	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O

,	x	N	N	O	O

k	x	N	N	O	O
,	x	N	N	O	O

...	m	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
get	eng	N	N	O	O

rid	eng	N	N	O	O

of	eng	N	N	O	O

kth	eng	N	N	O	O

person	eng	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

k	x	N	N	O	O
,	x	N	N	O	O

k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O

...	m	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

...	m	N	N	O	O
,	x	N	N	O	O

k	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
rearrange	eng	N	N	O	O

the	eng	N	N	O	O

sequence	eng	N	N	O	O

(	x	N	N	O	O
3	x	N	N	O	O
)	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

...	m	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O

...	m	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
the	eng	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O

person	eng	N	N	O	O

(	x	N	N	O	O
4	x	N	N	O	O
)	x	N	N	O	O

我们	r	N	N	O	O
假设	vn	N	N	O	O
f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
的	uj	N	N	O	O
值为	v	N	N	O	O
n	eng	N	N	O	O
个人	n	N	N	O	O
中	f	N	N	O	O
最后	f	N	N	O	O
存活	vn	N	N	O	O
的	uj	N	N	O	O
人	n	N	N	O	O
的	uj	N	N	O	O
序号	n	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O

注意	v	N	N	O	O
到	v	N	N	O	O
(	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
式	k	N	N	O	O
(	x	N	N	O	O
3	x	N	N	O	O
)	x	N	N	O	O
式	k	N	N	O	O
(	x	N	N	O	O
4	x	N	N	O	O
)	x	N	N	O	O
式	k	N	N	O	O
其实	d	N	N	O	O
是	v	N	N	O	O
同一个	b	N	N	O	O
序列	n	Y	N	O	O
。	x	N	N	O	O

注意	v	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
式	k	N	N	O	O
和	c	N	N	O	O
(	x	N	N	O	O
4	x	N	N	O	O
)	x	N	N	O	O
式	k	N	N	O	O
，	x	N	N	O	O
是	v	N	N	O	O
同一个	b	N	N	O	O
问题	n	N	N	O	O
，	x	N	N	O	O
不同	a	N	N	O	O
的	uj	N	N	O	O
仅仅	d	N	N	O	O
是	v	N	N	O	O
人数	n	N	N	O	O
。	x	N	N	O	O

假设	vn	N	N	O	O
我们	r	N	N	O	O
已知	v	N	N	O	O
f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
即	v	N	N	O	O
(	x	N	N	O	O
4	x	N	N	O	O
)	x	N	N	O	O
式	k	N	N	O	O
中	f	N	N	O	O
最后	f	N	N	O	O
剩下	v	N	N	O	O
的	uj	N	N	O	O
人	n	N	N	O	O
的	uj	N	N	O	O
序号	n	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
(	x	N	N	O	O
3	x	N	N	O	O
)	x	N	N	O	O
式	k	N	N	O	O
所	u	N	N	O	O
对应	vn	N	N	O	O
的	uj	N	N	O	O
序号	n	N	N	O	O
，	x	N	N	O	O
就是	d	N	N	O	O
f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
即	v	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
式	k	N	N	O	O
n	eng	N	N	O	O
个人	n	N	N	O	O
中	f	N	N	O	O
最后	f	N	N	O	O
存活	vn	N	N	O	O
的	uj	N	N	O	O
序号	n	N	N	O	O
。	x	N	N	O	O

而	c	N	N	O	O
从	p	N	N	O	O
(	x	N	N	O	O
3	x	N	N	O	O
)	x	N	N	O	O
(	x	N	N	O	O
4	x	N	N	O	O
)	x	N	N	O	O
式	k	N	N	O	O
中	f	N	N	O	O
我们	r	N	N	O	O
不难	d	N	N	O	O
发现	v	N	N	O	O
有	v	N	N	O	O
这样	r	N	N	O	O
一个	m	N	N	O	O
递推	v	Y	N	O	O
式	k	N	N	O	O
：	x	N	N	O	O

f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

+	x	N	N	O	O

k	x	N	N	O	O
)	x	N	N	O	O

%	x	N	N	O	O

n	x	N	N	O	O

显然	ad	N	N	O	O
，	x	N	N	O	O
f	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
。	x	N	N	O	O

于是	c	N	N	O	O
递推	v	Y	N	O	O
得	ud	N	N	O	O
f	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

View	eng	N	N	O	O

Code	eng	N	N	O	O

1	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

File	eng	N	N	O	O

Name	eng	N	N	O	O
:	x	N	N	O	O

3517.	m	N	N	O	O
cpp	eng	N	N	O	O

2	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

Author	eng	N	N	O	O
:	x	N	N	O	O

Missa	eng	N	N	O	O

3	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

Created	eng	N	N	O	O

Time	eng	N	N	O	O
:	x	N	N	O	O

2013	m	N	N	O	I-OJ
/	x	N	N	O	O
2	x	N	N	O	O
/	x	N	N	O	O
15	m	N	N	O	O

星期五	t	N	N	O	O

20	m	N	N	O	O
:	x	N	N	O	O
22	m	N	N	O	O
:	x	N	N	O	O
11	m	N	N	O	O

4	x	N	N	O	O

5	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

6	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

7	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

8	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

9	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cmath	eng	N	N	O	O
>	x	N	N	O	O

10	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

11	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stack	eng	N	N	O	O
>	x	N	N	O	O

12	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

13	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
vector	eng	N	N	O	O
>	x	N	N	O	O

14	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdlib	eng	N	N	O	O
>	x	N	N	O	O

15	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
map	eng	N	N	O	O
>	x	N	N	O	O

16	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
set	eng	N	N	O	O
>	x	N	N	O	O

17	m	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

18	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

CL	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
v	x	N	N	O	O
)	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
v	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

19	m	N	N	O	O

20	m	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

21	m	N	N	O	O

22	m	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

23	m	N	N	O	O

{	x	N	N	O	O

24	m	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
~	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
k	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

25	m	N	N	O	O

{	x	N	N	O	O

26	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

27	m	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

28	m	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

29	m	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

30	m	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

31	m	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

32	m	N	N	O	O

}	x	N	N	O	O

33	m	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

34	m	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

1013	m	N	N	I-OJ	O

-	x	N	N	O	O

XtestW	eng	N	N	O	O
的	uj	N	N	O	O
日志	ns	N	N	O	O

-	x	N	N	O	O

网易	n	N	N	O	O
博客	nr	N	N	O	O

1013	m	N	N	O	O

一	m	N	N	O	O
开始	v	N	N	O	O
的	uj	N	N	O	O
算法	n	Y	N	O	O
是	v	N	N	O	O
even	eng	N	N	O	O
时	n	N	N	O	O
每个	r	N	N	O	O
赋值	n	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
，	x	N	N	O	O
即必	d	N	N	O	O
为	p	N	N	O	O
真币	n	N	N	O	O
，	x	N	N	O	O
不是	c	N	N	O	O
“	x	N	N	O	O
even	eng	N	N	O	O
”	x	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
，	x	N	N	O	O
重	a	N	N	O	O
的	uj	N	N	O	O
赋值	n	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
轻	a	N	N	O	O
的	uj	N	N	O	O
赋值	n	N	N	O	O
为	p	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
（	x	N	N	O	O
初始化	l	N	N	O	O
所有	b	N	N	O	O
为	p	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O

最后	f	N	N	O	O
扫描	v	Y	N	O	O
一遍	m	N	N	O	O
，	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	m	N	N	O	O
中	f	N	N	O	O
必	d	N	N	O	O
有	v	N	N	O	O
一个	m	N	N	O	O
只	d	N	N	O	O
出现	v	N	N	O	O
一次	m	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
那个	r	N	N	O	O
就是	d	N	N	O	O
假币	n	N	N	O	O
，	x	N	N	O	O
后来	t	N	N	O	O
WA	eng	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

改	v	N	N	O	O
了	ul	N	N	O	O
算法	n	Y	N	O	O
，	x	N	N	O	O
初始化	l	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
，	x	N	N	O	O
even	eng	N	N	O	O
赋值	n	N	N	O	O
为	p	N	N	O	O
1000	m	N	N	O	O
，	x	N	N	O	O
必为	d	N	N	O	O
真币	n	N	N	O	O
，	x	N	N	O	O
不是	c	N	N	O	O
even	eng	N	N	O	O
的	uj	N	N	O	O
重	a	N	N	O	O
的	uj	N	N	O	O
加	v	N	N	O	O
1	m	N	N	O	O
，	x	N	N	O	O
轻	a	N	N	O	O
的	uj	N	N	O	O
减	v	N	N	O	O
1	m	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
最后	f	N	N	O	O
扫描	v	Y	N	O	O
一遍	m	N	N	O	O
，	x	N	N	O	O
不是	c	N	N	O	O
1000	m	N	N	O	O
的	uj	N	N	O	O
中得	ns	N	N	O	O
绝对值	l	N	N	O	O
最大	a	Y	N	O	O
的	uj	N	N	O	O
那个	r	N	N	O	O
是	v	N	N	O	O
假币	n	N	N	O	O
，	x	N	N	O	O
正的	d	N	N	O	O
重	a	N	N	O	O
，	x	N	N	O	O
负	v	N	N	O	O
的	uj	N	N	O	O
轻	a	N	N	O	O
，	x	N	N	O	O
AC	eng	N	N	O	O
鸟	n	N	N	O	O
~	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
math	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
12	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

str1	eng	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

str2	eng	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

str3	eng	N	N	O	O
[	x	N	N	O	O
5	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

*	x	N	N	O	O
str	eng	Y	N	O	O
=	x	N	N	O	O
"	x	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
must	eng	N	N	O	O

char	eng	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

tt	eng	N	N	O	O
,	x	N	N	O	O
mm	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
min	eng	N	N	O	O
,	x	N	N	O	O
flag	eng	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
12	m	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
3	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O

%	x	N	N	O	O
s	x	N	N	O	O

%	x	N	N	O	O
s	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
str1	eng	N	N	O	O
,	x	N	N	O	O
str2	eng	N	N	O	O
,	x	N	N	O	O
str3	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
strcmp	eng	N	N	O	O
(	x	N	N	O	O
str3	eng	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
even	eng	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
strlen	eng	N	N	O	O
(	x	N	N	O	O
str1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
str1	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1000	m	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
strlen	eng	N	N	O	O
(	x	N	N	O	O
str2	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
str2	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1000	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
strcmp	eng	N	N	O	O
(	x	N	N	O	O
str3	eng	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
up	eng	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
strlen	eng	N	N	O	O
(	x	N	N	O	O
str1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
str1	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
1000	m	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
str1	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
strlen	eng	N	N	O	O
(	x	N	N	O	O
str2	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
str2	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
1000	m	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
str2	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
strcmp	eng	N	N	O	O
(	x	N	N	O	O
str3	eng	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
down	eng	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
strlen	eng	N	N	O	O
(	x	N	N	O	O
str1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
str1	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
1000	m	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
str1	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
strlen	eng	N	N	O	O
(	x	N	N	O	O
str2	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
str2	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
1000	m	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
str2	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
12	m	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1000	m	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
abs	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
abs	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

flag	eng	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
flag	eng	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

str	eng	Y	N	O	O
=	x	N	N	O	O
"	x	N	N	O	O
heavy	eng	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

str	eng	Y	N	O	O
=	x	N	N	O	O
"	x	N	N	O	O
light	eng	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
c	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

counterfeit	eng	N	N	O	O

coin	eng	N	N	O	O

and	eng	N	N	O	O

it	eng	N	N	O	O

is	eng	N	N	O	O

%	x	N	N	O	O
s	eng	N	N	O	O
.	m	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
flag	eng	N	N	O	O
+	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
,	x	N	N	O	O
str	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
字典	n	N	N	B-KNOWLEDGE	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE	I-KNOWLEDGE
模版	v	N	N	O	O
(	x	N	N	O	O
T9	eng	N	N	O	O

PKU	eng	N	Y	B-OJ	B-OJ

1451	m	N	N	I-OJ	O
)	x	N	N	O	O
_	x	N	N	O	O
piratehome	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

字典	n	N	N	B-KNOWLEDGE	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE	I-KNOWLEDGE
模版	v	N	N	O	O
(	x	N	N	O	O
T9	eng	N	N	O	O

PKU	eng	N	Y	B-OJ	B-OJ

1451	m	N	N	I-OJ	O
)	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

"	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
"	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

"	x	N	N	O	O
iostream	eng	N	N	O	O
"	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

dir	eng	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

3	x	N	N	O	O
,	x	N	N	O	O
4	x	N	N	O	O
,	x	N	N	O	O
5	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

6	x	N	N	O	O
,	x	N	N	O	O
7	x	N	N	O	O
,	x	N	N	O	O
8	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

9	x	N	N	O	O
,	x	N	N	O	O
10	m	N	N	O	O
,	x	N	N	O	O
11	m	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

12	m	N	N	O	O
,	x	N	N	O	O
13	m	N	N	O	O
,	x	N	N	O	O
14	m	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

15	m	N	N	O	O
,	x	N	N	O	O
16	m	N	N	O	O
,	x	N	N	O	O
17	m	N	N	O	O
,	x	N	N	O	O
18	m	N	N	O	O
,	x	N	N	O	O

19	m	N	N	O	O
,	x	N	N	O	O
20	m	N	N	O	O
,	x	N	N	O	O
21	m	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

22	m	N	N	O	O
,	x	N	N	O	O
23	m	N	N	O	O
,	x	N	N	O	O
24	m	N	N	O	O
,	x	N	N	O	O
25	m	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

nowp	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

maxsum	eng	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

strp	eng	N	N	O	O
[	x	N	N	O	O
150	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

typedef	eng	N	N	O	O

struct	eng	N	N	O	O

Node	eng	N	N	O	O

{	x	N	N	O	O

Node	eng	N	N	O	O
*	x	N	N	O	O

letter	eng	N	N	O	O
[	x	N	N	O	O
26	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

frq	eng	N	N	O	O
[	x	N	N	O	O
26	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
*	x	N	N	O	O
DicTree	eng	N	N	O	O
,	x	N	N	O	O
Node	eng	N	N	O	O
;	x	N	N	O	O

DicTree	eng	N	N	O	O

NewTree	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

DicTree	eng	N	N	O	O

DicT	eng	N	N	O	O
;	x	N	N	O	O

DicT	eng	N	N	O	O
=	x	N	N	O	O
new	eng	N	N	O	O

Node	eng	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
letter	eng	N	N	O	O
,	x	N	N	O	O
NULL	eng	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
letter	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
frq	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
frq	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

DicT	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

BuiltTree	eng	N	N	O	O
(	x	N	N	O	O
DicTree	eng	N	N	O	O

&	x	N	N	O	O
DicT	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

DicT	eng	N	N	O	O
=	x	N	N	O	O
NewTree	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

DicTree	eng	N	N	O	O

InsetLetter	eng	N	N	O	O
(	x	N	N	O	O
DicTree	eng	N	N	O	O

&	x	N	N	O	O
DicT	eng	N	N	O	O
,	x	N	N	O	O
char	eng	N	N	O	O

les	eng	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

frqu	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
letter	eng	N	N	O	O
[	x	N	N	O	O
les	eng	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
a	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
NULL	eng	N	N	O	O
)	x	N	N	O	O

DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
letter	eng	N	N	O	O
[	x	N	N	O	O
les	eng	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
a	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
NewTree	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
frq	eng	N	N	O	O
[	x	N	N	O	O
les	eng	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
a	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
frqu	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
letter	eng	N	N	O	O
[	x	N	N	O	O
les	eng	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
a	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

InsetString	eng	N	N	O	O
(	x	N	N	O	O
DicTree	eng	N	N	O	O

&	x	N	N	O	O
DicT	eng	N	N	O	O
,	x	N	N	O	O
char	eng	N	N	O	O

str	eng	Y	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

frqu	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

DicTree	eng	N	N	O	O

TempTree	eng	N	N	O	O
=	x	N	N	O	O
DicT	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

str	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
\	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

TempTree	eng	N	N	O	O
=	x	N	N	O	O
InsetLetter	eng	N	N	O	O
(	x	N	N	O	O
TempTree	eng	N	N	O	O
,	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
frqu	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

DelTree	eng	N	N	O	O
(	x	N	N	O	O
DicTree	eng	N	N	O	O

&	x	N	N	O	O
DicT	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
NULL	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
26	m	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

DelTree	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
letter	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

delete	eng	N	N	O	O

DicT	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

FindWords	eng	N	N	O	O
(	x	N	N	O	O
DicTree	eng	N	N	O	O

&	x	N	N	O	O
DicT	eng	N	N	O	O
,	x	N	N	O	O

char	eng	N	N	O	O

instr	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

char	eng	N	N	O	O

outstr	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

p	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

mx	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
nowp	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
mx	eng	N	N	O	O
>	x	N	N	O	O
maxsum	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

maxsum	eng	N	N	O	O
=	x	N	N	O	O
mx	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

strp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
outstr	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
=	x	N	N	O	O
instr	eng	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

have	eng	N	N	O	O
=	x	N	N	O	O
false	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
4	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dir	eng	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	m	N	N	O	O
&&	x	N	N	O	O

DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
frq	eng	N	N	O	O
[	x	N	N	O	O
dir	eng	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

outstr	eng	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
a	x	N	N	O	O
'	x	N	N	O	O
+	x	N	N	O	O
dir	eng	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

have	eng	N	N	O	O
|	x	N	N	O	O
=	x	N	N	O	O
FindWords	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
letter	eng	N	N	O	O
[	x	N	N	O	O
dir	eng	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
instr	eng	N	N	O	O
,	x	N	N	O	O
outstr	eng	N	N	O	O
,	x	N	N	O	O
p	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
DicT	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
frq	eng	N	N	O	O
[	x	N	N	O	O
dir	eng	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

have	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

cas	eng	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
fq	eng	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

len	eng	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
time	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O

DicTree	eng	N	N	O	O

DicT	eng	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

instr	eng	N	N	O	O
[	x	N	N	O	O
150	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
outstr	eng	N	N	O	O
[	x	N	N	O	O
150	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
150	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

have	eng	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
cas	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
cas	eng	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

time	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
Scenario	eng	N	N	O	O

#	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
:	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
time	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

BuiltTree	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
str	eng	Y	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
fq	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

InsetString	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
,	x	N	N	O	O
str	eng	Y	N	O	O
,	x	N	N	O	O
fq	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
instr	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

nowp	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

have	eng	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

len	eng	N	N	O	O
=	x	N	N	O	O
strlen	eng	N	N	O	O
(	x	N	N	O	O
instr	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
<	x	N	N	O	O
len	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
have	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

nowp	eng	N	N	O	O
=	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

maxsum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

have	eng	N	N	O	O
=	x	N	N	O	O
FindWords	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
,	x	N	N	O	O
instr	eng	N	N	O	O
,	x	N	N	O	O
outstr	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
have	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
c	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
strp	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
MANUALLY	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

DelTree	eng	N	N	O	O
(	x	N	N	O	O
DicT	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj2181	eng	N	Y	B-OJ	B-OJ
-	x	N	N	O	O
-	x	N	N	O	O
Jumping	eng	N	N	O	O

Cows	eng	N	N	O	O
（	x	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
）	x	N	N	O	O
_	x	N	N	O	O
易川	nr	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

Description	eng	N	N	O	O

Farmer	eng	N	N	O	O

John	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

cows	eng	N	N	O	O

would	eng	N	N	O	O

like	eng	N	N	O	O

to	eng	N	N	O	O

jump	eng	N	N	O	O

over	eng	N	N	O	O

the	eng	N	N	O	O

moon	eng	N	N	O	O
,	x	N	N	O	O

just	eng	N	N	O	O

like	eng	N	N	O	O

the	eng	N	N	O	O

cows	eng	N	N	O	O

in	eng	Y	N	O	O

their	eng	N	N	O	O

favorite	eng	N	N	O	O

nursery	eng	N	N	O	O

rhyme	eng	N	N	O	O
.	m	N	N	O	O

Unfortunately	eng	N	N	O	O
,	x	N	N	O	O

cows	eng	N	N	O	O

can	eng	N	N	O	O

not	eng	N	N	O	O

jump	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

local	eng	N	N	O	O

witch	eng	N	N	O	O

doctor	eng	N	N	O	O

has	eng	Y	N	O	O

mixed	eng	N	N	O	O

up	eng	N	N	O	O

P	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

P	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

150	m	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
)	x	N	N	O	O

potions	eng	N	N	O	O

to	eng	N	N	O	O

aid	eng	N	N	O	O

the	eng	N	N	O	O

cows	eng	N	N	O	O

in	eng	Y	N	O	O

their	eng	N	N	O	O

quest	eng	N	N	O	O

to	eng	N	N	O	O

jump	eng	N	N	O	O
.	m	N	N	O	O

These	eng	N	N	O	O

potions	eng	N	N	O	O

must	eng	N	N	O	O

be	eng	Y	N	O	O

administered	eng	N	N	O	O

exactly	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

order	eng	N	N	O	O

they	eng	N	N	O	O

were	eng	N	N	O	O

created	eng	N	N	O	O
,	x	N	N	O	O

though	eng	N	N	O	O

some	eng	N	N	O	O

may	eng	N	N	O	O

be	eng	Y	N	O	O

skipped	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

potion	eng	N	N	O	O

has	eng	Y	N	O	O

a	x	N	N	O	O

'	x	N	N	O	O
strength	eng	N	N	O	O
'	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

strength	eng	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

500	m	N	N	O	O
)	x	N	N	O	O

that	eng	N	N	O	O

enhances	eng	N	N	O	O

the	eng	N	N	O	O

cows	eng	N	N	O	O
'	x	N	N	O	O

jumping	eng	N	N	O	O

ability	eng	N	N	O	O
.	m	N	N	O	O

Taking	eng	N	N	O	O

a	x	N	N	O	O

potion	eng	N	N	O	O

during	eng	N	N	O	O

an	eng	Y	N	O	O

odd	eng	N	N	O	O

time	eng	N	N	O	O

step	eng	N	N	O	O

increases	eng	N	N	O	O

the	eng	N	N	O	O

cows	eng	N	N	O	O
'	x	N	N	O	O

jump	eng	N	N	O	O
;	x	N	N	O	O

taking	eng	N	N	O	O

a	x	N	N	O	O

potion	eng	N	N	O	O

during	eng	N	N	O	O

an	eng	Y	N	O	O

even	eng	N	N	O	O

time	eng	N	N	O	O

step	eng	N	N	O	O

decreases	eng	N	N	O	O

the	eng	N	N	O	O

jump	eng	N	N	O	O
.	m	N	N	O	O

Before	eng	N	N	O	O

taking	eng	N	N	O	O

any	eng	N	N	O	O

potions	eng	N	N	O	O

the	eng	N	N	O	O

cows	eng	N	N	O	O
'	x	N	N	O	O

jumping	eng	N	N	O	O

ability	eng	N	N	O	O

is	eng	N	N	O	O
,	x	N	N	O	O

of	eng	N	N	O	O

course	eng	N	N	O	O
,	x	N	N	O	O

0.	m	N	N	O	O

No	eng	N	N	O	O

potion	eng	N	N	O	O

can	eng	N	N	O	O

be	eng	Y	N	O	O

taken	eng	N	N	O	O

twice	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

once	eng	N	N	O	O

the	eng	N	N	O	O

cow	eng	N	N	O	O

has	eng	Y	N	O	O

begun	eng	N	N	O	O

taking	eng	N	N	O	O

potions	eng	N	N	O	O
,	x	N	N	O	O

one	eng	N	N	O	O

potion	eng	N	N	O	O

must	eng	N	N	O	O

be	eng	Y	N	O	O

taken	eng	N	N	O	O

during	eng	N	N	O	O

each	eng	N	N	O	O

time	eng	N	N	O	O

step	eng	N	N	O	O
,	x	N	N	O	O

starting	eng	N	N	O	O

at	eng	N	N	O	O

time	eng	N	N	O	O

1.	m	N	N	O	O

One	eng	N	N	O	O

or	eng	Y	N	O	O

more	eng	N	N	O	O

potions	eng	N	N	O	O

may	eng	N	N	O	O

be	eng	Y	N	O	O

skipped	eng	N	N	O	O

in	eng	Y	N	O	O

each	eng	N	N	O	O

turn	eng	N	N	O	O
.	m	N	N	O	O

Determine	eng	N	N	O	O

which	eng	N	N	O	O

potions	eng	N	N	O	O

to	eng	N	N	O	O

take	eng	N	N	O	O

to	eng	N	N	O	O

get	eng	N	N	O	O

the	eng	N	N	O	O

highest	eng	N	N	O	O

jump	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

*	x	N	N	O	O

Line	eng	N	N	O	O

1	x	N	N	O	O
:	x	N	N	O	O

A	x	N	N	O	O

single	eng	N	N	O	O

integer	eng	N	N	O	O
,	x	N	N	O	O

P	x	N	N	O	O

*	x	N	N	O	O

Lines	eng	N	N	O	O

2..	m	N	N	O	O
P	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
:	x	N	N	O	O

Each	eng	N	N	O	O

line	eng	N	N	O	O

contains	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

integer	eng	N	N	O	O

that	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

strength	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

potion	eng	N	N	O	O
.	m	N	N	O	O

Line	eng	N	N	O	O

2	x	N	N	O	O

gives	eng	N	N	O	O

the	eng	N	N	O	O

strength	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

potion	eng	N	N	O	O
;	x	N	N	O	O

line	eng	N	N	O	O

3	x	N	N	O	O

gives	eng	N	N	O	O

the	eng	N	N	O	O

strength	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

second	eng	N	N	O	O

potion	eng	N	N	O	O
;	x	N	N	O	O

and	eng	N	N	O	O

so	eng	N	N	O	O

on	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

*	x	N	N	O	O

Line	eng	N	N	O	O

1	x	N	N	O	O
:	x	N	N	O	O

A	x	N	N	O	O

single	eng	N	N	O	O

integer	eng	N	N	O	O

that	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

maximum	eng	N	N	O	O

possible	eng	N	N	O	O

jump	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

8	x	N	N	O	O

7	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

8	x	N	N	O	O

4	x	N	N	O	O

3	x	N	N	O	O

5	x	N	N	O	O

6	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

17	m	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O

题意	n	N	N	O	O
是	v	N	N	O	O
有	v	N	N	O	O
P	eng	N	N	O	O
瓶	n	N	N	O	O
魔法	n	N	N	O	O
药水	n	N	N	O	O
，	x	N	N	O	O
能	v	N	N	O	O
让	v	N	N	O	O
牛	n	N	N	O	O
每次	r	N	N	O	O
跳	v	N	N	O	O
的	uj	N	N	O	O
高度	n	Y	N	O	O
相应	v	N	N	O	O
的	uj	N	N	O	O
增加	v	N	N	O	O
或	c	N	N	O	O
减少	v	N	N	O	O
。	x	N	N	O	O

有	v	N	N	O	O
头牛	n	N	N	O	O
每	r	N	N	O	O
跳	v	N	N	O	O
一步	m	N	N	O	O
喝	vg	N	N	O	O
一瓶	m	N	N	O	O
，	x	N	N	O	O
当	p	N	N	O	O
它	r	N	N	O	O
跳	v	N	N	O	O
的	uj	N	N	O	O
是	v	N	N	O	O
第奇	nz	N	N	O	O
数步	m	N	N	O	O
，	x	N	N	O	O
跳	v	N	N	O	O
的	uj	N	N	O	O
高度	n	Y	N	O	O
增加	v	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
如果	c	N	N	O	O
是	v	N	N	O	O
第	m	N	N	O	O
偶数	n	N	N	O	O
步	n	N	N	O	O
，	x	N	N	O	O
跳	v	N	N	O	O
得	ud	N	N	O	O
高度	n	Y	N	O	O
就	d	N	N	O	O
减少	v	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
问	n	N	N	O	O
怎样	r	N	N	O	O
合理安排	n	N	N	O	O
，	x	N	N	O	O
让	v	N	N	O	O
牛	n	N	N	O	O
跳	v	N	N	O	O
得	ud	N	N	O	O
更	d	N	N	O	O
高	a	N	N	O	O
？	x	N	N	O	O

·	x	N	N	O	O

#	x	N	N	O	O

include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

·	x	N	N	O	O

#	x	N	N	O	O

include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

·	x	N	N	O	O

int	eng	N	N	O	O

h1	eng	N	N	O	O
[	x	N	N	O	O
200000	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
h2	eng	N	N	O	O
[	x	N	N	O	O
200000	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
h1	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
h2	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
分别	d	N	N	O	O
记录	n	Y	N	O	O
喝	vg	N	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
瓶	n	N	N	O	O
药水	n	N	N	O	O
时	n	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
是	v	N	N	O	O
奇	ag	N	N	O	O
数步	m	N	N	O	O
时	ng	N	N	O	O
的	uj	N	N	O	O
高度	n	Y	N	O	O
和	c	N	N	O	O
是	v	N	N	O	O
偶数	n	N	N	O	O
步时	n	N	N	O	O
的	uj	N	N	O	O
高度	n	Y	N	O	O
!	x	N	N	O	O
!	x	N	N	O	O
!	x	N	N	O	O

·	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
200000	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

·	x	N	N	O	O

{	x	N	N	O	O

·	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O
max1	eng	N	N	O	O
,	x	N	N	O	O
max2	eng	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
p	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

·	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
h1	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
h1	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
h2	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
h2	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

·	x	N	N	O	O

{	x	N	N	O	O

·	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

·	x	N	N	O	O

{	x	N	N	O	O

·	x	N	N	O	O

h1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

h2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

}	x	N	N	O	O

·	x	N	N	O	O

else	eng	N	N	O	O

·	x	N	N	O	O

{	x	N	N	O	O

·	x	N	N	O	O

h1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
h2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
是	v	N	N	O	O
奇	ag	N	N	O	O
数步	m	N	N	O	O
，	x	N	N	O	O
那	r	N	N	O	O
该	r	N	N	O	O
步	q	N	N	O	O
的	uj	N	N	O	O
高度	n	Y	N	O	O
为	p	N	N	O	O
前	f	N	N	O	O
偶数	n	N	N	O	O
步	n	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
h1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
h1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

·	x	N	N	O	O

h1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
h1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

h2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
h1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
如果	c	N	N	O	O
是	v	N	N	O	O
偶数	n	N	N	O	O
步	n	N	N	O	O
，	x	N	N	O	O
那	r	N	N	O	O
该	r	N	N	O	O
步	q	N	N	O	O
的	uj	N	N	O	O
高度	n	Y	N	O	O
为	p	N	N	O	O
前	f	N	N	O	O
奇	v	N	N	O	O
数步	m	N	N	O	O
-	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
h2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
h2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

·	x	N	N	O	O

h2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
h2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

}	x	N	N	O	O

·	x	N	N	O	O

·	x	N	N	O	O

}	x	N	N	O	O

·	x	N	N	O	O

max1	eng	N	N	O	O
=	x	N	N	O	O
max2	eng	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

·	x	N	N	O	O

{	x	N	N	O	O

·	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
max1	eng	N	N	O	O
<	x	N	N	O	O
h1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

·	x	N	N	O	O

max1	eng	N	N	O	O
=	x	N	N	O	O
h1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
max2	eng	N	N	O	O
<	x	N	N	O	O
h2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

·	x	N	N	O	O

max2	eng	N	N	O	O
=	x	N	N	O	O
h2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

}	x	N	N	O	O

·	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
max1	eng	N	N	O	O
<	x	N	N	O	O
max2	eng	N	N	O	O
)	x	N	N	O	O

·	x	N	N	O	O

max1	eng	N	N	O	O
=	x	N	N	O	O
max2	eng	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
max1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

·	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

2379	m	N	N	I-OJ	O

ACM	eng	N	N	O	O

Rank	eng	N	N	O	O

Table	eng	N	N	O	O
(	x	N	N	O	O
数据结构	n	N	N	O	O
)	x	N	N	O	O
_	x	N	N	O	O
奔跑	v	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

Description	eng	N	N	O	O

ACM	eng	N	N	O	O

contests	eng	N	N	O	O
,	x	N	N	O	O

like	eng	N	N	O	O

the	eng	N	N	O	O

one	eng	N	N	O	O

you	eng	N	N	O	O

are	eng	N	N	O	O

participating	eng	N	N	O	O

in	eng	Y	N	O	O
,	x	N	N	O	O

are	eng	N	N	O	O

hosted	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

special	eng	N	N	O	O

software	eng	N	N	O	O
.	m	N	N	O	O

That	eng	N	N	O	O

software	eng	N	N	O	O
,	x	N	N	O	O

among	eng	N	N	O	O

other	eng	N	N	O	O

functions	eng	N	N	O	O
,	x	N	N	O	O

preforms	eng	N	N	O	O

a	x	N	N	O	O

job	eng	N	N	O	O

of	eng	N	N	O	O

accepting	eng	N	N	O	O

and	eng	N	N	O	O

evaluating	eng	N	N	O	O

teams	eng	N	N	O	O
'	x	N	N	O	O

solutions	eng	N	N	O	O

(	x	N	N	O	O
runs	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

displaying	eng	N	N	O	O

results	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

rank	eng	N	N	O	O

table	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

scoring	eng	N	N	O	O

rules	eng	N	N	O	O

are	eng	N	N	O	O

as	eng	Y	N	O	O

follows	eng	N	N	O	O
:	x	N	N	O	O

Each	eng	N	N	O	O

run	eng	N	N	O	O

is	eng	N	N	O	O

either	eng	N	N	O	O

accepted	eng	N	N	O	O

or	eng	Y	N	O	O

rejected	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

problem	eng	N	N	O	O

is	eng	N	N	O	O

considered	eng	N	N	O	O

solved	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

team	eng	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

one	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

runs	eng	N	N	O	O

submitted	eng	N	N	O	O

for	eng	Y	N	O	O

it	eng	N	N	O	O

is	eng	N	N	O	O

accepted	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

time	eng	N	N	O	O

consumed	eng	N	N	O	O

for	eng	Y	N	O	O

a	x	N	N	O	O

solved	eng	N	N	O	O

problem	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

time	eng	N	N	O	O

elapsed	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

beginning	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

contest	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

submission	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

accepted	eng	N	N	O	O

run	eng	N	N	O	O

for	eng	Y	N	O	O

this	eng	N	N	O	O

problem	eng	N	N	O	O

(	x	N	N	O	O
in	eng	Y	N	O	O

minutes	eng	N	N	O	O
)	x	N	N	O	O

plus	eng	N	N	O	O

20	m	N	N	O	O

minutes	eng	N	N	O	O

for	eng	Y	N	O	O

every	eng	N	N	O	O

other	eng	N	N	O	O

run	eng	N	N	O	O

for	eng	Y	N	O	O

this	eng	N	N	O	O

problem	eng	N	N	O	O

before	eng	N	N	O	O

the	eng	N	N	O	O

accepted	eng	N	N	O	O

one	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

an	eng	Y	N	O	O

unsolved	eng	N	N	O	O

problem	eng	N	N	O	O

consumed	eng	N	N	O	O

time	eng	N	N	O	O

is	eng	N	N	O	O

not	eng	N	N	O	O

computed	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

total	eng	N	N	O	O

time	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

sum	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

time	eng	N	N	O	O

consumed	eng	N	N	O	O

for	eng	Y	N	O	O

each	eng	N	N	O	O

problem	eng	N	N	O	O

solved	eng	N	N	O	O
.	m	N	N	O	O

Teams	eng	N	N	O	O

are	eng	N	N	O	O

ranked	eng	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

solved	eng	N	N	O	O

problems	eng	N	N	O	O
.	m	N	N	O	O

Teams	eng	N	N	O	O

that	eng	N	N	O	O

solve	eng	N	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

problems	eng	N	N	O	O

are	eng	N	N	O	O

ranked	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

least	eng	N	N	O	O

total	eng	N	N	O	O

time	eng	N	N	O	O
.	m	N	N	O	O

While	eng	N	N	O	O

the	eng	N	N	O	O

time	eng	N	N	O	O

shown	eng	N	N	O	O

is	eng	N	N	O	O

in	eng	Y	N	O	O

minutes	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

actual	eng	N	N	O	O

time	eng	N	N	O	O

is	eng	N	N	O	O

measured	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

precision	eng	N	N	O	O

of	eng	N	N	O	O

1	x	N	N	O	O

second	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

the	eng	N	N	O	O

seconds	eng	N	N	O	O

are	eng	N	N	O	O

taken	eng	N	N	O	O

into	eng	N	N	O	O

account	eng	N	N	O	O

when	eng	N	N	O	O

ranking	eng	N	N	O	O

teams	eng	N	N	O	O
.	m	N	N	O	O

Teams	eng	N	N	O	O

with	eng	N	N	O	O

equal	eng	N	N	O	O

rank	eng	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

above	eng	N	N	O	O

rules	eng	N	N	O	O

must	eng	N	N	O	O

be	eng	Y	N	O	O

sorted	eng	N	N	O	O

by	eng	N	N	O	O

increasing	eng	N	N	O	O

team	eng	N	N	O	O

number	eng	N	N	O	O
.	m	N	N	O	O

Your	eng	N	N	O	O

task	eng	N	N	O	O

is	eng	N	N	O	O
,	x	N	N	O	O

given	eng	N	N	O	O

the	eng	N	N	O	O

list	eng	N	N	O	O

of	eng	N	N	O	O

N	x	N	N	O	O

runs	eng	N	N	O	O

with	eng	N	N	O	O

submission	eng	N	N	O	O

time	eng	N	N	O	O

and	eng	N	N	O	O

result	eng	N	N	O	O

of	eng	N	N	O	O

each	eng	N	N	O	O

run	eng	N	N	O	O
,	x	N	N	O	O

compute	eng	N	N	O	O

the	eng	N	N	O	O

rank	eng	N	N	O	O

table	eng	N	N	O	O

for	eng	Y	N	O	O

C	x	N	N	O	O

teams	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

Input	eng	N	N	O	O

contains	eng	N	N	O	O

integer	eng	N	N	O	O

numbers	eng	N	N	O	O

C	x	N	N	O	O

N	x	N	N	O	O
,	x	N	N	O	O

followed	eng	N	N	O	O

by	eng	N	N	O	O

N	x	N	N	O	O

quartets	eng	N	N	O	O

of	eng	N	N	O	O

integes	eng	N	N	O	O

ci	eng	N	N	O	O

pi	eng	N	N	O	O

ti	eng	N	N	O	O

ri	eng	Y	N	O	O
,	x	N	N	O	O

where	eng	N	N	O	O

ci	eng	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

team	eng	N	N	O	O

number	eng	N	N	O	O
,	x	N	N	O	O

pi	eng	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

problem	eng	N	N	O	O

number	eng	N	N	O	O
,	x	N	N	O	O

ti	eng	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

submission	eng	N	N	O	O

time	eng	N	N	O	O

in	eng	Y	N	O	O

seconds	eng	N	N	O	O
,	x	N	N	O	O

ri	eng	Y	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

the	eng	N	N	O	O

run	eng	N	N	O	O

was	eng	N	N	O	O

accepted	eng	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O

otherwise	eng	N	N	O	O
.	m	N	N	O	O

1	x	N	N	O	O

≤	x	N	N	O	O

C	x	N	N	O	O
,	x	N	N	O	O

N	x	N	N	O	O

≤	x	N	N	O	O

1000	m	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O

≤	x	N	N	O	O

ci	eng	N	N	O	O

≤	x	N	N	O	O

C	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O

≤	x	N	N	O	O

pi	eng	N	N	O	O

≤	x	N	N	O	O

20	m	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O

≤	x	N	N	O	O

ti	eng	N	N	O	O

≤	x	N	N	O	O

36000.	m	N	N	O	O

Output	eng	N	N	O	O

Output	eng	N	N	O	O

must	eng	N	N	O	O

contain	eng	N	N	O	O

C	x	N	N	O	O

integers	eng	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

team	eng	N	N	O	O

numbers	eng	N	N	O	O

sorted	eng	N	N	O	O

by	eng	N	N	O	O

rank	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

3	x	N	N	O	O

3	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

3000	m	N	N	O	O

0	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

3100	m	N	N	O	I-OJ

1	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

4200	m	N	N	O	O

1	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

3	x	N	N	O	O

我	r	N	N	O	O
累	v	N	N	O	O
个	q	N	N	O	O
悲剧	n	N	N	O	O
诶	e	N	N	O	O
：	x	N	N	O	O
竟然	d	N	N	O	O
一直	d	N	N	O	O
都	d	N	N	O	O
理解	v	N	N	O	O
错题	n	N	N	O	O
意	n	N	N	O	O
：	x	N	N	O	O
关键	n	N	N	O	O
：	x	N	N	O	O
：	x	N	N	O	O
1	x	N	N	O	O
：	x	N	N	O	O
要	v	N	N	O	O
注意	v	N	N	O	O
输入	v	N	N	O	O
时间	n	N	N	O	O
并不一定	d	N	N	O	O
按	p	N	N	O	O
升序	n	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
要	v	N	N	O	O
对	p	N	N	O	O
输入	v	N	N	O	O
时间	n	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE
！	x	N	N	O	O
！	x	N	N	O	O

2	x	N	N	O	O
：	x	N	N	O	O
如果	c	N	N	O	O
做	v	N	N	O	O
题	n	N	N	O	O
数目	n	N	N	O	O
相同	d	N	N	O	O
，	x	N	N	O	O
按	p	N	N	O	O
所有	b	N	N	O	O
做	v	N	N	O	O
对	p	N	N	O	O
题目	n	Y	N	O	O
的	uj	N	N	O	O
时间	n	N	N	O	O
总和	n	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE
，	x	N	N	O	O
这样	r	N	N	O	O
才	d	N	N	O	O
叫	v	N	N	O	O
公平	n	Y	N	O	O
！	x	N	N	O	O
！	x	N	N	O	O

3	x	N	N	O	O
：	x	N	N	O	O
只有	c	N	N	O	O
该	r	N	N	O	O
题	n	N	N	O	O
接受	v	N	N	O	O
时	n	N	N	O	O
加罚	vn	N	N	O	O
时	ng	N	N	O	O
才	d	N	N	O	O
有效	a	Y	N	O	O
；	x	N	N	O	O
所以	c	N	N	O	O
要	v	N	N	O	O
注意	v	N	N	O	O
去	v	N	N	O	O
找到	v	N	N	O	O
没有	v	N	N	O	O
接收	v	N	N	O	O
的	uj	N	N	O	O
题	n	N	N	O	O
的	uj	N	N	O	O
加罚	vn	N	N	O	O
时	n	N	N	O	O
，	x	N	N	O	O
并	c	N	N	O	O
加以	v	N	N	O	O
忽略	d	N	N	O	O
；	x	N	N	O	O

4	x	N	N	O	O
：	x	N	N	O	O
最后	f	N	N	O	O
还要	c	N	N	O	O
注意	v	N	N	O	O
一道	m	N	N	O	O
题	n	N	N	O	O
也	d	N	N	O	O
没有	v	N	N	O	O
提交	v	N	N	O	O
的	uj	N	N	O	O
队	n	N	N	O	O
的	uj	N	N	O	O
队号	n	N	N	O	O
存储	j	N	N	O	O
！	x	N	N	O	O
！	x	N	N	O	O
！	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

struct	eng	N	N	O	O

stu1	eng	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

c1	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

p1	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

t1	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

r1	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
1150	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

stu2	eng	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

p	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
队号	n	N	N	O	O
；	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
[	x	N	N	O	O
25	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
解决	v	N	N	O	O
的	uj	N	N	O	O
题号	n	N	N	O	O
；	x	N	N	O	O

int	eng	N	N	O	O

num	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
解决	v	N	N	O	O
的	uj	N	N	O	O
题目	n	Y	N	O	O
数	n	N	N	O	O
；	x	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
用	p	N	N	O	O
的	uj	N	N	O	O
时间	n	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

r	x	N	N	O	O
[	x	N	N	O	O
25	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
对应	vn	N	N	O	O
题号	n	N	N	O	O
的	uj	N	N	O	O
加罚	vn	N	N	O	O
时间	n	N	N	O	O
；	x	N	N	O	O

}	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
1150	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cmp1	eng	N	N	O	O
(	x	N	N	O	O
const	eng	N	N	O	O

void	eng	N	N	O	O
*	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
const	eng	N	N	O	O

void	eng	N	N	O	O
*	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

struct	eng	N	N	O	O

stu1	eng	N	N	O	O

*	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
d	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

stu1	eng	N	N	O	O

*	x	N	N	O	O
)	x	N	N	O	O
a	x	N	N	O	O
;	x	N	N	O	O

d	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

stu1	eng	N	N	O	O

*	x	N	N	O	O
)	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t1	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t1	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t1	eng	N	N	O	O
-	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t1	eng	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

return	eng	N	N	O	O

c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
r1	eng	N	N	O	O
-	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
r1	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

cmp2	eng	N	N	O	O
(	x	N	N	O	O
const	eng	N	N	O	O

void	eng	N	N	O	O
*	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
const	eng	N	N	O	O

void	eng	N	N	O	O
*	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

struct	eng	N	N	O	O

stu2	eng	N	N	O	O

*	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
d	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

stu2	eng	N	N	O	O

*	x	N	N	O	O
)	x	N	N	O	O
a	x	N	N	O	O
;	x	N	N	O	O

d	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

stu2	eng	N	N	O	O

*	x	N	N	O	O
)	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
-	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
按	p	N	N	O	O
解决	v	N	N	O	O
题目	n	Y	N	O	O
数	n	N	N	O	O
排序	n	Y	N	O	O
；	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t	x	N	N	O	O
-	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
相同	d	N	N	O	O
题目	n	Y	N	O	O
数	m	N	N	O	O
按	p	N	N	O	O
时间	n	N	N	O	O
升序	n	N	N	O	O
排序	n	Y	N	O	O
；	x	N	N	O	O

else	eng	N	N	O	O

return	eng	N	N	O	O

c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
p	x	N	N	O	O
-	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
解决	v	N	N	O	O
题目	n	Y	N	O	O
数	n	N	N	O	O
相同	d	N	N	O	O
，	x	N	N	O	O
时间	n	N	N	O	O
也	d	N	N	O	O
相同	d	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
按	p	N	N	O	O
队号	n	N	N	O	O
排序	n	Y	N	O	O
；	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
c	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
n	eng	N	N	O	O
此	r	N	N	O	O
输入	v	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t1	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

qsort	eng	N	N	O	O
(	x	N	N	O	O
s1	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
cmp1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r1	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
没有	v	N	N	O	O
AC	eng	N	N	O	O
；	x	N	N	O	O

{	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
对应	vn	N	N	O	O
队号	n	N	N	O	O
的	uj	N	N	O	O
队号	n	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
m	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
1200	m	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
对应	vn	N	N	O	O
题号	n	N	N	O	O
加上	v	N	N	O	O
加罚	vn	N	N	O	O
时	n	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如	v	N	N	O	O
接受	v	N	N	O	O
；	x	N	N	O	O

{	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
m	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如	v	N	N	O	O
本	r	N	N	O	O
对	p	N	N	O	O
本题	n	N	N	O	O
是	v	N	N	O	O
第一次	m	N	N	O	O
提交	v	N	N	O	O
成功	a	N	N	O	O
；	x	N	N	O	O

{	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
m	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
输入	v	N	N	O	O
对应	vn	N	N	O	O
题号	n	N	N	O	O
；	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t1	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t1	eng	N	N	O	O
+	x	N	N	O	O
s	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
当前	t	N	N	O	O
时间	n	N	N	O	O
加上	v	N	N	O	O
加罚	vn	N	N	O	O
时	n	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
num	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
解决	v	N	N	O	O
题目	n	Y	N	O	O
数	m	N	N	O	O
加	v	N	N	O	O
一	m	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
c	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
将	d	N	N	O	O
没有	v	N	N	O	O
提交	v	N	N	O	O
过	ug	N	N	O	O
的	uj	N	N	O	O
队	n	N	N	O	O
的	uj	N	N	O	O
队号	n	N	N	O	O
打上	v	N	N	O	O
；	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
=	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

qsort	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
cmp2	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

"	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

1417	m	N	N	I-OJ	O

状态	n	Y	N	O	O
并	c	N	N	B-KNOWLEDGE	B-KNOWLEDGE
查集	v	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
+	x	N	N	O	O
背包	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
dp	eng	Y	N	B-KNOWLEDGE	O
_	x	N	N	O	O
C	eng	N	N	O	O
_	x	N	N	O	O
down	eng	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

这	r	N	N	O	O
题	n	N	N	O	O
纠结	v	N	N	O	O
了	ul	N	N	O	O
几天	m	N	N	O	O
，	x	N	N	O	O

不	d	N	N	O	O
解释	v	N	N	O	O
的	uj	N	N	O	O
30	m	N	N	O	O
+	x	N	N	O	O

才	d	N	N	O	O
A	eng	N	N	O	O

掉	zg	N	N	O	O
，	x	N	N	O	O

之前	f	N	N	O	O
一直	d	N	N	O	O
runtime	eng	N	N	O	O

搞	v	N	N	O	O
得	ud	N	N	O	O
我	r	N	N	O	O
一直	d	N	N	O	O
都	d	N	N	O	O
很	d	N	N	O	O
无	v	N	N	O	O
语	n	N	N	O	O
，	x	N	N	O	O
疯狂	a	N	N	O	O
提交	v	N	N	O	O
找	v	N	N	O	O
是	v	N	N	O	O
哪里	r	N	N	O	O
出	v	N	N	O	O
了	ul	N	N	O	O
问题	n	N	N	O	O
，	x	N	N	O	O

后来	t	N	N	O	O
静下来	l	N	N	O	O
后	f	N	N	O	O
，	x	N	N	O	O

把	p	N	N	O	O
程序	n	N	N	O	O
有读	v	N	N	O	O
了	ul	N	N	O	O
几遍	m	N	N	O	O
终于	d	N	N	O	O
找到	v	N	N	O	O
了	ul	N	N	O	O
错误	n	N	N	O	O
所在	b	N	N	O	O
，	x	N	N	O	O

不是	c	N	N	O	O
栈	n	N	N	B-KNOWLEDGE	B-KNOWLEDGE
溢出	v	N	N	O	O
，	x	N	N	O	O

也	d	N	N	O	O
不是	c	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

其实	d	N	N	O	O
就是	d	N	N	O	O
少	a	N	N	O	O
了	ul	N	N	O	O
个	q	N	N	O	O
符号	n	N	N	O	O

搞	v	N	N	O	O
得	ud	N	N	O	O
数组	n	Y	N	O	O
溢出	v	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

好	a	N	N	O	O
吧	y	N	N	O	O
，	x	N	N	O	O
辛辛苦苦	z	N	N	O	O
敲	v	N	N	O	O
了	ul	N	N	O	O
两百多	m	N	N	O	O
行	zg	N	N	O	O
，	x	N	N	O	O

没有	v	N	N	O	O
看	v	N	N	O	O
别人	r	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
其实	d	N	N	O	O
做	v	N	N	O	O
了	ul	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

1112	m	N	N	I-OJ	O

team	eng	N	N	O	O

them	eng	N	N	O	O

up	eng	N	N	O	O

和	c	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

1733	m	N	N	I-OJ	I-OJ

这	r	N	N	O	O
题	n	N	N	O	O
就	d	N	N	O	O
没	v	N	N	O	O
问题	n	N	N	O	O
，	x	N	N	O	O
要	v	N	N	O	O
的	uj	N	N	O	O
是	v	N	N	O	O
无限	v	Y	N	O	O
的	uj	N	N	O	O
耐心	a	N	N	O	O
，	x	N	N	O	O
和	c	N	N	O	O
纠结	v	N	N	O	O
再	d	N	N	O	O
纠结	v	N	N	O	O
...	m	N	N	O	O

True	eng	N	N	O	O

Liars	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

10000	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

1428	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

402	m	N	N	O	O

Description	eng	N	N	O	O

After	eng	N	N	O	O

having	eng	N	N	O	O

drifted	eng	N	N	O	O

about	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

small	eng	N	N	O	O

boat	eng	N	N	O	O

for	eng	Y	N	O	O

a	x	N	N	O	O

couple	eng	N	N	O	O

of	eng	N	N	O	O

days	eng	N	N	O	O
,	x	N	N	O	O

Akira	eng	N	N	O	O

Crusoe	eng	N	N	O	O

Maeda	eng	N	N	O	O

was	eng	N	N	O	O

finally	eng	N	N	O	O

cast	eng	N	N	O	O

ashore	eng	N	N	O	O

on	eng	N	N	O	O

a	x	N	N	O	O

foggy	eng	N	N	O	O

island	eng	N	N	O	O
.	m	N	N	O	O

Though	eng	N	N	O	O

he	eng	Y	N	O	O

was	eng	N	N	O	O

exhausted	eng	N	N	O	O

and	eng	N	N	O	O

despaired	eng	N	N	O	O
,	x	N	N	O	O

he	eng	Y	N	O	O

was	eng	N	N	O	O

still	eng	N	N	O	O

fortunate	eng	N	N	O	O

to	eng	N	N	O	O

remember	eng	N	N	O	O

a	x	N	N	O	O

legend	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

foggy	eng	N	N	O	O

island	eng	N	N	O	O
,	x	N	N	O	O

which	eng	N	N	O	O

he	eng	Y	N	O	O

had	eng	N	N	O	O

heard	eng	N	N	O	O

from	eng	N	N	O	O

patriarchs	eng	N	N	O	O

in	eng	Y	N	O	O

his	eng	N	N	O	O

childhood	eng	N	N	O	O
.	m	N	N	O	O

This	eng	N	N	O	O

must	eng	N	N	O	O

be	eng	Y	N	O	O

the	eng	N	N	O	O

island	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

legend	eng	N	N	O	O
.	m	N	N	O	O

In	eng	N	N	O	O

the	eng	N	N	O	O

legend	eng	N	N	O	O
,	x	N	N	O	O

two	eng	N	N	O	O

tribes	eng	N	N	O	O

have	eng	N	N	O	O

inhabited	eng	N	N	O	O

the	eng	N	N	O	O

island	eng	N	N	O	O
,	x	N	N	O	O

one	eng	N	N	O	O

is	eng	N	N	O	O

divine	eng	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

other	eng	N	N	O	O

is	eng	N	N	O	O

devilish	eng	N	N	O	O
,	x	N	N	O	O

once	eng	N	N	O	O

members	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

divine	eng	N	N	O	O

tribe	eng	N	N	O	O

bless	eng	N	N	O	O

you	eng	N	N	O	O
,	x	N	N	O	O

your	eng	N	N	O	O

future	eng	N	N	O	O

is	eng	N	N	O	O

bright	eng	N	N	O	O

and	eng	N	N	O	O

promising	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

your	eng	N	N	O	O

soul	eng	N	N	O	O

will	eng	N	N	O	O

eventually	eng	N	N	O	O

go	eng	N	N	O	O

to	eng	N	N	O	O

Heaven	eng	N	N	O	O
,	x	N	N	O	O

in	eng	Y	N	O	O

contrast	eng	N	N	O	O
,	x	N	N	O	O

once	eng	N	N	O	O

members	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

devilish	eng	N	N	O	O

tribe	eng	N	N	O	O

curse	eng	N	N	O	O

you	eng	N	N	O	O
,	x	N	N	O	O

your	eng	N	N	O	O

future	eng	N	N	O	O

is	eng	N	N	O	O

bleak	eng	N	N	O	O

and	eng	N	N	O	O

hopeless	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

your	eng	N	N	O	O

soul	eng	N	N	O	O

will	eng	N	N	O	O

eventually	eng	N	N	O	O

fall	eng	N	N	O	O

down	eng	N	N	O	O

to	eng	N	N	O	O

Hell	eng	N	N	O	O
.	m	N	N	O	O

In	eng	N	N	O	O

order	eng	N	N	O	O

to	eng	N	N	O	O

prevent	eng	N	N	O	O

the	eng	N	N	O	O

worst	eng	N	N	O	O
-	x	N	N	O	O
case	eng	N	N	O	O

scenario	eng	N	N	O	O
,	x	N	N	O	O

Akira	eng	N	N	O	O

should	eng	N	N	O	O

distinguish	eng	N	N	O	O

the	eng	N	N	O	O

devilish	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

divine	eng	N	N	O	O
.	m	N	N	O	O

But	eng	N	N	O	O

how	eng	N	N	O	O
?	x	N	N	O	O

They	eng	N	N	O	O

looked	eng	N	N	O	O

exactly	eng	N	N	O	O

alike	eng	N	N	O	O

and	eng	N	N	O	O

he	eng	Y	N	O	O

could	eng	N	N	O	O

not	eng	N	N	O	O

distinguish	eng	N	N	O	O

one	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

other	eng	N	N	O	O

solely	eng	N	N	O	O

by	eng	N	N	O	O

their	eng	N	N	O	O

appearances	eng	N	N	O	O
.	m	N	N	O	O

He	eng	N	N	O	O

still	eng	N	N	O	O

had	eng	N	N	O	O

his	eng	N	N	O	O

last	eng	N	N	O	O

hope	eng	N	N	O	O
,	x	N	N	O	O

however	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

members	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

divine	eng	N	N	O	O

tribe	eng	N	N	O	O

are	eng	N	N	O	O

truth	eng	N	N	O	O
-	x	N	N	O	O
tellers	eng	N	N	O	O
,	x	N	N	O	O

that	eng	N	N	O	O

is	eng	N	N	O	O
,	x	N	N	O	O

they	eng	N	N	O	O

always	eng	N	N	O	O

tell	eng	N	N	O	O

the	eng	N	N	O	O

truth	eng	N	N	O	O

and	eng	N	N	O	O

those	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

devilish	eng	N	N	O	O

tribe	eng	N	N	O	O

are	eng	N	N	O	O

liars	eng	N	N	O	O
,	x	N	N	O	O

that	eng	N	N	O	O

is	eng	N	N	O	O
,	x	N	N	O	O

they	eng	N	N	O	O

always	eng	N	N	O	O

tell	eng	N	N	O	O

a	x	N	N	O	O

lie	eng	N	N	O	O
.	m	N	N	O	O

He	eng	N	N	O	O

asked	eng	N	N	O	O

some	eng	N	N	O	O

of	eng	N	N	O	O

them	eng	N	N	O	O

whether	eng	N	N	O	O

or	eng	Y	N	O	O

not	eng	N	N	O	O

some	eng	N	N	O	O

are	eng	N	N	O	O

divine	eng	N	N	O	O
.	m	N	N	O	O

They	eng	N	N	O	O

knew	eng	N	N	O	O

one	eng	N	N	O	O

another	eng	N	N	O	O

very	eng	N	N	O	O

much	eng	N	N	O	O

and	eng	N	N	O	O

always	eng	N	N	O	O

responded	eng	N	N	O	O

to	eng	N	N	O	O

him	eng	N	N	O	O

"	x	N	N	O	O
faithfully	eng	N	N	O	O
"	x	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

their	eng	N	N	O	O

individual	eng	N	N	O	O

natures	eng	N	N	O	O

(	x	N	N	O	O
i	eng	N	N	O	O
.	m	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
,	x	N	N	O	O

they	eng	N	N	O	O

always	eng	N	N	O	O

tell	eng	N	N	O	O

the	eng	N	N	O	O

truth	eng	N	N	O	O

or	eng	Y	N	O	O

always	eng	N	N	O	O

a	x	N	N	O	O

lie	eng	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O

He	eng	N	N	O	O

did	eng	N	N	O	O

not	eng	N	N	O	O

dare	eng	N	N	O	O

to	eng	N	N	O	O

ask	eng	N	N	O	O

any	eng	N	N	O	O

other	eng	N	N	O	O

forms	eng	N	N	O	O

of	eng	N	N	O	O

questions	eng	N	N	O	O
,	x	N	N	O	O

since	eng	N	N	O	O

the	eng	N	N	O	O

legend	eng	N	N	O	O

says	eng	N	N	O	O

that	eng	N	N	O	O

a	x	N	N	O	O

devilish	eng	N	N	O	O

member	eng	N	N	O	O

would	eng	N	N	O	O

curse	eng	N	N	O	O

a	x	N	N	O	O

person	eng	N	N	O	O

forever	eng	N	N	O	O

when	eng	N	N	O	O

he	eng	Y	N	O	O

did	eng	N	N	O	O

not	eng	N	N	O	O

like	eng	N	N	O	O

the	eng	N	N	O	O

question	eng	N	N	O	O
.	m	N	N	O	O

He	eng	N	N	O	O

had	eng	N	N	O	O

another	eng	N	N	O	O

piece	eng	N	N	O	O

of	eng	N	N	O	O

useful	eng	N	N	O	O

informationf	eng	N	N	O	O

the	eng	N	N	O	O

legend	eng	N	N	O	O

tells	eng	N	N	O	O

the	eng	N	N	O	O

populations	eng	N	N	O	O

of	eng	N	N	O	O

both	eng	N	N	O	O

tribes	eng	N	N	O	O
.	m	N	N	O	O

These	eng	N	N	O	O

numbers	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

legend	eng	N	N	O	O

are	eng	N	N	O	O

trustworthy	eng	N	N	O	O

since	eng	N	N	O	O

everyone	eng	N	N	O	O

living	eng	N	N	O	O

on	eng	N	N	O	O

this	eng	N	N	O	O

island	eng	N	N	O	O

is	eng	N	N	O	O

immortal	eng	N	N	O	O

and	eng	N	N	O	O

none	eng	N	N	O	O

have	eng	N	N	O	O

ever	eng	N	N	O	O

been	eng	N	N	O	O

born	eng	N	N	O	O

at	eng	N	N	O	O

least	eng	N	N	O	O

these	eng	N	N	O	O

millennia	eng	N	N	O	O
.	m	N	N	O	O

You	eng	N	N	O	O

are	eng	N	N	O	O

a	x	N	N	O	O

good	eng	N	N	O	O

computer	eng	N	N	O	O

programmer	eng	N	N	O	O

and	eng	N	N	O	O

so	eng	N	N	O	O

requested	eng	N	N	O	O

to	eng	N	N	O	O

help	eng	N	N	O	O

Akira	eng	N	N	O	O

by	eng	N	N	O	O

writing	eng	N	N	O	O

a	x	N	N	O	O

program	eng	N	N	O	O

that	eng	N	N	O	O

classifies	eng	N	N	O	O

the	eng	N	N	O	O

inhabitants	eng	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

their	eng	N	N	O	O

answers	eng	N	N	O	O

to	eng	N	N	O	O

his	eng	N	N	O	O

inquiries	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

The	eng	N	N	O	O

input	eng	N	N	O	O

consists	eng	N	N	O	O

of	eng	N	N	O	O

multiple	eng	N	N	O	O

data	eng	N	N	O	O

sets	eng	N	N	O	O
,	x	N	N	O	O

each	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

following	eng	N	N	O	O

format	eng	N	N	O	O

:	x	N	N	O	O

n	x	N	N	O	O

p1	eng	N	N	O	O

p2	eng	N	N	O	O

xl	eng	N	N	O	O

yl	eng	N	N	O	O

a1	eng	N	N	O	O

x2	eng	N	N	O	O

y2	eng	N	N	O	O

a2	eng	N	N	O	O

...	m	N	N	O	O

xi	eng	N	N	O	O

yi	eng	N	N	O	O

ai	eng	N	N	O	O

...	m	N	N	O	O

xn	eng	N	N	O	O

yn	eng	N	N	O	O

an	eng	Y	N	O	O

The	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O

has	eng	Y	N	O	O

three	eng	N	N	O	O

non	eng	N	N	O	O
-	x	N	N	O	O
negative	eng	N	N	O	O

integers	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

p1	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

p2	eng	N	N	O	O
.	m	N	N	O	O

n	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

questions	eng	N	N	O	O

Akira	eng	N	N	O	O

asked	eng	N	N	O	O
.	m	N	N	O	O

pl	eng	N	N	O	O

and	eng	N	N	O	O

p2	eng	N	N	O	O

are	eng	N	N	O	O

the	eng	N	N	O	O

populations	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

divine	eng	N	N	O	O

and	eng	N	N	O	O

devilish	eng	N	N	O	O

tribes	eng	N	N	O	O
,	x	N	N	O	O

respectively	eng	N	N	O	O
,	x	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

legend	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

following	eng	N	N	O	O

n	x	N	N	O	O

lines	eng	N	N	O	O

has	eng	Y	N	O	O

two	eng	N	N	O	O

integers	eng	N	N	O	O

xi	eng	N	N	O	O
,	x	N	N	O	O

yi	eng	N	N	O	O

and	eng	N	N	O	O

one	eng	N	N	O	O

word	eng	N	N	O	O

ai	eng	N	N	O	O
.	m	N	N	O	O

xi	eng	N	N	O	O

and	eng	N	N	O	O

yi	eng	N	N	O	O

are	eng	N	N	O	O

the	eng	N	N	O	O

identification	eng	N	N	O	O

numbers	eng	N	N	O	O

of	eng	N	N	O	O

inhabitants	eng	N	N	O	O
,	x	N	N	O	O

each	eng	N	N	O	O

of	eng	N	N	O	O

which	eng	N	N	O	O

is	eng	N	N	O	O

between	eng	N	N	O	O

1	x	N	N	O	O

and	eng	N	N	O	O

p1	eng	N	N	O	O

+	x	N	N	O	O

p2	eng	N	N	O	O
,	x	N	N	O	O

inclusive	eng	N	N	O	O
.	m	N	N	O	O

ai	eng	N	N	O	O

is	eng	N	N	O	O

either	eng	N	N	O	O

yes	eng	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

the	eng	N	N	O	O

inhabitant	eng	N	N	O	O

xi	eng	N	N	O	O

said	eng	N	N	O	O

that	eng	N	N	O	O

the	eng	N	N	O	O

inhabitant	eng	N	N	O	O

yi	eng	N	N	O	O

was	eng	N	N	O	O

a	x	N	N	O	O

member	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

divine	eng	N	N	O	O

tribe	eng	N	N	O	O
,	x	N	N	O	O

or	eng	Y	N	O	O

no	eng	N	N	O	O
,	x	N	N	O	O

otherwise	eng	N	N	O	O
.	m	N	N	O	O

Note	eng	N	N	O	O

that	eng	N	N	O	O

xi	eng	N	N	O	O

and	eng	N	N	O	O

yi	eng	N	N	O	O

can	eng	N	N	O	O

be	eng	Y	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

number	eng	N	N	O	O

since	eng	N	N	O	O

"	x	N	N	O	O
are	eng	N	N	O	O

you	eng	N	N	O	O

a	x	N	N	O	O

member	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

divine	eng	N	N	O	O

tribe	eng	N	N	O	O
?	x	N	N	O	O
"	x	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

valid	eng	N	N	O	O

question	eng	N	N	O	O
.	m	N	N	O	O

Note	eng	N	N	O	O

also	eng	N	N	O	O

that	eng	N	N	O	O

two	eng	N	N	O	O

lines	eng	N	N	O	O

may	eng	N	N	O	O

have	eng	N	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

x	x	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

and	eng	N	N	O	O

y	x	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

since	eng	N	N	O	O

Akira	eng	N	N	O	O

was	eng	N	N	O	O

very	eng	N	N	O	O

upset	eng	N	N	O	O

and	eng	N	N	O	O

might	eng	N	N	O	O

have	eng	N	N	O	O

asked	eng	N	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

question	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

one	eng	N	N	O	O

more	eng	N	N	O	O

than	eng	N	N	O	O

once	eng	N	N	O	O
.	m	N	N	O	O

You	eng	N	N	O	O

may	eng	N	N	O	O

assume	eng	N	N	O	O

that	eng	N	N	O	O

n	x	N	N	O	O

is	eng	N	N	O	O

less	eng	N	N	O	O

than	eng	N	N	O	O

1000	m	N	N	O	O

and	eng	N	N	O	O

that	eng	N	N	O	O

p1	eng	N	N	O	O

and	eng	N	N	O	O

p2	eng	N	N	O	O

are	eng	N	N	O	O

less	eng	N	N	O	O

than	eng	N	N	O	O

300.	m	N	N	O	O

A	x	N	N	O	O

line	eng	N	N	O	O

with	eng	N	N	O	O

three	eng	N	N	O	O

zeros	eng	N	N	O	O
,	x	N	N	O	O

i	eng	N	N	O	O
.	m	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

represents	eng	N	N	O	O

the	eng	N	N	O	O

end	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

input	eng	N	N	O	O
.	m	N	N	O	O

You	eng	N	N	O	O

can	eng	N	N	O	O

assume	eng	N	N	O	O

that	eng	N	N	O	O

each	eng	N	N	O	O

data	eng	N	N	O	O

set	eng	N	N	O	O

is	eng	N	N	O	O

consistent	eng	N	N	O	O

and	eng	N	N	O	O

no	eng	N	N	O	O

contradictory	eng	N	N	O	O

answers	eng	N	N	O	O

are	eng	N	N	O	O

included	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

data	eng	N	N	O	O

set	eng	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

it	eng	N	N	O	O

includes	eng	N	N	O	O

sufficient	eng	N	N	O	O

information	eng	N	N	O	O

to	eng	N	N	O	O

classify	eng	N	N	O	O

all	eng	N	N	O	O

the	eng	N	N	O	O

inhabitants	eng	N	N	O	O
,	x	N	N	O	O

print	eng	N	N	O	O

the	eng	N	N	O	O

identification	eng	N	N	O	O

numbers	eng	N	N	O	O

of	eng	N	N	O	O

all	eng	N	N	O	O

the	eng	N	N	O	O

divine	eng	N	N	O	O

ones	eng	N	N	O	O

in	eng	Y	N	O	O

ascending	eng	N	N	O	O

order	eng	N	N	O	O
,	x	N	N	O	O

one	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O
.	m	N	N	O	O

In	eng	N	N	O	O

addition	eng	N	N	O	O
,	x	N	N	O	O

following	eng	N	N	O	O

the	eng	N	N	O	O

output	eng	N	N	O	O

numbers	eng	N	N	O	O
,	x	N	N	O	O

print	eng	N	N	O	O

end	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O
.	m	N	N	O	O

Otherwise	eng	N	N	O	O
,	x	N	N	O	O

i	eng	N	N	O	O
.	m	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

a	x	N	N	O	O

given	eng	N	N	O	O

data	eng	N	N	O	O

set	eng	N	N	O	O

does	eng	N	N	O	O

not	eng	N	N	O	O

include	eng	N	N	O	O

sufficient	eng	N	N	O	O

information	eng	N	N	O	O

to	eng	N	N	O	O

identify	eng	N	N	O	O

all	eng	N	N	O	O

the	eng	N	N	O	O

divine	eng	N	N	O	O

members	eng	N	N	O	O
,	x	N	N	O	O

print	eng	N	N	O	O

no	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

no	eng	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

no	eng	N	N	O	O

3	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

yes	eng	N	N	O	O

2	x	N	N	O	O

2	x	N	N	O	O

yes	eng	N	N	O	O

3	x	N	N	O	O

3	x	N	N	O	O

yes	eng	N	N	O	O

2	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

yes	eng	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

no	eng	N	N	O	O

5	x	N	N	O	O

4	x	N	N	O	O

3	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

yes	eng	N	N	O	O

1	x	N	N	O	O

3	x	N	N	O	O

no	eng	N	N	O	O

4	x	N	N	O	O

5	x	N	N	O	O

yes	eng	N	N	O	O

5	x	N	N	O	O

6	x	N	N	O	O

yes	eng	N	N	O	O

6	x	N	N	O	O

7	x	N	N	O	O

no	eng	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

no	eng	N	N	O	O

no	eng	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

end	eng	N	N	O	O

3	x	N	N	O	O

4	x	N	N	O	O

5	x	N	N	O	O

6	x	N	N	O	O

end	eng	N	N	O	O

Source	eng	N	N	O	O

Japan	eng	N	N	O	O

2002	m	N	N	O	O

Kanazawa	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

N	x	N	N	O	O

606	m	N	N	O	O

struct	eng	N	N	O	O

node	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

to	eng	N	N	O	O
,	x	N	N	O	O
next	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
1010	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
p1	eng	N	N	O	O
,	x	N	N	O	O
p2	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

bin	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
mark	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
prt	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
1010	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
pre	eng	N	N	O	O
[	x	N	N	O	O
1010	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
path	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cnt	eng	N	N	O	O
,	x	N	N	O	O
tcnt	eng	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cnt	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

tcnt	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
p1	eng	N	N	O	O
+	x	N	N	O	O
p2	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

bin	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
mark	eng	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
mark	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
pre	eng	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
pre	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
path	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
path	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
cnt1	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
cnt1	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
prt	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
prt	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

find	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
bin	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

s	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
=	x	N	N	O	O
bin	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bin	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
find	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

bin	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

merge	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

y	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

v	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
=	x	N	N	O	O
find	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

b	x	N	N	O	O
=	x	N	N	O	O
find	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

bin	eng	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

num	eng	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

add	eng	N	N	O	O
_	x	N	N	O	O
edge	eng	N	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

u	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

v	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

flag	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
cnt	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
=	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
cnt	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
next	eng	N	N	O	O
=	x	N	N	O	O
pre	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
flag	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

pre	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
flag	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
cnt	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

fuc	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
p1	eng	N	N	O	O
+	x	N	N	O	O
p2	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

bin	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
find	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

string	eng	N	N	O	O

c	x	N	N	O	O
=	x	N	N	O	O
"	x	N	N	O	O
yes	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
tmp	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
v	x	N	N	O	O
,	x	N	N	O	O
len	eng	N	N	O	O
,	x	N	N	O	O
ttmp	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
p1	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
p2	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
&&	x	N	N	O	O
(	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
p1	eng	N	N	O	O
+	x	N	N	O	O
p2	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

len	eng	N	N	O	O
=	x	N	N	O	O
p1	eng	N	N	O	O
+	x	N	N	O	O
p2	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
tmp	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O

v	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

v	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

merge	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
v	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

fuc	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tcnt	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
len	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
mark	eng	N	N	O	O
[	x	N	N	O	O
bin	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

mark	eng	N	N	O	O
[	x	N	N	O	O
bin	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
tcnt	eng	N	N	O	O
;	x	N	N	O	O

add	eng	N	N	O	O
_	x	N	N	O	O
edge	eng	N	N	O	O
(	x	N	N	O	O
tcnt	eng	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tcnt	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

add	eng	N	N	O	O
_	x	N	N	O	O
edge	eng	N	N	O	O
(	x	N	N	O	O
mark	eng	N	N	O	O
[	x	N	N	O	O
bin	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
tcnt	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

p	x	N	N	O	O
=	x	N	N	O	O
pre	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
p	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
next	eng	N	N	O	O
)	x	N	N	O	O

cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

p	x	N	N	O	O
=	x	N	N	O	O
pre	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
p	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
next	eng	N	N	O	O
)	x	N	N	O	O

cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O

cnt1	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

path	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O

cnt1	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O

cnt1	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
no	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

path	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
tcnt	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
p1	eng	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

ttmp	eng	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ttmp	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	m	N	N	O	O
&&	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ttmp	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

path	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

ttmp	eng	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ttmp	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	m	N	N	O	O
&&	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ttmp	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

path	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O

find	eng	N	N	O	O

now	eng	N	N	O	O

and	eng	N	N	O	O

catch	eng	N	N	O	O

them	eng	N	N	O	O

int	eng	N	N	O	O

ff	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ttmp	eng	N	N	O	O
=	x	N	N	O	O
p1	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
tcnt	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ttmp	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
no	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
tcnt	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ttmp	eng	N	N	O	O
-	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	m	N	N	O	O
&&	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ttmp	eng	N	N	O	O
-	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ff	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ttmp	eng	N	N	O	O
-	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ttmp	eng	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ttmp	eng	N	N	O	O
-	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ttmp	eng	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

ff	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ff	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
no	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

ttmp	eng	N	N	O	O
=	x	N	N	O	O
p1	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

mm	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
tcnt	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
path	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ttmp	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

mm	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

ttmp	eng	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

mm	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

ttmp	eng	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
cnt1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

p	x	N	N	O	O
=	x	N	N	O	O
pre	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
mm	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
p	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
next	eng	N	N	O	O
)	x	N	N	O	O

prt	eng	N	N	O	O
[	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
len	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
prt	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
end	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

3090	m	N	N	I-OJ	O

Visible	eng	N	N	O	O

Lattice	eng	N	N	O	O

Points	eng	N	N	O	O
_	x	N	N	O	O
JJing	eng	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

欧拉	ns	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
函数	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
的	uj	N	N	O	O
一个	m	N	N	O	O
应用	v	N	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
出	v	N	N	O	O
互质	n	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

Description	eng	N	N	O	O

A	x	N	N	O	O

lattice	eng	N	N	O	O

point	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
)	x	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

quadrant	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O

and	eng	N	N	O	O

y	x	N	N	O	O

are	eng	N	N	O	O

integers	eng	N	N	O	O

greater	eng	N	N	O	O

than	eng	N	N	O	O

or	eng	Y	N	O	O

equal	eng	N	N	O	O

to	eng	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

other	eng	N	N	O	O

than	eng	N	N	O	O

the	eng	N	N	O	O

origin	eng	N	N	O	O
,	x	N	N	O	O

is	eng	N	N	O	O

visible	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

origin	eng	N	N	O	O

if	eng	N	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O

from	eng	N	N	O	O

(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

to	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
)	x	N	N	O	O

does	eng	N	N	O	O

not	eng	N	N	O	O

pass	eng	N	N	O	O

through	eng	N	N	O	O

any	eng	N	N	O	O

other	eng	N	N	O	O

lattice	eng	N	N	O	O

point	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

example	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

point	eng	N	N	O	O

(	x	N	N	O	O
4	x	N	N	O	O
,	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O

is	eng	N	N	O	O

not	eng	N	N	O	O

visible	eng	N	N	O	O

since	eng	N	N	O	O

the	eng	N	N	O	O

line	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

origin	eng	N	N	O	O

passes	eng	N	N	O	O

through	eng	N	N	O	O

(	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O

The	eng	N	N	O	O

figure	eng	N	N	O	O

below	eng	N	N	O	O

shows	eng	N	N	O	O

the	eng	N	N	O	O

points	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
)	x	N	N	O	O

with	eng	N	N	O	O

0	x	N	N	O	O

≤	x	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O

≤	x	N	N	O	O

5	x	N	N	O	O

with	eng	N	N	O	O

lines	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

origin	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

visible	eng	N	N	O	O

points	eng	N	N	O	O
.	m	N	N	O	O

3090	m	N	N	O	O

Visible	eng	N	N	O	O

Lattice	eng	N	N	O	O

Points	eng	N	N	O	O
"	x	N	N	O	O
>	x	N	N	O	O

Write	eng	N	N	O	O

a	x	N	N	O	O

program	eng	N	N	O	O

which	eng	N	N	O	O
,	x	N	N	O	O

given	eng	N	N	O	O

a	x	N	N	O	O

value	eng	N	N	O	O

for	eng	Y	N	O	O

the	eng	N	N	O	O

size	eng	N	N	O	O
,	x	N	N	O	O

N	x	N	N	O	O
,	x	N	N	O	O

computes	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

visible	eng	N	N	O	O

points	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
)	x	N	N	O	O

with	eng	N	N	O	O

0	x	N	N	O	O

≤	x	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O

≤	x	N	N	O	O

N	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

The	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

input	eng	N	N	O	O

contains	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

integer	eng	N	N	O	O

C	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

≤	x	N	N	O	O

C	x	N	N	O	O

≤	x	N	N	O	O

1000	m	N	N	O	O
)	x	N	N	O	O

which	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

datasets	eng	N	N	O	O

that	eng	N	N	O	O

follow	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

dataset	eng	N	N	O	O

consists	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

input	eng	N	N	O	O

containing	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

integer	eng	N	N	O	O

N	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

≤	x	N	N	O	O

N	x	N	N	O	O

≤	x	N	N	O	O

1000	m	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

which	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

size	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

dataset	eng	N	N	O	O
,	x	N	N	O	O

there	eng	N	N	O	O

is	eng	N	N	O	O

to	eng	N	N	O	O

be	eng	Y	N	O	O

one	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

output	eng	N	N	O	O

consisting	eng	N	N	O	O

of	eng	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

dataset	eng	N	N	O	O

number	eng	N	N	O	O

starting	eng	N	N	O	O

at	eng	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

space	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

size	eng	N	N	O	O
,	x	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

space	eng	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

visible	eng	N	N	O	O

points	eng	N	N	O	O

for	eng	Y	N	O	O

that	eng	N	N	O	O

size	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

4	x	N	N	O	O

2	x	N	N	O	O

4	x	N	N	O	O

5	x	N	N	O	O

231	m	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

5	x	N	N	O	O

2	x	N	N	O	O

4	x	N	N	O	O

13	m	N	N	O	O

3	x	N	N	O	O

5	x	N	N	O	O

21	m	N	N	O	O

4	x	N	N	O	O

231	m	N	N	O	O

32549	m	N	N	O	O

3090	m	N	N	O	O

Visible	eng	N	N	O	O

Lattice	eng	N	N	O	O

Points	eng	N	N	O	O
"	x	N	N	O	O

title	eng	N	N	O	O
=	x	N	N	O	O
"	x	N	N	O	O
POJ	eng	N	Y	O	B-OJ

3090	m	N	N	O	O

Visible	eng	N	N	O	O

Lattice	eng	N	N	O	O

Points	eng	N	N	O	O
"	x	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

M	x	N	N	O	O

1005	m	N	N	O	I-OJ

int	eng	N	N	O	O

phi	eng	N	N	O	O
[	x	N	N	O	O
M	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

oula	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
欧拉	ns	Y	N	B-KNOWLEDGE	O
函数	n	Y	N	I-KNOWLEDGE	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
M	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
phi	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

phi	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
3	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
M	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
phi	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
M	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

phi	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
phi	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
/	x	N	N	O	O
i	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

cas	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
v	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

oula	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
cas	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
cas	eng	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

sum	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
phi	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
v	eng	N	N	O	O
++	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

