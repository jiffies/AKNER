POJ1176	eng	N	Y	B-OJ	B-OJ

(	x	N	N	O	O
规律	n	Y	N	O	O
循环	vn	N	N	O	O
)	x	N	N	O	O

-	x	N	N	O	O

czhou0	eng	N	N	O	O
的	uj	N	N	O	O
专栏	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

问题	n	N	N	O	O
：	x	N	N	O	O

　	x	N	N	O	O
　	x	N	N	O	O
有	v	N	N	O	O
N	eng	N	N	O	O
个	m	N	N	O	O
开着	v	N	N	O	O
的	uj	N	N	O	O
灯	n	N	N	O	O
，	x	N	N	O	O
和	c	N	N	O	O
控制	v	Y	N	O	O
这个	r	N	N	O	O
N	eng	N	N	O	O
个	m	N	N	O	O
灯	n	N	N	O	O
的	uj	N	N	O	O
四个	m	N	N	O	O
开关	v	N	N	O	O
。	x	N	N	O	O

四个	m	N	N	O	O
开关	v	N	N	O	O
作用	v	N	N	O	O
不同	a	N	N	O	O
。	x	N	N	O	O

第一个	m	N	N	O	O
开关	v	N	N	O	O
：	x	N	N	O	O
flip	eng	N	N	O	O
所有	b	N	N	O	O
的	uj	N	N	O	O
灯	n	N	N	O	O
。	x	N	N	O	O

第二个	m	N	N	O	O
开关	v	N	N	O	O
：	x	N	N	O	O
flip	eng	N	N	O	O
奇数	n	Y	N	O	O
编号	n	N	N	O	O
的	uj	N	N	O	O
灯	n	N	N	O	O
。	x	N	N	O	O

第三个	m	N	N	O	O
开关	v	N	N	O	O
：	x	N	N	O	O
flip	eng	N	N	O	O
偶数	n	N	N	O	O
编号	n	N	N	O	O
的	uj	N	N	O	O
灯	n	N	N	O	O
。	x	N	N	O	O

第四个	m	N	N	O	O
开关	v	N	N	O	O
：	x	N	N	O	O
flip	eng	N	N	O	O
编号	n	N	N	O	O
为	p	N	N	O	O
3	m	N	N	O	O

*	x	N	N	O	O

K	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O

的	uj	N	N	O	O
灯	n	N	N	O	O
，	x	N	N	O	O
其中	r	N	N	O	O
K	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
2....	m	N	N	O	O
。	x	N	N	O	O

已知	v	N	N	O	O
在	p	N	N	O	O
C	eng	N	N	O	O
次	t	N	N	O	O
操作	v	Y	N	O	O
后	f	N	N	O	O
其中	r	N	N	O	O
几个	m	N	N	O	O
灯	n	N	N	O	O
的	uj	N	N	O	O
状态	n	Y	N	O	O
，	x	N	N	O	O
给出	v	N	N	O	O
所有	b	N	N	O	O
灯	n	N	N	O	O
在	p	N	N	O	O
这	r	N	N	O	O
C	eng	N	N	O	O
次	t	N	N	O	O
操作	v	Y	N	O	O
后	f	N	N	O	O
所有	b	N	N	O	O
可能	v	N	N	O	O
的	uj	N	N	O	O
状态	n	Y	N	O	O
。	x	N	N	O	O

方法	n	Y	N	O	O
：	x	N	N	O	O

　	x	N	N	O	O
　	x	N	N	O	O
通过观察	l	N	N	O	O
可以	c	N	N	O	O
发现	v	N	N	O	O
，	x	N	N	O	O
这些	r	N	N	O	O
灯	n	N	N	O	O
一共	j	N	N	O	O
可以	c	N	N	O	O
分成	v	N	N	O	O
4	m	N	N	O	O
种	m	N	N	O	O
，	x	N	N	O	O
同种	r	N	N	O	O
灯	n	N	N	O	O
无论	c	N	N	O	O
在	p	N	N	O	O
何种	r	N	N	O	O
操作	v	Y	N	O	O
下	f	N	N	O	O
，	x	N	N	O	O
状态	n	Y	N	O	O
都	d	N	N	O	O
是	v	N	N	O	O
相同	d	N	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

即	v	N	N	O	O
：	x	N	N	O	O
（	x	N	N	O	O
1	x	N	N	O	O
）	x	N	N	O	O
编号	n	N	N	O	O
为	p	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
7	x	N	N	O	O
,	x	N	N	O	O
13	m	N	N	O	O
,	x	N	N	O	O
19....	m	N	N	O	O
的	uj	N	N	O	O
灯	n	N	N	O	O
。	x	N	N	O	O

（	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O
编号	n	N	N	O	O
为	p	N	N	O	O
4	m	N	N	O	O
,	x	N	N	O	O
10	m	N	N	O	O
,	x	N	N	O	O
16	m	N	N	O	O
,	x	N	N	O	O
22....	m	N	N	O	O
的	uj	N	N	O	O
灯	n	N	N	O	O
。	x	N	N	O	O

（	x	N	N	O	O
3	x	N	N	O	O
）	x	N	N	O	O
编号	n	N	N	O	O
为	p	N	N	O	O
奇数	n	Y	N	O	O
，	x	N	N	O	O
但是	c	N	N	O	O
不	d	N	N	O	O
属于	v	N	N	O	O
（	x	N	N	O	O
1	x	N	N	O	O
）	x	N	N	O	O
的	uj	N	N	O	O
灯	n	N	N	O	O
。	x	N	N	O	O

（	x	N	N	O	O
4	x	N	N	O	O
）	x	N	N	O	O
编号	n	N	N	O	O
为	p	N	N	O	O
偶数	n	N	N	O	O
，	x	N	N	O	O
但是	c	N	N	O	O
不	d	N	N	O	O
属于	v	N	N	O	O
（	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O
的	uj	N	N	O	O
灯	n	N	N	O	O
。	x	N	N	O	O

　	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
对于	p	N	N	O	O
第	m	N	N	O	O
（	x	N	N	O	O
1	x	N	N	O	O
）	x	N	N	O	O
种灯	n	N	N	O	O
，	x	N	N	O	O
唯	b	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
4	m	N	N	O	O
号	m	N	N	O	O
开关	v	N	N	O	O
能够	v	N	N	O	O
控制	v	Y	N	O	O
，	x	N	N	O	O
且	zg	N	N	O	O
这些	r	N	N	O	O
开关	v	N	N	O	O
的	uj	N	N	O	O
作用	v	N	N	O	O
是	v	N	N	O	O
等效	v	N	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

　	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
对于	p	N	N	O	O
第	m	N	N	O	O
（	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O
种灯	n	N	N	O	O
，	x	N	N	O	O
唯有	b	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
3	m	N	N	O	O
号	m	N	N	O	O
开关	v	N	N	O	O
能够	v	N	N	O	O
控制	v	Y	N	O	O
，	x	N	N	O	O
且	zg	N	N	O	O
这些	r	N	N	O	O
开关	v	N	N	O	O
的	uj	N	N	O	O
作用	v	N	N	O	O
是	v	N	N	O	O
等效	v	N	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

　	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
对于	p	N	N	O	O
第	m	N	N	O	O
（	x	N	N	O	O
3	x	N	N	O	O
）	x	N	N	O	O
种灯	n	N	N	O	O
，	x	N	N	O	O
唯有	b	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
2	m	N	N	O	O
号	m	N	N	O	O
开关	v	N	N	O	O
能够	v	N	N	O	O
控制	v	Y	N	O	O
，	x	N	N	O	O
且	zg	N	N	O	O
这些	r	N	N	O	O
开关	v	N	N	O	O
的	uj	N	N	O	O
作用	v	N	N	O	O
是	v	N	N	O	O
等效	v	N	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

　	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
　	x	N	N	O	O
对于	p	N	N	O	O
第	m	N	N	O	O
（	x	N	N	O	O
4	x	N	N	O	O
）	x	N	N	O	O
种灯	n	N	N	O	O
，	x	N	N	O	O
唯有	b	N	N	O	O
第	m	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
3	x	N	N	O	O
,	x	N	N	O	O
4	m	N	N	O	O
号	m	N	N	O	O
开关	v	N	N	O	O
能够	v	N	N	O	O
控制	v	Y	N	O	O
，	x	N	N	O	O
且	zg	N	N	O	O
这些	r	N	N	O	O
开关	v	N	N	O	O
的	uj	N	N	O	O
作用	v	N	N	O	O
是	v	N	N	O	O
等效	v	N	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

　	x	N	N	O	O
　	x	N	N	O	O
同一个	b	N	N	O	O
开关	v	N	N	O	O
无论	c	N	N	O	O
按动	vn	N	N	O	O
多少	m	N	N	O	O
次	q	N	N	O	O
，	x	N	N	O	O
其	r	N	N	O	O
效果	n	N	N	O	O
只有	c	N	N	O	O
两种	m	N	N	O	O
。	x	N	N	O	O

即	v	N	N	O	O
所有	b	N	N	O	O
奇	ag	N	N	O	O
数次	m	N	N	O	O
的	uj	N	N	O	O
按动	vn	N	N	O	O
的	uj	N	N	O	O
效果	n	N	N	O	O
与	p	N	N	O	O
按动	vn	N	N	O	O
一次	m	N	N	O	O
相同	d	N	N	O	O
；	x	N	N	O	O
所有	b	N	N	O	O
偶数	n	N	N	O	O
次	m	N	N	O	O
的	uj	N	N	O	O
按动	vn	N	N	O	O
与	p	N	N	O	O
不	v	N	N	O	O
按动	vn	N	N	O	O
的	uj	N	N	O	O
效果	n	N	N	O	O
也	d	N	N	O	O
相同	d	N	N	O	O
。	x	N	N	O	O

　	x	N	N	O	O
　	x	N	N	O	O
现在	t	N	N	O	O
只	d	N	N	O	O
需	v	N	N	O	O
将	d	N	N	O	O
这	r	N	N	O	O
四个	m	N	N	O	O
开关	v	N	N	O	O
的	uj	N	N	O	O
按动	vn	N	N	O	O
次数	n	N	N	O	O
按	p	N	N	O	O
奇偶	n	N	N	O	O
枚举	nz	Y	N	O	O
（	x	N	N	O	O
共有	v	N	N	O	O
2	x	N	N	O	O

*	x	N	N	O	O

2	x	N	N	O	O

*	x	N	N	O	O

2	x	N	N	O	O

*	x	N	N	O	O

2	x	N	N	O	O

=	x	N	N	O	O

16	m	N	N	O	O
种	m	N	N	O	O
情况	n	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
与	p	N	N	O	O
已知	v	N	N	O	O
的	uj	N	N	O	O
C	eng	N	N	O	O
次	t	N	N	O	O
操作	v	Y	N	O	O
后	f	N	N	O	O
的	uj	N	N	O	O
灯	n	N	N	O	O
的	uj	N	N	O	O
状态	n	Y	N	O	O
对比	v	N	N	O	O
即可	d	N	N	O	O
，	x	N	N	O	O
若	c	N	N	O	O
符合	v	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
为	p	N	N	O	O
潜在	t	N	N	O	O
的	uj	N	N	O	O
正确	ad	N	N	O	O
答案	n	N	N	O	O
。	x	N	N	O	O

这里	r	N	N	O	O
说	v	N	N	O	O
是	v	N	N	O	O
“	x	N	N	O	O
潜在	t	N	N	O	O
”	x	N	N	O	O
的	uj	N	N	O	O
答案	n	N	N	O	O
，	x	N	N	O	O
是因为	c	N	N	O	O
还	d	N	N	O	O
需要	v	N	N	O	O
考虑	v	N	N	O	O
该	r	N	N	O	O
开关	v	N	N	O	O
组合	v	Y	N	O	O
能否	v	N	N	O	O
在	p	N	N	O	O
C	eng	N	N	O	O
次	t	N	N	O	O
操作	v	Y	N	O	O
内	n	N	N	O	O
完成	v	N	N	O	O
。	x	N	N	O	O

不	d	N	N	O	O
可能	v	N	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O
共有	v	N	N	O	O
2	m	N	N	O	O
种	m	N	N	O	O
：	x	N	N	O	O
（	x	N	N	O	O
1	x	N	N	O	O
）	x	N	N	O	O
按动	vn	N	N	O	O
奇	ag	N	N	O	O
数次	m	N	N	O	O
的	uj	N	N	O	O
开关	v	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
大于	d	N	N	O	O
C	x	N	N	O	O
。	x	N	N	O	O

（	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O
按动	vn	N	N	O	O
奇	ag	N	N	O	O
数次	m	N	N	O	O
的	uj	N	N	O	O
开关	v	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
与	p	N	N	O	O
C	eng	N	N	O	O
的	uj	N	N	O	O
奇偶性	n	N	N	O	O
不同	a	N	N	O	O
。	x	N	N	O	O

排除	v	N	N	O	O
这	r	N	N	O	O
两种	m	N	N	O	O
情况	n	N	N	O	O
之后	f	N	N	O	O
，	x	N	N	O	O
便	d	N	N	O	O
得到	v	N	N	O	O
了	ul	N	N	O	O
正确	ad	N	N	O	O
答案	n	N	N	O	O
。	x	N	N	O	O

附	v	N	N	O	O
代码	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
vector	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

isEven	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O

%	x	N	N	O	O

2	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

is3K1	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

%	x	N	N	O	O

3	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

N	x	N	N	O	O
,	x	N	N	O	O

C	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

isOn	eng	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

N	x	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

C	x	N	N	O	O
;	x	N	N	O	O

vector	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

result	eng	N	N	O	O
;	x	N	N	O	O
int	eng	N	N	O	O

temp	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

temp	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
is3K1	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

isEven	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

isOn	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
is3K1	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

!	x	N	N	O	O

isEven	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

isOn	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isEven	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

isOn	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
else	eng	N	N	O	O
{	x	N	N	O	O

isOn	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

temp	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
is3K1	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

isEven	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

isOn	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
is3K1	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

!	x	N	N	O	O

isEven	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

isOn	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isEven	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

isOn	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
else	eng	N	N	O	O
{	x	N	N	O	O

isOn	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

16	m	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

string	eng	N	N	O	O

temp	eng	N	N	O	O
(	x	N	N	O	O
N	x	N	N	O	O
,	x	N	N	O	O

'	x	N	N	O	O
1	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

&	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

&	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

&	x	N	N	O	O

4	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

&	x	N	N	O	O

8	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
on	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

%	x	N	N	O	O

2	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isOn	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
else	eng	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isOn	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
on	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

%	x	N	N	O	O

2	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isOn	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
else	eng	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isOn	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
on	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

)	x	N	N	O	O

%	x	N	N	O	O

2	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isOn	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
else	eng	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isOn	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
on	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

%	x	N	N	O	O

2	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isOn	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
else	eng	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isOn	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
on	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

%	x	N	N	O	O

2	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

C	x	N	N	O	O

%	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
on	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

on	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

>	x	N	N	O	O

C	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
on	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O

temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

'	x	N	N	O	O
1	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
on	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O

temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

'	x	N	N	O	O
1	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
on	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O

temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

'	x	N	N	O	O
1	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
on	eng	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

3	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O

temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

'	x	N	N	O	O
1	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

temp	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

result	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
result	eng	N	N	O	O
.	m	N	N	O	O
begin	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

result	eng	N	N	O	O
.	m	N	N	O	O
end	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

result	eng	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

result	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

endl	eng	N	N	O	O
;	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

3286	m	N	N	I-OJ	O

How	eng	N	N	O	O

many	eng	N	N	O	O

0	x	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O
?	x	N	N	O	O

/	x	N	N	O	O

2282	m	N	N	O	O

The	eng	N	N	O	O

Counting	eng	N	N	O	O

Problem	eng	N	N	O	O

排列组合	n	Y	N	B-KNOWLEDGE	O
统计数字	l	Y	N	O	O

-	x	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

比如	v	N	N	O	O
算	v	N	N	O	O
4123	m	N	N	O	O
中	f	N	N	O	O
有	v	N	N	O	O
多少	m	N	N	O	O
个	m	N	N	O	O
2	m	N	N	O	O

按	p	N	N	O	O
位	v	N	N	O	O
统计	v	Y	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
先算	d	N	N	O	O
各位	r	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
个位	n	N	N	O	O
是	v	N	N	O	O
2	m	N	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O
有	v	N	N	O	O
413	m	N	N	O	O
种	m	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
因为	c	N	N	O	O
各位	r	N	N	O	O
左边	f	N	N	O	O
可以	c	N	N	O	O
0	x	N	N	O	O
~	x	N	N	O	O
412	m	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
而	c	N	N	O	O
右边	f	N	N	O	O
没有	v	N	N	O	O
数字	n	Y	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O

然后	c	N	N	O	O
是	v	N	N	O	O
十位	m	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
十位	m	N	N	O	O
是	v	N	N	O	O
2	m	N	N	O	O
的	uj	N	N	O	O
有	v	N	N	O	O
41	m	N	N	O	O
*	x	N	N	O	O
10	m	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
*	x	N	N	O	O
4	m	N	N	O	O
种	m	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
当	t	N	N	O	O
左边	f	N	N	O	O
从	p	N	N	O	O
0	m	N	N	O	O
~	x	N	N	O	O
40	m	N	N	O	O
时	n	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
右边	f	N	N	O	O
可以	c	N	N	O	O
从	p	N	N	O	O
0	m	N	N	O	O
~	x	N	N	O	O
9	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
而	c	N	N	O	O
左边	f	N	N	O	O
为	p	N	N	O	O
41	m	N	N	O	O
时	n	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
右边	f	N	N	O	O
只能	v	N	N	O	O
从	p	N	N	O	O
0	m	N	N	O	O
~	x	N	N	O	O
3	x	N	N	O	O

然后	c	N	N	O	O
是	v	N	N	O	O
百位	m	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
百位	m	N	N	O	O
有	v	N	N	O	O
4	m	N	N	O	O
*	x	N	N	O	O
100	m	N	N	O	O
种	m	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
即	v	N	N	O	O
左边	f	N	N	O	O
从	p	N	N	O	O
0	m	N	N	O	O
~	x	N	N	O	O
3	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
右边	f	N	N	O	O
从	p	N	N	O	O
0	m	N	N	O	O
~	x	N	N	O	O
99	m	N	N	O	O

千位	m	N	N	O	O
有	v	N	N	O	O

1	x	N	N	O	O
*	x	N	N	O	O
1000	m	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
左边	f	N	N	O	O
没有	v	N	N	O	O
数字	n	Y	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
右边	f	N	N	O	O
0	x	N	N	O	O
~	x	N	N	O	O
999	m	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O

上面	f	N	N	O	O
是	v	N	N	O	O
计算	v	Y	N	O	O
1	x	N	N	O	O
~	x	N	N	O	O
9	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
计算	v	Y	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
比较	d	N	N	O	O
特殊	a	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
原因	n	N	N	O	O
是	v	N	N	O	O
除了	p	N	N	O	O
0	m	N	N	O	O
这	r	N	N	O	O
一个	m	N	N	O	O
数字	n	Y	N	O	O
之外	f	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
不能	v	N	N	O	O
做	v	N	N	O	O
开头	v	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O

可以	c	N	N	O	O
看到	v	N	N	O	O
在	p	N	N	O	O
求	v	N	N	O	O
1	m	N	N	O	O
~	x	N	N	O	O
9	m	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
都	d	N	N	O	O
是	v	N	N	O	O
分为	v	N	N	O	O
2	x	N	N	O	O
部分	n	Y	N	O	O
相乘	v	Y	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
这样	r	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
处理	v	N	N	O	O
也	d	N	N	O	O
很	d	N	N	O	O
简单	a	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
只	d	N	N	O	O
需	v	N	N	O	O
把	p	N	N	O	O
相乘	v	Y	N	O	O
的	uj	N	N	O	O
左半	m	N	N	O	O
部分	n	Y	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O
,	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

3286	m	N	N	I-OJ	O

题意	n	N	N	O	O
：	x	N	N	O	O
输入	v	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
[	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
之间	f	N	N	O	O
的	uj	N	N	O	O
所有	b	N	N	O	O
数	m	N	N	O	O
中	f	N	N	O	O
0	m	N	N	O	O
出现	v	N	N	O	O
的	uj	N	N	O	O
次数	n	N	N	O	O
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

lint	eng	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

lint	eng	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
12	m	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

{	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

10	m	N	N	O	O
,	x	N	N	O	O

100	m	N	N	O	O
,	x	N	N	O	O

1000	m	N	N	O	O
,	x	N	N	O	O

10000	m	N	N	O	O
,	x	N	N	O	O

100000	m	N	N	O	O
,	x	N	N	O	O

1000000	m	N	N	O	O
,	x	N	N	O	O

10000000	m	N	N	O	O
,	x	N	N	O	O

100000000	m	N	N	O	O
,	x	N	N	O	O

1000000000	m	N	N	O	O
,	x	N	N	O	O

10000000000	m	N	N	O	O
,	x	N	N	O	O

100000000000	m	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

lint	eng	N	N	O	O

count	eng	N	N	O	O

(	x	N	N	O	O

lint	eng	N	N	O	O

n	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

lint	eng	N	N	O	O

left	eng	N	N	O	O
,	x	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O

sum	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

12	m	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

left	eng	N	N	O	O

=	x	N	N	O	O

n	x	N	N	O	O

/	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

left	eng	N	N	O	O

*	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

m	x	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
n	x	N	N	O	O

%	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

n	x	N	N	O	O

%	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
求出	v	N	N	O	O
从	p	N	N	O	O
第	m	N	N	O	O
到	v	N	N	O	O
高	a	N	N	O	O
的	uj	N	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
位	q	N	N	O	O
上	f	N	N	O	O
的	uj	N	N	O	O
具体	a	N	N	O	O
数字	n	Y	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O

m	x	N	N	O	O

>	x	N	N	O	O

0	x	N	N	O	O

)	x	N	N	O	O

sum	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O

m	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O

)	x	N	N	O	O

sum	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O

%	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O

n	x	N	N	O	O

<	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

sum	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

lint	eng	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

(	x	N	N	O	O
n	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
count	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
count	eng	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	O	B-OJ

2282	m	N	N	O	O

题意	n	N	N	O	O
：	x	N	N	O	O
输入	v	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
[	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
之间	f	N	N	O	O
的	uj	N	N	O	O
所有	b	N	N	O	O
数	m	N	N	O	O
中	f	N	N	O	O
0	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
3	x	N	N	O	O
,	x	N	N	O	O
4	x	N	N	O	O
,	x	N	N	O	O
5	x	N	N	O	O
,	x	N	N	O	O
6	x	N	N	O	O
,	x	N	N	O	O
7	x	N	N	O	O
,	x	N	N	O	O
8	x	N	N	O	O
,	x	N	N	O	O
9	x	N	N	O	O
出现	v	N	N	O	O
的	uj	N	N	O	O
次数	n	N	N	O	O
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

lint	eng	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

int	eng	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
9	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

{	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

10	m	N	N	O	O
,	x	N	N	O	O

100	m	N	N	O	O
,	x	N	N	O	O

1000	m	N	N	O	O
,	x	N	N	O	O

10000	m	N	N	O	O
,	x	N	N	O	O

100000	m	N	N	O	O
,	x	N	N	O	O

1000000	m	N	N	O	O
,	x	N	N	O	O

10000000	m	N	N	O	O
,	x	N	N	O	O

100000000	m	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

lint	eng	N	N	O	O

count	eng	N	N	O	O

(	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

id	eng	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

lint	eng	N	N	O	O

left	eng	N	N	O	O
,	x	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O

sum	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

9	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

left	eng	N	N	O	O

=	x	N	N	O	O

n	x	N	N	O	O

/	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

(	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

left	eng	N	N	O	O

*	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

m	x	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
n	x	N	N	O	O

%	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

n	x	N	N	O	O

%	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
求出	v	N	N	O	O
从	p	N	N	O	O
第	m	N	N	O	O
到	v	N	N	O	O
高	a	N	N	O	O
的	uj	N	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
位	q	N	N	O	O
上	f	N	N	O	O
的	uj	N	N	O	O
具体	a	N	N	O	O
数字	n	Y	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O

m	x	N	N	O	O

>	x	N	N	O	O

id	eng	N	N	O	O

)	x	N	N	O	O

sum	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O

m	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

id	eng	N	N	O	O

)	x	N	N	O	O

sum	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O

%	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O

n	x	N	N	O	O

<	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

sum	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O

x	x	N	N	O	O

>	x	N	N	O	O

y	x	N	N	O	O

)	x	N	N	O	O

swap	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

9	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O

"	x	N	N	O	O
,	x	N	N	O	O
count	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
count	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

pku1178	eng	N	Y	B-OJ	B-OJ
解题	n	N	N	O	O
报告	n	N	N	O	O
_	x	N	N	O	O
.....	m	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
162.105.81.212	m	N	N	O	O
/	x	N	N	O	O
JudgeOnline	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
1178	m	N	N	O	O

题意	n	N	N	O	O
：	x	N	N	O	O
一个	m	N	N	O	O
棋盘	n	Y	N	O	O
（	x	N	N	O	O
8	x	N	N	O	O
*	x	N	N	O	O
8	x	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
一个	m	N	N	O	O
王	nr	N	N	O	O
，	x	N	N	O	O
还有	v	N	N	O	O
n	eng	N	N	O	O
个	m	N	N	O	O
马	n	N	N	O	O
（	x	N	N	O	O
n	eng	N	N	O	O
不	c	N	N	O	O
确定	v	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
马有马	nr	N	N	O	O
的	uj	N	N	O	O
走法	n	N	N	O	O
，	x	N	N	O	O
王有王	nr	N	N	O	O
的	uj	N	N	O	O
走法	n	N	N	O	O
，	x	N	N	O	O
还有	v	N	N	O	O
当	p	N	N	O	O
王和马	nr	N	N	O	O
走到	v	N	N	O	O
一个	m	N	N	O	O
格子	n	N	N	O	O
上时	t	N	N	O	O
，	x	N	N	O	O
马	n	N	N	O	O
可以	c	N	N	O	O
带	v	N	N	O	O
着	uz	N	N	O	O
王	nr	N	N	O	O
走	v	N	N	O	O
，	x	N	N	O	O
输入	v	N	N	O	O
一串	m	N	N	O	O
字符	n	Y	N	O	O
，	x	N	N	O	O
字母	n	Y	N	O	O
代表	n	N	N	O	O
x	x	N	N	O	O
坐标	v	Y	N	O	O
，	x	N	N	O	O
数字	n	Y	N	O	O
代表	n	N	N	O	O
y	x	N	N	O	O
坐标	v	Y	N	O	O
，	x	N	N	O	O
问	n	N	N	O	O
最少	d	N	N	O	O
经过	p	N	N	O	O
多少	m	N	N	O	O
步	n	N	N	O	O
可以	c	N	N	O	O
使	v	N	N	O	O
棋盘	n	Y	N	O	O
上	f	N	N	O	O
的	uj	N	N	O	O
棋子	n	N	N	O	O
都	d	N	N	O	O
到达	v	N	N	O	O
同一个	b	N	N	O	O
格子	n	N	N	O	O
？	x	N	N	O	O

分析	vn	N	N	O	O
：	x	N	N	O	O
先	d	N	N	O	O
按照	p	N	N	O	O
马	n	N	N	O	O
走	v	N	N	O	O
的	uj	N	N	O	O
线路	n	N	N	O	O
建图	n	Y	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
用	p	N	N	O	O
floyd	eng	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
算出	v	N	N	O	O
每	r	N	N	O	O
两个	m	N	N	O	O
点	m	N	N	O	O
之间	f	N	N	O	O
的	uj	N	N	O	O
最小	a	Y	N	O	O
步数	n	N	N	O	O
，	x	N	N	O	O
接着就是	l	N	N	O	O
枚举	nz	Y	N	O	O
，	x	N	N	O	O
第一步	m	N	N	O	O
枚举	nz	Y	N	O	O
可能	v	N	N	O	O
的	uj	N	N	O	O
汇聚	v	N	N	O	O
点	m	N	N	O	O
，	x	N	N	O	O
第二步	m	N	N	O	O
枚举	nz	Y	N	O	O
一个	m	N	N	O	O
马	n	N	N	O	O
带走	v	N	N	O	O
王	nr	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
，	x	N	N	O	O
最后	f	N	N	O	O
就是	d	N	N	O	O
枚举	nz	Y	N	O	O
每个	r	N	N	O	O
马	n	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
，	x	N	N	O	O
计算	v	Y	N	O	O
出	v	N	N	O	O
最小	a	Y	N	O	O
的	uj	N	N	O	O
步数	n	N	N	O	O
。	x	N	N	O	O

代码	n	N	N	O	O
及	c	N	N	O	O
部分	n	Y	N	O	O
注释	v	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
math	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAX	eng	N	N	O	O

70	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

INF	eng	N	N	O	O

1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
29	m	N	N	O	O

int	eng	N	N	O	O

sx	eng	N	N	O	O
,	x	N	N	O	O
sy	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

dx	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
dy	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

ch	eng	Y	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cnt	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ix	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

iy	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

max	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

b	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
>	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

a	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

return	eng	N	N	O	O

b	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

check	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

y	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	m	N	N	O	O
&&	x	N	N	O	O
y	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	m	N	N	O	O
&&	x	N	N	O	O
x	eng	N	N	O	O
<	x	N	N	O	O
8	m	N	N	O	O
&&	x	N	N	O	O
y	eng	N	N	O	O
<	x	N	N	O	O
8	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
建图	n	Y	N	O	O

以	p	N	N	O	O
马	n	N	N	O	O
走	v	N	N	O	O
的	uj	N	N	O	O
路线	n	N	N	O	O
建图	n	Y	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
dis	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
dis	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
64	m	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
64	m	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
INF	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
8	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
8	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
8	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
ix	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
i	eng	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
iy	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
j	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
check	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
continue	eng	N	N	O	O
;	x	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
*	x	N	N	O	O
8	m	N	N	O	O
+	x	N	N	O	O
j	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
*	x	N	N	O	O
8	m	N	N	O	O
+	x	N	N	O	O
y	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
*	x	N	N	O	O
8	m	N	N	O	O
+	x	N	N	O	O
y	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
*	x	N	N	O	O
8	m	N	N	O	O
+	x	N	N	O	O
j	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

floyd	eng	Y	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
64	m	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
64	m	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
64	m	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
64	m	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

fun	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
tmp	eng	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
INF	eng	N	N	O	O
,	x	N	N	O	O
min	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
64	m	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
枚举	nz	Y	N	O	O
可能	v	N	N	O	O
的	uj	N	N	O	O
汇集点	n	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
64	m	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
枚举	nz	Y	N	O	O
可能	v	N	N	O	O
的	uj	N	N	O	O
带走	v	N	N	O	O
王	nr	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O

{	x	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
(	x	N	N	O	O
abs	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
%	x	N	N	O	O
8	x	N	N	O	O
-	x	N	N	O	O
sx	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
abs	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
/	x	N	N	O	O
8	x	N	N	O	O
-	x	N	N	O	O
sy	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
王	nr	N	N	O	O
走	v	N	N	O	O
的	uj	N	N	O	O
步数	n	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
INF	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
c	x	N	N	O	O
<	x	N	N	O	O
cnt	eng	N	N	O	O
;	x	N	N	O	O
c++	nz	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
dx	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
dy	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
8	x	N	N	O	O
;	x	N	N	O	O

tmp	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
每个	r	N	N	O	O
马	n	N	N	O	O
到	v	N	N	O	O
汇集点	n	N	N	O	O
的	uj	N	N	O	O
距离	n	Y	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
min	eng	N	N	O	O
)	x	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
dis	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
选择	v	N	N	O	O
最少	d	N	N	O	O
的	uj	N	N	O	O
带走	v	N	N	O	O
王	nr	N	N	O	O
的	uj	N	N	O	O
马	n	N	N	O	O

}	x	N	N	O	O

tmp	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
>	x	N	N	O	O
tmp	eng	N	N	O	O
)	x	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
tmp	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
INF	eng	N	N	O	O
)	x	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ch	eng	Y	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

sx	eng	N	N	O	O
=	x	N	N	O	O
ch	eng	Y	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

sy	eng	N	N	O	O
=	x	N	N	O	O
ch	eng	Y	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
1	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

cnt	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
strlen	eng	N	N	O	O
(	x	N	N	O	O
ch	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dx	eng	N	N	O	O
[	x	N	N	O	O
cnt	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
ch	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

dy	eng	N	N	O	O
[	x	N	N	O	O
cnt	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
ch	eng	Y	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
1	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

floyd	eng	Y	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

fun	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

D4A3A8H1H8	eng	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

10	m	N	N	O	O

A1A2A3H2H5H6H7H8C1C2C5C6C7E2E3E4E5E6E7E8	eng	N	N	O	O

42	m	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

[	x	N	N	O	O
后缀	n	Y	N	B-KNOWLEDGE	O
数组	n	Y	N	I-KNOWLEDGE	O
、	x	N	N	O	O
出现	v	N	N	O	O
k	eng	N	N	O	O
次	m	N	N	O	O
的	uj	N	N	O	O
重复	d	Y	N	O	O
子串	n	Y	N	O	O
]	x	N	N	O	O
Pku3261	eng	N	Y	B-OJ	B-OJ

-	x	N	N	O	O
-	x	N	N	O	O

Milk	eng	N	N	O	O

Patterns	eng	N	N	O	O
_	x	N	N	O	O
Fstephen	eng	N	N	O	O
的	uj	N	N	O	O
茶几	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
pku	eng	N	Y	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
JudgeOnline	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
3261	m	N	N	O	O

题目	n	Y	N	O	O
大意	d	N	N	O	O
：	x	N	N	O	O
给出	v	N	N	O	O
n	eng	N	N	O	O
个	m	N	N	O	O
数字	n	Y	N	O	O
组成	v	N	N	O	O
的	uj	N	N	O	O
一个	m	N	N	O	O
字符串	n	Y	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
最长	a	Y	N	O	O
的	uj	N	N	O	O
恰好	d	N	N	O	O
出现	v	N	N	O	O
k	eng	N	N	O	O
次	m	N	N	O	O
的	uj	N	N	O	O
重复	d	Y	N	O	O
子串	n	Y	N	O	O
（	x	N	N	O	O
可	v	N	N	O	O
重叠	v	N	N	O	O
）	x	N	N	O	O
的	uj	N	N	O	O
字符串	n	Y	N	O	O
的	uj	N	N	O	O
长度	ns	Y	N	O	O
。	x	N	N	O	O

分析	vn	N	N	O	O
：	x	N	N	O	O
后缀	n	Y	N	B-KNOWLEDGE	O
数组	n	Y	N	I-KNOWLEDGE	O
一个	m	N	N	O	O
经典	n	N	N	O	O
的	uj	N	N	O	O
应用	v	N	N	O	O
。	x	N	N	O	O

先	d	N	N	O	O
二分	m	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
答案	n	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
分组	vn	Y	N	O	O
。	x	N	N	O	O

只要	c	N	N	O	O
某	r	N	N	O	O
一组	m	N	N	O	O
包含	v	N	N	O	O
的	uj	N	N	O	O
后缀	n	Y	N	O	O
数量	n	N	N	O	O
大于	d	N	N	O	O
等于	v	N	N	O	O
k	x	N	N	O	O
，	x	N	N	O	O
表示	v	Y	N	O	O
有	v	N	N	O	O
解	v	N	N	O	O
。	x	N	N	O	O

这个	r	N	N	O	O
不难理解	l	N	N	O	O
。	x	N	N	O	O

等	u	N	N	O	O
完成	v	N	N	O	O
了	ul	N	N	O	O
论文	nz	N	N	O	O
里面	f	N	N	O	O
的	uj	N	N	O	O
练习	v	N	N	O	O
之后	f	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
再	d	N	N	O	O
写	v	N	N	O	O
个	q	N	N	O	O
总结	n	N	N	O	O
笔记	n	N	N	O	O
吧	y	N	N	O	O
。	x	N	N	O	O

深刻	d	N	N	O	O
体会	n	N	N	O	O
到	v	N	N	O	O
后缀	n	Y	N	B-KNOWLEDGE	O
数组	n	Y	N	I-KNOWLEDGE	O
的	uj	N	N	O	O
强大	a	N	N	O	O
....	m	N	N	O	O

note	eng	N	N	O	O
：	x	N	N	O	O
1	x	N	N	O	O
、	x	N	N	O	O
分组	vn	Y	N	O	O
时	n	N	N	O	O
，	x	N	N	O	O
每次	r	N	N	O	O
height	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
k	eng	N	N	O	O
时	n	N	N	O	O
，	x	N	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
个	m	N	N	O	O
后缀	n	Y	N	O	O
是	v	N	N	O	O
归到	v	N	N	O	O
下	f	N	N	O	O
一个组	m	N	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

2	x	N	N	O	O
、	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
返回	v	N	N	O	O
的	uj	N	N	O	O
值	n	N	N	O	O
是	v	N	N	O	O
成功	a	N	N	O	O
读取	v	N	N	O	O
了	ul	N	N	O	O
多少	m	N	N	O	O
个	q	N	N	O	O
数据	n	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
文件	n	N	N	O	O
结束	v	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
返回	v	N	N	O	O
EOF	eng	N	N	O	O
。	x	N	N	O	O

一	m	N	N	O	O
开始	v	N	N	O	O
不	d	N	N	O	O
知道	v	N	N	O	O
这个	r	N	N	O	O
，	x	N	N	O	O
结果	n	N	N	O	O
OLE	eng	N	N	O	O
=	x	N	N	O	O

=	x	N	N	O	O

codes	eng	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

maxn	eng	N	N	O	O
=	x	N	N	O	O
20010	m	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
wa	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
wb	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
wv	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
rank	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
height	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cmp	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

b	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

return	eng	N	N	O	O

r	x	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
b	x	N	N	O	O
]	x	N	N	O	O
&&	x	N	N	O	O
r	eng	N	N	O	O
[	x	N	N	O	O
a	eng	N	N	O	O
+	x	N	N	O	O
l	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
b	eng	N	N	O	O
+	x	N	N	O	O
l	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

da	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
sa	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

m	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
wa	eng	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
y	x	N	N	O	O
=	x	N	N	O	O
wb	eng	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

sa	eng	N	N	O	O
[	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
p	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
*	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
p	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
p	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
wv	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

sa	eng	N	N	O	O
[	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
wv	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
t	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
=	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
[	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

x	x	N	N	O	O
[	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
cmp	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
?	x	N	N	O	O
p	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
:	x	N	N	O	O
p	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

cal	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

*	x	N	N	O	O
sa	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

rank	eng	N	N	O	O
[	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
height	eng	N	N	O	O
[	x	N	N	O	O
rank	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
?	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
:	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
sa	eng	N	N	O	O
[	x	N	N	O	O
rank	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

check	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
cnt	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
height	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O

cnt	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
++	x	N	N	O	O
cnt	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
cnt	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

bin	eng	N	N	O	O
_	x	N	N	O	O
search	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
r	eng	N	N	O	O
+	x	N	N	O	O
l	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
l	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O
mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
r	eng	N	N	O	O
+	x	N	N	O	O
l	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
check	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

l	x	N	N	O	O
=	x	N	N	O	O
mid	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

r	x	N	N	O	O
=	x	N	N	O	O
mid	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

mid	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
k	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
>	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
?	x	N	N	O	O
m	x	N	N	O	O
:	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

m	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

da	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
sa	eng	N	N	O	O
,	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cal	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
sa	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
bin	eng	N	N	O	O
_	x	N	N	O	O
search	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

3333	m	N	N	I-OJ	I-OJ
_	x	N	N	O	O
foreverlin	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
dfs	eng	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
,	x	N	N	O	O
从	p	N	N	O	O
1	m	N	N	O	O
到	v	N	N	O	O
n	eng	N	N	O	O
有序	n	Y	N	O	O
的	uj	N	N	O	O
检查	vn	N	N	O	O

dfs	eng	Y	N	B-KNOWLEDGE	B-KNOWLEDGE

/	x	N	N	O	O
/	x	N	N	O	O
这么	r	N	N	O	O
想	v	N	N	O	O
如果	c	N	N	O	O
能	v	N	N	O	O
回到	v	N	N	O	O
比	p	N	N	O	O
当前	t	N	N	O	O
小	a	N	N	O	O
的	uj	N	N	O	O
编号	n	N	N	O	O
，	x	N	N	O	O
那	r	N	N	O	O
当然	d	N	N	O	O
回去	v	N	N	O	O
划算	v	N	N	O	O
啦	y	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
这点	mq	N	N	O	O
的	uj	N	N	O	O
跳跃	v	N	N	O	O
点	m	N	N	O	O
比	p	N	N	O	O
当前	t	N	N	O	O
大	a	N	N	O	O
，	x	N	N	O	O
且	c	N	N	O	O
值比	v	N	N	O	O
顺序	n	N	N	O	O
走	v	N	N	O	O
又	d	N	N	O	O
多	m	N	N	O	O
肯定	v	N	N	O	O
不会	v	N	N	O	O
选择	v	N	N	O	O
跳跃	v	N	N	O	O

typedef	eng	N	N	O	O

struct	eng	N	N	O	O

Node	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

d	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
正常	d	N	N	O	O
的	uj	N	N	O	O
查询	v	N	N	O	O

int	eng	N	N	O	O

td	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
玩	n	N	N	O	O
trick	eng	N	N	O	O
了	ul	N	N	O	O
他	r	N	N	O	O
检查	vn	N	N	O	O
所需	n	N	N	O	O
的	uj	N	N	O	O
时间	n	N	N	O	O

int	eng	N	N	O	O

tc	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
到	v	N	N	O	O
下	f	N	N	O	O
个	q	N	N	O	O
房间	n	N	N	O	O
去	v	N	N	O	O

}	x	N	N	O	O
Node	eng	N	N	O	O
;	x	N	N	O	O

Node	eng	N	N	O	O

num	eng	N	N	O	O
[	x	N	N	O	O
101	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
101	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
101	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

c	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
>	x	N	N	O	O
sum	eng	N	N	O	O
)	x	N	N	O	O
sum	eng	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
tc	eng	N	N	O	O
<	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
tc	eng	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
d	eng	N	N	O	O
-	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
tc	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
d	eng	N	N	O	O
<	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
td	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
tc	eng	N	N	O	O
,	x	N	N	O	O
c	eng	N	N	O	O
+	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
td	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
tc	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
c	eng	N	N	O	O
+	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
d	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
t	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
d	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
td	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
tc	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
记录	n	Y	N	O	O
顺序	n	N	N	O	O
找	v	N	N	O	O
的	uj	N	N	O	O
代价	n	N	N	O	O

{	x	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
num	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
d	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ3249	eng	N	Y	B-OJ	B-OJ
（	x	N	N	O	O
Test	eng	N	N	O	O

for	eng	Y	N	O	O

Job	eng	N	N	O	O
）	x	N	N	O	O

-	x	N	N	O	O

Oi	eng	N	N	O	O
不	c	N	N	O	O
回头	v	N	N	O	O
，	x	N	N	O	O
菜鸟	n	N	N	O	O
变大牛	nz	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

拓扑	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
排序	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
+	x	N	N	O	O
打擂台	v	N	N	O	O

找	v	N	N	O	O
一个	m	N	N	O	O
入度	ns	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
结点	n	Y	N	O	O
进行	v	N	N	O	O
DFS	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
，	x	N	N	O	O
直到	v	N	N	O	O
找到	v	N	N	O	O
一个	m	N	N	O	O
出度	n	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
结点	n	Y	N	O	O
结束	v	N	N	O	O
并	c	N	N	O	O
更新	d	N	N	O	O
ans	eng	N	N	O	O
。	x	N	N	O	O

数据结构	n	N	N	O	O
使用	v	N	N	O	O
边	d	N	N	O	O
表	v	N	N	O	O
。	x	N	N	O	O

program	eng	N	N	O	O

POJ3249	eng	N	Y	O	B-OJ
;	x	N	N	O	O

const	eng	N	N	O	O

maxn	eng	N	N	O	O
=	x	N	N	O	O
100001	m	N	N	O	O
;	x	N	N	O	O

maxm	eng	N	N	O	O
=	x	N	N	O	O
1000001	m	N	N	O	O
;	x	N	N	O	O

type	eng	N	N	O	O

gta	eng	N	N	O	O
=	x	N	N	O	O
record	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
next	eng	N	N	O	O
:	x	N	N	O	O
longint	eng	N	N	O	O
;	x	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

var	eng	N	N	O	O

b	x	N	N	O	O
:	x	N	N	O	O
array	eng	N	N	O	O

[	x	N	N	O	O
0..	m	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O

of	eng	N	N	O	O

boolean	eng	N	N	O	O
;	x	N	N	O	O

map	eng	N	N	O	O
:	x	N	N	O	O
array	eng	N	N	O	O

[	x	N	N	O	O
0..	m	N	N	O	O
maxm	eng	N	N	O	O
]	x	N	N	O	O

of	eng	N	N	O	O

gta	eng	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
,	x	N	N	O	O
into	eng	N	N	O	O
,	x	N	N	O	O
first	eng	N	N	O	O
,	x	N	N	O	O
f	x	N	N	O	O
:	x	N	N	O	O
array	eng	N	N	O	O

[	x	N	N	O	O
0..	m	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O

of	eng	N	N	O	O

longint	eng	N	N	O	O
;	x	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
,	x	N	N	O	O
tot	eng	N	N	O	O
:	x	N	N	O	O
longint	eng	N	N	O	O
;	x	N	N	O	O

procedure	eng	N	N	O	O

init	eng	N	N	O	O
;	x	N	N	O	O

var	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
x1	eng	N	N	O	O
,	x	N	N	O	O
x2	eng	N	N	O	O
:	x	N	N	O	O
longint	eng	N	N	O	O
;	x	N	N	O	O

begin	eng	N	N	O	O

ans	eng	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
maxlongint	eng	N	N	O	O
;	x	N	N	O	O

fillchar	eng	N	N	O	O
(	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
false	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

fillchar	eng	N	N	O	O
(	x	N	N	O	O
f	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
f	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
200	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

fillchar	eng	N	N	O	O
(	x	N	N	O	O
map	eng	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
map	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

fillchar	eng	N	N	O	O
(	x	N	N	O	O
first	eng	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
first	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

fillchar	eng	N	N	O	O
(	x	N	N	O	O
into	eng	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
into	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tot	eng	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

readln	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

i	x	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O

to	eng	N	N	O	O

n	x	N	N	O	O

do	eng	N	N	O	O

readln	eng	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

i	x	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O

to	eng	N	N	O	O

m	x	N	N	O	O

do	eng	N	N	O	O

begin	eng	N	N	O	O

readln	eng	N	N	O	O
(	x	N	N	O	O
x1	eng	N	N	O	O
,	x	N	N	O	O
x2	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

inc	eng	N	N	O	O
(	x	N	N	O	O
into	eng	N	N	O	O
[	x	N	N	O	O
x2	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

inc	eng	N	N	O	O
(	x	N	N	O	O
tot	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
tot	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
x1	eng	N	N	O	O
;	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
tot	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
x2	eng	N	N	O	O
;	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
tot	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
next	eng	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
first	eng	N	N	O	O
[	x	N	N	O	O
x1	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

first	eng	N	N	O	O
[	x	N	N	O	O
x1	eng	N	N	O	O
]	x	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
tot	eng	N	N	O	O
;	x	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

procedure	eng	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
:	x	N	N	O	O
longint	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

var	eng	N	N	O	O

t	x	N	N	O	O
,	x	N	N	O	O
now	eng	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
:	x	N	N	O	O
longint	eng	N	N	O	O
;	x	N	N	O	O

begin	eng	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
先	d	N	N	O	O
标记	n	N	N	O	O
这个	r	N	N	O	O
点	m	N	N	O	O
已	d	N	N	O	O
访问	v	N	N	O	O
过	ug	N	N	O	O
。	x	N	N	O	O

now	eng	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
maxlongint	eng	N	N	O	O
;	x	N	N	O	O

t	x	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
first	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
先	d	N	N	O	O
找	v	N	N	O	O
与	p	N	N	O	O
x	eng	N	N	O	O
相连	d	N	N	O	O
的	uj	N	N	O	O
第一个	m	N	N	O	O
结点	n	Y	N	O	O
。	x	N	N	O	O

while	eng	N	N	O	O

t	x	N	N	O	O
<	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O

do	eng	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
把	p	N	N	O	O
与	p	N	N	O	O
x	eng	N	N	O	O
相连	d	N	N	O	O
的	uj	N	N	O	O
所有	b	N	N	O	O
点	m	N	N	O	O
遍历	v	Y	N	O	O
一遍	m	N	N	O	O
。	x	N	N	O	O

begin	eng	N	N	O	O

y	x	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

not	eng	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O

then	eng	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
与	p	N	N	O	O
x	eng	N	N	O	O
相连	d	N	N	O	O
的	uj	N	N	O	O
这个	r	N	N	O	O
点	m	N	N	O	O
没有	v	N	N	O	O
访问	v	N	N	O	O
过	ug	N	N	O	O
就	d	N	N	O	O
访问	v	N	N	O	O
。	x	N	N	O	O

if	eng	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
now	eng	N	N	O	O

then	eng	N	N	O	O

now	eng	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
＞	x	N	N	O	O
now	eng	N	N	O	O
就	d	N	N	O	O
更新	d	N	N	O	O
。	x	N	N	O	O

t	x	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
next	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
访问	v	N	N	O	O
下	f	N	N	O	O
一个点	m	N	N	O	O
。	x	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

first	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O

then	eng	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

else	eng	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
now	eng	N	N	O	O
+	x	N	N	O	O
c	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
这个	r	N	N	O	O
点	m	N	N	O	O
的	uj	N	N	O	O
出度	n	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
（	x	N	N	O	O
终点	d	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
值	n	N	N	O	O
返回	v	N	N	O	O
这个	r	N	N	O	O
点	m	N	N	O	O
的	uj	N	N	O	O
值	n	N	N	O	O
。	x	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

procedure	eng	N	N	O	O

main	eng	N	N	O	O
;	x	N	N	O	O

var	eng	N	N	O	O

i	x	N	N	O	O
:	x	N	N	O	O
longint	eng	N	N	O	O
;	x	N	N	O	O

begin	eng	N	N	O	O

for	eng	Y	N	O	O

i	x	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O

to	eng	N	N	O	O

n	x	N	N	O	O

do	eng	N	N	O	O

begin	eng	N	N	O	O

if	eng	N	N	O	O

into	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O

then	eng	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
入度	ns	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
这个	r	N	N	O	O
点	m	N	N	O	O
为	p	N	N	O	O
起点	n	N	N	O	O
。	x	N	N	O	O

进行	v	N	N	O	O
DFS	eng	N	N	O	B-KNOWLEDGE
。	x	N	N	O	O

begin	eng	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
ans	eng	N	N	O	O

then	eng	N	N	O	O

ans	eng	N	N	O	O
:	x	N	N	O	O
=	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
以	p	N	N	O	O
当前	t	N	N	O	O
点	m	N	N	O	O
为	p	N	N	O	O
起点	n	N	N	O	O
得到	v	N	N	O	O
的	uj	N	N	O	O
结果	n	N	N	O	O
＞	x	N	N	O	O
ans	eng	N	N	O	O
就	d	N	N	O	O
更新	d	N	N	O	O
。	x	N	N	O	O

（	x	N	N	O	O
打擂台	v	N	N	O	O
）	x	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

begin	eng	N	N	O	O

assign	eng	N	N	O	O
(	x	N	N	O	O
input	eng	N	N	O	O
,	x	N	N	O	O
'	x	N	N	O	O
POJ3249	eng	N	Y	O	O
.	m	N	N	O	O
in	eng	Y	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

reset	eng	N	N	O	O
(	x	N	N	O	O
input	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

assign	eng	N	N	O	O
(	x	N	N	O	O
output	eng	N	N	O	O
,	x	N	N	O	O
'	x	N	N	O	O
POJ3249	eng	N	Y	O	O
.	m	N	N	O	O
out	eng	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

rewrite	eng	N	N	O	O
(	x	N	N	O	O
output	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

not	eng	N	N	O	O

eof	eng	N	N	O	O

do	eng	N	N	O	O

begin	eng	N	N	O	O

init	eng	N	N	O	O
;	x	N	N	O	O

main	eng	N	N	O	O
;	x	N	N	O	O

writeln	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

end	eng	N	N	O	O
;	x	N	N	O	O

close	eng	N	N	O	O
(	x	N	N	O	O
input	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

close	eng	N	N	O	O
(	x	N	N	O	O
output	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

end	eng	N	N	O	O
.	m	N	N	O	O

pku	eng	N	Y	B-OJ	B-OJ

1505	m	N	N	I-OJ	O

copying	eng	N	N	O	O

books	eng	N	N	O	O
(	x	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	O
)	x	N	N	O	O

-	x	N	N	O	O

xmx	eng	N	N	O	O

-	x	N	N	O	O

博客园	nr	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

books	eng	N	N	O	O
[	x	N	N	O	O
510	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
510	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
510	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

part	eng	N	N	O	O
[	x	N	N	O	O
510	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

Max	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
?	x	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
:	x	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

Min	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
?	x	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
:	x	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

int	eng	N	N	O	O

sum	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
p	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O
p	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

t	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

books	eng	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

t	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

cal2	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
st	eng	Y	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

sum	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

books	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

Max	eng	N	N	O	O
(	x	N	N	O	O
books	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

k	x	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

l	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

l	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
sum	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
books	eng	N	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
]	x	N	N	O	O

>	x	N	N	O	O
=	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

books	eng	N	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
]	x	N	N	O	O

,	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

l	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
sum	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

>	x	N	N	O	O
=	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

j	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

Min	eng	N	N	O	O
(	x	N	N	O	O

sum	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

j	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O

,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O

st	eng	Y	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

books	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
t	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
k	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
books	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cal2	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

st	eng	Y	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

st	eng	Y	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

books	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
st	eng	Y	N	O	O

>	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
m	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

part	eng	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

st	eng	Y	N	O	O

=	x	N	N	O	O

books	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
st	eng	Y	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
m	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
-	x	N	N	O	O
j	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

part	eng	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

st	eng	Y	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

part	eng	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

st	eng	Y	N	O	O

=	x	N	N	O	O

books	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

j	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
books	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

part	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O

/	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
books	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

(	x	N	N	O	O
调换	v	N	N	O	O
次序	n	N	N	O	O
)	x	N	N	O	O
POJ2013	eng	N	Y	B-OJ	B-OJ

Symmetric	eng	N	N	O	O

Order	eng	N	N	O	O
_	x	N	N	O	O
On	eng	N	N	O	O
_	x	N	N	O	O
the	eng	N	N	O	O
_	x	N	N	O	O
road	eng	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

题目	n	Y	N	O	O
：	x	N	N	O	O
http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
poj	eng	N	Y	O	O
.	m	N	N	O	O
org	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
2013	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
set	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

str	eng	Y	N	O	O
[	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
30	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
30	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
SET	eng	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
set	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

2985	m	N	N	I-OJ	I-OJ
_	x	N	N	O	O
乐吾天	nr	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

昨天	t	N	N	O	O
zbwm	eng	N	N	O	O
让	v	N	N	O	O
我	r	N	N	O	O
用	p	N	N	O	O
splay	eng	N	N	B-KNOWLEDGE	O
写	v	N	N	O	O
这	r	N	N	O	O
道题	n	N	N	O	O
，	x	N	N	O	O
但是	c	N	N	O	O
由于	c	N	N	O	O
我	r	N	N	O	O
傻	a	N	N	O	O
不	d	N	N	O	O
小心	n	N	N	O	O
忘	v	N	N	O	O
了	ul	N	N	O	O
splay	eng	N	N	B-KNOWLEDGE	O
怎么	r	N	N	O	O
写	v	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

想	v	N	N	O	O
了	ul	N	N	O	O
很久	m	N	N	O	O
终于	d	N	N	O	O
想	v	N	N	O	O
起来	v	N	N	O	O
怎么	r	N	N	O	O
写	v	N	N	O	O
splay	eng	N	N	B-KNOWLEDGE	O
了	ul	N	N	O	O
，	x	N	N	O	O
用	p	N	N	O	O
vijos1081	eng	N	N	B-OJ	O
试了试	v	N	N	O	O
发现	v	N	N	O	O
的确	d	N	N	O	O
没	d	N	N	O	O
写	v	N	N	O	O
次	q	N	N	O	O
，	x	N	N	O	O
于是	c	N	N	O	O
我	r	N	N	O	O
就	d	N	N	O	O
用	p	N	N	O	O
splay	eng	N	N	B-KNOWLEDGE	O
写	v	N	N	O	O
了	ul	N	N	O	O
个	q	N	N	O	O
这	r	N	N	O	O
道题	n	N	N	O	O
。	x	N	N	O	O

gnaggnoyil	eng	N	N	O	O
神牛	n	N	N	O	O
用	p	N	N	O	O
sbt	eng	N	N	O	O
只用	v	N	N	O	O
了	ul	N	N	O	O
1313	m	N	N	O	O
ms	eng	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
就	d	N	N	O	O
比较	d	N	N	O	O
弱	a	N	N	O	O
，	x	N	N	O	O
写	v	N	N	O	O
了	ul	N	N	O	O
个	q	N	N	O	O
splay	eng	N	N	B-KNOWLEDGE	O
用	p	N	N	O	O
了	ul	N	N	O	O
1422	m	N	N	O	O
ms	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

maxn	eng	N	N	O	O
=	x	N	N	O	O
250001	m	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
key	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
root	eng	N	N	O	O
,	x	N	N	O	O
total	eng	N	N	O	O
,	x	N	N	O	O
nt	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
size	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

splay	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O
&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

pt	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

pt	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
pt	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

key	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
key	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

w	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
>	x	N	N	O	O
key	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
>	x	N	N	O	O
key	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
w	eng	N	N	O	O
&&	x	N	N	O	O
k	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
key	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
s	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
pt	eng	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

pt	eng	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

ps	eng	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

w	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
w	x	N	N	O	O
<	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
w	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
pt	eng	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

pt	eng	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

ps	eng	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
y	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
pt	eng	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

ps	eng	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
s	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O
&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

splay	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
x	eng	N	N	O	O
&&	x	N	N	O	O
key	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O
return	eng	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

int	eng	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
++	x	N	N	O	O
total	eng	N	N	O	O
;	x	N	N	O	O
key	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O
return	eng	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

int	eng	N	N	O	O

w	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
>	x	N	N	O	O
key	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
!	x	N	N	O	O
w	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
s	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

remove	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O
&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

splay	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O
return	eng	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

int	eng	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
return	eng	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

splay	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
s	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

get	eng	N	N	O	O
_	x	N	N	O	O
kth	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
;	x	N	N	O	O
;	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
continue	eng	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

k	x	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
count	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

splay	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
,	x	N	N	O	O
key	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

key	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

father	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

p	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
;	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
p	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
;	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
=	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

p	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

freopen	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
1.	m	N	N	O	O
in	eng	Y	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
r	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
stdin	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

nt	eng	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

size	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

w	x	N	N	O	O
,	x	N	N	O	O
u	x	N	N	O	O
,	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
w	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
w	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
u	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
v	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

u	x	N	N	O	O
=	x	N	N	O	O
father	eng	N	N	O	O
(	x	N	N	O	O
u	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
v	x	N	N	O	O
=	x	N	N	O	O
father	eng	N	N	O	O
(	x	N	N	O	O
v	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
u	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
v	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

remove	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
,	x	N	N	O	O
size	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

remove	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
,	x	N	N	O	O
size	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

size	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
size	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O

nt	eng	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
,	x	N	N	O	O
size	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
u	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
get	eng	N	N	O	O
_	x	N	N	O	O
kth	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
,	x	N	N	O	O
nt	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
-	x	N	N	O	O
u	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

推荐	v	N	N	O	O
文章	n	N	N	O	O
:	x	N	N	O	O

1.	m	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

1733	m	N	N	I-OJ	I-OJ

/	x	N	N	O	O

URAL	eng	N	N	B-OJ	B-OJ

1003	m	N	N	I-OJ	I-OJ

Parity	eng	N	N	O	O

game	eng	N	N	O	O

[	x	N	N	O	O
并	c	N	N	B-KNOWLEDGE	B-KNOWLEDGE
查集	v	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
]	x	N	N	I-KNOWLEDGE	O

2.	m	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

1611	m	N	N	I-OJ	I-OJ
-	x	N	N	O	O
The	eng	N	N	O	O

Suspects	eng	N	N	O	O

3.	m	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

1006	m	N	N	I-OJ	I-OJ

Biorhythms	eng	N	N	O	O

4.	m	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

1005	m	N	N	I-OJ	O

I	x	N	N	O	O

Think	eng	N	N	O	O

I	x	N	N	O	O

Need	eng	N	N	O	O

a	x	N	N	O	O

Houseboat	eng	N	N	O	O

5.	m	N	N	O	O

[	x	N	N	B-OJ	O
POJ	eng	N	Y	I-OJ	B-OJ

2019	m	N	N	I-OJ	I-KNOWLEDGE
]	x	N	N	O	O
矩阵	n	Y	N	O	O
处理	v	N	N	O	O

6.	m	N	N	O	O

[	x	N	N	O	O
POJ	eng	N	Y	B-OJ	B-OJ

1019	m	N	N	I-OJ	I-OJ
]	x	N	N	O	O
数字	n	Y	N	O	O
处理	v	N	N	O	O

7.	m	N	N	O	O

[	x	N	N	O	O
POJ	eng	N	Y	B-OJ	B-OJ

2299	m	N	N	I-OJ	I-OJ
]	x	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O

8.	m	N	N	O	O

[	x	N	N	O	O
POJ	eng	N	Y	B-OJ	B-OJ

2029	m	N	N	I-OJ	I-OJ
]	x	N	N	O	O
矩阵	n	Y	N	O	O
处理	v	N	N	O	O

9.	m	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

1140	m	N	N	I-OJ	I-OJ

Expanding	eng	N	N	O	O

Fractions	eng	N	N	O	O

模拟	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE

UVa	eng	N	N	B-OJ	O

590	m	N	N	I-OJ	O

-	x	N	N	O	O

Always	eng	N	N	O	O

on	eng	N	N	O	O

the	eng	N	N	O	O

run	eng	N	N	O	O
_	x	N	N	O	O
Knowledgetime	eng	N	N	O	O
的	uj	N	N	O	O
空间	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

UVa	eng	N	N	B-OJ	O

590	m	N	N	I-OJ	O

-	x	N	N	O	O

Always	eng	N	N	O	O

on	eng	N	N	O	O

the	eng	N	N	O	O

run	eng	N	N	O	O

读	v	N	N	O	O
了	ul	N	N	O	O
半天	m	N	N	O	O
题目	n	Y	N	O	O
，	x	N	N	O	O
又	d	N	N	O	O
在	p	N	N	O	O
st8676746	eng	N	N	O	O
帮助	v	N	N	O	O
下才	t	N	N	O	O
真正	d	N	N	O	O
将题	n	N	N	O	O
理解	v	N	N	O	O
，	x	N	N	O	O
不过	c	N	N	O	O
大部分	m	N	N	O	O
还是	c	N	N	O	O
靠	v	N	N	O	O
我	r	N	N	O	O
的	uj	N	N	O	O
努力	ad	N	N	O	O
。	x	N	N	O	O

在	p	N	N	O	O
这里	r	N	N	O	O
感谢	v	N	N	O	O
st867646	eng	N	N	O	O
！	x	N	N	O	O

说	v	N	N	O	O
实在	v	N	N	O	O
的	uj	N	N	O	O
在	p	N	N	O	O
看到	v	N	N	O	O
别人	r	N	N	O	O
对	p	N	N	O	O
这	r	N	N	O	O
题	n	N	N	O	O
的	uj	N	N	O	O
评价	n	N	N	O	O
：	x	N	N	O	O
简单	a	N	N	O	O
题	n	N	N	O	O
，	x	N	N	O	O
水题	n	N	N	O	O
...	m	N	N	O	O
再	d	N	N	O	O
想想	v	N	N	O	O
自己	r	N	N	O	O
当时	t	N	N	O	O
在	p	N	N	O	O
看	v	N	N	O	O
这	r	N	N	O	O
题	n	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
没有	v	N	N	O	O
思路	n	N	N	O	O
，	x	N	N	O	O
也	d	N	N	O	O
不知	v	N	N	O	O
如何	r	N	N	O	O
下手	v	N	N	O	O
，	x	N	N	O	O
心理	n	N	N	O	O
无不	d	N	N	O	O
是	v	N	N	O	O
一种	m	N	N	O	O
打击	v	N	N	O	O
，	x	N	N	O	O
心中	s	N	N	O	O
不由	a	N	N	O	O
产生	n	N	N	O	O
一种	m	N	N	O	O
自卑感	n	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
感觉	n	N	N	O	O
自己	r	N	N	O	O
太弱	a	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

可	v	N	N	O	O
我	r	N	N	O	O
并	c	N	N	O	O
没有	v	N	N	O	O
被	p	N	N	O	O
这	r	N	N	O	O
击倒	v	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
还是	c	N	N	O	O
坚强	v	N	N	O	O
的	uj	N	N	O	O
面对	v	N	N	O	O
。	x	N	N	O	O

我	r	N	N	O	O
也	d	N	N	O	O
没看	v	N	N	O	O
那些	r	N	N	O	O
牛人	n	N	N	O	O
的	uj	N	N	O	O
代码	n	N	N	O	O
，	x	N	N	O	O
他们	r	N	N	O	O
写	v	N	N	O	O
得	ud	N	N	O	O
高级	b	N	N	O	O
我	r	N	N	O	O
可能	v	N	N	O	O
不	d	N	N	O	O
太	d	N	N	O	O
看	v	N	N	O	O
懂	v	N	N	O	O
。	x	N	N	O	O

只是	c	N	N	O	O
自己	r	N	N	O	O
永不	d	N	N	O	O
停息	v	N	N	O	O
的	uj	N	N	O	O
想	v	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
半天	m	N	N	O	O
了	ul	N	N	O	O
过去	t	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
直到现在	l	N	N	O	O
我	r	N	N	O	O
才	d	N	N	O	O
解决	v	N	N	O	O
这	r	N	N	O	O
题	n	N	N	O	O
，	x	N	N	O	O
但	c	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
一次	m	N	N	O	O
AC	eng	N	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

就	d	N	N	O	O
说	v	N	N	O	O
说	v	N	N	O	O
这	r	N	N	O	O
题	n	N	N	O	O
的	uj	N	N	O	O
解法	v	Y	N	O	O
吧	y	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
没有	v	N	N	O	O
利用	n	N	N	O	O
什么	r	N	N	O	O
高级	b	N	N	O	O
的	uj	N	N	O	O
东西	ns	N	N	O	O
，	x	N	N	O	O
只是	c	N	N	O	O
利用	n	N	N	O	O
简单	a	N	N	O	O
语句	n	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
想	v	N	N	O	O
代码	n	N	N	O	O
可读性	n	N	N	O	O
还	d	N	N	O	O
可以	c	N	N	O	O
。	x	N	N	O	O

这	r	N	N	O	O
题	n	N	N	O	O
是	v	N	N	O	O
好像	v	N	N	O	O
是	v	N	N	O	O
最	d	N	N	B-KNOWLEDGE	O
短	a	N	N	I-KNOWLEDGE	I-KNOWLEDGE
路径	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
问题	n	N	N	O	O
，	x	N	N	O	O
但是	c	N	N	O	O
再	d	N	N	O	O
仔细	ad	N	N	O	O
想想	v	N	N	O	O
，	x	N	N	O	O
最好	a	N	N	O	O
的	uj	N	N	O	O
做法	v	N	N	O	O
是	v	N	N	O	O
利用	n	N	N	O	O
动态	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
规划	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
，	x	N	N	O	O
这样	r	N	N	O	O
可以	c	N	N	O	O
使	v	N	N	O	O
问题	n	N	N	O	O
变得	v	N	N	O	O
简单	a	N	N	O	O
。	x	N	N	O	O

最优	d	N	N	O	O
解	v	N	N	O	O
的	uj	N	N	O	O
来源	n	N	N	O	O
可能	v	N	N	O	O
有	v	N	N	O	O
n	eng	N	N	O	O
-	x	N	N	O	O
1	m	N	N	O	O
个	m	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
我们	r	N	N	O	O
令	nrt	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
表示	v	Y	N	O	O
城市	ns	N	N	O	O
i	eng	N	N	O	O
在	p	N	N	O	O
j	eng	N	N	O	O
天	q	N	N	O	O
的	uj	N	N	O	O
旅行	vn	N	N	O	O
最小	a	Y	N	O	O
费用	n	N	N	O	O
，	x	N	N	O	O
那么	r	N	N	O	O
则	d	N	N	O	O
有	v	N	N	O	O
状态	n	Y	N	O	O
转移	v	N	N	O	O
方程	n	Y	N	O	O
：	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
{	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
p	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

|	x	N	N	O	O

1	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O

and	eng	N	N	O	O

c	x	N	N	O	O
≠	x	N	N	O	O
i	x	N	N	O	O

}	x	N	N	O	O
.	x	N	N	O	O

Initinatify	eng	N	N	O	O
:	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

Anothers	eng	N	N	O	O
:	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O

目标	n	N	N	O	O
：	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O

.	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

Source	eng	N	N	O	O

Code	eng	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
cas	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
16	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
16	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
32	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O
days	eng	N	N	O	O
[	x	N	N	O	O
16	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
16	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
16	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1024	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

readdata	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
days	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

c	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
c	x	N	N	O	O
<	x	N	N	O	O
days	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
c++	nz	N	N	O	O
)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
p	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

travel	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
,	x	N	N	O	O
min	eng	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

c	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
c	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
c++	nz	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
No	eng	N	N	O	O

answer	eng	N	N	O	O

t	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
days	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
No	eng	N	N	O	O

flight	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
min	eng	N	N	O	O
<	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
p	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
min	eng	N	N	O	O
>	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
p	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
p	eng	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

ans	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
Scenario	eng	N	N	O	O

#	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
++	x	N	N	O	O
cas	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
The	eng	N	N	O	O

best	eng	N	N	O	O

flight	eng	N	N	O	O

costs	eng	N	N	O	O

%	x	N	N	O	O
d	eng	N	N	O	O
.	m	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
No	eng	N	N	O	O

flight	eng	N	N	O	O

possible	eng	N	N	O	O
.	m	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
k	eng	N	N	O	O
)	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
n	x	N	N	O	O

&&	x	N	N	O	O

!	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

readdata	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

travel	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ2038	eng	N	Y	B-OJ	B-OJ

-	x	N	N	O	O

hongshundi	eng	N	N	O	O
的	uj	N	N	O	O
专栏	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

摘要	v	N	N	O	O
：	x	N	N	O	O
水题	n	N	N	O	O
，	x	N	N	O	O
用	p	N	N	O	O
了	ul	N	N	O	O
next	eng	N	N	O	O
_	x	N	N	O	O
permutation	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

size	eng	N	N	O	O

=	x	N	N	O	O

100	m	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

length	eng	N	N	O	O

=	x	N	N	O	O

5	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

array	eng	N	N	O	O
[	x	N	N	O	O
length	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

string	eng	N	N	O	O

data	eng	N	N	O	O
[	x	N	N	O	O
size	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

calDist	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

dist	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
<	x	N	N	O	O
length	eng	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O
<	x	N	N	O	O
length	eng	N	N	O	O
;	x	N	N	O	O

k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
1	m	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
2	m	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

s	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
<	x	N	N	O	O
length	eng	N	N	O	O
;	x	N	N	O	O

s	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
at	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

array	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
1	m	N	N	O	O

=	x	N	N	O	O

s	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
at	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

array	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
2	m	N	N	O	O

=	x	N	N	O	O

s	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
index	eng	N	N	O	O
_	x	N	N	O	O
1	m	N	N	O	O

>	x	N	N	O	O

index	eng	N	N	O	O
_	x	N	N	O	O
2	m	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

dist	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

dist	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

n	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

n	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

data	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

min	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O

=	x	N	N	O	O

100	m	N	N	O	O

*	x	N	N	O	O

10	m	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
length	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

array	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
+	x	N	N	O	O
i	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

string	eng	N	N	O	O

median	eng	N	N	O	O
_	x	N	N	O	O
str	eng	Y	N	O	O

=	x	N	N	O	O

"	x	N	N	O	O
ABCDE	eng	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O

min	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O

=	x	N	N	O	O

min	eng	N	N	O	O
(	x	N	N	O	O
min	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O
,	x	N	N	O	O

calDist	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O

next	eng	N	N	O	O
_	x	N	N	O	O
permutation	eng	N	N	O	O
(	x	N	N	O	O
array	eng	N	N	O	O
,	x	N	N	O	O

array	eng	N	N	O	O
+	x	N	N	O	O
length	eng	N	N	O	O
)	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

value	eng	N	N	O	O

=	x	N	N	O	O

calDist	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

value	eng	N	N	O	O

<	x	N	N	O	O

min	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

min	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O

=	x	N	N	O	O

value	eng	N	N	O	O
;	x	N	N	O	O

median	eng	N	N	O	O
_	x	N	N	O	O
str	eng	Y	N	O	O
.	m	N	N	O	O
clear	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

buf	eng	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
length	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

sprintf	eng	N	N	O	O
(	x	N	N	O	O
buf	eng	N	N	O	O
,	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
c	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

array	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

median	eng	N	N	O	O
_	x	N	N	O	O
str	eng	Y	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

buf	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

median	eng	N	N	O	O
_	x	N	N	O	O
str	eng	Y	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

"	x	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

median	eng	N	N	O	O

ranking	eng	N	N	O	O

with	eng	N	N	O	O

value	eng	N	N	O	O

"	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

min	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

"	x	N	N	O	O
.	x	N	N	O	O
"	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

3844	m	N	N	I-OJ	O

Divisible	eng	N	N	O	O

Subsequences	eng	N	N	O	O

-	x	N	N	O	O

计算机	n	N	N	O	O
的	uj	N	N	O	O
艺术	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

Description	eng	N	N	O	O

Given	eng	N	N	O	O

a	x	N	N	O	O

sequence	eng	N	N	O	O

of	eng	N	N	O	O

positive	eng	N	N	O	O

integers	eng	N	N	O	O
,	x	N	N	O	O

count	eng	N	N	O	O

all	eng	N	N	O	O

contiguous	eng	N	N	O	O

subsequences	eng	N	N	O	O

(	x	N	N	O	O
sometimes	eng	N	N	O	O

called	eng	N	N	O	O

substrings	eng	N	N	O	O
,	x	N	N	O	O

in	eng	Y	N	O	O

contrast	eng	N	N	O	O

to	eng	N	N	O	O

subsequences	eng	N	N	O	O
,	x	N	N	O	O

which	eng	N	N	O	O

may	eng	N	N	O	O

leave	eng	N	N	O	O

out	eng	N	N	O	O

elements	eng	N	N	O	O
)	x	N	N	O	O

the	eng	N	N	O	O

sum	eng	N	N	O	O

of	eng	N	N	O	O

which	eng	N	N	O	O

is	eng	N	N	O	O

divisible	eng	N	N	O	O

by	eng	N	N	O	O

a	x	N	N	O	O

given	eng	N	N	O	O

number	eng	N	N	O	O
.	m	N	N	O	O

These	eng	N	N	O	O

subsequences	eng	N	N	O	O

may	eng	N	N	O	O

overlap	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

example	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

sequence	eng	N	N	O	O

(	x	N	N	O	O
see	eng	N	N	O	O

sample	eng	N	N	O	O

input	eng	N	N	O	O
)	x	N	N	O	O

2	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

2	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

2	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

2	x	N	N	O	O

contains	eng	N	N	O	O

six	eng	N	N	O	O

contiguous	eng	N	N	O	O

subsequences	eng	N	N	O	O

the	eng	N	N	O	O

sum	eng	N	N	O	O

of	eng	N	N	O	O

which	eng	N	N	O	O

is	eng	N	N	O	O

divisible	eng	N	N	O	O

by	eng	N	N	O	O

four	eng	N	N	O	O
:	x	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

to	eng	N	N	O	O

eighth	eng	N	N	O	O

number	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

second	eng	N	N	O	O

to	eng	N	N	O	O

fourth	eng	N	N	O	O

number	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

second	eng	N	N	O	O

to	eng	N	N	O	O

seventh	eng	N	N	O	O

number	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

third	eng	N	N	O	O

to	eng	N	N	O	O

fifth	eng	N	N	O	O

number	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

fourth	eng	N	N	O	O

to	eng	N	N	O	O

sixth	eng	N	N	O	O

number	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

fifth	eng	N	N	O	O

to	eng	N	N	O	O

seventh	eng	N	N	O	O

number	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

The	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

input	eng	N	N	O	O

consists	eng	N	N	O	O

of	eng	N	N	O	O

an	eng	Y	N	O	O

integer	eng	N	N	O	O

c	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

c	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

200	m	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

test	eng	N	N	O	O

cases	eng	N	N	O	O
.	m	N	N	O	O

Then	eng	N	N	O	O

follow	eng	N	N	O	O

two	eng	N	N	O	O

lines	eng	N	N	O	O

per	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O

starts	eng	N	N	O	O

with	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

consisting	eng	N	N	O	O

of	eng	N	N	O	O

two	eng	N	N	O	O

integers	eng	N	N	O	O

d	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

d	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O

000	m	N	N	O	O

000	m	N	N	O	O
)	x	N	N	O	O

and	eng	N	N	O	O

n	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

50	m	N	N	O	O

000	m	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

divisor	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

sum	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

subsequences	eng	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

length	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

sequence	eng	N	N	O	O
,	x	N	N	O	O

respectively	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

second	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O

contains	eng	N	N	O	O

the	eng	N	N	O	O

elements	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

sequence	eng	N	N	O	O
,	x	N	N	O	O

which	eng	N	N	O	O

are	eng	N	N	O	O

integers	eng	N	N	O	O

between	eng	N	N	O	O

1	x	N	N	O	O

and	eng	N	N	O	O

1	x	N	N	O	O

000	m	N	N	O	O

000	m	N	N	O	O

000	m	N	N	O	O
,	x	N	N	O	O

inclusively	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O
,	x	N	N	O	O

print	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

line	eng	N	N	O	O

consisting	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

integer	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

contiguous	eng	N	N	O	O

subsequences	eng	N	N	O	O

the	eng	N	N	O	O

sum	eng	N	N	O	O

of	eng	N	N	O	O

which	eng	N	N	O	O

is	eng	N	N	O	O

divisible	eng	N	N	O	O

by	eng	N	N	O	O

d	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

2	x	N	N	O	O

7	x	N	N	O	O

3	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

4	x	N	N	O	O

8	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

0	x	N	N	O	O

6	x	N	N	O	O

Source	eng	N	N	O	O

2009	m	N	N	O	O

ACM	eng	N	N	O	O

North	eng	N	N	O	O

Western	eng	N	N	O	O

European	eng	N	N	O	O

Regional	eng	N	N	O	O

Contest	eng	N	N	O	O

先求	n	N	N	O	O
累加	v	Y	N	O	O
和	c	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
...	m	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
求余	l	N	N	O	O
，	x	N	N	O	O
若	c	N	N	O	O
两个	m	N	N	O	O
累加	v	Y	N	O	O
和	c	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
，	x	N	N	O	O
那么	r	N	N	O	O
(	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
，	x	N	N	O	O
即	c	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

...	m	N	N	O	O

,	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
就是	d	N	N	O	O
一个	m	N	N	O	O
满足条件	l	N	N	O	O
的	uj	N	N	O	O
连续	a	Y	N	O	O
子	ng	N	N	O	O
序列	n	Y	N	O	O
。	x	N	N	O	O

注意	v	N	N	O	O
余数	m	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O
，	x	N	N	O	O
可以	c	N	N	O	O
在	p	N	N	O	O
原	n	N	N	O	O
序列	n	Y	N	O	O
最	d	N	N	O	O
前面	f	N	N	O	O
加上	v	N	N	O	O
一个	m	N	N	O	O
假设	vn	N	N	O	O
的	uj	N	N	O	O
元素	n	N	N	O	O
0	x	N	N	O	O
，	x	N	N	O	O
这	r	N	N	O	O
就	d	N	N	O	O
就	d	N	N	O	O
可以	c	N	N	O	O
统一	vn	N	N	O	O
处理	v	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
memory	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAX	eng	N	N	O	O
_	x	N	N	O	O
LEN	eng	N	N	O	O

50010	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAX	eng	N	N	O	O
_	x	N	N	O	O
NUMBER	eng	N	N	O	O

1000010	m	N	N	O	O

int	eng	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
_	x	N	N	O	O
LEN	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

mod	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
_	x	N	N	O	O
NUMBER	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

c	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
c	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

d	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
d	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
mod	eng	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
mod	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

mod	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
x	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

%	x	N	N	O	O
=	x	N	N	O	O

d	x	N	N	O	O
;	x	N	N	O	O

mod	eng	N	N	O	O
[	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

result	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

d	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
mod	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

>	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

result	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

mod	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

*	x	N	N	O	O

(	x	N	N	O	O
mod	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

result	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

3244	m	N	N	I-OJ	O

Difference	eng	N	N	O	O

between	eng	N	N	O	O

Triplets	eng	N	N	O	O

-	x	N	N	O	O

celia01	eng	N	N	O	O

-	x	N	N	O	O

博客园	nr	N	N	O	O

3244	m	N	N	O	O

一个	m	N	N	O	O
数学题	n	Y	N	O	O

Difference	eng	N	N	O	O

between	eng	N	N	O	O

Triplets	eng	N	N	O	O

For	eng	N	N	O	O

every	eng	N	N	O	O

pair	eng	N	N	O	O

of	eng	N	N	O	O

triplets	eng	N	N	O	O
,	x	N	N	O	O

Ta	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
Ia	eng	N	N	O	O
,	x	N	N	O	O

Ja	eng	N	N	O	O
,	x	N	N	O	O

Ka	eng	N	N	O	O
)	x	N	N	O	O

and	eng	N	N	O	O

Tb	eng	N	N	O	O
=	x	N	N	O	O

(	x	N	N	O	O
Ib	eng	N	N	O	O
,	x	N	N	O	O

Jb	eng	N	N	O	O
,	x	N	N	O	O

Kb	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

we	eng	N	N	O	O

define	eng	N	N	O	O

the	eng	N	N	O	O

difference	eng	N	N	O	O

value	eng	N	N	O	O

between	eng	N	N	O	O

Ta	eng	N	N	O	O

and	eng	N	N	O	O

Tbas	eng	N	N	O	O

follows	eng	N	N	O	O
:	x	N	N	O	O

D	x	N	N	O	O
(	x	N	N	O	O
Ta	eng	N	N	O	O
,	x	N	N	O	O

Tb	eng	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O

max	eng	N	N	O	O

{	x	N	N	O	O
Ia	eng	N	N	O	O

−	x	N	N	O	O

Ib	eng	N	N	O	O
,	x	N	N	O	O

Ja	eng	N	N	O	O

−	x	N	N	O	O

Jb	eng	N	N	O	O
,	x	N	N	O	O

Ka	eng	N	N	O	O

−	x	N	N	O	O

Kb	eng	N	N	O	O
}	x	N	N	O	O

−	x	N	N	O	O

min	eng	N	N	O	O

{	x	N	N	O	O
Ia	eng	N	N	O	O

−	x	N	N	O	O

Ib	eng	N	N	O	O
,	x	N	N	O	O

Ja	eng	N	N	O	O

−	x	N	N	O	O

Jb	eng	N	N	O	O
,	x	N	N	O	O

Ka	eng	N	N	O	O

−	x	N	N	O	O

Kb	eng	N	N	O	O
}	x	N	N	O	O

Now	eng	N	N	O	O

you	eng	N	N	O	O

are	eng	N	N	O	O

given	eng	N	N	O	O

N	x	N	N	O	O

triplets	eng	N	N	O	O
,	x	N	N	O	O

could	eng	N	N	O	O

you	eng	N	N	O	O

write	eng	N	N	O	O

a	x	N	N	O	O

program	eng	N	N	O	O

to	eng	N	N	O	O

calculate	eng	N	N	O	O

the	eng	N	N	O	O

sum	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

difference	eng	N	N	O	O

values	eng	N	N	O	O

between	eng	N	N	O	O

every	eng	N	N	O	O

unordered	eng	N	N	O	O

pair	eng	N	N	O	O

of	eng	N	N	O	O

triplets	eng	N	N	O	O
?	x	N	N	O	O

给出	v	N	N	O	O
N	eng	N	N	O	O
个	m	N	N	O	O
三元组	n	N	N	O	O
，	x	N	N	O	O
将	d	N	N	O	O
给出	v	N	N	O	O
的	uj	N	N	O	O
三元组	n	N	N	O	O
两	m	N	N	O	O
两	m	N	N	O	O
组合	v	Y	N	O	O
，	x	N	N	O	O
分别	d	N	N	O	O
求出	v	N	N	O	O
D	eng	N	N	O	O
(	x	N	N	O	O
Ta	eng	N	N	O	O
,	x	N	N	O	O

Tb	eng	N	N	O	O
)	x	N	N	O	O
的	uj	N	N	O	O
值	n	N	N	O	O
。	x	N	N	O	O

若	c	N	N	O	O
任意	v	Y	N	O	O
两个	m	N	N	O	O
三元组	n	N	N	O	O
为	p	N	N	O	O
Ta	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
Ia	eng	N	N	O	O
,	x	N	N	O	O

Ja	eng	N	N	O	O
,	x	N	N	O	O

Ka	eng	N	N	O	O
)	x	N	N	O	O

and	eng	N	N	O	O

Tb	eng	N	N	O	O
=	x	N	N	O	O

(	x	N	N	O	O
Ib	eng	N	N	O	O
,	x	N	N	O	O

Jb	eng	N	N	O	O
,	x	N	N	O	O

Kb	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

则	d	N	N	O	O
：	x	N	N	O	O
D	x	N	N	O	O
(	x	N	N	O	O
Ta	eng	N	N	O	O
,	x	N	N	O	O

Tb	eng	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O

max	eng	N	N	O	O

{	x	N	N	O	O
Ia	eng	N	N	O	O

−	x	N	N	O	O

Ib	eng	N	N	O	O
,	x	N	N	O	O

Ja	eng	N	N	O	O

−	x	N	N	O	O

Jb	eng	N	N	O	O
,	x	N	N	O	O

Ka	eng	N	N	O	O

−	x	N	N	O	O

Kb	eng	N	N	O	O
}	x	N	N	O	O

−	x	N	N	O	O

min	eng	N	N	O	O

{	x	N	N	O	O
Ia	eng	N	N	O	O

−	x	N	N	O	O

Ib	eng	N	N	O	O
,	x	N	N	O	O

Ja	eng	N	N	O	O

−	x	N	N	O	O

Jb	eng	N	N	O	O
,	x	N	N	O	O

Ka	eng	N	N	O	O

−	x	N	N	O	O

Kb	eng	N	N	O	O
}	x	N	N	O	O

最后	f	N	N	O	O
求	v	N	N	O	O
所有	b	N	N	O	O
D	x	N	N	O	O
(	x	N	N	O	O
Ta	eng	N	N	O	O
,	x	N	N	O	O

Tb	eng	N	N	O	O
)	x	N	N	O	O
和	c	N	N	O	O
的	uj	N	N	O	O
值	n	N	N	O	O

这	r	N	N	O	O
道题	n	N	N	O	O
有个	r	N	N	O	O
很	d	N	N	O	O
关键	n	N	N	O	O
的	uj	N	N	O	O
公式	n	Y	N	O	O
，	x	N	N	O	O
知道	v	N	N	O	O
的	uj	N	N	O	O
就	d	N	N	O	O
很	d	N	N	O	O
容易	a	N	N	O	O
做	v	N	N	O	O
出来	v	N	N	O	O
了	ul	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
公式	n	Y	N	O	O
max	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
min	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
|	x	N	N	O	O
a	x	N	N	O	O
-	x	N	N	O	O
b	x	N	N	O	O
|	x	N	N	O	O
+	x	N	N	O	O
|	x	N	N	O	O
b	x	N	N	O	O
-	x	N	N	O	O
c	x	N	N	O	O
|	x	N	N	O	O
+	x	N	N	O	O
|	x	N	N	O	O
a	x	N	N	O	O
-	x	N	N	O	O
c	x	N	N	O	O
|	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2.	m	N	N	O	O

把	p	N	N	O	O
a	eng	N	N	O	O
、	x	N	N	O	O
b	x	N	N	O	O
、	x	N	N	O	O
c	eng	N	N	O	O
想成	v	N	N	O	O
是	v	N	N	O	O
数轴	n	N	N	O	O
上	f	N	N	O	O
的	uj	N	N	O	O
三个	m	N	N	O	O
点	m	N	N	O	O
就	d	N	N	O	O
很	d	N	N	O	O
容易	a	N	N	O	O
得出	v	N	N	O	O
上述	b	N	N	O	O
公式	n	Y	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

然而	c	N	N	O	O
求	v	N	N	O	O
出	v	N	N	O	O
所有	b	N	N	O	O
的	uj	N	N	O	O
|	x	N	N	O	O
a	x	N	N	O	O
-	x	N	N	O	O
b	x	N	N	O	O
|	x	N	N	O	O
+	x	N	N	O	O
|	x	N	N	O	O
b	x	N	N	O	O
-	x	N	N	O	O
c	x	N	N	O	O
|	x	N	N	O	O
+	x	N	N	O	O
|	x	N	N	O	O
a	x	N	N	O	O
-	x	N	N	O	O
c	x	N	N	O	O
|	x	N	N	O	O
，	x	N	N	O	O
再	d	N	N	O	O
求和	v	N	N	O	O
也	d	N	N	O	O
不是	c	N	N	O	O
简单	a	N	N	O	O
的	uj	N	N	O	O
问题	n	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
进而	c	N	N	O	O
继续	v	N	N	O	O
化简	n	N	N	O	O
得	ud	N	N	O	O
：	x	N	N	O	O

max	eng	N	N	O	O

{	x	N	N	O	O
Ia	eng	N	N	O	O

−	x	N	N	O	O

Ib	eng	N	N	O	O
,	x	N	N	O	O

Ja	eng	N	N	O	O

−	x	N	N	O	O

Jb	eng	N	N	O	O
,	x	N	N	O	O

Ka	eng	N	N	O	O

−	x	N	N	O	O

Kb	eng	N	N	O	O
}	x	N	N	O	O

−	x	N	N	O	O

min	eng	N	N	O	O

{	x	N	N	O	O
Ia	eng	N	N	O	O

−	x	N	N	O	O

Ib	eng	N	N	O	O
,	x	N	N	O	O

Ja	eng	N	N	O	O

−	x	N	N	O	O

Jb	eng	N	N	O	O
,	x	N	N	O	O

Ka	eng	N	N	O	O

−	x	N	N	O	O

Kb	eng	N	N	O	O
}	x	N	N	O	O

=	x	N	N	O	O
(	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
Ia	eng	N	N	O	O

−	x	N	N	O	O

Ib	eng	N	N	O	O
)	x	N	N	O	O
—	x	N	N	O	O
(	x	N	N	O	O

Ja	eng	N	N	O	O

–	x	N	N	O	O

Jb	eng	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
+	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
Ja	eng	N	N	O	O

–	x	N	N	O	O

Jb	eng	N	N	O	O
)	x	N	N	O	O
—	x	N	N	O	O
(	x	N	N	O	O
Ka	eng	N	N	O	O

−	x	N	N	O	O

Kb	eng	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
+	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O

Ka	eng	N	N	O	O

−	x	N	N	O	O

Kb	eng	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
(	x	N	N	O	O

Ia	eng	N	N	O	O

−	x	N	N	O	O

Ib	eng	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
Ia	eng	N	N	O	O

–	x	N	N	O	O

Ja	eng	N	N	O	O
)	x	N	N	O	O
—	x	N	N	O	O
(	x	N	N	O	O
Ib	eng	N	N	O	O
—	x	N	N	O	O
Jb	eng	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
+	x	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
Ja	eng	N	N	O	O

−	x	N	N	O	O

Ka	eng	N	N	O	O
)	x	N	N	O	O
—	x	N	N	O	O
(	x	N	N	O	O
Jb	eng	N	N	O	O

−	x	N	N	O	O

Kb	eng	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
+	x	N	N	O	O
|	x	N	N	O	O

(	x	N	N	O	O
Ka	eng	N	N	O	O

–	x	N	N	O	O

Ia	eng	N	N	O	O
)	x	N	N	O	O
—	x	N	N	O	O
(	x	N	N	O	O

Ka	eng	N	N	O	O

−	x	N	N	O	O

Ib	eng	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O

如果	c	N	N	O	O
令	nrt	N	N	O	O
a	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O

Ii	eng	N	N	O	O

–	x	N	N	O	O

Ji	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O

Ji	eng	N	N	O	O

–	x	N	N	O	O

Ki	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O

Ki	eng	N	N	O	O

–	x	N	N	O	O

Ii	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
原	n	N	N	O	O
问题	n	N	N	O	O
等价	n	N	N	O	O
为	p	N	N	O	O
(	x	N	N	O	O
|	x	N	N	O	O
ai	eng	N	N	O	O
-	x	N	N	O	O
aj	eng	N	N	O	O
|	x	N	N	O	O
+	x	N	N	O	O
|	x	N	N	O	O
bi	eng	N	N	O	O
-	x	N	N	O	O
bj	eng	N	N	O	O
|	x	N	N	O	O
+	x	N	N	O	O
|	x	N	N	O	O
ci	eng	N	N	O	O
-	x	N	N	O	O
cj	eng	N	N	O	O
|	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
，	x	N	N	O	O
对于	p	N	N	O	O
每个	r	N	N	O	O
含	n	N	N	O	O
a	eng	N	N	O	O
、	x	N	N	O	O
b	x	N	N	O	O
、	x	N	N	O	O
c	eng	N	N	O	O
的	uj	N	N	O	O
绝对值	l	N	N	O	O
式子	n	N	N	O	O
可以	c	N	N	O	O
分开	v	N	N	O	O
求	v	N	N	O	O
：	x	N	N	O	O

例如	v	N	N	O	O
，	x	N	N	O	O
根据	p	N	N	O	O
ai	eng	N	N	O	O
，	x	N	N	O	O
aj	eng	N	N	O	O
的	uj	N	N	O	O
大小	b	N	N	O	O
即可	d	N	N	O	O
知道	v	N	N	O	O
在	p	N	N	O	O
最后	f	N	N	O	O
的	uj	N	N	O	O
求和	v	N	N	O	O
式	k	N	N	O	O
中	f	N	N	O	O
贡献	n	N	N	O	O
了	ul	N	N	O	O
多少	m	N	N	O	O
次	q	N	N	O	O
加法	v	N	N	O	O
和	c	N	N	O	O
减法	v	N	N	O	O
。	x	N	N	O	O

将	d	N	N	O	O
x	eng	N	N	O	O
数组	n	Y	N	O	O
排序	n	Y	N	B-KNOWLEDGE	O
，	x	N	N	O	O
对于	p	N	N	O	O
第	m	N	N	O	O
xi	eng	N	N	O	O
个	m	N	N	O	O
，	x	N	N	O	O
他	r	N	N	O	O
前面	f	N	N	O	O
的	uj	N	N	O	O
比	p	N	N	O	O
它	r	N	N	O	O
小	n	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
在	p	N	N	O	O
和	c	N	N	O	O
i	eng	N	N	O	O
点	m	N	N	O	O
比较	d	N	N	O	O
时	n	N	N	O	O
i	eng	N	N	O	O
点	m	N	N	O	O
贡献	n	N	N	O	O
了	ul	N	N	O	O
i	eng	N	N	O	O
次	m	N	N	O	O
加	v	N	N	O	O
，	x	N	N	O	O
对	p	N	N	O	O
后面	f	N	N	O	O
的	uj	N	N	O	O
n	eng	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
个	m	N	N	O	O
点	m	N	N	O	O
向	p	N	N	O	O
他们	r	N	N	O	O
贡献	n	N	N	O	O
了	ul	N	N	O	O
n	eng	N	N	O	O
-	x	N	N	O	O
i	eng	N	N	O	O
次	t	N	N	O	O
减法	v	N	N	O	O

1	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

2	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

3	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

4	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cmath	eng	N	N	O	O
>	x	N	N	O	O

5	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

6	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

see	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
#	x	N	N	O	O
x	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
"	x	N	N	O	O
:	x	N	N	O	O
"	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

7	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

N	x	N	N	O	O

200010	m	N	N	O	O

8	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

9	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

x	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

z	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

10	m	N	N	O	O

11	m	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

12	m	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
,	x	N	N	O	O

k	x	N	N	O	O
,	x	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

13	m	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O

b	x	N	N	O	O
,	x	N	N	O	O

c	x	N	N	O	O
,	x	N	N	O	O

sum	eng	N	N	O	O
;	x	N	N	O	O

14	m	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
~	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
&&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

15	m	N	N	O	O

16	m	N	N	O	O

sum	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

17	m	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

18	m	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
lld	eng	N	N	O	O
%	x	N	N	O	O
lld	eng	N	N	O	O
%	x	N	N	O	O
lld	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
b	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
c	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

19	m	N	N	O	O

x	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
-	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O
y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
-	x	N	N	O	O
c	x	N	N	O	O
;	x	N	N	O	O
z	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
-	x	N	N	O	O
c	x	N	N	O	O
;	x	N	N	O	O

20	m	N	N	O	O

}	x	N	N	O	O

21	m	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
z	x	N	N	O	O
,	x	N	N	O	O
z	eng	N	N	O	O
+	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

22	m	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

23	m	N	N	O	O

sum	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
y	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
z	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

24	m	N	N	O	O

}	x	N	N	O	O

25	m	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
sum	eng	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

26	m	N	N	O	O

}	x	N	N	O	O

27	m	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

28	m	N	N	O	O

}	x	N	N	O	O

pku3233	eng	N	Y	B-OJ	B-OJ
_	x	N	N	O	O
chenjiang	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

*	x	N	N	O	O

File	eng	N	N	O	O
:	x	N	N	O	O

pku3233	eng	N	Y	O	O
.	m	N	N	O	O
cpp	eng	N	N	O	O

*	x	N	N	O	O

Author	eng	N	N	O	O
:	x	N	N	O	O

chenjiang	eng	N	N	O	O

*	x	N	N	O	O
第一个	m	N	N	O	O
矩阵	n	Y	N	B-KNOWLEDGE	O
乘法	n	Y	N	I-KNOWLEDGE	O
的	uj	N	N	O	O
题目	n	Y	N	O	O
，	x	N	N	O	O
调试	vn	N	N	O	O
了	ul	N	N	O	O
n	eng	N	N	O	O
久	a	N	N	O	O
才	d	N	N	O	O
对	p	N	N	O	O
啊	y	N	N	O	O
。	x	N	N	O	O

*	x	N	N	O	O

Created	eng	N	N	O	O

on	eng	N	N	O	O

2010	m	N	N	O	O
年	m	N	N	O	O
7	m	N	N	O	O
月	m	N	N	O	O
8	m	N	N	O	O
日	m	N	N	O	O
,	x	N	N	O	O

下午	t	N	N	O	O
4	x	N	N	O	O
:	x	N	N	O	O
58	m	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
fstream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stack	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
map	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
bitset	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
math	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
time	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
vector	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
set	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

k	x	N	N	O	O
,	x	N	N	O	O

m	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

matrix	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

mat	eng	N	N	O	O
[	x	N	N	O	O
40	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
40	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

Init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

print	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

matrix	eng	N	N	O	O

operator	eng	N	N	O	O
+	x	N	N	O	O
(	x	N	N	O	O
matrix	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

matrix	eng	N	N	O	O

operator	eng	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
matrix	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

matrix	eng	N	N	O	O

pow	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

K	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

matrix	eng	N	N	O	O

add	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

K	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

matrix	eng	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
Init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

matrix	eng	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
print	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

"	x	N	N	O	O
,	x	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

matrix	eng	N	N	O	O

matrix	eng	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
operator	eng	N	N	O	O

+	x	N	N	O	O
(	x	N	N	O	O
matrix	eng	N	N	O	O

t	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

matrix	eng	N	N	O	O

temp	eng	N	N	O	O
;	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
Init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
t	eng	N	N	O	O
.	m	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
.	m	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
%	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

temp	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

matrix	eng	N	N	O	O

matrix	eng	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
operator	eng	N	N	O	O

*	x	N	N	O	O
(	x	N	N	O	O
matrix	eng	N	N	O	O

t	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
;	x	N	N	O	O

matrix	eng	N	N	O	O

temp	eng	N	N	O	O
;	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
Init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
s	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
s	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
t	eng	N	N	O	O
.	m	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
temp	eng	N	N	O	O
.	m	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O

temp	eng	N	N	O	O
.	m	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
%	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

temp	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

matrix	eng	N	N	O	O

matrix	eng	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
pow	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

K	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

matrix	eng	N	N	O	O

t	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
*	x	N	N	O	O
this	eng	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
*	x	N	N	O	O
this	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
K	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
*	x	N	N	O	O
this	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
K	eng	N	N	O	O
&	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

t	eng	N	N	O	O
.	m	N	N	O	O
pow	eng	N	N	O	O
(	x	N	N	O	O
K	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
*	x	N	N	O	O
this	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

return	eng	N	N	O	O

t	eng	N	N	O	O
.	m	N	N	O	O
pow	eng	N	N	O	O
(	x	N	N	O	O
K	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

matrix	eng	N	N	O	O

matrix	eng	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
add	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

K	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
K	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
*	x	N	N	O	O
this	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
K	eng	N	N	O	O
&	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

add	eng	N	N	O	O
(	x	N	N	O	O
K	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
pow	eng	N	N	O	O
(	x	N	N	O	O
K	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

matrix	eng	N	N	O	O

t	x	N	N	O	O
=	x	N	N	O	O
add	eng	N	N	O	O
(	x	N	N	O	O
K	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

t	eng	N	N	O	O
+	x	N	N	O	O
t	eng	N	N	O	O
*	x	N	N	O	O
pow	eng	N	N	O	O
(	x	N	N	O	O
K	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

*	x	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

argc	eng	N	N	O	O
,	x	N	N	O	O

char	eng	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O

argv	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

matrix	eng	N	N	O	O

t	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
k	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

t	eng	N	N	O	O
.	m	N	N	O	O
Init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
j	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
t	eng	N	N	O	O
.	m	N	N	O	O
mat	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

t	eng	N	N	O	O
.	m	N	N	O	O
add	eng	N	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
.	m	N	N	O	O
print	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
EXIT	eng	N	N	O	O
_	x	N	N	O	O
SUCCESS	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

1204	m	N	N	I-OJ	O

-	x	N	N	O	O

c++	nz	N	N	O	O
语言	n	N	N	O	O
程序开发	nr	N	N	O	O
技术	n	N	N	O	O
文章	n	N	N	O	O
_	x	N	N	O	O
c++	nz	N	N	O	O
编程	n	N	N	O	O

-	x	N	N	O	O

红	a	N	N	O	O
黑	a	N	N	O	O
联盟	j	N	N	O	O

trie	eng	N	N	B-KNOWLEDGE	O
树	n	N	N	I-KNOWLEDGE	O
做法	v	N	N	O	O

[	x	N	N	O	O
cpp	eng	N	N	O	O
]	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdlib	eng	N	N	O	O
>	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

kind	eng	N	N	O	O
=	x	N	N	O	O
26	m	N	N	O	O
;	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
1010	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
1010	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

h	x	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

g	x	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
q	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

xx	eng	N	N	O	O
[	x	N	N	O	O
1010	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
yy	eng	N	N	O	O
[	x	N	N	O	O
1010	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
zz	eng	N	N	O	O
[	x	N	N	O	O
1010	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

trie	eng	N	N	O	O
{	x	N	N	O	O

struct	eng	N	N	O	O

trie	eng	N	N	O	O

*	x	N	N	O	O

fail	eng	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
next	eng	N	N	O	O
[	x	N	N	O	O
kind	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

count	eng	N	N	O	O
,	x	N	N	O	O
num	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

trie	eng	N	N	O	O

*	x	N	N	O	O

root	eng	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
char	eng	N	N	O	O
*	x	N	N	O	O

str	eng	Y	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

ii	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

len	eng	N	N	O	O
=	x	N	N	O	O
strlen	eng	N	N	O	O
(	x	N	N	O	O
str	eng	Y	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
tem	eng	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

trie	eng	N	N	O	O

*	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
q	x	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
=	x	N	N	O	O
root	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
len	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

tem	eng	N	N	O	O
=	x	N	N	O	O
str	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
next	eng	N	N	O	O
[	x	N	N	O	O
tem	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
NULL	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

q	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

trie	eng	N	N	O	O
*	x	N	N	O	O
)	x	N	N	O	O
calloc	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

trie	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
count	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
fail	eng	N	N	O	O
=	x	N	N	O	O
NULL	eng	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
q	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
next	eng	N	N	O	O
,	x	N	N	O	O
NULL	eng	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
q	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
next	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
next	eng	N	N	O	O
[	x	N	N	O	O
tem	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
q	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

p	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
next	eng	N	N	O	O
[	x	N	N	O	O
tem	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

p	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
count	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
=	x	N	N	O	O
ii	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

yes	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O

&&	x	N	N	O	O

j	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O

&&	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O

&&	x	N	N	O	O

j	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

query	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

tem	eng	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
pp	eng	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

trie	eng	N	N	O	O
*	x	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
root	eng	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
pp	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
yes	eng	N	N	O	O
(	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
pp	eng	N	N	O	O
*	x	N	N	O	O
h	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
pp	eng	N	N	O	O
*	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
pp	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
pp	eng	N	N	O	O
*	x	N	N	O	O
h	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
pp	eng	N	N	O	O
*	x	N	N	O	O
g	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

tem	eng	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
next	eng	N	N	O	O
[	x	N	N	O	O
tem	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
NULL	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
tmp	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
next	eng	N	N	O	O
[	x	N	N	O	O
tem	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
count	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

sum	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

xx	eng	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

yy	eng	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

zz	eng	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

tmp	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
count	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

sea	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

char	eng	N	N	O	O

str	eng	Y	N	O	O
[	x	N	N	O	O
2010	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
8	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

query	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
sum	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
q	x	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

char	eng	N	N	O	O

str	eng	Y	N	O	O
[	x	N	N	O	O
2010	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

root	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

trie	eng	N	N	O	O
*	x	N	N	O	O
)	x	N	N	O	O
calloc	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

trie	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

root	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
fail	eng	N	N	O	O
=	x	N	N	O	O
NULL	eng	N	N	O	O
;	x	N	N	O	O

root	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
count	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

root	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
next	eng	N	N	O	O
,	x	N	N	O	O
NULL	eng	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
root	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
next	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
q	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
q	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
str	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
str	eng	Y	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

sea	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
q	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
c	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
xx	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
yy	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
+	x	N	N	O	O
zz	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

AC	eng	N	N	B-KNOWLEDGE	O
自动机	n	N	N	I-KNOWLEDGE	O
做法	v	N	N	O	O

作者	n	N	N	O	O
：	x	N	N	O	O
waitfor	eng	N	N	O	O
_	x	N	N	O	O
poj	eng	N	Y	B-OJ	B-OJ

2440	m	N	N	I-OJ	O

DNA	eng	N	N	O	O
_	x	N	N	O	O
chenwenwen0210	eng	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

题目	n	Y	N	O	O
大意	d	N	N	O	O
：	x	N	N	O	O
要求	v	N	N	O	O
01	m	N	N	O	O
串	v	N	N	O	O
的	uj	N	N	O	O
种数	n	N	N	O	O
，	x	N	N	O	O
01	m	N	N	O	O
里面	f	N	N	O	O
不能	v	N	N	O	O
出现	v	N	N	O	O
101	m	N	N	O	O
，	x	N	N	O	O
111	m	N	N	O	O
这	r	N	N	O	O
两种	m	N	N	O	O
子串	n	Y	N	O	O
。	x	N	N	O	O

输入	v	N	N	O	O
长度	ns	Y	N	O	O
N	x	N	N	O	O
（	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
N	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
10	m	N	N	O	O
^	x	N	N	O	O
8	x	N	N	O	O
）	x	N	N	O	O
,	x	N	N	O	O
要求	v	N	N	O	O
输出	v	Y	N	O	O
满足要求	l	N	N	O	O
的	uj	N	N	O	O
串	v	N	N	O	O
的	uj	N	N	O	O
数目	n	N	N	O	O
。	x	N	N	O	O

解题	n	N	N	O	O
报告	n	N	N	O	O
：	x	N	N	O	O
一	m	N	N	O	O
看到	v	N	N	O	O
这种	r	N	N	O	O
数据	n	N	N	O	O
范围	n	N	N	O	O
就	d	N	N	O	O
想到	v	N	N	O	O
了	ul	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
加	v	N	N	O	O
矩阵	n	Y	N	O	O
优化	vn	Y	N	O	O
。	x	N	N	O	O

n	x	N	N	O	O
<	x	N	N	O	O
3	m	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
输出	v	Y	N	O	O
2	x	N	N	O	O
^	x	N	N	O	O
n	x	N	N	O	O

当	t	N	N	O	O
n	eng	N	N	O	O
>	x	N	N	O	O
2	m	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O

可以	c	N	N	O	O
先用	n	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
表示	v	Y	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
代表	n	N	N	O	O
长度	ns	Y	N	O	O
为	p	N	N	O	O
i	eng	N	N	O	O
最后	f	N	N	O	O
两位	m	N	N	O	O
的	uj	N	N	O	O
01	m	N	N	O	O
，	x	N	N	O	O
状态	n	Y	N	O	O
是	v	N	N	O	O
j	eng	N	N	O	O
的	uj	N	N	O	O
种	n	N	N	O	O
数目	n	N	N	O	O
。	x	N	N	O	O

0	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
4	x	N	N	O	O

然后	c	N	N	O	O
由	p	N	N	O	O
当前	t	N	N	O	O
的	uj	N	N	O	O
j	eng	N	N	O	O
后面	f	N	N	O	O
加上	v	N	N	O	O
一个	m	N	N	O	O
0	x	N	N	O	O
或者	c	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
可以	c	N	N	O	O
推出	v	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
对应	vn	N	N	O	O
种数	n	N	N	O	O

状态	n	Y	N	O	O
之间	f	N	N	O	O
的	uj	N	N	O	O
转移	v	N	N	O	O
图	n	N	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O

当	t	N	N	O	O
长度	ns	Y	N	O	O
为	p	N	N	O	O
2	m	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
有	v	N	N	O	O
初始状态	l	N	N	O	O

00	m	N	N	O	O
，	x	N	N	O	O
01	m	N	N	O	O
，	x	N	N	O	O
10	m	N	N	O	O
，	x	N	N	O	O
11	m	N	N	O	O

可以	c	N	N	O	O
构造	v	Y	N	O	O
一个	m	N	N	O	O
矩阵	n	Y	N	O	O
满足	v	N	N	O	O
上图	v	N	N	O	O
的	uj	N	N	O	O
递推	v	Y	N	O	O
式	k	N	N	O	O
。	x	N	N	O	O

矩阵	n	Y	N	O	O
A	x	N	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O

矩阵	n	Y	N	O	O
B	x	N	N	O	O
=	x	N	N	O	O

A	x	N	N	O	O
*	x	N	N	O	O
B	eng	N	N	O	O
就	d	N	N	O	O
推出	v	N	N	O	O
了	ul	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
的	uj	N	N	O	O
状态	n	Y	N	O	O
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

MAX	eng	N	N	O	O
=	x	N	N	O	O
4	x	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

MOD	eng	N	N	O	O
=	x	N	N	O	O
2005	m	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

multi	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

b	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

m	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
b	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
%	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
<	x	N	N	O	O
3	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ret	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O

{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

tmp	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O

{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O

{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	eng	N	N	O	O
&	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
multi	eng	N	N	O	O
(	x	N	N	O	O
ret	eng	N	N	O	O
,	x	N	N	O	O
tmp	eng	N	N	O	O
,	x	N	N	O	O
MAX	eng	N	N	O	O
,	x	N	N	O	O
MOD	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

multi	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
,	x	N	N	O	O
tmp	eng	N	N	O	O
,	x	N	N	O	O
MAX	eng	N	N	O	O
,	x	N	N	O	O
MOD	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

n	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
MAX	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
MAX	eng	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ans	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
ret	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
%	x	N	N	O	O
MOD	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

638	m	N	N	O	O

5	x	N	N	O	O

851	m	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

pku	eng	N	Y	B-OJ	B-OJ

1190	m	N	N	I-OJ	O

搜索	v	Y	N	O	O
好题	n	N	N	O	O

-	x	N	N	O	O

nizhenyang	eng	N	N	O	O
的	uj	N	N	O	O
日志	ns	N	N	O	O

-	x	N	N	O	O

网易	n	N	N	O	O
博客	nr	N	N	O	O

搜索	v	Y	N	O	O
顺序	n	N	N	O	O
的	uj	N	N	O	O
选择	v	N	N	O	O

由于	c	N	N	O	O
R	eng	N	N	O	O
和	c	N	N	O	O
H	eng	N	N	O	O
是	v	N	N	O	O
从下到上	l	N	N	O	O
递减	v	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
体积	n	Y	N	O	O
也	d	N	N	O	O
是	v	N	N	O	O
从下到上	l	N	N	O	O
递减	v	N	N	O	O
，	x	N	N	O	O
因此	c	N	N	O	O
选择	v	N	N	O	O
从下到上	l	N	N	O	O
的	uj	N	N	O	O
搜索	v	Y	N	O	O
顺序	n	N	N	O	O
有利于	v	N	N	O	O
判断	v	Y	N	O	O
当前情况	l	N	N	O	O
是否	v	N	N	O	O
可行	v	Y	N	O	O
。	x	N	N	O	O

此外	c	N	N	O	O
，	x	N	N	O	O
注意	v	N	N	O	O
到	v	N	N	O	O
表面积	n	N	N	O	O
包括	v	N	N	O	O
每层	n	N	N	O	O
蛋糕	n	N	N	O	O
的	uj	N	N	O	O
侧	n	N	N	O	O
面积	n	Y	N	O	O
和	c	N	N	O	O
裸露	v	N	N	O	O
的	uj	N	N	O	O
顶	n	N	N	O	O
面积	n	Y	N	O	O
。	x	N	N	O	O

确定	v	N	N	O	O
了	ul	N	N	O	O
最底层	n	N	N	O	O
的	uj	N	N	O	O
蛋糕	n	N	N	O	O
就	d	N	N	O	O
确定	v	N	N	O	O
了	ul	N	N	O	O
每层	n	N	N	O	O
蛋糕	n	N	N	O	O
裸露	v	N	N	O	O
的	uj	N	N	O	O
顶	n	N	N	O	O
面积	n	Y	N	O	O
之	u	N	N	O	O
和	c	N	N	O	O
，	x	N	N	O	O
需要	v	N	N	O	O
考虑	v	N	N	O	O
的	uj	N	N	O	O
只	d	N	N	O	O
剩下	v	N	N	O	O
每层	n	N	N	O	O
蛋糕	n	N	N	O	O
的	uj	N	N	O	O
侧	n	N	N	O	O
面积	n	Y	N	O	O
。	x	N	N	O	O

因此	c	N	N	O	O
这样	r	N	N	O	O
的	uj	N	N	O	O
搜索	v	Y	N	O	O
顺序	n	N	N	O	O
有利于	v	N	N	O	O
判断	v	Y	N	O	O
是否	v	N	N	O	O
可能	v	N	N	O	O
出现	v	N	N	O	O
比	p	N	N	O	O
已知	v	N	N	O	O
最优	d	N	N	O	O
解	v	N	N	O	O
更优	d	N	N	O	O
的	uj	N	N	O	O
解	v	N	N	O	O

我们	r	N	N	O	O
设	v	N	N	O	O
当前	t	N	N	O	O
为	p	N	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
层	q	N	N	O	O
蛋糕	n	N	N	O	O
，	x	N	N	O	O
上	f	N	N	O	O
一层	m	N	N	O	O
蛋糕	n	N	N	O	O
的	uj	N	N	O	O
半径	n	N	N	O	O
和	c	N	N	O	O
高度	n	Y	N	O	O
为	p	N	N	O	O
lastr	eng	N	N	O	O
,	x	N	N	O	O
lasth	eng	N	N	O	O
,	x	N	N	O	O
当前	t	N	N	O	O
的	uj	N	N	O	O
面积	n	Y	N	O	O
为	p	N	N	O	O
S	eng	N	N	O	O
,	x	N	N	O	O
余下	m	N	N	O	O
的	uj	N	N	O	O
体积	n	Y	N	O	O
为	p	N	N	O	O
leftv	eng	N	N	O	O
.	m	N	N	O	O

我们	r	N	N	O	O
可以	c	N	N	O	O
用	p	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
lastr	eng	N	N	O	O
,	x	N	N	O	O
lasth	eng	N	N	O	O
,	x	N	N	O	O
leftv	eng	N	N	O	O
,	x	N	N	O	O
S	x	N	N	O	O
)	x	N	N	O	O
表示	v	Y	N	O	O
一个	m	N	N	O	O
状态	n	Y	N	O	O
.	x	N	N	O	O

初始状态	l	N	N	O	O
为	p	N	N	O	O
(	x	N	N	O	O
M	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
Rm	eng	N	N	O	O
,	x	N	N	O	O
Hm	eng	N	N	O	O
,	x	N	N	O	O
N	x	N	N	O	O
,	x	N	N	O	O
R	x	N	N	O	O
*	x	N	N	O	O
R	x	N	N	O	O
*	x	N	N	O	O
H	x	N	N	O	O
,	x	N	N	O	O
R	x	N	N	O	O
*	x	N	N	O	O
R	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O
*	x	N	N	O	O
R	x	N	N	O	O
*	x	N	N	O	O
H	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
Rm	eng	N	N	O	O
,	x	N	N	O	O
Hm	eng	N	N	O	O
为	p	N	N	O	O
第	m	N	N	O	O
m	eng	N	N	O	O
层	q	N	N	O	O
的	uj	N	N	O	O
半径	n	N	N	O	O
和	c	N	N	O	O
高	a	N	N	O	O
，	x	N	N	O	O
R	x	N	N	O	O
*	x	N	N	O	O
R	x	N	N	O	O
*	x	N	N	O	O
H	x	N	N	O	O
表示	v	Y	N	O	O
第一层	m	N	N	O	O
的	uj	N	N	O	O
体积	n	Y	N	O	O
，	x	N	N	O	O
R	x	N	N	O	O
*	x	N	N	O	O
R	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O
*	x	N	N	O	O
R	x	N	N	O	O
*	x	N	N	O	O
H	x	N	N	O	O
表示	v	Y	N	O	O
顶	v	N	N	O	O
面积	n	Y	N	O	O
加	v	N	N	O	O
侧	v	N	N	O	O
面积	n	Y	N	O	O
,	x	N	N	O	O
即	v	N	N	O	O
当前	t	N	N	O	O
总面积	n	Y	N	O	O
.	x	N	N	O	O

目标	n	N	N	O	O
状态	n	Y	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
R1	eng	N	N	O	O
,	x	N	N	O	O
H1	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
S	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
其中	r	N	N	O	O
R1	eng	N	N	O	O
,	x	N	N	O	O
H1	eng	N	N	O	O
为	p	N	N	O	O
第一层	m	N	N	O	O
的	uj	N	N	O	O
半径	n	N	N	O	O
和	c	N	N	O	O
高	a	N	N	O	O
，	x	N	N	O	O
S	x	N	N	O	O
表示	v	Y	N	O	O
总面积	n	Y	N	O	O
．	x	N	N	O	O
于是	c	N	N	O	O
我们	r	N	N	O	O
的	uj	N	N	O	O
目标	n	N	N	O	O
是	v	N	N	O	O
找到	v	N	N	O	O
一条	m	N	N	O	O
路径	n	Y	N	O	O
从	p	N	N	O	O
初始	v	N	N	O	O
节点	n	N	N	O	O
到	v	N	N	O	O
任意	v	Y	N	O	O
目标	n	N	N	O	O
节点	n	N	N	O	O
，	x	N	N	O	O
并且	c	N	N	O	O
S	x	N	N	O	O
最小	a	Y	N	O	O
.	x	N	N	O	O

递归	v	Y	N	O	B-KNOWLEDGE
的	uj	N	N	O	O
式子	n	N	N	O	O
：	x	N	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
Ri	eng	N	N	O	O
,	x	N	N	O	O
Hi	eng	N	N	O	O
,	x	N	N	O	O
Vi	eng	N	N	O	O
,	x	N	N	O	O
Si	eng	N	N	O	O
)	x	N	N	O	O
à	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
Ri	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
Hi	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
Vi	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
Si	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

其中	r	N	N	O	O
必须	d	N	N	O	O
满足	v	N	N	O	O
:	x	N	N	O	O

Ri	eng	N	N	O	O
>	x	N	N	O	O
Ri	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O

Hi	eng	N	N	O	O
>	x	N	N	O	O
Hi	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O

Vi	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
=	x	N	N	O	O
Vi	eng	N	N	O	O
-	x	N	N	O	O
Ri	eng	N	N	O	O
*	x	N	N	O	O
Ri	eng	N	N	O	O
*	x	N	N	O	O
Hi	eng	N	N	O	O

Si	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
=	x	N	N	O	O
Si	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O
*	x	N	N	O	O
Ri	eng	N	N	O	O
*	x	N	N	O	O
Hi	eng	N	N	O	O

直接	ad	N	N	O	O
的	uj	N	N	O	O
搜索	v	Y	N	O	O
显然	ad	N	N	O	O
是	v	N	N	O	O
会	v	N	N	O	O
超时	b	N	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

因此	c	N	N	O	O
必须	d	N	N	O	O
加以	v	N	N	O	O
优化	vn	Y	N	O	O
。	x	N	N	O	O

1	x	N	N	O	O
、	x	N	N	O	O

切	v	N	N	O	O
到	v	N	N	O	O
当前	t	N	N	O	O
层	q	N	N	O	O
时	ng	N	N	O	O
表面积	n	N	N	O	O
比	p	N	N	O	O
最小	a	Y	N	O	O
的	uj	N	N	O	O
面积	n	Y	N	O	O
大	a	N	N	O	O
，	x	N	N	O	O
可以	c	N	N	O	O
剪枝	n	Y	N	O	B-KNOWLEDGE
；	x	N	N	O	O

2	x	N	N	O	O
、	x	N	N	O	O

如果	c	N	N	O	O
剩下	v	N	N	O	O
的	uj	N	N	O	O
体积	n	Y	N	O	O
，	x	N	N	O	O
比	p	N	N	O	O
可能	v	N	N	O	O
切出	v	N	N	O	O
的	uj	N	N	O	O
最小	a	Y	N	O	O
体积小	n	N	N	O	O
，	x	N	N	O	O
剪枝	n	Y	N	O	B-KNOWLEDGE
。	x	N	N	O	O

3	x	N	N	O	O
、	x	N	N	O	O
从	p	N	N	O	O
第	m	N	N	O	O
K	eng	N	N	O	O
层	q	N	N	O	O
到	v	N	N	O	O
M	eng	N	N	O	O
层	q	N	N	O	O
还	d	N	N	O	O
需要	v	N	N	O	O
加上	v	N	N	O	O
的	uj	N	N	O	O
面积	n	Y	N	O	O
=	x	N	N	O	O

。	x	N	N	O	O

所以	c	N	N	O	O
，	x	N	N	O	O
当	t	N	N	O	O
已经	d	N	N	O	O
花费	n	N	N	O	O
的	uj	N	N	O	O
面积	n	Y	N	O	O

时	ng	N	N	O	O
可	v	N	N	O	O
剪枝	n	Y	N	B-KNOWLEDGE	O
，	x	N	N	O	O
余下	m	N	N	O	O
的	uj	N	N	O	O
则	d	N	N	O	O
是	v	N	N	O	O
写	v	N	N	O	O
递归	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
程序	n	N	N	O	O
的	uj	N	N	O	O
问题	n	N	N	O	O
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

no1s	eng	N	N	O	O
,	x	N	N	O	O
mins	eng	N	N	O	O
=	x	N	N	O	O
10000000	m	N	N	O	O
,	x	N	N	O	O
lever	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n3	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
x	x	N	N	O	O
*	x	N	N	O	O
x	x	N	N	O	O
/	x	N	N	O	O
4	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

求和	v	N	N	O	O
公式	n	Y	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

f	x	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

leftv	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

floor	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

lastr	eng	N	N	O	O

,	x	N	N	O	O
int	eng	N	N	O	O

lasth	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

s	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O

s	x	N	N	O	O

+	x	N	N	O	O

2	x	N	N	O	O
*	x	N	N	O	O
leftv	eng	N	N	O	O
/	x	N	N	O	O
lastr	eng	N	N	O	O

>	x	N	N	O	O
=	x	N	N	O	O

mins	eng	N	N	O	O

)	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

leftv	eng	N	N	O	O

<	x	N	N	O	O

n3	eng	N	N	O	O
(	x	N	N	O	O
floor	eng	N	N	O	O
)	x	N	N	O	O

)	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
floor	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
leftv	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

mins	eng	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
h	x	N	N	O	O
,	x	N	N	O	O
r2	eng	N	N	O	O
,	x	N	N	O	O
maxh	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
=	x	N	N	O	O
lastr	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
r	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
floor	eng	N	N	O	O
;	x	N	N	O	O
r	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

r2	eng	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
*	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
floor	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O

s	x	N	N	O	O
=	x	N	N	O	O
r2	eng	N	N	O	O
;	x	N	N	O	O

maxh	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
leftv	eng	N	N	O	O
-	x	N	N	O	O
n3	eng	N	N	O	O
(	x	N	N	O	O
floor	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
r2	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
maxh	eng	N	N	O	O
>	x	N	N	O	O
lasth	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

maxh	eng	N	N	O	O
=	x	N	N	O	O
lasth	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
h	x	N	N	O	O
=	x	N	N	O	O
maxh	eng	N	N	O	O
;	x	N	N	O	O
h	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
floor	eng	N	N	O	O
;	x	N	N	O	O
h	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

f	x	N	N	O	O
(	x	N	N	O	O
leftv	eng	N	N	O	O
-	x	N	N	O	O
r2	eng	N	N	O	O
*	x	N	N	O	O
h	x	N	N	O	O
,	x	N	N	O	O
floor	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
h	x	N	N	O	O
,	x	N	N	O	O
s	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O
*	x	N	N	O	O
r	x	N	N	O	O
*	x	N	N	O	O
h	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O

10000	m	N	N	O	O
,	x	N	N	O	O

1000	m	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
mins	eng	N	N	O	O
>	x	N	N	O	O
100000000	m	N	N	O	O
)	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
mins	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

总结	n	N	N	O	O
：	x	N	N	O	O
学到	v	N	N	O	O
了	ul	N	N	O	O
搜索	v	Y	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
状态	n	Y	N	O	O
的	uj	N	N	O	O
设计	vn	N	N	O	O
方法	n	Y	N	O	O
，	x	N	N	O	O
搜索	v	Y	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
剪枝	n	Y	N	B-KNOWLEDGE	O
技巧	n	N	N	O	O
，	x	N	N	O	O
递归	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
解决	v	N	N	O	O
的	uj	N	N	O	O
设计	vn	N	N	O	O
方法	n	Y	N	O	O

POJ3628	eng	N	Y	B-OJ	B-OJ
-	x	N	N	O	O
Bookshelf	eng	N	N	O	O

2	m	N	N	O	I-OJ
_	x	N	N	O	O
vjudge	eng	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

题目	n	Y	N	O	O
链接	n	N	N	O	O
：	x	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
poj	eng	N	Y	O	O
.	m	N	N	O	O
org	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
3628	m	N	N	O	O

题意	n	N	N	O	O
描述	v	N	N	O	O
：	x	N	N	O	O
有	v	N	N	O	O
n	eng	N	N	O	O
头牛	n	N	N	O	O
，	x	N	N	O	O
有	v	N	N	O	O
一个	m	N	N	O	O
高	a	N	N	O	O
为	p	N	N	O	O
m	eng	N	N	O	O
的	uj	N	N	O	O
书架	n	N	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
其中	r	N	N	O	O
某	r	N	N	O	O
几头	m	N	N	O	O
牛	n	N	N	O	O
摞	v	N	N	O	O
起来	v	N	N	O	O
比	p	N	N	O	O
书架	n	N	N	O	O
高	a	N	N	O	O
的	uj	N	N	O	O
最小	a	Y	N	O	O
高度	n	Y	N	O	O
。	x	N	N	O	O

题意	n	N	N	O	O
分析	vn	N	N	O	O
：	x	N	N	O	O
0	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
背包	n	Y	N	B-KNOWLEDGE	I-KNOWLEDGE
、	x	N	N	O	O
、	x	N	N	O	O
、	x	N	N	O	O

代码	n	N	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O

一	m	N	N	O	I-OJ
、	x	N	N	O	O
背包	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
写法	v	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

max	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
(	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O

?	x	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
)	x	N	N	O	O
:	x	N	N	O	O
(	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAX	eng	N	N	O	O

20000005	m	N	N	O	O

int	eng	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
25	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
m	eng	N	N	O	O

)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

2	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

sum	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
w	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

max	eng	N	N	O	O
(	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O

j	x	N	N	O	O
-	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

]	x	N	N	O	O

+	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

i	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
-	x	N	N	O	O
m	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

二	m	N	N	O	I-OJ
、	x	N	N	O	O
改写	v	N	N	O	O
背包	n	Y	N	O	B-KNOWLEDGE
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAX	eng	N	N	O	O

20000005	m	N	N	O	O

int	eng	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
22	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
m	eng	N	N	O	O

)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

2	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

sum	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
w	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O

dp	eng	Y	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
)	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O

j	x	N	N	O	O
-	x	N	N	O	O
w	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

]	x	N	N	O	O

)	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
-	x	N	N	O	O
m	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

三	m	N	N	O	O
、	x	N	N	O	O
深	a	N	N	O	O
搜	v	N	N	O	O
写法	v	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAX	eng	N	N	O	O

99999999	m	N	N	O	O

int	eng	N	N	O	O

w	x	N	N	O	O
[	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

MAX	eng	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O

int	eng	N	N	O	O

num	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

sum	eng	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

sum	eng	N	N	O	O

>	x	N	N	O	O
=	x	N	N	O	O

ans	eng	N	N	O	O

)	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

num	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

sum	eng	N	N	O	O

>	x	N	N	O	O
=	x	N	N	O	O

m	x	N	N	O	O

)	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O

num	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O

sum	eng	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O

num	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O

sum	eng	N	N	O	O
+	x	N	N	O	O
w	eng	N	N	O	O
[	x	N	N	O	O
num	eng	N	N	O	O
]	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
m	eng	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
w	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
-	x	N	N	O	O
m	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
HDU1505	eng	N	Y	B-OJ	B-OJ
/	x	N	N	O	O
POJ1964	eng	N	Y	B-OJ	B-OJ

City	eng	N	N	O	O

Game	eng	N	N	O	O

-	x	N	N	O	O

c++	nz	N	N	O	O
语言	n	N	N	O	O
程序开发	nr	N	N	O	O
技术	n	N	N	O	O
文章	n	N	N	O	O
_	x	N	N	O	O
c++	nz	N	N	O	O
编程	n	N	N	O	O

-	x	N	N	O	O

红	a	N	N	O	O
黑	a	N	N	O	O
联盟	j	N	N	O	O

和	c	N	N	O	O
HDU	eng	N	Y	B-OJ	B-OJ

1506	m	N	N	I-OJ	O
类似	v	N	N	O	O
，	x	N	N	O	O
用	p	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
表示	v	Y	N	O	O

在	p	N	N	O	O
i	eng	N	N	O	O
高度	n	Y	N	O	O
j	x	N	N	O	O
位置	v	N	N	O	O
上	f	N	N	O	O
的	uj	N	N	O	O
最大	a	Y	N	O	O
高度	n	Y	N	O	O

[	x	N	N	O	O
cpp	eng	N	N	O	O
]	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

N	x	N	N	O	O

1002	m	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

l	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

www	eng	N	N	O	O
.2	m	N	N	O	O
cto	eng	N	N	O	O
.	m	N	N	O	O
com	eng	N	N	O	O

char	eng	N	N	O	O

ch	eng	Y	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

max	eng	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

T	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
T	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
T	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ch	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ch	eng	Y	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
F	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
高度	n	Y	N	O	O
处理	v	N	N	O	O

else	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
若	c	N	N	O	O
遇上	v	N	N	O	O
‘	x	N	N	O	O
R	x	N	N	O	O
’	x	N	N	O	O
，	x	N	N	O	O
高度	n	Y	N	O	O
置	v	N	N	O	O
零	m	N	N	O	O

}	x	N	N	O	O

max	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
从	p	N	N	O	O
第一行	m	N	N	O	O
开始	v	N	N	O	O
扫描	v	Y	N	O	O
，	x	N	N	O	O
其他	r	N	N	O	O
实现	v	N	N	O	O
几乎	d	N	N	O	O
与	p	N	N	O	O
HDU	eng	N	Y	B-OJ	B-OJ

1506	m	N	N	I-OJ	O
一样	r	N	N	O	O

{	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
m	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

l	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

l	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
[	x	N	N	O	O
l	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

r	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
l	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
3	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
max	eng	N	N	O	O
<	x	N	N	O	O
ans	eng	N	N	O	O
)	x	N	N	O	O

max	eng	N	N	O	O
=	x	N	N	O	O
ans	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
max	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

2893	m	N	N	I-OJ	O

M	x	N	N	O	O

×	x	N	N	O	O

N	x	N	N	O	O

Puzzle	eng	N	N	O	O

(	x	N	N	O	O
由	p	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
求解	v	N	N	O	O
8	x	N	N	O	O
数码	n	Y	N	O	O
问题	n	N	N	O	O
的	uj	N	N	O	O
推广	v	N	N	O	O
)	x	N	N	O	O
_	x	N	N	O	O
answerme11	eng	N	N	O	O
的	uj	N	N	O	O
空间	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

这	r	N	N	O	O
是	v	N	N	O	O
一道	m	N	N	O	O
8	x	N	N	O	O
数码	n	Y	N	O	O
问题	n	N	N	O	O
推广	v	N	N	O	O
的	uj	N	N	O	O
题目	n	Y	N	O	O
，	x	N	N	O	O
可	v	N	N	O	O
通过	p	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
个数	n	Y	N	O	O
判定	v	Y	N	O	O
问题	n	N	N	O	O
是否	v	N	N	O	O
可解	v	N	N	O	O
。	x	N	N	O	O

解决	v	N	N	O	O
这个	r	N	N	O	O
问题	n	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
可以	c	N	N	O	O
首先	d	N	N	O	O
把	p	N	N	O	O
初始	v	N	N	O	O
矩阵	n	Y	N	O	O
按	p	N	N	O	O
从上到下	l	N	N	O	O
，	x	N	N	O	O
从左到右	l	N	N	O	O
顺序排列	l	N	N	O	O
成	n	N	N	O	O
一个	m	N	N	O	O
一维	m	N	N	O	O
数组	n	Y	N	O	O
的	uj	N	N	O	O
数列	m	Y	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
将	d	N	N	O	O
问题	n	N	N	O	O
化成	v	N	N	O	O
求解	v	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
的	uj	N	N	O	O
问题	n	N	N	O	O
。	x	N	N	O	O

若	c	N	N	O	O
初始	v	N	N	O	O
矩阵	n	Y	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O
与	p	N	N	O	O
目标	n	N	N	O	O
矩阵	n	Y	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O
奇偶性	n	N	N	O	O
一致	d	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
问题	n	N	N	O	O
可解	v	N	N	O	O
。	x	N	N	O	O

（	x	N	N	O	O
其中	r	N	N	O	O
两个	m	N	N	O	O
矩阵	n	Y	N	O	O
都	d	N	N	O	O
要	v	N	N	O	O
扣除	v	N	N	O	O
数字	n	Y	N	O	O
0	m	N	N	O	O
对	p	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O
的	uj	N	N	O	O
影响	vn	N	N	O	O
）	x	N	N	O	O
。	x	N	N	O	O

至于	p	N	N	O	O
为什么	r	N	N	O	O
这样	r	N	N	O	O
求解	v	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
也	d	N	N	O	O
无法	n	N	N	O	O
完全	ad	Y	N	O	O
解释	v	N	N	O	O
，	x	N	N	O	O
但是	c	N	N	O	O
可以	c	N	N	O	O
提供	v	N	N	O	O
一些	m	N	N	O	O
参考	v	N	N	O	O
知识	v	N	N	O	O
：	x	N	N	O	O

假设	vn	N	N	O	O
这个	r	N	N	O	O
矩阵	n	Y	N	O	O
有	v	N	N	O	O
3	m	N	N	O	O
列	nr	N	N	O	O
，	x	N	N	O	O
且	zg	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
设为	v	N	N	O	O
N	eng	N	N	O	O

（	x	N	N	O	O
1	x	N	N	O	O
）	x	N	N	O	O
首先	d	N	N	O	O
，	x	N	N	O	O
对于	p	N	N	O	O
可	v	N	N	O	O
左右	m	N	N	O	O
移动	vn	N	N	O	O
的	uj	N	N	O	O
数字	n	Y	N	O	O
，	x	N	N	O	O
它	r	N	N	O	O
左右	m	N	N	O	O
移动	vn	N	N	O	O
是	v	N	N	O	O
不会	v	N	N	O	O
对	p	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
产生	n	N	N	O	O
影响	vn	N	N	O	O
；	x	N	N	O	O

（	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O
若	c	N	N	O	O
数字	n	Y	N	O	O
a0	eng	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
的话	u	N	N	O	O
会	v	N	N	O	O
移到	v	N	N	O	O
它	r	N	N	O	O
之前	f	N	N	O	O
或	c	N	N	O	O
之后	f	N	N	O	O
的	uj	N	N	O	O
两个	m	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
，	x	N	N	O	O
假设	vn	N	N	O	O
是	v	N	N	O	O
向上	d	N	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
且	c	N	N	O	O
这	r	N	N	O	O
两个	m	N	N	O	O
数字	n	Y	N	O	O
为	p	N	N	O	O
a1	eng	N	N	O	O
，	x	N	N	O	O
a2	eng	N	N	O	O
：	x	N	N	O	O
(	x	N	N	O	O
3	m	N	N	O	O
个	m	N	N	O	O
数字	n	Y	N	O	O
肯定	v	N	N	O	O
是	v	N	N	O	O
不同	a	N	N	O	O
数字	n	Y	N	O	O
)	x	N	N	O	O

若	c	N	N	O	O
a0	eng	N	N	O	O

<	x	N	N	O	O

a1	eng	N	N	O	O

<	x	N	N	O	O

a2	eng	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
新	a	N	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
为	p	N	N	O	O
N	eng	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
，	x	N	N	O	O

若	c	N	N	O	O
a1	eng	N	N	O	O

<	x	N	N	O	O

a0	eng	N	N	O	O

<	x	N	N	O	O

a2	eng	N	N	O	O
,	x	N	N	O	O

则	d	N	N	O	O
新	a	N	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
为	p	N	N	O	O
N	eng	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O

=	x	N	N	O	O

N	x	N	N	O	O
，	x	N	N	O	O

若	c	N	N	O	O
a1	eng	N	N	O	O

<	x	N	N	O	O

a2	eng	N	N	O	O

<	x	N	N	O	O

a0	eng	N	N	O	O
,	x	N	N	O	O

则	d	N	N	O	O
新	a	N	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
为	p	N	N	O	O
N	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O
，	x	N	N	O	O

由此可见	c	N	N	O	O
，	x	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
移动	vn	N	N	O	O
是	v	N	N	O	O
不	d	N	N	O	O
影响	vn	N	N	O	O
矩阵	n	Y	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
的	uj	N	N	O	O
奇偶性	n	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
推广	v	N	N	O	O
到	v	N	N	O	O
列数	n	N	N	O	O
为	p	N	N	O	O
奇数	n	Y	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O
也	d	N	N	O	O
是	v	N	N	O	O
一样	r	N	N	O	O
。	x	N	N	O	O

那么	r	N	N	O	O
若	c	N	N	O	O
判定	v	Y	N	O	O
初始	v	N	N	O	O
矩阵	n	Y	N	O	O
与	p	N	N	O	O
目标	n	N	N	O	O
矩阵	n	Y	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
是否	v	N	N	O	O
相同	d	N	N	O	O
，	x	N	N	O	O
即可	d	N	N	O	O
判定	v	Y	N	O	O
问题	n	N	N	O	O
是否	v	N	N	O	O
可解	v	N	N	O	O
，	x	N	N	O	O
若同则	c	N	N	O	O
可解	v	N	N	O	O
，	x	N	N	O	O
否则	c	N	N	O	O
不可	v	N	N	O	O
解	v	N	N	O	O
。	x	N	N	O	O

若列	m	N	N	O	O
数为	n	N	N	O	O
偶数	n	N	N	O	O
的话	u	N	N	O	O
，	x	N	N	O	O
数字	n	Y	N	O	O
左右	m	N	N	O	O
移动	vn	N	N	O	O
同理	n	N	N	O	O
不	d	N	N	O	O
影响	vn	N	N	O	O
，	x	N	N	O	O
但是	c	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
一次	m	N	N	O	O
会	v	N	N	O	O
改变	v	N	N	O	O
一次	m	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
的	uj	N	N	O	O
奇偶性	n	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
对于	p	N	N	O	O
这种	r	N	N	O	O
情况	n	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
可以	c	N	N	O	O
计算	v	Y	N	O	O
初始	v	N	N	O	O
矩阵	n	Y	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
到	v	N	N	O	O
目标	n	N	N	O	O
矩阵	n	Y	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
位置	v	N	N	O	O
的	uj	N	N	O	O
差值	n	N	N	O	O

S	x	N	N	O	O

，	x	N	N	O	O
这样	r	N	N	O	O
可以	c	N	N	O	O
判定	v	Y	N	O	O
奇偶性	n	N	N	O	O
被	p	N	N	O	O
如何	r	N	N	O	O
改变	v	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

由于	c	N	N	O	O
0	x	N	N	O	O
最终	d	N	N	O	O
是	v	N	N	O	O
要	v	N	N	O	O
到	v	N	N	O	O
目标	n	N	N	O	O
位置	v	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
无论	c	N	N	O	O
0	m	N	N	O	O
在	p	N	N	O	O
工程	n	N	N	O	O
中	f	N	N	O	O
如何	r	N	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
的	uj	N	N	O	O
奇偶性	n	N	N	O	O
只	m	N	N	O	O
和	c	N	N	O	O
S	eng	N	N	O	O
有关	vn	N	N	O	O
。	x	N	N	O	O

那	r	N	N	O	O
有些	r	N	N	O	O
人	n	N	N	O	O
可能	v	N	N	O	O
会	v	N	N	O	O
想	v	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
怎么	r	N	N	O	O
只	d	N	N	O	O
考虑	v	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
不	d	N	N	O	O
考虑	v	N	N	O	O
其他	r	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
可以	c	N	N	O	O
这样	r	N	N	O	O
想	v	N	N	O	O
，	x	N	N	O	O
无论	c	N	N	O	O
那个	r	N	N	O	O
数字	n	Y	N	O	O
要	v	N	N	O	O
移动	vn	N	N	O	O
都	d	N	N	O	O
是	v	N	N	O	O
要	v	N	N	O	O
和	c	N	N	O	O
0	m	N	N	O	O
交换	v	N	N	O	O
位置	v	N	N	O	O
，	x	N	N	O	O
也就是说	l	N	N	O	O
无论	c	N	N	O	O
那个	r	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
移动	vn	N	N	O	O
都	d	N	N	O	O
是	v	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
在	p	N	N	O	O
这里	r	N	N	O	O
我们	r	N	N	O	O
就	d	N	N	O	O
只	d	N	N	O	O
分析	vn	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
即可	d	N	N	O	O
。	x	N	N	O	O

以下	f	N	N	O	O
是	v	N	N	O	O
本题	n	N	N	O	O
的	uj	N	N	O	O
代码	n	N	N	O	O
，	x	N	N	O	O
求解	v	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O
用	p	N	N	O	O
的	uj	N	N	O	O
是	v	N	N	O	O
归并	v	Y	N	B-KNOWLEDGE	O
法	j	N	N	I-KNOWLEDGE	O
的	uj	N	N	O	O
模板	n	Y	N	O	O
，	x	N	N	O	O
其实	d	N	N	O	O
用	p	N	N	O	O
树状	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
数组	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
也	d	N	N	O	O
可以	c	N	N	O	O
求解	v	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O
。	x	N	N	O	O

但	c	N	N	O	O
自己	r	N	N	O	O
写嫌	v	N	N	O	O
麻烦	an	N	N	O	O
，	x	N	N	O	O
就用	v	N	N	O	O
了	ul	N	N	O	O
USO	eng	N	N	O	O
同学	n	N	N	O	O
的	uj	N	N	O	O
归并	v	Y	N	B-KNOWLEDGE	O
法	j	N	N	I-KNOWLEDGE	O
的	uj	N	N	O	O
模板	n	Y	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAXN	eng	N	N	O	O

1000005	m	N	N	O	O

int	eng	N	N	O	O

cnt	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
MAXN	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
MAXN	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
0...	m	N	N	O	O
n	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

初始化	l	N	N	O	O
cnt	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

call	eng	N	N	O	O
:	x	N	N	O	O
MergeSort	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

MergeSort	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
归并	v	Y	N	B-KNOWLEDGE	O
求	v	N	N	O	O
逆序	n	Y	N	O	O
对数	n	Y	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
tmp	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
>	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

MergeSort	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

MergeSort	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
mid	eng	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
mid	eng	N	N	O	O
&&	x	N	N	O	O
j	eng	N	N	O	O
<	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

cnt	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
mid	eng	N	N	O	O
-	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O

c	x	N	N	O	O
[	x	N	N	O	O
tmp	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
pl	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O

|	x	N	N	O	O
|	x	N	N	O	O

m	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
break	eng	N	N	O	O
;	x	N	N	O	O

cnt	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

pl	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
loc0	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
*	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
pl	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
pl	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

x	x	N	N	O	O

=	x	N	N	O	O

pl	eng	N	N	O	O
/	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

loc0	eng	N	N	O	O

=	x	N	N	O	O

pl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

pl	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

MergeSort	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
pl	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cnt	eng	N	N	O	O

-	x	N	N	O	O
=	x	N	N	O	O

loc0	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
扣除	v	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
逆	n	N	N	O	O
序数	n	Y	N	O	O

int	eng	N	N	O	O

step	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
若列	m	N	N	O	O
数为	n	N	N	O	O
奇数	n	Y	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
上下左右	m	N	N	O	O
移动	vn	N	N	O	O
都	d	N	N	O	O
不	d	N	N	O	O
影响	vn	N	N	O	O
最终	d	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
的	uj	N	N	O	O
总数	n	N	N	O	O

step	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

step	eng	N	N	O	O

=	x	N	N	O	O

n	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O

-	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
若列	m	N	N	O	O
数为	n	N	N	O	O
偶数	n	N	N	O	O
，	x	N	N	O	O
左右	m	N	N	O	O
移动	vn	N	N	O	O
不	d	N	N	O	O
影响	vn	N	N	O	O
，	x	N	N	O	O
但	c	N	N	O	O
上下	f	Y	N	O	O
移动	vn	N	N	O	O
一次	m	N	N	O	O
，	x	N	N	O	O
会	v	N	N	O	O
改变	v	N	N	O	O
一次	m	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
的	uj	N	N	O	O
奇偶性	n	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
step	eng	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

cnt	eng	N	N	O	O

%	x	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
初始	v	N	N	O	O
，	x	N	N	O	O
结束	v	N	N	O	O
状态	n	Y	N	O	O
的	uj	N	N	O	O
逆序	n	Y	N	O	O
对	p	N	N	O	O
总数	n	N	N	O	O
奇偶性	n	N	N	O	O
一致	d	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
问题	n	N	N	O	O
可解	v	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
YES	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
NO	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

3585	m	N	N	I-OJ	O

一道	m	N	N	O	O
很好	a	N	N	O	O
的	uj	N	N	O	O
树	n	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE

-	x	N	N	O	O

ronaflx	eng	N	N	O	O

-	x	N	N	O	O

博客园	nr	N	N	O	O

题目	n	Y	N	O	O
要求	v	N	N	O	O
给	p	N	N	O	O
一棵	m	N	N	O	O
加权	v	N	N	O	O
无向	d	Y	N	O	B-KNOWLEDGE
树	v	N	N	O	I-KNOWLEDGE
，	x	N	N	O	O
求	v	N	N	O	O
每个	r	N	N	O	O
点	m	N	N	O	O
到	v	N	N	O	O
叶子	nr	N	N	O	O
节点	n	N	N	O	O
的	uj	N	N	O	O
最大	a	Y	N	O	O
流量	n	N	N	O	O
。	x	N	N	O	O

范围	n	N	N	O	O
20	m	N	N	O	O
万	m	N	N	O	O
。	x	N	N	O	O

必须	d	N	N	O	O
是	v	N	N	O	O
O	eng	N	N	O	O
(	x	N	N	O	O
N	x	N	N	O	O
)	x	N	N	O	O
的	uj	N	N	O	O
树	n	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
才	d	N	N	O	O
行	v	N	N	O	O
。	x	N	N	O	O

首先	d	N	N	O	O
固定	a	Y	N	O	O
一个	m	N	N	O	O
为	p	N	N	O	O
根	a	N	N	O	O
，	x	N	N	O	O
做	v	N	N	O	O
一次	m	N	N	O	O
DFS	eng	N	N	B-KNOWLEDGE	O
，	x	N	N	O	O
求	v	N	N	O	O
每个	r	N	N	O	O
节点	n	N	N	O	O
到	v	N	N	O	O
其子	r	N	N	O	O
树	v	N	N	O	O
的	uj	N	N	O	O
叶子	nr	N	N	O	O
节点	n	N	N	O	O
的	uj	N	N	O	O
流量	n	N	N	O	O
和	c	N	N	O	O
son	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
，	x	N	N	O	O
以及	c	N	N	O	O
每个	r	N	N	O	O
节点	n	N	N	O	O
对	p	N	N	O	O
其	r	N	N	O	O
父亲	n	N	N	O	O
节点	n	N	N	O	O
的	uj	N	N	O	O
贡献	n	N	N	O	O
belong	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
，	x	N	N	O	O
还有	v	N	N	O	O
每个	r	N	N	O	O
点	m	N	N	O	O
和	c	N	N	O	O
他	r	N	N	O	O
父亲	n	N	N	O	O
节点	n	N	N	O	O
的	uj	N	N	O	O
边权	n	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
。	x	N	N	O	O

然后	c	N	N	O	O
对	p	N	N	O	O
每个	r	N	N	O	O
节点	n	N	N	O	O
做	v	N	N	O	O
一次	m	N	N	O	O
记忆	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
化	n	N	N	I-KNOWLEDGE	I-KNOWLEDGE
搜索	v	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
，	x	N	N	O	O
顺着	p	N	N	O	O
第一次	m	N	N	O	O
搜索	v	Y	N	O	O
的	uj	N	N	O	O
边	n	N	N	O	O
反向	v	N	N	O	O
搜索	v	Y	N	O	O
。	x	N	N	O	O

DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
的	uj	N	N	O	O
转移	v	N	N	O	O
方程	n	Y	N	O	O
是	v	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

min	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
father	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

belong	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

dege	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

+	x	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

解题	n	N	N	O	O
的	uj	N	N	O	O
过程	n	N	N	O	O
比较	d	N	N	O	O
坎坷	a	N	N	O	O
。	x	N	N	O	O

首先	d	N	N	O	O
状态	n	Y	N	O	O
转移	v	N	N	O	O
方程	n	Y	N	O	O
多次	m	N	N	O	O
修改	v	N	N	O	O
，	x	N	N	O	O
导致	v	N	N	O	O
第一次	m	N	N	O	O
DFS	eng	N	N	B-KNOWLEDGE	O
所	c	N	N	O	O
要求	v	N	N	O	O
的	uj	N	N	O	O
东西	ns	N	N	O	O
不	d	N	N	O	O
明确	ad	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
改	v	N	N	O	O
了	ul	N	N	O	O
好	a	N	N	O	O
多次	m	N	N	O	O
。	x	N	N	O	O

这	r	N	N	O	O
是	v	N	N	O	O
写	v	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
的	uj	N	N	O	O
一大	a	N	N	O	O
忌讳	v	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
没	v	N	N	O	O
确定	v	N	N	O	O
转移	v	N	N	O	O
过程	n	N	N	O	O
就	d	N	N	O	O
开始	v	N	N	O	O
写题	n	N	N	O	O

确定	v	N	N	O	O
转移	v	N	N	O	O
方程	n	Y	N	O	O
以后	f	N	N	O	O
，	x	N	N	O	O
有	v	N	N	O	O
一种	m	N	N	O	O
特殊	a	N	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O
没有	v	N	N	O	O
处理	v	N	N	O	O
好	a	N	N	O	O
，	x	N	N	O	O
就是	d	N	N	O	O
当	t	N	N	O	O
固定	a	Y	N	O	O
的	uj	N	N	O	O
根是	n	N	N	O	O
个度	n	N	N	O	O
为	p	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
时	ng	N	N	O	O
，	x	N	N	O	O
需要	v	N	N	O	O
特殊	a	N	N	O	O
处理	v	N	N	O	O
。	x	N	N	O	O

思考问题	n	N	N	O	O
需要	v	N	N	O	O
群面	n	N	N	O	O
。	x	N	N	O	O

一下	m	N	N	O	O
为此	r	N	N	O	O
题	n	N	N	O	O
的	uj	N	N	O	O
代码	n	N	N	O	O
：	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

3585	m	N	N	I-OJ	O

1	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

2	x	N	N	O	O

*	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O

3	x	N	N	O	O

*	x	N	N	O	O

4	x	N	N	O	O

*	x	N	N	O	O

Filename	eng	N	N	O	O
:	x	N	N	O	O

dp	eng	Y	N	O	O
.	m	N	N	O	O
cpp	eng	N	N	O	O

5	x	N	N	O	O

*	x	N	N	O	O

6	x	N	N	O	O

*	x	N	N	O	O

Description	eng	N	N	O	O
:	x	N	N	O	O

tree	eng	N	N	O	O

dp	eng	Y	N	O	O

problem	eng	N	N	O	O

7	x	N	N	O	O

*	x	N	N	O	O

8	x	N	N	O	O

*	x	N	N	O	O

Version	eng	N	N	O	O
:	x	N	N	O	O

1.0	m	N	N	O	O

9	x	N	N	O	O

*	x	N	N	O	O

Created	eng	N	N	O	O
:	x	N	N	O	O

2011	m	N	N	O	O
年	m	N	N	O	O
07	m	N	N	O	O
月	m	N	N	O	O
22	m	N	N	O	O
日	m	N	N	O	O

13	m	N	N	O	O
时	n	N	N	O	O
41	m	N	N	O	O
分	v	N	N	O	O
18	m	N	N	O	O
秒	m	N	N	O	O

10	m	N	N	O	O

*	x	N	N	O	O

Revision	eng	N	N	O	O
:	x	N	N	O	O

none	eng	N	N	O	O

11	m	N	N	O	O

*	x	N	N	O	O

Compiler	eng	N	N	O	O
:	x	N	N	O	O

gcc	eng	N	N	O	O

12	m	N	N	O	O

*	x	N	N	O	O

13	m	N	N	O	O

*	x	N	N	O	O

Author	eng	N	N	O	O
:	x	N	N	O	O

ronaflx	eng	N	N	O	O

14	m	N	N	O	O

*	x	N	N	O	O

Company	eng	N	N	O	O
:	x	N	N	O	O

hit	eng	N	N	O	O
-	x	N	N	O	O
ACM	eng	N	N	O	O
-	x	N	N	O	O
Group	eng	N	N	O	O

15	m	N	N	O	O

*	x	N	N	O	O

16	m	N	N	O	O

*	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O

17	m	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

18	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdlib	eng	N	N	O	O
>	x	N	N	O	O

19	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cctype	eng	N	N	O	O
>	x	N	N	O	O

20	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

21	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

22	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cmath	eng	N	N	O	O
>	x	N	N	O	O

23	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
ctime	eng	N	N	O	O
>	x	N	N	O	O

24	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
climits	eng	N	N	O	O
>	x	N	N	O	O

25	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

26	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
functional	eng	N	N	O	O
>	x	N	N	O	O

27	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
numeric	eng	N	N	O	O
>	x	N	N	O	O

28	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
vector	eng	N	N	O	O
>	x	N	N	O	O

29	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
map	eng	N	N	O	O
>	x	N	N	O	O

30	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
set	eng	N	N	O	O
>	x	N	N	O	O

31	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

32	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stack	eng	N	N	O	O
>	x	N	N	O	O

33	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
bitset	eng	N	N	O	O
>	x	N	N	O	O

34	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
list	eng	N	N	O	O
>	x	N	N	O	O

35	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

36	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

37	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
sstream	eng	N	N	O	O
>	x	N	N	O	O

38	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
fstream	eng	N	N	O	O
>	x	N	N	O	O

39	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iomanip	eng	N	N	O	O
>	x	N	N	O	O

40	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdexcept	eng	N	N	O	O
>	x	N	N	O	O

41	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
utility	eng	N	N	O	O
>	x	N	N	O	O

42	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cassert	eng	N	N	O	O
>	x	N	N	O	O

43	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
complex	eng	N	N	O	O
>	x	N	N	O	O

44	m	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

45	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

LEFT	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

46	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

RIGHT	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

|	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

47	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MID	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

r	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

48	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

CC	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O

v	x	N	N	O	O
)	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O

v	x	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

49	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

REP	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

l	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O

int	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

50	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

FOREACH	eng	N	N	O	O
(	x	N	N	O	O
con	eng	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
__	x	N	N	O	O
typeof	eng	N	N	O	O
(	x	N	N	O	O
con	eng	N	N	O	O
.	m	N	N	O	O
begin	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

con	eng	N	N	O	O
.	m	N	N	O	O
begin	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

con	eng	N	N	O	O
.	m	N	N	O	O
end	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

51	m	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

N	x	N	N	O	O

=	x	N	N	O	O

200000	m	N	N	O	O
;	x	N	N	O	O

52	m	N	N	O	O

const	eng	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

INF	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
long	eng	N	N	O	O

long	eng	N	N	O	O
)	x	N	N	O	O

N	x	N	N	O	O

*	x	N	N	O	O

N	x	N	N	O	O
;	x	N	N	O	O

53	m	N	N	O	O

vector	eng	N	N	O	O
<	x	N	N	O	O
pair	eng	N	N	O	O
<	x	N	N	O	O
int	eng	N	N	O	O
,	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O
>	x	N	N	O	O

>	x	N	N	O	O

adj	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

54	m	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

belong	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

55	m	N	N	O	O

int	eng	N	N	O	O

father	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

56	m	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

DP	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O

57	m	N	N	O	O

{	x	N	N	O	O

58	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

59	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O

&&	x	N	N	O	O

x	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

60	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

61	m	N	N	O	O

{	x	N	N	O	O

62	m	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

63	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
adj	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

adj	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
second	eng	N	N	O	O

*	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

64	m	N	N	O	O

else	eng	N	N	O	O

return	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

65	m	N	N	O	O

}	x	N	N	O	O

66	m	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
min	eng	N	N	O	O
(	x	N	N	O	O
DP	eng	N	N	O	O
(	x	N	N	O	O
father	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

-	x	N	N	O	O

belong	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

father	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O

?	x	N	N	O	O

0	x	N	N	O	O

:	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

+	x	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

67	m	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

ans	eng	N	N	O	O
;	x	N	N	O	O

68	m	N	N	O	O

return	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

69	m	N	N	O	O

}	x	N	N	O	O

70	m	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

pre	eng	N	N	O	O
)	x	N	N	O	O

71	m	N	N	O	O

{	x	N	N	O	O

72	m	N	N	O	O

father	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

pre	eng	N	N	O	O
;	x	N	N	O	O

73	m	N	N	O	O

int	eng	N	N	O	O

isLeaf	eng	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

74	m	N	N	O	O

FOREACH	eng	N	N	O	O
(	x	N	N	O	O
adj	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O

75	m	N	N	O	O

{	x	N	N	O	O

76	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
first	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

pre	eng	N	N	O	O
)	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
second	eng	N	N	O	O
;	x	N	N	O	O

77	m	N	N	O	O

else	eng	N	N	O	O

78	m	N	N	O	O

{	x	N	N	O	O

79	m	N	N	O	O

isLeaf	eng	N	N	O	O

=	x	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

80	m	N	N	O	O

int	eng	N	N	O	O

score	eng	N	N	O	O

=	x	N	N	O	O

min	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
second	eng	N	N	O	O
,	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
first	eng	N	N	O	O
,	x	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

81	m	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

score	eng	N	N	O	O
;	x	N	N	O	O

82	m	N	N	O	O

belong	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
first	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

score	eng	N	N	O	O
;	x	N	N	O	O

83	m	N	N	O	O

}	x	N	N	O	O

84	m	N	N	O	O

}	x	N	N	O	O

85	m	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
isLeaf	eng	N	N	O	O

?	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

:	x	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

86	m	N	N	O	O

}	x	N	N	O	O

87	m	N	N	O	O

88	m	N	N	O	O

89	m	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

90	m	N	N	O	O

{	x	N	N	O	O

91	m	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

v	x	N	N	O	O
,	x	N	N	O	O

u	x	N	N	O	O
,	x	N	N	O	O

c	x	N	N	O	O
;	x	N	N	O	O

92	m	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

93	m	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
t	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

94	m	N	N	O	O

{	x	N	N	O	O

95	m	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

96	m	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

adj	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
clear	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

97	m	N	N	O	O

CC	eng	N	N	O	O
(	x	N	N	O	O
son	eng	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

98	m	N	N	O	O

CC	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
,	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

99	m	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

100	m	N	N	O	O

{	x	N	N	O	O

101	m	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
v	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
u	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
c	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

102	m	N	N	O	O

v	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
,	x	N	N	O	O

u	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

103	m	N	N	O	O

adj	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
make	eng	N	N	O	O
_	x	N	N	O	O
pair	eng	N	N	O	O
(	x	N	N	O	O
u	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
long	eng	N	N	O	O

long	eng	N	N	O	O
)	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

104	m	N	N	O	O

adj	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
make	eng	N	N	O	O
_	x	N	N	O	O
pair	eng	N	N	O	O
(	x	N	N	O	O
v	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
long	eng	N	N	O	O

long	eng	N	N	O	O
)	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

105	m	N	N	O	O

}	x	N	N	O	O

106	m	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

107	m	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

108	m	N	N	O	O

DP	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

109	m	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O

n	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
lld	eng	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
lld	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

father	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

110	m	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
lld	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

*	x	N	N	O	O
max	eng	N	N	O	O
_	x	N	N	O	O
element	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
,	x	N	N	O	O

dp	eng	Y	N	O	O

+	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

111	m	N	N	O	O

}	x	N	N	O	O

112	m	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

113	m	N	N	O	O

}	x	N	N	O	O

POJ2472	eng	N	Y	B-OJ	B-OJ

n	eng	N	N	O	O
次	m	N	N	O	O
迪杰	nr	N	N	B-KNOWLEDGE	O
斯特拉	nrt	N	N	I-KNOWLEDGE	O

-	x	N	N	O	O

Belong	eng	N	N	O	O

to	eng	N	N	O	O

Sopranos	eng	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

一个	m	N	N	O	O
简单	a	N	N	O	O
的	uj	N	N	O	O
最	a	N	N	O	O
短路	n	Y	N	O	O
，	x	N	N	O	O
之前	f	N	N	O	O
写	v	N	N	O	O
过	ug	N	N	O	O
一个	m	N	N	O	O
等效于	v	N	N	O	O
floyd	eng	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
（	x	N	N	O	O
floyd	eng	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
太	n	N	N	O	O
简单	a	N	N	O	O
，	x	N	N	O	O
但	c	N	N	O	O
人家	n	N	N	O	O
思想	n	Y	N	O	O
很	zg	N	N	O	O
强大	a	N	N	O	O
）	x	N	N	O	O
的	uj	N	N	O	O
DJ	eng	N	N	O	O
，	x	N	N	O	O
这次	r	N	N	O	O
又	d	N	N	O	O
重温	n	N	N	O	O
一下	m	N	N	O	O
，	x	N	N	O	O
不错	a	N	N	O	O
，	x	N	N	O	O
依然	d	N	N	O	O
好	a	N	N	O	O
用	p	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

根据	p	N	N	O	O
floyd	eng	Y	N	B-KNOWLEDGE	O
的	uj	N	N	O	O
思想	n	Y	N	O	O
和	c	N	N	O	O
DJ	eng	N	N	O	O
的	uj	N	N	O	O
思想	n	Y	N	O	O
可知	v	N	N	O	O
，	x	N	N	O	O
n	eng	N	N	O	O
次	t	N	N	O	O
DJ	eng	N	N	O	O
算法	n	Y	N	O	O
相当于	v	N	N	O	O
一次	m	N	N	O	O
floyd	eng	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
算法	n	Y	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cmath	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

buzhun	eng	N	N	O	O
_	x	N	N	O	O
tou	eng	N	N	O	O
_	x	N	N	O	O
zhuan	eng	N	N	O	O
_	x	N	N	O	O
pzjay	eng	N	N	O	O
_	x	N	N	O	O
wenzhang	eng	N	N	O	O

0	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

N	x	N	N	O	O
=	x	N	N	O	O
1000	m	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

double	eng	N	N	O	O

pp	eng	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1.00	m	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

Pzjay	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

used	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

nax	eng	N	N	O	O
=	x	N	N	O	O
101	m	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

DJ	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

k	x	N	N	O	O
,	x	N	N	O	O
beg	eng	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

min	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
used	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
used	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

used	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
pp	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
used	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

Pzjay	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
min	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
Pzjay	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

beg	eng	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

used	eng	N	N	O	O
[	x	N	N	O	O
beg	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
used	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

Pzjay	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
Pzjay	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
beg	eng	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
Pzjay	eng	N	N	O	O
[	x	N	N	O	O
beg	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

Pzjay	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
Pzjay	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
beg	eng	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
Pzjay	eng	N	N	O	O
[	x	N	N	O	O
beg	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

tmp	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
Pzjay	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
Pzjay	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
used	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
used	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
i	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
tmp	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

Pzjay	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
Pzjay	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
tmp	eng	N	N	O	O
*	x	N	N	O	O
0.01	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

DJ	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O
for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
.2	m	N	N	O	O
lf	eng	N	N	O	O

"	x	N	N	O	O
,	x	N	N	O	O
Pzjay	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
*	x	N	N	O	O
/	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
.6	m	N	N	O	O
lf	eng	N	N	O	O

percent	eng	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
100.0	m	N	N	O	O
*	x	N	N	O	O
Pzjay	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

buzhun	eng	N	N	O	O
_	x	N	N	O	O
tou	eng	N	N	O	O
_	x	N	N	O	O
zhuan	eng	N	N	O	O
_	x	N	N	O	O
pzjay	eng	N	N	O	O
_	x	N	N	O	O
wenzhang	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

最	d	N	N	O	O
简单	a	N	N	O	O
的	uj	N	N	O	O
DP	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
，	x	N	N	O	O
POJ2760	eng	N	Y	B-OJ	B-OJ
数字	n	Y	N	O	O
三角形	n	Y	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O
。	x	N	N	O	O

_	x	N	N	O	O
王彪	nr	N	N	O	O
_	x	N	N	O	O
NEU	eng	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

2760	m	N	N	O	O
:	x	N	N	O	O
数字	n	Y	N	O	O
三角形	n	Y	N	O	O

查看	v	N	N	O	O

提交	v	N	N	O	O

统计	v	Y	N	O	O

提示	v	N	N	O	O

提问	v	N	N	O	O

时间	n	N	N	O	O
限制	v	Y	N	O	O
:	x	N	N	O	O

1000	m	N	N	O	O
ms	eng	N	N	O	O

内存	n	N	N	O	O
限制	v	Y	N	O	O
:	x	N	N	O	O

65536	m	N	N	O	O
kB	eng	N	N	O	O

描述	v	N	N	O	O

7	x	N	N	O	O

3	x	N	N	O	O

8	x	N	N	O	O

8	x	N	N	O	O

1	x	N	N	O	O

0	x	N	N	O	O

2	x	N	N	O	O

7	x	N	N	O	O

4	x	N	N	O	O

4	x	N	N	O	O

4	x	N	N	O	O

5	x	N	N	O	O

2	x	N	N	O	O

6	x	N	N	O	O

5	x	N	N	O	O

(	x	N	N	O	O
图	n	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O

图	n	N	N	O	O
1	m	N	N	O	O
给出	v	N	N	O	O
了	ul	N	N	O	O
一个	m	N	N	O	O
数字	n	Y	N	O	O
三角形	n	Y	N	O	O
。	x	N	N	O	O

从	p	N	N	O	O
三角形	n	Y	N	O	O
的	uj	N	N	O	O
顶部	f	N	N	O	O
到	v	N	N	O	O
底部	f	N	N	O	O
有	v	N	N	O	O
很多	m	N	N	O	O
条	n	N	N	O	O
不同	a	N	N	O	O
的	uj	N	N	O	O
路径	n	Y	N	O	O
。	x	N	N	O	O

对于	p	N	N	O	O
每	r	N	N	O	O
条	q	N	N	O	O
路径	n	Y	N	O	O
，	x	N	N	O	O
把	p	N	N	O	O
路径	n	Y	N	O	O
上面	f	N	N	O	O
的	uj	N	N	O	O
数加	n	Y	N	O	O
起来	v	N	N	O	O
可以	c	N	N	O	O
得到	v	N	N	O	O
一个	m	N	N	O	O
和	c	N	N	O	O
，	x	N	N	O	O
你	r	N	N	O	O
的	uj	N	N	O	O
任务	n	N	N	O	O
就是	d	N	N	O	O
找到	v	N	N	O	O
最大	a	Y	N	O	O
的	uj	N	N	O	O
和	c	N	N	O	O
。	x	N	N	O	O

注意	v	N	N	O	O
：	x	N	N	O	O
路径	n	Y	N	O	O
上	f	N	N	O	O
的	uj	N	N	O	O
每	r	N	N	O	O
一步	m	N	N	O	O
只能	v	N	N	O	O
从	p	N	N	O	O
一个	m	N	N	O	O
数	m	N	N	O	O
走到	v	N	N	O	O
下	f	N	N	O	O
一层	m	N	N	O	O
上	f	N	N	O	O
和	c	N	N	O	O
它	r	N	N	O	O
最近	f	N	N	O	O
的	uj	N	N	O	O
左边	f	N	N	O	O
的	uj	N	N	O	O
那个	r	N	N	O	O
数	n	N	N	O	O
或者	c	N	N	O	O
右边	f	N	N	O	O
的	uj	N	N	O	O
那个	r	N	N	O	O
数	n	N	N	O	O
。	x	N	N	O	O

输入	v	N	N	O	O

输入	v	N	N	O	O
的	uj	N	N	O	O
是	v	N	N	O	O
一行	m	N	N	O	O
是	v	N	N	O	O
一个	m	N	N	O	O
整数	n	Y	N	O	O
N	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O

N	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

100	m	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
给出	v	N	N	O	O
三角形	n	Y	N	O	O
的	uj	N	N	O	O
行数	n	N	N	O	O
。	x	N	N	O	O

下面	f	N	N	O	O
的	uj	N	N	O	O
N	eng	N	N	O	O
行	n	N	N	O	O
给出	v	N	N	O	O
数字	n	Y	N	O	O
三角形	n	Y	N	O	O
。	x	N	N	O	O

数字	n	Y	N	O	O
三角形	n	Y	N	O	O
上	f	N	N	O	O
的	uj	N	N	O	O
数	m	N	N	O	O
的	uj	N	N	O	O
范围	n	N	N	O	O
都	d	N	N	O	O
在	p	N	N	O	O
0	m	N	N	O	O
和	c	N	N	O	O
100	m	N	N	O	O
之间	f	N	N	O	O
。	x	N	N	O	O

输出	v	Y	N	O	O

输出	v	Y	N	O	O
最大	a	Y	N	O	O
的	uj	N	N	O	O
和	c	N	N	O	O
。	x	N	N	O	O

样例	n	N	N	O	O
输入	v	N	N	O	O

5	x	N	N	O	O

7	x	N	N	O	O

3	x	N	N	O	O

8	x	N	N	O	O

8	x	N	N	O	O

1	x	N	N	O	O

0	x	N	N	O	O

2	x	N	N	O	O

7	x	N	N	O	O

4	x	N	N	O	O

4	x	N	N	O	O

4	x	N	N	O	O

5	x	N	N	O	O

2	x	N	N	O	O

6	x	N	N	O	O

5	x	N	N	O	O

样例	n	N	N	O	O
输出	v	Y	N	O	O

30	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
max	eng	N	N	O	O
;	x	N	N	O	O

max	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
/	x	N	N	O	O
SPAN	eng	N	N	O	O
>	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
m	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
/	x	N	N	O	O
SPAN	eng	N	N	O	O
>	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
/	x	N	N	O	O
SPAN	eng	N	N	O	O
>	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
max	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
/	x	N	N	O	O
SPAN	eng	N	N	O	O
>	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
max	eng	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
max	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

1849	m	N	N	I-OJ	O

Two	eng	N	N	O	O

-	x	N	N	O	O

Because	eng	N	N	O	O

Of	eng	N	N	O	O

You	eng	N	N	O	O

-	x	N	N	O	O

博客园	nr	N	N	O	O

在	p	N	N	O	O
某个	r	N	N	O	O
点	m	N	N	O	O
派出	v	N	N	O	O
两个	m	N	N	O	O
点	m	N	N	O	O
去	v	N	N	O	O
遍历	v	Y	N	O	O
所有	b	N	N	O	O
的	uj	N	N	O	O
边	n	N	N	O	O
，	x	N	N	O	O
花费	n	N	N	O	O
为边	r	N	N	O	O
的	uj	N	N	O	O
权值	n	N	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
最少	d	N	N	O	O
的	uj	N	N	O	O
花费	n	N	N	O	O

仔细分析	n	N	N	O	O
后	f	N	N	O	O
发现	v	N	N	O	O
从	p	N	N	O	O
哪个	r	N	N	O	O
点	m	N	N	O	O
出发	v	N	N	O	O
是	v	N	N	O	O
无所谓	l	N	N	O	O
的	uj	N	N	O	O

如果	c	N	N	O	O
从	p	N	N	O	O
某个	r	N	N	O	O
点	m	N	N	O	O
出发	v	N	N	O	O
要	v	N	N	O	O
回到	v	N	N	O	O
这个	r	N	N	O	O
点	m	N	N	O	O
，	x	N	N	O	O
那么	r	N	N	O	O
它	r	N	N	O	O
走过	v	N	N	O	O
的	uj	N	N	O	O
边	n	N	N	O	O
肯定	v	N	N	O	O
都	d	N	N	O	O
被	p	N	N	O	O
他	r	N	N	O	O
遍历	v	Y	N	O	O
了	ul	N	N	O	O
两遍	m	N	N	O	O
，	x	N	N	O	O
画	v	N	N	O	O
个	q	N	N	O	O
图	n	N	N	O	O
模拟	v	Y	N	O	O
一下	m	N	N	O	O
就	d	N	N	O	O
知道	v	N	N	O	O
了	ul	N	N	O	O

但是	c	N	N	O	O
如果	c	N	N	O	O
不	d	N	N	O	O
回来	v	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
所	u	N	N	O	O
走	v	N	N	O	O
路径	n	Y	N	O	O
中	f	N	N	O	O
有	v	N	N	O	O
一条	m	N	N	O	O
简单	a	N	N	O	O
路径	n	Y	N	O	O
是	v	N	N	O	O
可以	c	N	N	O	O
只	d	N	N	O	O
走一遍	l	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
派出	v	N	N	O	O
了	ul	N	N	O	O
两个	m	N	N	O	O
点	m	N	N	O	O
去	v	N	N	O	O
遍历	v	Y	N	O	O
，	x	N	N	O	O
也就是说	l	N	N	O	O
有	v	N	N	O	O
两条	m	N	N	O	O
简单	a	N	N	O	O
路径	n	Y	N	O	O
是	v	N	N	O	O
可以	c	N	N	O	O
直	d	N	N	O	O
走	v	N	N	O	O
一边	d	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
我们	r	N	N	O	O
要使	c	N	N	O	O
这	r	N	N	O	O
两条	m	N	N	O	O
简单	a	N	N	O	O
路径	n	Y	N	O	O
的	uj	N	N	O	O
总和	n	N	N	O	O
尽可能	d	N	N	O	O
的	uj	N	N	O	O
长	n	N	N	O	O
，	x	N	N	O	O
就	d	N	N	O	O
转换	v	Y	N	O	O
为了	p	N	N	O	O
树	v	N	N	O	O
的	uj	N	N	O	O
最长	a	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
路径	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
问题	n	N	N	I-KNOWLEDGE	O
了	ul	N	N	O	O

所以	c	N	N	O	O
答案	n	N	N	O	O
就	d	N	N	O	O
为	p	N	N	O	O
总	b	N	N	O	O
的	uj	N	N	O	O
边权	n	N	N	O	O
和	c	N	N	O	O
的	uj	N	N	O	O
两倍	m	N	N	O	O
减去	v	N	N	O	O
树	v	N	N	O	O
的	uj	N	N	O	O
最长	a	Y	N	O	B-KNOWLEDGE
路	n	N	N	O	O

View	eng	N	N	O	O

Code	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
vector	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

vector	eng	N	N	O	O
<	x	N	N	O	O
pair	eng	N	N	O	O
<	x	N	N	O	O
int	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O
>	x	N	N	O	O

>	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
100010	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

step	eng	N	N	O	O
[	x	N	N	O	O
100100	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

vis	eng	N	N	O	O
[	x	N	N	O	O
100010	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

bfs	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

&	x	N	N	O	O
s	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

Max	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
vis	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
vis	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

queue	eng	N	N	O	O
<	x	N	N	O	O
int	eng	N	N	O	O
>	x	N	N	O	O

Q	x	N	N	O	O
;	x	N	N	O	O

Q	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
step	eng	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
Q	eng	N	N	O	O
.	m	N	N	O	O
empty	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

fr	eng	N	N	O	O
=	x	N	N	O	O
Q	eng	N	N	O	O
.	m	N	N	O	O
front	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
Q	eng	N	N	O	O
.	m	N	N	O	O
pop	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
fr	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

to	eng	N	N	O	O
=	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
fr	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
first	eng	N	N	O	O
,	x	N	N	O	O
w	x	N	N	O	O
=	x	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
fr	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
second	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
vis	eng	N	N	O	O
[	x	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

step	eng	N	N	O	O
[	x	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
step	eng	N	N	O	O
[	x	N	N	O	O
fr	eng	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
w	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
step	eng	N	N	O	O
[	x	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
Max	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

Max	eng	N	N	O	O
=	x	N	N	O	O
step	eng	N	N	O	O
[	x	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
=	x	N	N	O	O
to	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

vis	eng	N	N	O	O
[	x	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

Q	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
(	x	N	N	O	O
to	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O
return	eng	N	N	O	O

Max	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
w	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
s	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
b	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
w	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
w	x	N	N	O	O
;	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
make	eng	N	N	O	O
_	x	N	N	O	O
pair	eng	N	N	O	O
(	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
w	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
b	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
make	eng	N	N	O	O
_	x	N	N	O	O
pair	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
w	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bfs	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

mm	eng	N	N	O	O
=	x	N	N	O	O
bfs	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
-	x	N	N	O	O
mm	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

数据结构	n	N	N	O	O
与	p	N	N	O	O
算法	n	Y	N	O	O
学习	v	N	N	O	O
之	u	N	N	O	O
九	m	N	N	O	O
【	x	N	N	O	O
图论	n	Y	N	B-KNOWLEDGE	O
其他	r	N	N	O	O
问题	n	N	N	O	O
】	x	N	N	O	O
HOJ	eng	N	Y	B-OJ	B-OJ

1303	m	N	N	I-OJ	I-OJ
/	x	N	N	O	O
POJ	eng	N	Y	B-OJ	B-OJ

1776	m	N	N	I-OJ	O

+	x	N	N	O	O

HOJ	eng	N	Y	B-OJ	B-OJ

1115	m	N	N	I-OJ	I-OJ
/	x	N	N	O	O
POJ	eng	N	Y	B-OJ	B-OJ

1129	m	N	N	I-OJ	I-OJ

+	x	N	N	O	O

HOJ	eng	N	Y	B-OJ	B-OJ

1266	m	N	N	I-OJ	I-OJ
/	x	N	N	O	O
POJ	eng	N	Y	B-OJ	B-OJ

1620	m	N	N	I-OJ	I-OJ
_	x	N	N	O	O
漫步	vn	N	N	O	O
在	p	N	N	O	O
橙色	n	N	N	O	O
夕阳	ns	N	N	O	O
下	f	N	N	O	O
的	uj	N	N	O	O
路	n	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

HOJ	eng	N	Y	B-OJ	B-OJ

1303	m	N	N	I-OJ	I-OJ
/	x	N	N	I-OJ	O
POJ	eng	N	Y	B-OJ	B-OJ

1776	m	N	N	I-OJ	O

Task	eng	N	N	O	O

Sequences	eng	N	N	O	O
（	x	N	N	O	O
比赛	vn	N	N	O	O
图	n	N	N	O	O
构造	v	Y	N	O	O
哈密顿	nr	Y	N	B-KNOWLEDGE	O
图	n	N	N	I-KNOWLEDGE	I-KNOWLEDGE
）	x	N	N	O	O

传送门	n	N	N	O	O
：	x	N	N	O	O
http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
hit	eng	N	N	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
hoj	eng	N	Y	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
/	x	N	N	O	O
view	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
1303	m	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
poj	eng	N	Y	O	O
.	m	N	N	O	O
org	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
1776	m	N	N	O	O

题意	n	N	N	O	O
：	x	N	N	O	O
Tom	eng	N	N	O	O
有	v	N	N	O	O
一个	m	N	N	O	O
machine	eng	N	N	O	O
，	x	N	N	O	O
要	v	N	N	O	O
做	v	N	N	O	O
很多	m	N	N	O	O
task	eng	N	N	O	O
，	x	N	N	O	O
machine	eng	N	N	O	O
不能	v	N	N	O	O
在	p	N	N	O	O
多个	m	N	N	O	O
task	eng	N	N	O	O
之间	f	N	N	O	O
自由	a	N	N	O	O
移动	vn	N	N	O	O
，	x	N	N	O	O
只能	v	N	N	O	O
从	p	N	N	O	O
特定	d	N	N	O	O
的	uj	N	N	O	O
task	eng	N	N	O	O
移动	vn	N	N	O	O
到	v	N	N	O	O
它	r	N	N	O	O
的	uj	N	N	O	O
后继	nr	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
不	d	N	N	O	O
存在	v	N	N	O	O
后继	nr	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
要	v	N	N	O	O
重启	v	N	N	O	O
机器	n	N	N	O	O
，	x	N	N	O	O
请问	v	N	N	O	O
怎样	r	N	N	O	O
安排	v	N	N	O	O
machine	eng	N	N	O	O
的	uj	N	N	O	O
工作	vn	N	N	O	O
流程	n	N	N	O	O
，	x	N	N	O	O
才能	v	N	N	O	O
使得	v	N	N	O	O
启动	vn	N	N	O	O
次数	n	N	N	O	O
最少	d	N	N	O	O
。	x	N	N	O	O

输入	v	N	N	O	O
：	x	N	N	O	O
task	eng	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
，	x	N	N	O	O
还有	v	N	N	O	O
可	v	N	N	O	O
达	v	N	N	O	O
矩阵	n	Y	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
可达	v	N	N	O	O
则	d	N	N	O	O
为	p	N	N	O	O
1	m	N	N	O	O
，	x	N	N	O	O
否则	c	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
。	x	N	N	O	O

输出	v	Y	N	O	O
：	x	N	N	O	O
需要	v	N	N	O	O
启动	vn	N	N	O	O
的	uj	N	N	O	O
次数	n	N	N	O	O
(	x	N	N	O	O
肯定	v	N	N	O	O
为	p	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
每次	r	N	N	O	O
启动	vn	N	N	O	O
的	uj	N	N	O	O
task	eng	N	N	O	O
个数	n	Y	N	O	O
(	x	N	N	O	O
肯定	v	N	N	O	O
为	p	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
task	eng	N	N	O	O
顺序	n	N	N	O	O
。	x	N	N	O	O

思路	n	N	N	O	O
：	x	N	N	O	O
此	zg	N	N	O	O
题为	v	N	N	O	O
求	v	N	N	O	O
比赛	vn	N	N	O	O
图	n	N	N	O	O
的	uj	N	N	O	O
哈密顿	nr	Y	N	O	O
路	n	N	N	O	O
，	x	N	N	O	O
由于	c	N	N	O	O
此	zg	N	N	O	O
有向图	nr	N	N	O	O
中	f	N	N	O	O
任意	v	Y	N	O	O
两点	m	N	N	O	O
都	d	N	N	O	O
有	v	N	N	O	O
边	d	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
该	r	N	N	O	O
图	n	N	N	O	O
必	d	N	N	O	O
有	v	N	N	O	O
哈密顿	nr	Y	N	O	O
路	n	N	N	O	O
。	x	N	N	O	O

构造方法	n	N	N	O	O
：	x	N	N	O	O

初始	v	N	N	O	O
：	x	N	N	O	O
将点	n	N	N	O	O
1	m	N	N	O	O
加入	v	N	N	O	O
没有	v	N	N	O	O
边	d	N	N	O	O
的	uj	N	N	O	O
路中	s	N	N	O	O
。	x	N	N	O	O

考虑	v	N	N	O	O
点	m	N	N	O	O
2	m	N	N	O	O
。	x	N	N	O	O

如果	c	N	N	O	O
有	v	N	N	O	O
（	x	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
2	x	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
将	d	N	N	O	O
2	m	N	N	O	O
加入	v	N	N	O	O
1	x	N	N	O	O
之后	f	N	N	O	O
，	x	N	N	O	O
形成	v	N	N	O	O
1	x	N	N	O	O
，	x	N	N	O	O
2	m	N	N	O	O
路	n	N	N	O	O
，	x	N	N	O	O
否则	c	N	N	O	O
，	x	N	N	O	O
将	d	N	N	O	O
2	m	N	N	O	O
加入	v	N	N	O	O
1	x	N	N	O	O
之前	f	N	N	O	O
，	x	N	N	O	O
形成	v	N	N	O	O
2	x	N	N	O	O
，	x	N	N	O	O
1	x	N	N	O	O
。	x	N	N	O	O

依次	d	N	N	O	O
考虑	v	N	N	O	O
点	m	N	N	O	O
3	m	N	N	O	O
，	x	N	N	O	O
4	x	N	N	O	O
，	x	N	N	O	O
5	x	N	N	O	O
，	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
，	x	N	N	O	O
i	x	N	N	O	O
；	x	N	N	O	O
设	v	N	N	O	O
形成	v	N	N	O	O
路	n	N	N	O	O
a1	eng	N	N	O	O
，	x	N	N	O	O
a2	eng	N	N	O	O
，	x	N	N	O	O
a3	eng	N	N	O	O
，	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
，	x	N	N	O	O
ai	eng	N	N	O	O
；	x	N	N	O	O
现在	t	N	N	O	O
将	d	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
加入	v	N	N	O	O
此	zg	N	N	O	O
路	n	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
有	v	N	N	O	O
（	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
，	x	N	N	O	O
a1	eng	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
将	d	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
加入	v	N	N	O	O
a1	eng	N	N	O	O
之前	f	N	N	O	O
；	x	N	N	O	O
否则	c	N	N	O	O
，	x	N	N	O	O
有	v	N	N	O	O
（	x	N	N	O	O
a1	eng	N	N	O	O
，	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
有	v	N	N	O	O
（	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
，	x	N	N	O	O
a2	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
则	d	N	N	O	O
将	d	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
加入	v	N	N	O	O
a1	eng	N	N	O	O
和	c	N	N	O	O
a2	eng	N	N	O	O
之间	f	N	N	O	O
；	x	N	N	O	O
否则	c	N	N	O	O
，	x	N	N	O	O
考虑	v	N	N	O	O
（	x	N	N	O	O
a2	eng	N	N	O	O
,	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
。	x	N	N	O	O

直到	v	N	N	O	O
最后	f	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
有	v	N	N	O	O
(	x	N	N	O	O
ai	eng	N	N	O	O
,	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
则	d	N	N	O	O
将	d	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
加入	v	N	N	O	O
ai	eng	N	N	O	O
之后	f	N	N	O	O
。	x	N	N	O	O

程序	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
deque	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

MAX	eng	N	N	O	O

=	x	N	N	O	O

1024	m	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

deque	eng	N	N	O	O
<	x	N	N	O	O
int	eng	N	N	O	O
>	x	N	N	O	O

q	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
clear	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
front	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
q	eng	N	N	O	O
.	m	N	N	O	O
front	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
front	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
q	eng	N	N	O	O
.	m	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

deque	eng	N	N	O	O
<	x	N	N	O	O
int	eng	N	N	O	O
>	x	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
iterator	eng	N	N	O	O

iter	eng	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

first	eng	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
iter	eng	N	N	O	O

=	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
begin	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

iter	eng	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
end	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

iter	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
!	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
*	x	N	N	O	O
iter	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

!	x	N	N	O	O
first	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

first	eng	N	N	O	O

=	x	N	N	O	O

!	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
*	x	N	N	O	O
iter	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
insert	eng	N	N	O	O
(	x	N	N	O	O
iter	eng	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

1	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

endl	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

n	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

endl	eng	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

first	eng	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
deque	eng	N	N	O	O
<	x	N	N	O	O
int	eng	N	N	O	O
>	x	N	N	O	O
:	x	N	N	O	O
:	x	N	N	O	O
iterator	eng	N	N	O	O

iter	eng	N	N	O	O

=	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
begin	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

iter	eng	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

q	eng	N	N	O	O
.	m	N	N	O	O
end	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

iter	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
first	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

first	eng	N	N	O	O

=	x	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

*	x	N	N	O	O
iter	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

"	x	N	N	O	O

"	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

*	x	N	N	O	O
iter	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

HOJ	eng	N	Y	B-OJ	B-OJ

1115	m	N	N	I-OJ	I-OJ
/	x	N	N	O	O
POJ	eng	N	Y	B-OJ	B-OJ

1129	m	N	N	I-OJ	I-OJ

Channel	eng	N	N	O	O

Allocation	eng	N	N	O	O
（	x	N	N	O	O
染色	n	N	N	B-KNOWLEDGE	O
问题	n	N	N	I-KNOWLEDGE	O
+	x	N	N	O	O
四色	mq	N	N	B-KNOWLEDGE	O
定理	vn	Y	N	I-KNOWLEDGE	O
）	x	N	N	O	O

传送门	n	N	N	O	O
：	x	N	N	O	O
http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
hit	eng	N	N	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
hoj	eng	N	Y	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
/	x	N	N	O	O
view	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
1115	m	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
poj	eng	N	Y	O	O
.	m	N	N	O	O
org	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
1129	m	N	N	O	O

题意	n	N	N	O	O
：	x	N	N	O	O
染色	n	N	N	B-KNOWLEDGE	O
问题	n	N	N	I-KNOWLEDGE	O
，	x	N	N	O	O
相邻	v	N	N	O	O
的	uj	N	N	O	O
repeater	eng	N	N	O	O
之间	f	N	N	O	O
不能	v	N	N	O	O
用	p	N	N	O	O
相同	d	N	N	O	O
的	uj	N	N	O	O
颜色	n	N	N	O	O
。	x	N	N	O	O

输入	v	N	N	O	O
：	x	N	N	O	O
邻接	v	Y	N	B-KNOWLEDGE	O
表	v	N	N	I-KNOWLEDGE	O
。	x	N	N	O	O

输出	v	Y	N	O	O
：	x	N	N	O	O
最少	d	N	N	O	O
需要	v	N	N	O	O
的	uj	N	N	O	O
颜色	n	N	N	O	O
（	x	N	N	O	O
注意	v	N	N	O	O
单数	n	N	N	O	O
和	c	N	N	O	O
复数	n	N	N	O	O
形式	n	N	N	O	O
）	x	N	N	O	O
。	x	N	N	O	O

思路	n	N	N	O	O
：	x	N	N	O	O
最	d	N	N	O	O
多用	b	N	N	O	O
四种	m	N	N	O	O
颜色	n	N	N	O	O
即可	d	N	N	O	O
，	x	N	N	O	O
用	p	N	N	O	O
DFS	eng	N	N	B-KNOWLEDGE	B-KNOWLEDGE
进行	v	N	N	O	O
枚举	nz	Y	N	O	O
即可	d	N	N	O	O
。	x	N	N	O	O

程序	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

MAX	eng	N	N	O	O

=	x	N	N	O	O

26	m	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

color	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
map	eng	N	N	O	O
,	x	N	N	O	O

false	eng	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
map	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

check	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

v	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

color	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

color	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

v	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

c	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
c	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

4	x	N	N	O	O

|	x	N	N	O	O
|	x	N	N	O	O

v	x	N	N	O	O

>	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

c	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

color	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
check	eng	N	N	O	O
(	x	N	N	O	O
v	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
DFS	eng	N	N	O	O
(	x	N	N	O	O
v	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

c	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

color	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

n	x	N	N	O	O

&&	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

string	eng	N	N	O	O

s	x	N	N	O	O
;	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

s	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O
)	x	N	N	O	O
s	eng	N	N	O	O
.	m	N	N	O	O
length	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

'	x	N	N	O	O
A	x	N	N	O	O
'	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

4	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
color	eng	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
color	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
DFS	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

"	x	N	N	O	O
1	x	N	N	O	O

channel	eng	N	N	O	O

needed	eng	N	N	O	O
.	m	N	N	O	O
"	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

"	x	N	N	O	O

channels	eng	N	N	O	O

needed	eng	N	N	O	O
.	m	N	N	O	O
"	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

HOJ	eng	N	Y	B-OJ	B-OJ

1266	m	N	N	I-OJ	I-OJ
/	x	N	N	O	O
POJ	eng	N	Y	B-OJ	B-OJ

1620	m	N	N	I-OJ	O

Phone	eng	N	N	O	O

Home	eng	N	N	O	O
（	x	N	N	O	O
染色	n	N	N	B-KNOWLEDGE	O
问题	n	N	N	I-KNOWLEDGE	O
+	x	N	N	O	O
四色	mq	N	N	B-KNOWLEDGE	O
定理	vn	Y	N	I-KNOWLEDGE	O
）	x	N	N	O	O

传送门	n	N	N	O	O
：	x	N	N	O	O
http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
hit	eng	N	N	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
hoj	eng	N	Y	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
/	x	N	N	O	O
view	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
1266	m	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
poj	eng	N	Y	O	O
.	m	N	N	O	O
org	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
1620	m	N	N	O	O

题意	n	N	N	O	O
：	x	N	N	O	O
还是	c	N	N	O	O
染色	n	N	N	B-KNOWLEDGE	O
问题	n	N	N	I-KNOWLEDGE	O
，	x	N	N	O	O
就是	d	N	N	O	O
改成	v	N	N	O	O
频率	n	N	N	O	O
，	x	N	N	O	O
距离	n	Y	N	O	O
在	p	N	N	O	O
20	m	N	N	O	O
以内	f	N	N	O	O
的	uj	N	N	O	O
就是	d	N	N	O	O
算	v	N	N	O	O
邻居	v	N	N	O	O
。	x	N	N	O	O

输入	v	N	N	O	O
：	x	N	N	O	O
每个	r	N	N	O	O
Tower	eng	N	N	O	O
的	uj	N	N	O	O
坐标	v	Y	N	O	O
。	x	N	N	O	O

输出	v	Y	N	O	O
：	x	N	N	O	O
最少	d	N	N	O	O
需要	v	N	N	O	O
的	uj	N	N	O	O
颜色	n	N	N	O	O
。	x	N	N	O	O

思路	n	N	N	O	O
：	x	N	N	O	O
还是	c	N	N	O	O
DFS	eng	N	N	B-KNOWLEDGE	O
，	x	N	N	O	O
枚举	nz	Y	N	O	O
四种	m	N	N	O	O
颜色	n	N	N	O	O
即可	d	N	N	O	O
。	x	N	N	O	O

程序	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

MAX	eng	N	N	O	O

=	x	N	N	O	O

12	m	N	N	O	O
;	x	N	N	O	O

class	eng	N	N	O	O

Tower	eng	N	N	O	O

{	x	N	N	O	O

public	eng	N	N	O	O
:	x	N	N	O	O

double	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

set	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

x	x	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

near	eng	N	N	O	O
(	x	N	N	O	O
const	eng	N	N	O	O

Tower	eng	N	N	O	O
&	x	N	N	O	O

t	x	N	N	O	O
)	x	N	N	O	O

const	eng	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O

-	x	N	N	O	O

t	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
)	x	N	N	O	O

*	x	N	N	O	O

(	x	N	N	O	O
x	x	N	N	O	O

-	x	N	N	O	O

t	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
)	x	N	N	O	O

+	x	N	N	O	O

(	x	N	N	O	O
y	x	N	N	O	O

-	x	N	N	O	O

t	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O

*	x	N	N	O	O

(	x	N	N	O	O
y	x	N	N	O	O

-	x	N	N	O	O

t	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

20	m	N	N	O	O

*	x	N	N	O	O

20	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

no	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

color	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

Tower	eng	N	N	O	O

tower	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
map	eng	N	N	O	O
,	x	N	N	O	O

false	eng	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
map	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

check	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

v	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

color	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

color	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bool	eng	N	N	O	O

DFS	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

v	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

c	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
c	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

4	x	N	N	O	O

|	x	N	N	O	O
|	x	N	N	O	O

v	x	N	N	O	O

>	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

c	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

color	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
check	eng	N	N	O	O
(	x	N	N	O	O
v	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
DFS	eng	N	N	O	O
(	x	N	N	O	O
v	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

c	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

color	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

n	x	N	N	O	O

&&	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

init	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

tower	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
set	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
tower	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
near	eng	N	N	O	O
(	x	N	N	O	O
tower	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

4	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
color	eng	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
color	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
DFS	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

"	x	N	N	O	O
The	eng	N	N	O	O

towers	eng	N	N	O	O

in	eng	Y	N	O	O

case	eng	N	N	O	O

"	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

++	x	N	N	O	O
no	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

"	x	N	N	O	O

can	eng	N	N	O	O

be	eng	Y	N	O	O

covered	eng	N	N	O	O

in	eng	Y	N	O	O

"	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

"	x	N	N	O	O

frequencies	eng	N	N	O	O
.	m	N	N	O	O
"	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

endl	eng	N	N	O	O
;	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ3277	eng	N	Y	B-OJ	B-OJ
(	x	N	N	O	O
线段	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE	I-KNOWLEDGE
,	x	N	N	O	O
离散	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
化	n	N	N	I-KNOWLEDGE	I-KNOWLEDGE
,	x	N	N	O	O
扫描线	n	Y	N	B-KNOWLEDGE	O
)	x	N	N	O	O
_	x	N	N	O	O
飘羽逸狂	i	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

City	eng	N	N	O	O

Horizon	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

2000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

65536	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

13819	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

3734	m	N	N	O	O

Description	eng	N	N	O	O

Farmer	eng	N	N	O	O

John	eng	N	N	O	O

has	eng	Y	N	O	O

taken	eng	N	N	O	O

his	eng	N	N	O	O

cows	eng	N	N	O	O

on	eng	N	N	O	O

a	x	N	N	O	O

trip	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

city	eng	N	N	O	O
!	x	N	N	O	O

As	eng	N	N	O	O

the	eng	N	N	O	O

sun	eng	N	N	O	O

sets	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

cows	eng	N	N	O	O

gaze	eng	N	N	O	O

at	eng	N	N	O	O

the	eng	N	N	O	O

city	eng	N	N	O	O

horizon	eng	N	N	O	O

and	eng	N	N	O	O

observe	eng	N	N	O	O

the	eng	N	N	O	O

beautiful	eng	N	N	O	O

silhouettes	eng	N	N	O	O

formed	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

rectangular	eng	N	N	O	O

buildings	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

entire	eng	N	N	O	O

horizon	eng	N	N	O	O

is	eng	N	N	O	O

represented	eng	N	N	O	O

by	eng	N	N	O	O

a	x	N	N	O	O

number	eng	N	N	O	O

line	eng	N	N	O	O

with	eng	N	N	O	O

N	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

≤	x	N	N	O	O

N	x	N	N	O	O

≤	x	N	N	O	O

40	m	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
)	x	N	N	O	O

buildings	eng	N	N	O	O
.	m	N	N	O	O

Building	eng	N	N	O	O

i	x	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

silhouette	eng	N	N	O	O

has	eng	Y	N	O	O

a	x	N	N	O	O

base	eng	N	N	O	O

that	eng	N	N	O	O

spans	eng	N	N	O	O

locations	eng	N	N	O	O

Ai	eng	N	N	O	O

through	eng	N	N	O	O

Bi	eng	N	N	O	O

along	eng	N	N	O	O

the	eng	N	N	O	O

horizon	eng	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

≤	x	N	N	O	O

Ai	eng	N	N	O	O

<	x	N	N	O	O

Bi	eng	N	N	O	O

≤	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
)	x	N	N	O	O

and	eng	N	N	O	O

has	eng	Y	N	O	O

height	eng	N	N	O	O

Hi	eng	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O

≤	x	N	N	O	O

Hi	eng	N	N	O	O

≤	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
,	x	N	N	O	O
000	m	N	N	O	O
)	x	N	N	O	O
.	x	N	N	O	O

Determine	eng	N	N	O	O

the	eng	N	N	O	O

area	eng	N	N	O	O
,	x	N	N	O	O

in	eng	Y	N	O	O

square	eng	N	N	O	O

units	eng	N	N	O	O
,	x	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

aggregate	eng	N	N	O	O

silhouette	eng	N	N	O	O

formed	eng	N	N	O	O

by	eng	N	N	O	O

all	eng	N	N	O	O

N	x	N	N	O	O

buildings	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

Line	eng	N	N	O	O

1	x	N	N	O	O
:	x	N	N	O	O

A	x	N	N	O	O

single	eng	N	N	O	O

integer	eng	N	N	O	O
:	x	N	N	O	O

N	x	N	N	O	O

Lines	eng	N	N	O	O

2..	m	N	N	O	O
N	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
:	x	N	N	O	O

Input	eng	N	N	O	O

line	eng	N	N	O	O

i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O

describes	eng	N	N	O	O

building	eng	N	N	O	O

i	x	N	N	O	O

with	eng	N	N	O	O

three	eng	N	N	O	O

space	eng	N	N	O	O
-	x	N	N	O	O
separated	eng	N	N	O	O

integers	eng	N	N	O	O
:	x	N	N	O	O

Ai	eng	N	N	O	O
,	x	N	N	O	O

Bi	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

Hi	eng	N	N	O	O

Output	eng	N	N	O	O

Line	eng	N	N	O	O

1	x	N	N	O	O
:	x	N	N	O	O

The	eng	N	N	O	O

total	eng	N	N	O	O

area	eng	N	N	O	O
,	x	N	N	O	O

in	eng	Y	N	O	O

square	eng	N	N	O	O

units	eng	N	N	O	O
,	x	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

silhouettes	eng	N	N	O	O

formed	eng	N	N	O	O

by	eng	N	N	O	O

all	eng	N	N	O	O

N	x	N	N	O	O

buildings	eng	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

4	x	N	N	O	O

2	x	N	N	O	O

5	x	N	N	O	O

1	x	N	N	O	O

9	x	N	N	O	O

10	m	N	N	O	O

4	x	N	N	O	O

6	x	N	N	O	O

8	x	N	N	O	O

2	x	N	N	O	O

4	x	N	N	O	O

6	x	N	N	O	O

3	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

16	m	N	N	O	O

Hint	eng	N	N	O	O

The	eng	N	N	O	O

first	eng	N	N	O	O

building	eng	N	N	O	O

overlaps	eng	N	N	O	O

with	eng	N	N	O	O

the	eng	N	N	O	O

fourth	eng	N	N	O	O

building	eng	N	N	O	O

for	eng	Y	N	O	O

an	eng	Y	N	O	O

area	eng	N	N	O	O

of	eng	N	N	O	O

1	x	N	N	O	O

square	eng	N	N	O	O

unit	eng	N	N	O	O
,	x	N	N	O	O

so	eng	N	N	O	O

the	eng	N	N	O	O

total	eng	N	N	O	O

area	eng	N	N	O	O

is	eng	N	N	O	O

just	eng	N	N	O	O

3	x	N	N	O	O
*	x	N	N	O	O
1	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
*	x	N	N	O	O
4	x	N	N	O	O

+	x	N	N	O	O

2	x	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O

+	x	N	N	O	O

2	x	N	N	O	O
*	x	N	N	O	O
3	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O

=	x	N	N	O	O

16.	m	N	N	O	O

Source	eng	N	N	O	O

USACO	eng	N	Y	O	B-OJ

2007	m	N	N	O	O

Open	eng	N	N	O	O

Silver	eng	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O

MYCode	eng	N	N	O	O
:	x	N	N	O	O

#	x	N	N	O	O
pragma	eng	N	N	O	O

warning	eng	N	N	O	O
(	x	N	N	O	O
disable	eng	N	N	O	O
:	x	N	N	O	O
4786	m	N	N	O	O
)	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
线段	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE	I-KNOWLEDGE
模板	n	Y	N	O	O

struct	eng	N	N	O	O

line	eng	N	N	O	O

{	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

left	eng	N	N	O	O
,	x	N	N	O	O
right	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
左	m	N	N	O	O
端点	n	N	N	O	O
、	x	N	N	O	O
右	f	N	N	O	O
端点	n	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

len	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cover	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

sline	eng	N	N	O	O

{	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

left	eng	N	N	O	O
,	x	N	N	O	O
right	eng	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

flag	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

id	eng	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
40001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
在	p	N	N	O	O
y	eng	N	N	O	O
轴	n	N	N	O	O
上	f	N	N	O	O
建立	v	N	N	O	O
线段	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE	I-KNOWLEDGE
,	x	N	N	O	O
所以	c	N	N	O	O
对	p	N	N	O	O
y	eng	N	N	O	O
排序	n	Y	N	B-KNOWLEDGE	O
并	c	N	N	O	O
去	v	N	N	O	O
重	a	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

rev	eng	N	N	O	O
[	x	N	N	O	O
40001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
给出	v	N	N	O	O
每个	r	N	N	O	O
编号	n	N	N	O	O
对应	vn	N	N	O	O
的	uj	N	N	O	O
高度	n	Y	N	O	O

struct	eng	N	N	O	O

line	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
350001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
y	x	N	N	O	O
轴线	n	N	N	O	O
段树	nr	Y	N	O	O

sline	eng	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
80001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
插入	v	N	N	O	O
线段	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE	I-KNOWLEDGE
的	uj	N	N	O	O
竖直	v	N	N	O	O
线段	n	Y	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

yy	eng	N	N	O	O
[	x	N	N	O	O
40001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
建立	v	N	N	O	O

void	eng	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

s	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

t	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
s	eng	N	N	O	O
+	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
=	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
cover	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
t	x	N	N	O	O

-	x	N	N	O	O

s	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
叶	nr	N	N	O	O
节点	n	N	N	O	O
返回	v	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
端点	n	N	N	O	O
模型	n	Y	N	O	O
,	x	N	N	O	O
不是	c	N	N	O	O
格子	n	N	N	O	O
模型	n	Y	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
插入	v	N	N	O	O

void	eng	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

left	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

right	eng	N	N	O	O
,	x	N	N	O	O
double	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

flag	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

step	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
要	v	N	N	O	O
插入	v	N	N	O	O
的	uj	N	N	O	O
线段	n	Y	N	O	O
的	uj	N	N	O	O
左	m	N	N	O	O
端点	n	N	N	O	O
和	c	N	N	O	O
右	n	N	N	O	O
端点	n	N	N	O	O
、	x	N	N	O	O
以及	c	N	N	O	O
当前	t	N	N	O	O
线段	n	Y	N	B-KNOWLEDGE	O
树中	s	N	N	I-KNOWLEDGE	O
的	uj	N	N	O	O
某条	r	N	N	O	O
线段	n	Y	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
left	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O

&&	x	N	N	O	O

right	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
cover	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

flag	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
插入	v	N	N	O	O
结束	v	N	N	O	O
返回	v	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
当前	t	N	N	O	O
线段	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE	I-KNOWLEDGE
的	uj	N	N	O	O
线段	n	Y	N	O	O
没有	v	N	N	O	O
儿子	n	N	N	O	O
，	x	N	N	O	O
插入	v	N	N	O	O
结束	v	N	N	O	O
返回	v	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
mid	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
right	eng	N	N	O	O
)	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
left	eng	N	N	O	O
,	x	N	N	O	O
right	eng	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
flag	eng	N	N	O	O
,	x	N	N	O	O
step	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
中点	n	N	N	O	O
在	p	N	N	O	O
t	eng	N	N	O	O
的	uj	N	N	O	O
右边	f	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
应该	v	N	N	O	O
插入	v	N	N	O	O
到	v	N	N	O	O
左	m	N	N	O	O
儿子	n	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
mid	eng	N	N	O	O
<	x	N	N	O	O
left	eng	N	N	O	O
)	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
left	eng	N	N	O	O
,	x	N	N	O	O
right	eng	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
flag	eng	N	N	O	O
,	x	N	N	O	O
step	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
中点	n	N	N	O	O
在	p	N	N	O	O
s	eng	N	N	O	O
的	uj	N	N	O	O
左边	f	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
应该	v	N	N	O	O
插入	v	N	N	O	O
到	v	N	N	O	O
右	f	N	N	O	O
儿子	n	N	N	O	O

else	eng	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
否则	c	N	N	O	O
，	x	N	N	O	O
中	f	N	N	O	O
点	m	N	N	O	O
一定	d	N	N	O	O
在	p	N	N	O	O
s	eng	N	N	O	O
和	c	N	N	O	O
t	eng	N	N	O	O
之间	f	N	N	O	O
，	x	N	N	O	O
把	p	N	N	O	O
待	v	N	N	O	O
插	v	N	N	O	O
线段	n	Y	N	O	O
分成	v	N	N	O	O
两半	m	N	N	O	O
分别	d	N	N	O	O
插	v	N	N	O	O
到	v	N	N	O	O
左右	m	N	N	O	O
儿子	n	N	N	O	O
里面	f	N	N	O	O

{	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
left	eng	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
flag	eng	N	N	O	O
,	x	N	N	O	O
step	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
mid	eng	N	N	O	O
,	x	N	N	O	O
right	eng	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
flag	eng	N	N	O	O
,	x	N	N	O	O
step	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
访问	v	N	N	O	O

void	eng	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

step	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
cover	eng	N	N	O	O

>	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O

=	x	N	N	O	O

yy	eng	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

yy	eng	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
step	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
step	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O

=	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O

+	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
step	eng	N	N	O	O
*	x	N	N	O	O
2	m	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

cmp	eng	N	N	O	O
(	x	N	N	O	O
const	eng	N	N	O	O

sline	eng	N	N	O	O
&	x	N	N	O	O
p1	eng	N	N	O	O
,	x	N	N	O	O
const	eng	N	N	O	O

sline	eng	N	N	O	O
&	x	N	N	O	O
p2	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

p1	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

<	x	N	N	O	O

p2	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

b	eng	N	N	O	O
_	x	N	N	O	O
search	eng	N	N	O	O
(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O

key	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

left	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O
right	eng	N	N	O	O

=	x	N	N	O	O

id	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
note	eng	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
left	eng	N	N	O	O

<	x	N	N	O	O

right	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
note	eng	N	N	O	O

{	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

mid	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
left	eng	N	N	O	O

+	x	N	N	O	O

right	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
yy	eng	N	N	O	O
[	x	N	N	O	O
mid	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

key	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

mid	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
yy	eng	N	N	O	O
[	x	N	N	O	O
mid	eng	N	N	O	O
]	x	N	N	O	O

<	x	N	N	O	O

key	eng	N	N	O	O
)	x	N	N	O	O

left	eng	N	N	O	O

=	x	N	N	O	O

mid	eng	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

right	eng	N	N	O	O

=	x	N	N	O	O

mid	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

x1	eng	N	N	O	O
,	x	N	N	O	O
x2	eng	N	N	O	O
,	x	N	N	O	O
yi	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
x1	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
x2	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
yi	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O

x1	eng	N	N	O	O

;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O

=	x	N	N	O	O

yi	eng	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
flag	eng	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O

x2	eng	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
left	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O

=	x	N	N	O	O

yi	eng	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
flag	eng	N	N	O	O

=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

yi	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
p	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
p	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O
*	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
cmp	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

id	eng	N	N	O	O

=	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

yy	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

yy	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

2	x	N	N	O	O

;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

yy	eng	N	N	O	O
[	x	N	N	O	O
id	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
id	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
线段	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE	I-KNOWLEDGE
区间	n	Y	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
id	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

total	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
b	eng	N	N	O	O
_	x	N	N	O	O
search	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
flag	eng	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

(	x	N	N	O	O
n	x	N	N	O	O
*	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
更新	d	N	N	O	O
线段	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE	I-KNOWLEDGE

total	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
len	eng	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

-	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

insert	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
b	eng	N	N	O	O
_	x	N	N	O	O
search	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
right	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
flag	eng	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64d	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
total	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

Run	eng	N	N	O	O

ID	eng	N	N	O	O

User	eng	N	N	O	O

Problem	eng	N	N	O	O

Result	eng	N	N	O	O

Memory	eng	N	N	O	O

Time	eng	N	N	O	O

Language	eng	N	N	O	O

Code	eng	N	N	O	O

Length	eng	N	N	O	O

Submit	eng	N	N	O	O

Time	eng	N	N	O	O

10616667	m	N	N	O	O

ruffy	eng	N	N	O	O

3277	m	N	N	O	O

Accepted	eng	N	N	O	O

14244	m	N	N	O	O
K	eng	N	N	O	O

938	m	N	N	O	O
MS	eng	N	N	O	O

C++	nz	N	N	O	O

3114	m	N	N	O	O
B	eng	N	N	O	O

2012	m	N	N	O	O
-	x	N	N	O	O
08	m	N	N	O	O
-	x	N	N	O	O
06	m	N	N	O	O

13	m	N	N	O	O
:	x	N	N	O	O
07	m	N	N	O	O
:	x	N	N	O	O
35	m	N	N	O	O

10616077	m	N	N	O	O

ruffy	eng	N	N	O	O

3277	m	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O

Exceeded	eng	N	N	O	O

C++	nz	N	N	O	O

2634	m	N	N	O	O
B	eng	N	N	O	O

2012	m	N	N	O	O
-	x	N	N	O	O
08	m	N	N	O	O
-	x	N	N	O	O
06	m	N	N	O	O

11	m	N	N	O	O
:	x	N	N	O	O
38	m	N	N	O	O
:	x	N	N	O	O
11	m	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O

这	r	N	N	O	O
道题	n	N	N	O	O
和	c	N	N	O	O
POJ1151	eng	N	Y	B-OJ	B-OJ
类似	v	N	N	O	O
,	x	N	N	O	O
更为	d	N	N	O	O
简单	a	N	N	O	O
一些	m	N	N	O	O
,	x	N	N	O	O
1151	m	N	N	O	O
可以	c	N	N	O	O
用	p	N	N	O	O
map	eng	N	N	O	O
离散	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
化	n	N	N	I-KNOWLEDGE	I-KNOWLEDGE
,	x	N	N	O	O
不会	v	N	N	O	O
超时	b	N	N	O	O
,	x	N	N	O	O
但是	c	N	N	O	O
这	r	N	N	O	O
道题	n	N	N	O	O
离散	v	Y	N	B-KNOWLEDGE	O
化	v	N	N	I-KNOWLEDGE	O
的	uj	N	N	O	O
方式	n	N	N	O	O
只	d	N	N	O	O
能够	v	N	N	O	O
是	v	N	N	O	O
二分	m	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
查找	v	Y	N	O	O
,	x	N	N	O	O
如果	c	N	N	O	O
用	p	N	N	O	O
map	eng	N	N	O	O
的话	u	N	N	O	O
将	d	N	N	O	O
会	v	N	N	O	O
TLE	eng	N	N	O	O
,	x	N	N	O	O
因为	c	N	N	O	O
这	r	N	N	O	O
道题	n	N	N	O	O
的	uj	N	N	O	O
数据量	n	N	N	O	O
更	d	N	N	O	O
大	a	N	N	O	O
,	x	N	N	O	O
map	eng	N	N	O	O
的	uj	N	N	O	O
缺陷	v	N	N	O	O
就	d	N	N	O	O
暴露	v	N	N	O	O
出来	v	N	N	O	O
了	ul	N	N	O	O
.	m	N	N	O	O

虽然	c	N	N	O	O
用	p	N	N	O	O
STL	eng	N	N	O	O
的	uj	N	N	O	O
map	eng	N	N	O	O
可以	c	N	N	O	O
使得	v	N	N	O	O
离散	v	Y	N	B-KNOWLEDGE	O
化	n	N	N	I-KNOWLEDGE	O
变得	v	N	N	O	O
更为	d	N	N	O	O
简单	a	N	N	O	O
一些	m	N	N	O	O
,	x	N	N	O	O
但是	c	N	N	O	O
效率	n	N	N	O	O
不行	v	N	N	O	O
,	x	N	N	O	O
所以	c	N	N	O	O
离散	v	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
化	n	N	N	I-KNOWLEDGE	I-KNOWLEDGE
还是	c	N	N	O	O
要	v	N	N	O	O
用	p	N	N	O	O
自己	r	N	N	O	O
写	v	N	N	O	O
的	uj	N	N	O	O
二分	m	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
查找	v	Y	N	O	O
.	x	N	N	O	O

这	r	N	N	O	O
道题	n	N	N	O	O
有	v	N	N	O	O
一点	m	N	N	O	O
不	d	N	N	O	O
明白	nr	N	N	O	O
,	x	N	N	O	O
为什么	r	N	N	O	O
中间	f	N	N	O	O
数据	n	N	N	O	O
会	v	N	N	O	O
超	v	N	N	O	O
int	eng	N	N	O	O
?	x	N	N	O	O
如果	c	N	N	O	O
只有	c	N	N	O	O
结果	n	N	N	O	O
用	p	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O
将	d	N	N	O	O
会	v	N	N	O	O
得到	v	N	N	O	O
wa	eng	N	N	O	O
.	m	N	N	O	O

pku2100	eng	N	Y	B-OJ	B-OJ

连续	a	Y	N	O	O
数	m	N	N	O	O
的	uj	N	N	O	O
平方和	nr	N	N	O	O

-	x	N	N	O	O

笑	v	N	N	O	O
风生	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
math	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

int	eng	N	N	O	O

ret1	eng	N	N	O	O
[	x	N	N	O	O
10000001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ret2	eng	N	N	O	O
[	x	N	N	O	O
10000001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cnt	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

N	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
I64u	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
N	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

base	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

r	x	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
int	eng	N	N	O	O
)	x	N	N	O	O
sqrt	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
float	eng	N	N	O	O
)	x	N	N	O	O
N	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

r	x	N	N	O	O

&&	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

r	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
base	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

N	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cnt	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

ret1	eng	N	N	O	O
[	x	N	N	O	O
cnt	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

ret2	eng	N	N	O	O
[	x	N	N	O	O
cnt	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

j	x	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

base	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O
)	x	N	N	O	O
j	x	N	N	O	O
*	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

continue	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
base	eng	N	N	O	O

>	x	N	N	O	O

N	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

base	eng	N	N	O	O

-	x	N	N	O	O
=	x	N	N	O	O

(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O
)	x	N	N	O	O
i	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

base	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O
)	x	N	N	O	O
j	x	N	N	O	O
*	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

cnt	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

cnt	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

"	x	N	N	O	O
,	x	N	N	O	O

ret2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
ret1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O

=	x	N	N	O	O

ret1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

ret2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

"	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ
：	x	N	N	I-OJ	O
2713	m	N	N	I-OJ	O

肿瘤	n	N	N	O	O
面积	n	Y	N	O	O
_	x	N	N	O	O
小	a	N	N	O	O
_	x	N	N	O	O
船	n	N	N	O	O
__	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

肿瘤	n	N	N	O	O
面积	n	Y	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O
1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O
65536	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submit	eng	N	N	O	O
:	x	N	N	O	O
445	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O
189	m	N	N	O	O

Description	eng	N	N	O	O

在	p	N	N	O	O
一个	m	N	N	O	O
正方形	n	N	N	O	O
的	uj	N	N	O	O
灰度	n	N	N	O	O
图片	n	N	N	O	O
上	f	N	N	O	O
，	x	N	N	O	O
肿瘤	n	N	N	O	O
是	v	N	N	O	O
一块	m	N	N	O	O
矩形	n	Y	N	O	O
的	uj	N	N	O	O
区域	n	N	N	O	O
，	x	N	N	O	O
肿瘤	n	N	N	O	O
的	uj	N	N	O	O
边缘	n	N	N	O	O
所在	b	N	N	O	O
的	uj	N	N	O	O
像素点	n	N	N	O	O
在	p	N	N	O	O
图片	n	N	N	O	O
中用	n	N	N	O	O
0	m	N	N	O	O
表示	v	Y	N	O	O
。	x	N	N	O	O

其它	r	N	N	O	O
肿瘤	n	N	N	O	O
内	f	N	N	O	O
和	c	N	N	O	O
肿瘤	n	N	N	O	O
外	f	N	N	O	O
的	uj	N	N	O	O
点	q	N	N	O	O
都	d	N	N	O	O
用	p	N	N	O	O
255	m	N	N	O	O
表示	v	Y	N	O	O
。	x	N	N	O	O

现在	t	N	N	O	O
要求	v	N	N	O	O
你	r	N	N	O	O
编写	v	N	N	O	O
一个	m	N	N	O	O
程序	n	N	N	O	O
，	x	N	N	O	O
计算	v	Y	N	O	O
肿瘤	n	N	N	O	O
内部	f	Y	N	O	O
的	uj	N	N	O	O
像素点	n	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
（	x	N	N	O	O
不	d	N	N	O	O
包括	v	N	N	O	O
肿瘤	n	N	N	O	O
边缘	n	N	N	O	O
上	f	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
）	x	N	N	O	O
。	x	N	N	O	O

已知	v	N	N	O	O
肿瘤	n	N	N	O	O
的	uj	N	N	O	O
边缘	n	N	N	O	O
平行	n	N	N	O	O
于	p	N	N	O	O
图像	n	N	N	O	O
的	uj	N	N	O	O
边缘	n	N	N	O	O
。	x	N	N	O	O

Input	eng	N	N	O	O

只有	c	N	N	O	O
一个	m	N	N	O	O
测试	vn	N	N	O	O
样例	n	N	N	O	O
。	x	N	N	O	O

第一行	m	N	N	O	O
有	v	N	N	O	O
一个	m	N	N	O	O
整数	n	Y	N	O	O
n	x	N	N	O	O
，	x	N	N	O	O
表示	v	Y	N	O	O
正方形	n	N	N	O	O
图像	n	N	N	O	O
的	uj	N	N	O	O
边长	n	N	N	O	O
。	x	N	N	O	O

其后	c	N	N	O	O
n	eng	N	N	O	O
行	n	N	N	O	O
每行	r	N	N	O	O
有	v	N	N	O	O
n	eng	N	N	O	O
个	m	N	N	O	O
整数	n	Y	N	O	O
，	x	N	N	O	O
取值	v	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
或	c	N	N	O	O
255	m	N	N	O	O
。	x	N	N	O	O

整数	n	Y	N	O	O
之间	f	N	N	O	O
用	p	N	N	O	O
一个	m	N	N	O	O
空格	n	N	N	O	O
隔开	v	N	N	O	O
。	x	N	N	O	O

已知	v	N	N	O	O
n	eng	N	N	O	O
不	c	N	N	O	O
大于	d	N	N	O	O
100	m	N	N	O	O
。	x	N	N	O	O

Output	eng	N	N	O	O

输出	v	Y	N	O	O
一行	m	N	N	O	O
，	x	N	N	O	O
该行	r	N	N	O	O
包含	v	N	N	O	O
一个	m	N	N	O	O
整数	n	Y	N	O	O
，	x	N	N	O	O
为	p	N	N	O	O
要求	v	N	N	O	O
的	uj	N	N	O	O
肿瘤	n	N	N	O	O
内	f	N	N	O	O
的	uj	N	N	O	O
像素点	n	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
。	x	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

Source	eng	N	N	O	O

POJ	eng	N	Y	O	B-OJ
：	x	N	N	O	O
2713	m	N	N	O	O

C语言	n	N	N	O	O
代码	n	N	N	O	O
：	x	N	N	O	O

1	x	N	N	O	O

Sample	eng	N	N	O	O

Result	eng	N	N	O	O
:	x	N	N	O	O

5255	m	N	N	O	O

255	m	N	N	O	O

255	m	N	N	O	O

255	m	N	N	O	O

255255	m	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

255255	m	N	N	O	O

0	x	N	N	O	O

255	m	N	N	O	O

0	x	N	N	O	O

255255	m	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

0	x	N	N	O	O

255255	m	N	N	O	O

255	m	N	N	O	O

255	m	N	N	O	O

255	m	N	N	O	O

255	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O
int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sum1	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
n	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
m	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
x	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
x	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
计算	v	Y	N	O	O
出宽	v	N	N	O	O
/	x	N	N	O	O

else	eng	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
y	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
y	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

sum1	eng	N	N	O	O
=	x	N	N	O	O
sum1	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
计算	v	Y	N	O	O
出长	v	N	N	O	O
/	x	N	N	O	O

else	eng	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
*	x	N	N	O	O
sum1	eng	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
sum	eng	N	N	O	O
+	x	N	N	O	O
sum1	eng	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O
pku1160	eng	N	Y	B-OJ	B-OJ

Post	eng	N	N	O	O

Office	eng	N	N	O	O

解题	n	N	N	O	O
报告	n	N	N	O	O

-	x	N	N	O	O

xxm137164869	eng	N	N	O	O
的	uj	N	N	O	O
专栏	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

思路	n	N	N	O	O
：	x	N	N	O	O
用	p	N	N	O	O
opt	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
记录	n	Y	N	O	O
把	p	N	N	O	O
前	f	N	N	O	O
i	eng	N	N	O	O
个	m	N	N	O	O
邮局	n	N	N	O	O
建到	v	N	N	O	O
前	f	N	N	O	O
j	eng	N	N	O	O
个	m	N	N	O	O
村庄	n	N	N	O	O
中	f	N	N	O	O
的	uj	N	N	O	O
最优	d	N	N	O	O
解	v	N	N	O	O
，	x	N	N	O	O
用	p	N	N	O	O
cost	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
记录	n	Y	N	O	O
所有	b	N	N	O	O
在	p	N	N	O	O
i	eng	N	N	O	O
到	v	N	N	O	O
j	eng	N	N	O	O
村庄	n	N	N	O	O
中	f	N	N	O	O
，	x	N	N	O	O
建	n	N	N	O	O
1	m	N	N	O	O
个	m	N	N	O	O
邮局	n	N	N	O	O
的	uj	N	N	O	O
最小	a	Y	N	O	O
代价	n	N	N	O	O
。	x	N	N	O	O

显然	ad	N	N	O	O
邮局	n	N	N	O	O
应该	v	N	N	O	O
设到	v	N	N	O	O
中点	n	N	N	O	O
。	x	N	N	O	O

让	v	N	N	O	O
前	f	N	N	O	O
i	eng	N	N	O	O
个	m	N	N	O	O
邮局	n	N	N	O	O
覆盖	v	Y	N	O	O
前	f	N	N	O	O
j	eng	N	N	O	O
个	m	N	N	O	O
村庄	n	N	N	O	O
，	x	N	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
个	m	N	N	O	O
邮局	n	N	N	O	O
覆盖	v	Y	N	O	O
第	m	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
至	p	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
个	m	N	N	O	O
村庄	n	N	N	O	O
(	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
状态	n	Y	N	O	O
转移	v	N	N	O	O
方程	n	Y	N	O	O
为	p	N	N	O	O

opt	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
{	x	N	N	O	O
opt	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
cost	eng	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

(	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
j	eng	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

代码	n	N	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O

Code	eng	N	N	O	O
:	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

Max	eng	N	N	O	O
(	x	N	N	O	O
305	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

data	eng	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

op	eng	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cost	eng	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
Max	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
;	x	N	N	O	O

cost	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

cost	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
mid	eng	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
?	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
mid	eng	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
:	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
data	eng	N	N	O	O
[	x	N	N	O	O
mid	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

op	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
3000000	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

op	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
op	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
3000000	m	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
op	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
op	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
cost	eng	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

op	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
op	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
cost	eng	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
op	eng	N	N	O	O
[	x	N	N	O	O
m	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj	eng	N	Y	B-OJ	B-OJ

2241	m	N	N	I-OJ	O

-	x	N	N	O	O

宇宙	n	N	N	O	O
吾	r	N	N	O	O
心	s	N	N	O	O

-	x	N	N	O	O

博客园	nr	N	N	O	O

题意	n	N	N	O	O
：	x	N	N	O	O
已知	v	N	N	O	O
有	v	N	N	O	O
n	eng	N	N	O	O
（	x	N	N	O	O
n	x	N	N	O	O
<	x	N	N	O	O
30	m	N	N	O	O
）	x	N	N	O	O
种	m	N	N	O	O
类型	n	Y	N	O	O
的	uj	N	N	O	O
block	eng	N	N	O	O
，	x	N	N	O	O
以及	c	N	N	O	O
它们	r	N	N	O	O
的	uj	N	N	O	O
长宽	v	N	N	O	O
高	a	N	N	O	O
，	x	N	N	O	O
每种	r	N	N	O	O
类型	n	Y	N	O	O
的	uj	N	N	O	O
block	eng	N	N	O	O
都	d	N	N	O	O
有	v	N	N	O	O
无限	v	Y	N	O	O
多个	m	N	N	O	O
。	x	N	N	O	O

问	n	N	N	O	O
如果	c	N	N	O	O
把	p	N	N	O	O
他们	r	N	N	O	O
叠起来	v	N	N	O	O
（	x	N	N	O	O
上面	f	N	N	O	O
block	eng	N	N	O	O
的	uj	N	N	O	O
底面	f	N	N	O	O
的	uj	N	N	O	O
长宽	v	N	N	O	O
，	x	N	N	O	O
必须	d	N	N	O	O
比	p	N	N	O	O
下面	f	N	N	O	O
的	uj	N	N	O	O
block	eng	N	N	O	O
的	uj	N	N	O	O
底面	f	N	N	O	O
长宽	v	N	N	O	O
都	d	N	N	O	O
短	a	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
最高	a	N	N	O	O
能	v	N	N	O	O
有	v	N	N	O	O
多	m	N	N	O	O
高	a	N	N	O	O
。	x	N	N	O	O

代码	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
fstream	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

e	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

s	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
h	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

e	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cmp	eng	N	N	O	O
(	x	N	N	O	O
const	eng	N	N	O	O

void	eng	N	N	O	O

*	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
const	eng	N	N	O	O

void	eng	N	N	O	O

*	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
e	x	N	N	O	O

*	x	N	N	O	O
)	x	N	N	O	O
a	x	N	N	O	O
)	x	N	N	O	O
.	m	N	N	O	O
s	eng	N	N	O	O
-	x	N	N	O	O
(	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
e	x	N	N	O	O

*	x	N	N	O	O
)	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O
.	m	N	N	O	O
s	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
101	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

read	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

ifstream	eng	N	N	O	O

cin	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
in	eng	Y	N	O	O
.	m	N	N	O	O
txt	eng	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
h	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

k	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
Case	eng	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
:	x	N	N	O	O

maximum	eng	N	N	O	O

height	eng	N	N	O	O

=	x	N	N	O	O

"	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
s	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
t	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
h	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

v	x	N	N	O	O
=	x	N	N	O	O
h	x	N	N	O	O
;	x	N	N	O	O

e	x	N	N	O	O

b	x	N	N	O	O
;	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
s	eng	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
=	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
h	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
h	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

v	x	N	N	O	O
=	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
s	eng	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
=	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
min	eng	N	N	O	O
(	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
h	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
(	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
h	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

v	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
;	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
s	eng	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

b	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
=	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

qsort	eng	N	N	O	O
(	x	N	N	O	O
a	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
e	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
cmp	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

n	x	N	N	O	O
=	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
s	eng	N	N	O	O
>	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
s	eng	N	N	O	O
&&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
>	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
,	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
,	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
ans	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

read	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj4047	eng	N	Y	B-OJ	B-OJ

garden	eng	N	N	O	O
_	x	N	N	O	O
心自	i	N	N	O	O
天涯	n	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

每个	r	N	N	O	O
节点	n	N	N	O	O
记录	n	Y	N	O	O
从	p	N	N	O	O
它	r	N	N	O	O
开始	v	N	N	O	O
的	uj	N	N	O	O
k	eng	N	N	O	O
个数	n	Y	N	O	O
之	u	N	N	O	O
和	c	N	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
收集	v	N	N	O	O
其中	r	N	N	O	O
的	uj	N	N	O	O
最大值	l	N	N	O	O
，	x	N	N	O	O
使用	v	N	N	O	O
懒惰	a	N	N	O	O
标记	n	N	N	O	O
法	j	N	N	O	O
。	x	N	N	O	O

注意	v	N	N	O	O
细节	n	N	N	O	O
，	x	N	N	O	O
写	v	N	N	O	O
好	a	N	N	O	O
pushup	eng	N	N	O	O
和	c	N	N	O	O
pushdown	eng	N	N	O	O
。	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

LS	eng	N	N	O	O

(	x	N	N	O	O
rt	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

RS	eng	N	N	O	O

(	x	N	N	O	O
rt	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
|	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

int	eng	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
200005	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
tem	eng	N	N	O	O
[	x	N	N	O	O
200005	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

MAX	eng	N	N	O	O
[	x	N	N	O	O
600010	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
lz	eng	N	N	O	O
[	x	N	N	O	O
600010	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

kk	eng	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

pushup	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

rt	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

MAX	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

max	eng	N	N	O	O
(	x	N	N	O	O
MAX	eng	N	N	O	O
[	x	N	N	O	O
LS	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
MAX	eng	N	N	O	O
[	x	N	N	O	O
RS	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

pushdown	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

rt	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

lz	eng	N	N	O	O
[	x	N	N	O	O
LS	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

lz	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

lz	eng	N	N	O	O
[	x	N	N	O	O
RS	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

lz	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

MAX	eng	N	N	O	O
[	x	N	N	O	O
RS	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

lz	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

MAX	eng	N	N	O	O
[	x	N	N	O	O
LS	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

lz	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

lz	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

maketree	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

rt	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

lz	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

MAX	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

tem	eng	N	N	O	O
[	x	N	N	O	O
kk	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

maketree	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
LS	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

maketree	eng	N	N	O	O
(	x	N	N	O	O
m	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
RS	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

pushup	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
rt	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

s	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

t	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

sc	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

rt	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

MAX	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

sc	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
lz	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

pushdown	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
rt	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O

&&	x	N	N	O	O

t	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

MAX	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

sc	eng	N	N	O	O
;	x	N	N	O	O

lz	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

sc	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
sc	eng	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
LS	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
t	x	N	N	O	O
>	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
sc	eng	N	N	O	O
,	x	N	N	O	O
m	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
RS	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

pushup	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
rt	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

query	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

s	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

t	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

rt	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
lz	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

pushdown	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
rt	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ret	eng	N	N	O	O

=	x	N	N	O	O

-	x	N	N	O	O
200000000	m	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O

&&	x	N	N	O	O

t	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

MAX	eng	N	N	O	O
[	x	N	N	O	O
rt	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O

ret	eng	N	N	O	O

=	x	N	N	O	O

max	eng	N	N	O	O
(	x	N	N	O	O
ret	eng	N	N	O	O
,	x	N	N	O	O
query	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
LS	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
t	x	N	N	O	O
>	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O

ret	eng	N	N	O	O

=	x	N	N	O	O

max	eng	N	N	O	O
(	x	N	N	O	O
ret	eng	N	N	O	O
,	x	N	N	O	O
query	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
m	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
RS	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

ret	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

num	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
tmp	eng	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
num	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

kk	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
lz	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
lz	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
MAX	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
MAX	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tem	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
k	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
fa	eng	N	N	O	O
+	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

tem	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

tem	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

tem	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

maketree	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
p	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
query	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
-	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
-	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
-	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
<	x	N	N	O	O
k	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O
{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
fa	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
k	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

tmp	eng	N	N	O	O

=	x	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

fa	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

tmp	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

hdu	eng	N	Y	B-OJ	B-OJ

1060	m	N	N	I-OJ	I-OJ
_	x	N	N	O	O
striver	eng	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

题目	n	Y	N	O	O
：	x	N	N	O	O
http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
hdu	eng	N	Y	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
showproblem	eng	N	N	O	O
.	m	N	N	O	O
php	eng	N	N	O	O
?	x	N	N	O	O
pid	eng	N	N	O	O
=	x	N	N	O	O
1060	m	N	N	O	O

思路	n	N	N	O	O
：	x	N	N	O	O
刚	d	N	N	O	O
开始	v	N	N	O	O
做	v	N	N	O	O
，	x	N	N	O	O
发现	v	N	N	O	O
很	zg	N	N	O	O
纠结	v	N	N	O	O
！	x	N	N	O	O
！	x	N	N	O	O

后来	t	N	N	O	O
，	x	N	N	O	O
看到	v	N	N	O	O
了	ul	N	N	O	O
一个	m	N	N	O	O
人	n	N	N	O	O
的	uj	N	N	O	O
分析	vn	N	N	O	O
，	x	N	N	O	O
是	v	N	N	O	O
这样	r	N	N	O	O
转换	v	Y	N	O	O
的	uj	N	N	O	O

m	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
^	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
两边	f	N	N	O	O
同取	v	N	N	O	O
对数	n	Y	N	O	O
，	x	N	N	O	O
得到	v	N	N	O	O
，	x	N	N	O	O
log10	eng	N	N	O	O
(	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
*	x	N	N	O	O
log10	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
再	d	N	N	O	O
得到	v	N	N	O	O
，	x	N	N	O	O
m	x	N	N	O	O
=	x	N	N	O	O
10	m	N	N	O	O
^	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
*	x	N	N	O	O
log10	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

然后	c	N	N	O	O
，	x	N	N	O	O
对于	p	N	N	O	O
10	m	N	N	O	O
的	uj	N	N	O	O
整数	n	Y	N	O	O
次	m	N	N	O	O
幂	n	N	N	O	O
，	x	N	N	O	O
第一位	m	N	N	O	O
是	v	N	N	O	O
1	m	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
，	x	N	N	O	O
第一位	m	N	N	O	O
数	n	N	N	O	O
取决于	v	N	N	O	O
n	x	N	N	O	O
*	x	N	N	O	O
log10	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
的	uj	N	N	O	O
小数	n	Y	N	O	O
部分	n	Y	N	O	O

总之	c	N	N	O	O
，	x	N	N	O	O
log	eng	N	N	O	O
很	d	N	N	O	O
强大	a	N	N	O	O
啊	zg	N	N	O	O
，	x	N	N	O	O
在	p	N	N	O	O
求	v	N	N	O	O
一个	m	N	N	O	O
数	m	N	N	O	O
的	uj	N	N	O	O
位数	n	Y	N	O	O
上	f	N	N	O	O
，	x	N	N	O	O
在	p	N	N	O	O
将	d	N	N	O	O
大	a	N	N	O	O
整数	n	Y	N	O	O
化成	v	N	N	O	O
范围	n	N	N	O	O
内	f	N	N	O	O
的	uj	N	N	O	O
整数	n	Y	N	O	O
上	f	N	N	O	O
，	x	N	N	O	O
在	p	N	N	O	O
指数	n	N	N	O	O
问题	n	N	N	O	O
上	f	N	N	O	O

代码	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cmath	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

s	x	N	N	O	O
,	x	N	N	O	O
num	eng	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
=	x	N	N	O	O
num	eng	N	N	O	O
*	x	N	N	O	O
log10	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O
)	x	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
-	x	N	N	O	O
a	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O
)	x	N	N	O	O
(	x	N	N	O	O
pow	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
double	eng	N	N	O	O
)	x	N	N	O	O
10	m	N	N	O	O
,	x	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cout	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
sum	eng	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

2142	m	N	N	I-OJ	O

The	eng	N	N	O	O

Balance	eng	N	N	O	O
_	x	N	N	O	O
编织	n	N	N	O	O
梦想	n	N	N	O	O
，	x	N	N	O	O
编织	n	N	N	O	O
未来	t	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

题目	n	Y	N	O	O
大意	d	N	N	O	O
：	x	N	N	O	O
给定	v	N	N	O	O
两种	m	N	N	O	O
重量	n	N	N	O	O
的	uj	N	N	O	O
砝码	n	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
，	x	N	N	O	O
和	c	N	N	O	O
一个	m	N	N	O	O
重量	n	N	N	O	O
为	p	N	N	O	O
d	eng	N	N	O	O
的	uj	N	N	O	O
物品	n	N	N	O	O
。	x	N	N	O	O

物品	n	N	N	O	O
放在	v	N	N	O	O
天	q	N	N	O	O
枰	ng	N	N	O	O
的	uj	N	N	O	O
右边	f	N	N	O	O
，	x	N	N	O	O
问	n	N	N	O	O
需要	v	N	N	O	O
多少	m	N	N	O	O
个	m	N	N	O	O
a	eng	N	N	O	O
和	c	N	N	O	O
多少	m	N	N	O	O
个	m	N	N	O	O
b	eng	N	N	O	O
使得	v	N	N	O	O
天	q	N	N	O	O
枰	ng	N	N	O	O
平衡	a	Y	N	O	O
，	x	N	N	O	O
假设	vn	N	N	O	O
需要	v	N	N	O	O
x	eng	N	N	O	O
个	m	N	N	O	O
a	eng	N	N	O	O
和	c	N	N	O	O
y	eng	N	N	O	O
个	m	N	N	O	O
b	eng	N	N	O	O
,	x	N	N	O	O
那么	r	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
y	eng	N	N	O	O
最少	d	N	N	O	O
者	k	N	N	O	O
为	p	N	N	O	O
最优	d	N	N	O	O
解	v	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
两种	m	N	N	O	O
方案	n	N	N	O	O
的	uj	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
y	eng	N	N	O	O
一样	r	N	N	O	O
小	a	N	N	O	O
，	x	N	N	O	O
那么	r	N	N	O	O
a	x	N	N	O	O
*	x	N	N	O	O
x	eng	N	N	O	O
+	x	N	N	O	O
b	eng	N	N	O	O
*	x	N	N	O	O
y	x	N	N	O	O
最小	a	Y	N	O	O
者	k	N	N	O	O
为	p	N	N	O	O
最优	d	N	N	O	O
解	v	N	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
最优	d	N	N	O	O
的	uj	N	N	O	O
x	eng	N	N	O	O
和	c	N	N	O	O
y	eng	N	N	O	O
。	x	N	N	O	O

解题	n	N	N	O	O
思路	n	N	N	O	O
：	x	N	N	O	O
很	zg	N	N	O	O
简单	a	N	N	O	O
的	uj	N	N	O	O
一个	m	N	N	O	O
求同	v	N	N	O	O
余	m	N	N	O	O
方程	n	Y	N	O	O
问题	n	N	N	O	O
。	x	N	N	O	O

附	v	N	N	O	O
代码	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

extend	eng	N	N	O	O
_	x	N	N	O	O
gcd	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

b	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

&	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
b	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

x	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

a	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

extend	eng	N	N	O	O
_	x	N	N	O	O
gcd	eng	Y	N	O	O
(	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
%	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

x	x	N	N	O	O

=	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O

=	x	N	N	O	O

j	x	N	N	O	O

-	x	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
/	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
d	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
xx	eng	N	N	O	O
,	x	N	N	O	O
yy	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ansa	eng	N	N	O	O
,	x	N	N	O	O

ansb	eng	N	N	O	O
,	x	N	N	O	O

ansc	eng	N	N	O	O
,	x	N	N	O	O

ansd	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
b	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
n	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ansa	eng	N	N	O	O

=	x	N	N	O	O

ansb	eng	N	N	O	O

=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

ansc	eng	N	N	O	O

=	x	N	N	O	O

ansd	eng	N	N	O	O

=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

d	x	N	N	O	O

=	x	N	N	O	O

extend	eng	N	N	O	O
_	x	N	N	O	O
gcd	eng	Y	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

xx	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
b	x	N	N	O	O
/	x	N	N	O	O
d	x	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

xx	eng	N	N	O	O

=	x	N	N	O	O

xx	eng	N	N	O	O

%	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
xx	eng	N	N	O	O

<	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

xx	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

n	x	N	N	O	O

/	x	N	N	O	O

d	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

d	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

yy	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
*	x	N	N	O	O
xx	eng	N	N	O	O
-	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O

=	x	N	N	O	O

abs	eng	N	N	O	O
(	x	N	N	O	O
yy	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ansa	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O

&&	x	N	N	O	O

ansb	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
ansa	eng	N	N	O	O

=	x	N	N	O	O

xx	eng	N	N	O	O
;	x	N	N	O	O

ansb	eng	N	N	O	O

=	x	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
xx	eng	N	N	O	O

+	x	N	N	O	O

k	x	N	N	O	O

<	x	N	N	O	O

ansa	eng	N	N	O	O

+	x	N	N	O	O

ansb	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ansa	eng	N	N	O	O

=	x	N	N	O	O

xx	eng	N	N	O	O
;	x	N	N	O	O

ansb	eng	N	N	O	O

=	x	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
xx	eng	N	N	O	O

+	x	N	N	O	O

k	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

ansa	eng	N	N	O	O

+	x	N	N	O	O

ansb	eng	N	N	O	O

&&	x	N	N	O	O

(	x	N	N	O	O
xx	eng	N	N	O	O
*	x	N	N	O	O
a	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O

<	x	N	N	O	O

ansa	eng	N	N	O	O
*	x	N	N	O	O
a	eng	N	N	O	O
+	x	N	N	O	O
ansb	eng	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ansa	eng	N	N	O	O

=	x	N	N	O	O

xx	eng	N	N	O	O
;	x	N	N	O	O

ansb	eng	N	N	O	O

=	x	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

xx	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
xx	eng	N	N	O	O

+	x	N	N	O	O

j	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

a	x	N	N	O	O
;	x	N	N	O	O

a	x	N	N	O	O

=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

n	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

d	x	N	N	O	O

=	x	N	N	O	O

extend	eng	N	N	O	O
_	x	N	N	O	O
gcd	eng	Y	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

xx	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
b	x	N	N	O	O
/	x	N	N	O	O
d	x	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
x	x	N	N	O	O
;	x	N	N	O	O

xx	eng	N	N	O	O

=	x	N	N	O	O

xx	eng	N	N	O	O

%	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
xx	eng	N	N	O	O

<	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

xx	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

n	x	N	N	O	O

/	x	N	N	O	O

d	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

d	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

yy	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
*	x	N	N	O	O
xx	eng	N	N	O	O
-	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O

=	x	N	N	O	O

abs	eng	N	N	O	O
(	x	N	N	O	O
yy	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ansc	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O

&&	x	N	N	O	O

ansd	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O
ansc	eng	N	N	O	O

=	x	N	N	O	O

xx	eng	N	N	O	O
;	x	N	N	O	O

ansd	eng	N	N	O	O

=	x	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
xx	eng	N	N	O	O

+	x	N	N	O	O

k	x	N	N	O	O

<	x	N	N	O	O

ansc	eng	N	N	O	O

+	x	N	N	O	O

ansd	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ansc	eng	N	N	O	O

=	x	N	N	O	O

xx	eng	N	N	O	O
;	x	N	N	O	O

ansd	eng	N	N	O	O

=	x	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
xx	eng	N	N	O	O

+	x	N	N	O	O

k	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

ansa	eng	N	N	O	O

+	x	N	N	O	O

ansb	eng	N	N	O	O

&&	x	N	N	O	O

(	x	N	N	O	O
xx	eng	N	N	O	O
*	x	N	N	O	O
a	eng	N	N	O	O
+	x	N	N	O	O
k	eng	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O

<	x	N	N	O	O

ansc	eng	N	N	O	O
*	x	N	N	O	O
a	eng	N	N	O	O
+	x	N	N	O	O
ansd	eng	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ansc	eng	N	N	O	O

=	x	N	N	O	O

xx	eng	N	N	O	O
;	x	N	N	O	O

ansd	eng	N	N	O	O

=	x	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

xx	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
xx	eng	N	N	O	O

+	x	N	N	O	O

j	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ansa	eng	N	N	O	O

+	x	N	N	O	O

ansb	eng	N	N	O	O

>	x	N	N	O	O

ansc	eng	N	N	O	O

+	x	N	N	O	O

ansd	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ansa	eng	N	N	O	O

=	x	N	N	O	O

ansd	eng	N	N	O	O
;	x	N	N	O	O

ansb	eng	N	N	O	O

=	x	N	N	O	O

ansc	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ansa	eng	N	N	O	O

+	x	N	N	O	O

ansb	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

ansd	eng	N	N	O	O

+	x	N	N	O	O

ansc	eng	N	N	O	O

&&	x	N	N	O	O

(	x	N	N	O	O
ansa	eng	N	N	O	O
*	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
ansb	eng	N	N	O	O
*	x	N	N	O	O
a	x	N	N	O	O

>	x	N	N	O	O

ansc	eng	N	N	O	O
*	x	N	N	O	O
a	x	N	N	O	O

+	x	N	N	O	O

ansd	eng	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ansa	eng	N	N	O	O

=	x	N	N	O	O

ansd	eng	N	N	O	O
;	x	N	N	O	O

ansb	eng	N	N	O	O

=	x	N	N	O	O

ansc	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ansa	eng	N	N	O	O
,	x	N	N	O	O
ansb	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

pku	eng	N	Y	B-OJ	B-OJ

1493	m	N	N	I-OJ	I-OJ
_	x	N	N	O	O
皇	ng	N	N	O	O
傲	a	N	N	O	O
殛	g	N	N	O	O
天	q	N	N	O	O
的	uj	N	N	O	O
空间	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

num	eng	N	N	O	O
,	x	N	N	O	O
max	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

out	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

string	eng	N	N	O	O

a1	eng	N	N	O	O
;	x	N	N	O	O

string	eng	N	N	O	O

a2	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

result	eng	N	N	O	O
[	x	N	N	O	O
14	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O

cin	eng	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
n	x	N	N	O	O

&&	x	N	N	O	O

n	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O

result	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
result	eng	N	N	O	O
)	x	N	N	O	O

)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

a1	eng	N	N	O	O

;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

a1	eng	N	N	O	O
.	m	N	N	O	O
length	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

25	m	N	N	O	O

)	x	N	N	O	O

cin	eng	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

a2	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

a1	eng	N	N	O	O
.	m	N	N	O	O
length	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

25	m	N	N	O	O

)	x	N	N	O	O

result	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

a1	eng	N	N	O	O
.	m	N	N	O	O
length	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

result	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

a1	eng	N	N	O	O
.	m	N	N	O	O
length	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

+	x	N	N	O	O

a2	eng	N	N	O	O
.	m	N	N	O	O
length	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

max	eng	N	N	O	O

=	x	N	N	O	O

num	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

result	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

>	x	N	N	O	O

max	eng	N	N	O	O

)	x	N	N	O	O

max	eng	N	N	O	O

=	x	N	N	O	O

result	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

num	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
result	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

out	eng	N	N	O	O

=	x	N	N	O	O

n	x	N	N	O	O
*	x	N	N	O	O
max	eng	N	N	O	O

-	x	N	N	O	O

num	eng	N	N	O	O
;	x	N	N	O	O

cout	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

out	eng	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

endl	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

【	x	N	N	O	O
转	v	N	N	O	O
】	x	N	N	O	O
pku	eng	N	Y	B-OJ	B-OJ

1191	m	N	N	I-OJ	I-OJ

棋盘	n	Y	N	O	O
分割	v	Y	N	O	O

（	x	N	N	O	O
动态	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
规划	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
）	x	N	N	O	O
_	x	N	N	O	O
沧海桑田	ns	N	N	O	O

.	x	N	N	O	O

蓝色	n	N	N	O	O
空间	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O
1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O
10000	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O
3151	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O
1146	m	N	N	O	O

Description	eng	N	N	O	O

将	d	N	N	O	O
一个	m	N	N	O	O
８	x	N	N	O	O
*	x	N	N	O	O
８	x	N	N	O	O
的	uj	N	N	O	O
棋盘	n	Y	N	O	O
进行	v	N	N	O	O
如下	t	N	N	O	O
分割	v	Y	N	O	O
：	x	N	N	O	O
将	d	N	N	O	O
原	d	N	N	O	O
棋盘	n	Y	N	O	O
割	v	N	N	O	O
下	f	N	N	O	O
一块	m	N	N	O	O
矩形	n	Y	N	O	O
棋盘	n	Y	N	O	O
并使	c	N	N	O	O
剩下	v	N	N	O	O
部分	n	Y	N	O	O
也	d	N	N	O	O
是	v	N	N	O	O
矩形	n	Y	N	O	O
，	x	N	N	O	O
再	d	N	N	O	O
将	d	N	N	O	O
剩下	v	N	N	O	O
的	uj	N	N	O	O
部分	n	Y	N	O	O
继续	v	N	N	O	O
如此	c	N	N	O	O
分割	v	Y	N	O	O
，	x	N	N	O	O
这样	r	N	N	O	O
割	v	N	N	O	O
了	ul	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
次后	t	N	N	O	O
，	x	N	N	O	O
连同	a	Y	N	O	O
最后	f	N	N	O	O
剩下	v	N	N	O	O
的	uj	N	N	O	O
矩形	n	Y	N	O	O
棋盘	n	Y	N	O	O
共有	v	N	N	O	O
n	eng	N	N	O	O
块	q	N	N	O	O
矩形	n	Y	N	O	O
棋盘	n	Y	N	O	O
。	x	N	N	O	O

(	x	N	N	O	O
每次	r	N	N	O	O
切割	v	Y	N	O	O
都	d	N	N	O	O
只能	v	N	N	O	O
沿着	p	N	N	O	O
棋盘	n	Y	N	O	O
格子	n	N	N	O	O
的	uj	N	N	O	O
边	n	N	N	O	O
进行	v	N	N	O	O
)	x	N	N	O	O

原	n	N	N	O	O
棋盘	n	Y	N	O	O
上	f	N	N	O	O
每	r	N	N	O	O
一格	n	N	N	O	O
有	v	N	N	O	O
一个	m	N	N	O	O
分值	n	N	N	O	O
，	x	N	N	O	O
一块	m	N	N	O	O
矩形	n	Y	N	O	O
棋盘	n	Y	N	O	O
的	uj	N	N	O	O
总	n	N	N	O	O
分为	v	N	N	O	O
其	r	N	N	O	O
所	u	N	N	O	O
含	v	N	N	O	O
各	r	N	N	O	O
格	n	N	N	O	O
分值	n	N	N	O	O
之	u	N	N	O	O
和	c	N	N	O	O
。	x	N	N	O	O

现在	t	N	N	O	O
需要	v	N	N	O	O
把	p	N	N	O	O
棋盘	n	Y	N	O	O
按	p	N	N	O	O
上述	b	N	N	O	O
规则	n	N	N	O	O
分割	v	Y	N	O	O
成	n	N	N	O	O
n	eng	N	N	O	O
块	q	N	N	O	O
矩形	n	Y	N	O	O
棋盘	n	Y	N	O	O
，	x	N	N	O	O
并使	c	N	N	O	O
各	r	N	N	O	O
矩形	n	Y	N	O	O
棋盘	n	Y	N	O	O
总分	n	N	N	O	O
的	uj	N	N	O	O
均	d	N	N	O	O
方差	n	N	N	O	O
最小	a	Y	N	O	O
。	x	N	N	O	O

均	d	N	N	O	O
方差	n	N	N	O	O
，	x	N	N	O	O
其中	r	N	N	O	O
平均值	n	N	N	O	O
，	x	N	N	O	O
xi	eng	N	N	O	O
为	p	N	N	O	O
第	m	N	N	O	O
i	eng	N	N	O	O
块	q	N	N	O	O
矩形	n	Y	N	O	O
棋盘	n	Y	N	O	O
的	uj	N	N	O	O
总分	n	N	N	O	O
。	x	N	N	O	O

请	v	N	N	O	O
编程	n	N	N	O	O
对	p	N	N	O	O
给出	v	N	N	O	O
的	uj	N	N	O	O
棋盘	n	Y	N	O	O
及	c	N	N	O	O
n	eng	N	N	O	O
，	x	N	N	O	O
求出	v	N	N	O	O
O	eng	N	N	O	O
'	x	N	N	O	O
的	uj	N	N	O	O
最小值	l	N	N	O	O
。	x	N	N	O	O

Input	eng	N	N	O	O

第	m	N	N	O	O
1	m	N	N	O	O
行为	v	N	N	O	O
一个	m	N	N	O	O
整数	n	Y	N	O	O
n	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O

<	x	N	N	O	O

15	m	N	N	O	O
)	x	N	N	O	O
。	x	N	N	O	O

第	m	N	N	O	O
2	m	N	N	O	O
行至	v	N	N	O	O
第	m	N	N	O	O
9	m	N	N	O	O
行	v	N	N	O	O
每	r	N	N	O	O
行为	v	N	N	O	O
8	m	N	N	O	O
个	m	N	N	O	O
小于	v	N	N	O	O
100	m	N	N	O	O
的	uj	N	N	O	O
非	h	N	N	O	O
负	n	N	N	O	O
整数	n	Y	N	O	O
，	x	N	N	O	O
表示	v	Y	N	O	O
棋盘	n	Y	N	O	O
上	f	N	N	O	O
相应	v	N	N	O	O
格子	n	N	N	O	O
的	uj	N	N	O	O
分值	n	N	N	O	O
。	x	N	N	O	O

每行	r	N	N	O	O
相邻	v	N	N	O	O
两	m	N	N	O	O
数	n	N	N	O	O
之间	f	N	N	O	O
用	p	N	N	O	O
一个	m	N	N	O	O
空格	n	N	N	O	O
分隔	v	N	N	O	O
。	x	N	N	O	O

Output	eng	N	N	O	O

仅	d	N	N	O	O
一个	m	N	N	O	O
数	n	N	N	O	O
，	x	N	N	O	O
为	p	N	N	O	O
O	eng	N	N	O	O
'	x	N	N	O	O
（	x	N	N	O	O
四舍五入	i	N	N	O	O
精确	a	Y	N	O	O
到	v	N	N	O	O
小数点	n	Y	N	O	O
后	f	N	N	O	O
三位	m	N	N	O	O
）	x	N	N	O	O
。	x	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

3	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

3	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

0	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

1	x	N	N	O	O

0	x	N	N	O	O

3	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

1.633	m	N	N	O	O

Source	eng	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
动态	n	Y	N	B-KNOWLEDGE	B-KNOWLEDGE
规划	n	Y	N	I-KNOWLEDGE	I-KNOWLEDGE
练习题	n	N	N	O	O
刚刚开始	nr	N	N	O	O
的	uj	N	N	O	O
时候	n	N	N	O	O
，	x	N	N	O	O
考虑	v	N	N	O	O
到	v	N	N	O	O
每个	r	N	N	O	O
状态	n	Y	N	O	O
需要	v	N	N	O	O
记录	n	Y	N	O	O
的	uj	N	N	O	O
信息	n	N	N	O	O
需要	v	N	N	O	O
开	v	N	N	O	O
一个	m	N	N	O	O
5	m	N	N	O	O
维	nr	N	N	O	O
的	uj	N	N	O	O
数组	n	Y	N	O	O
（	x	N	N	O	O
左上角	f	N	N	O	O
左边	f	N	N	O	O
i1	eng	N	N	O	O
,	x	N	N	O	O
j1	eng	N	N	O	O
;	x	N	N	O	O
右下角	f	N	N	O	O
坐标	v	Y	N	O	O
i2	eng	N	N	O	O
,	x	N	N	O	O
j2	eng	N	N	O	O
;	x	N	N	O	O
当前	t	N	N	O	O
切割	v	Y	N	O	O
到	v	N	N	O	O
第几次	m	N	N	O	O
）	x	N	N	O	O
，	x	N	N	O	O
有点	n	N	N	O	O
被	p	N	N	O	O
吓	v	N	N	O	O
懵	v	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
这	r	N	N	O	O
道题	n	N	N	O	O
晾	v	N	N	O	O
了	ul	N	N	O	O
很久	m	N	N	O	O
，	x	N	N	O	O
刚刚	d	N	N	O	O
才	d	N	N	O	O
做	v	N	N	O	O
出来	v	N	N	O	O
。	x	N	N	O	O

还有	v	N	N	O	O
个	q	N	N	O	O
原因	n	N	N	O	O
就是	d	N	N	O	O
腾讯	nz	N	N	O	O
赛上	t	N	N	O	O
，	x	N	N	O	O
有	v	N	N	O	O
道	q	N	N	O	O
PAPERCUT	eng	N	N	O	O
，	x	N	N	O	O
本质	n	N	N	O	O
上	f	N	N	O	O
跟	p	N	N	O	O
棋盘	n	Y	N	O	O
分割	v	Y	N	O	O
是	v	N	N	O	O
相同	d	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
可	v	N	N	O	O
提交	v	N	N	O	O
了	ul	N	N	O	O
n	eng	N	N	O	O
次	t	N	N	O	O
，	x	N	N	O	O
都	d	N	N	O	O
是	v	N	N	O	O
WA	eng	N	N	O	O
，	x	N	N	O	O
为了	p	N	N	O	O
验证	v	N	N	O	O
我	r	N	N	O	O
的	uj	N	N	O	O
思路	n	N	N	O	O
是	v	N	N	O	O
正确	ad	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
拿	v	N	N	O	O
这	r	N	N	O	O
道题	n	N	N	O	O
来	v	N	N	O	O
检测	vn	N	N	O	O
一下	m	N	N	O	O
，	x	N	N	O	O
事实证明	l	N	N	O	O
之前	f	N	N	O	O
是	v	N	N	O	O
出	v	N	N	O	O
了	ul	N	N	O	O
点	m	N	N	O	O
逻辑	n	N	N	O	O
上	f	N	N	O	O
的	uj	N	N	O	O
错误	n	N	N	O	O
。	x	N	N	O	O

除了	p	N	N	O	O
上面	f	N	N	O	O
的	uj	N	N	O	O
5	m	N	N	O	O
维	v	N	N	O	O
数组	n	Y	N	O	O
外	f	N	N	O	O
，	x	N	N	O	O
还	d	N	N	O	O
需开	v	N	N	O	O
个	m	N	N	O	O
4	m	N	N	O	O
维	v	N	N	O	O
数组	n	Y	N	O	O
来	v	N	N	O	O
保存	v	N	N	O	O
分割	v	Y	N	O	O
后	f	N	N	O	O
的	uj	N	N	O	O
每个	r	N	N	O	O
子	ng	N	N	O	O
棋盘	n	Y	N	O	O
的	uj	N	N	O	O
总分	n	N	N	O	O
的	uj	N	N	O	O
平方	q	Y	N	O	O
。	x	N	N	O	O

均	d	N	N	O	O
方差	n	N	N	O	O
公式	n	Y	N	O	O
比较复杂	l	N	N	O	O
，	x	N	N	O	O
联立	v	N	N	O	O
题目	n	Y	N	O	O
给	p	N	N	O	O
的	uj	N	N	O	O
两个	m	N	N	O	O
式子	n	N	N	O	O
，	x	N	N	O	O
化简	n	N	N	O	O
之后	f	N	N	O	O
，	x	N	N	O	O
就	d	N	N	O	O
可以	c	N	N	O	O
得到	v	N	N	O	O
题目	n	Y	N	O	O
要求	v	N	N	O	O
的	uj	N	N	O	O
就是	d	N	N	O	O
每块	r	N	N	O	O
子	ng	N	N	O	O
棋盘	n	Y	N	O	O
的	uj	N	N	O	O
总分	n	N	N	O	O
最小	a	Y	N	O	O
。	x	N	N	O	O

对于	p	N	N	O	O
一个	m	N	N	O	O
棋盘	n	Y	N	O	O
，	x	N	N	O	O
可以	c	N	N	O	O
横	v	N	N	O	O
着	uz	N	N	O	O
切割	v	Y	N	O	O
，	x	N	N	O	O
也	d	N	N	O	O
可以	c	N	N	O	O
竖直	v	N	N	O	O
切割	v	Y	N	O	O
。	x	N	N	O	O

切割	v	Y	N	O	O
完	v	N	N	O	O
，	x	N	N	O	O
会	v	N	N	O	O
得到	v	N	N	O	O
两块	m	N	N	O	O
子	ng	N	N	O	O
棋盘	n	Y	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
此时	c	N	N	O	O
还	d	N	N	O	O
切	v	N	N	O	O
不够	v	N	N	O	O
n	eng	N	N	O	O
次	t	N	N	O	O
的话	u	N	N	O	O
，	x	N	N	O	O
就	d	N	N	O	O
继续	v	N	N	O	O
递归	v	Y	N	O	B-KNOWLEDGE
，	x	N	N	O	O
对	p	N	N	O	O
两块	m	N	N	O	O
子	ng	N	N	O	O
棋盘	n	Y	N	O	O
进行	v	N	N	O	O
切割	v	Y	N	O	O
，	x	N	N	O	O
找出	v	Y	N	O	O
最小	a	Y	N	O	O
的	uj	N	N	O	O
切割	v	Y	N	O	O
方式	n	N	N	O	O
。	x	N	N	O	O

子	ng	N	N	O	O
棋盘	n	Y	N	O	O
的	uj	N	N	O	O
最小	a	Y	N	O	O
分割	v	Y	N	O	O
导致	v	N	N	O	O
整个	b	N	N	O	O
棋盘	n	Y	N	O	O
的	uj	N	N	O	O
最小	a	Y	N	O	O
分割	v	Y	N	O	O
，	x	N	N	O	O
符合	v	N	N	O	O
最优	d	N	N	O	O
子结构	n	N	N	O	O
。	x	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
源码	n	N	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O
#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
math	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

double	eng	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
20	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
10	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

cal	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i1	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

j1	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

i2	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

j2	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
i1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j2	eng	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
i1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j2	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
i1	eng	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
i2	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
j1	eng	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
j2	eng	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

sum	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
i1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j2	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
*	x	N	N	O	O
sum	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
i1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j2	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

double	eng	N	N	O	O

ge	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i1	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

j1	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

i2	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

j2	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O

return	eng	N	N	O	O

cal	eng	N	N	O	O
(	x	N	N	O	O
i1	eng	N	N	O	O
,	x	N	N	O	O
j1	eng	N	N	O	O
,	x	N	N	O	O
i2	eng	N	N	O	O
,	x	N	N	O	O
j2	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
f	x	N	N	O	O
[	x	N	N	O	O
i1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
i1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

ff	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

mini	eng	N	N	O	O
=	x	N	N	O	O
999999999999999	m	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
i1	eng	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
i2	eng	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ff	eng	N	N	O	O
=	x	N	N	O	O
__	x	N	N	O	O
min	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
ge	eng	N	N	O	O
(	x	N	N	O	O
i1	eng	N	N	O	O
,	x	N	N	O	O
j1	eng	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j2	eng	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
cal	eng	N	N	O	O
(	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
j1	eng	N	N	O	O
,	x	N	N	O	O
i2	eng	N	N	O	O
,	x	N	N	O	O
j2	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
(	x	N	N	O	O
ge	eng	N	N	O	O
(	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
j1	eng	N	N	O	O
,	x	N	N	O	O
i2	eng	N	N	O	O
,	x	N	N	O	O
j2	eng	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
cal	eng	N	N	O	O
(	x	N	N	O	O
i1	eng	N	N	O	O
,	x	N	N	O	O
j1	eng	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j2	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ff	eng	N	N	O	O
<	x	N	N	O	O
mini	eng	N	N	O	O
)	x	N	N	O	O

mini	eng	N	N	O	O
=	x	N	N	O	O
ff	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
j1	eng	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
j2	eng	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ff	eng	N	N	O	O
=	x	N	N	O	O
__	x	N	N	O	O
min	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
ge	eng	N	N	O	O
(	x	N	N	O	O
i1	eng	N	N	O	O
,	x	N	N	O	O
j1	eng	N	N	O	O
,	x	N	N	O	O
i2	eng	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
cal	eng	N	N	O	O
(	x	N	N	O	O
i1	eng	N	N	O	O
,	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
i2	eng	N	N	O	O
,	x	N	N	O	O
j2	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
(	x	N	N	O	O
ge	eng	N	N	O	O
(	x	N	N	O	O
i1	eng	N	N	O	O
,	x	N	N	O	O
j	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
i2	eng	N	N	O	O
,	x	N	N	O	O
j2	eng	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
cal	eng	N	N	O	O
(	x	N	N	O	O
i1	eng	N	N	O	O
,	x	N	N	O	O
j1	eng	N	N	O	O
,	x	N	N	O	O
i2	eng	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
ff	eng	N	N	O	O
<	x	N	N	O	O
mini	eng	N	N	O	O
)	x	N	N	O	O

mini	eng	N	N	O	O
=	x	N	N	O	O
ff	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
i1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
mini	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

f	x	N	N	O	O
[	x	N	N	O	O
i1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j1	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
freopen	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
1.	m	N	N	O	O
txt	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
"	x	N	N	O	O
r	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
stdin	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

double	eng	N	N	O	O

sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
lf	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
f	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
f	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
8	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
8	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
lf	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sum	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
sum	eng	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

min	eng	N	N	O	O
=	x	N	N	O	O
ge	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
8	x	N	N	O	O
,	x	N	N	O	O
8	x	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
.3	m	N	N	O	O
lf	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
sqrt	eng	N	N	O	O
(	x	N	N	O	O
min	eng	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
*	x	N	N	O	O
x	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

POJ	eng	N	Y	B-OJ	B-OJ

2379	m	N	N	I-OJ	O

ACM	eng	N	N	O	O

Rank	eng	N	N	O	O

Table	eng	N	N	O	O
(	x	N	N	O	O
数据结构	n	N	N	O	O
)	x	N	N	O	O
_	x	N	N	O	O
奔跑	v	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

Description	eng	N	N	O	O

ACM	eng	N	N	O	O

contests	eng	N	N	O	O
,	x	N	N	O	O

like	eng	N	N	O	O

the	eng	N	N	O	O

one	eng	N	N	O	O

you	eng	N	N	O	O

are	eng	N	N	O	O

participating	eng	N	N	O	O

in	eng	Y	N	O	O
,	x	N	N	O	O

are	eng	N	N	O	O

hosted	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

special	eng	N	N	O	O

software	eng	N	N	O	O
.	m	N	N	O	O

That	eng	N	N	O	O

software	eng	N	N	O	O
,	x	N	N	O	O

among	eng	N	N	O	O

other	eng	N	N	O	O

functions	eng	N	N	O	O
,	x	N	N	O	O

preforms	eng	N	N	O	O

a	x	N	N	O	O

job	eng	N	N	O	O

of	eng	N	N	O	O

accepting	eng	N	N	O	O

and	eng	N	N	O	O

evaluating	eng	N	N	O	O

teams	eng	N	N	O	O
'	x	N	N	O	O

solutions	eng	N	N	O	O

(	x	N	N	O	O
runs	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

displaying	eng	N	N	O	O

results	eng	N	N	O	O

in	eng	Y	N	O	O

a	x	N	N	O	O

rank	eng	N	N	O	O

table	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

scoring	eng	N	N	O	O

rules	eng	N	N	O	O

are	eng	N	N	O	O

as	eng	Y	N	O	O

follows	eng	N	N	O	O
:	x	N	N	O	O

Each	eng	N	N	O	O

run	eng	N	N	O	O

is	eng	N	N	O	O

either	eng	N	N	O	O

accepted	eng	N	N	O	O

or	eng	Y	N	O	O

rejected	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

problem	eng	N	N	O	O

is	eng	N	N	O	O

considered	eng	N	N	O	O

solved	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

team	eng	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

one	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

runs	eng	N	N	O	O

submitted	eng	N	N	O	O

for	eng	Y	N	O	O

it	eng	N	N	O	O

is	eng	N	N	O	O

accepted	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

time	eng	N	N	O	O

consumed	eng	N	N	O	O

for	eng	Y	N	O	O

a	x	N	N	O	O

solved	eng	N	N	O	O

problem	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

time	eng	N	N	O	O

elapsed	eng	N	N	O	O

from	eng	N	N	O	O

the	eng	N	N	O	O

beginning	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

contest	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

submission	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

accepted	eng	N	N	O	O

run	eng	N	N	O	O

for	eng	Y	N	O	O

this	eng	N	N	O	O

problem	eng	N	N	O	O

(	x	N	N	O	O
in	eng	Y	N	O	O

minutes	eng	N	N	O	O
)	x	N	N	O	O

plus	eng	N	N	O	O

20	m	N	N	O	O

minutes	eng	N	N	O	O

for	eng	Y	N	O	O

every	eng	N	N	O	O

other	eng	N	N	O	O

run	eng	N	N	O	O

for	eng	Y	N	O	O

this	eng	N	N	O	O

problem	eng	N	N	O	O

before	eng	N	N	O	O

the	eng	N	N	O	O

accepted	eng	N	N	O	O

one	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

an	eng	Y	N	O	O

unsolved	eng	N	N	O	O

problem	eng	N	N	O	O

consumed	eng	N	N	O	O

time	eng	N	N	O	O

is	eng	N	N	O	O

not	eng	N	N	O	O

computed	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

total	eng	N	N	O	O

time	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

sum	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

time	eng	N	N	O	O

consumed	eng	N	N	O	O

for	eng	Y	N	O	O

each	eng	N	N	O	O

problem	eng	N	N	O	O

solved	eng	N	N	O	O
.	m	N	N	O	O

Teams	eng	N	N	O	O

are	eng	N	N	O	O

ranked	eng	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

solved	eng	N	N	O	O

problems	eng	N	N	O	O
.	m	N	N	O	O

Teams	eng	N	N	O	O

that	eng	N	N	O	O

solve	eng	N	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

problems	eng	N	N	O	O

are	eng	N	N	O	O

ranked	eng	N	N	O	O

by	eng	N	N	O	O

the	eng	N	N	O	O

least	eng	N	N	O	O

total	eng	N	N	O	O

time	eng	N	N	O	O
.	m	N	N	O	O

While	eng	N	N	O	O

the	eng	N	N	O	O

time	eng	N	N	O	O

shown	eng	N	N	O	O

is	eng	N	N	O	O

in	eng	Y	N	O	O

minutes	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

actual	eng	N	N	O	O

time	eng	N	N	O	O

is	eng	N	N	O	O

measured	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

precision	eng	N	N	O	O

of	eng	N	N	O	O

1	x	N	N	O	O

second	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

the	eng	N	N	O	O

seconds	eng	N	N	O	O

are	eng	N	N	O	O

taken	eng	N	N	O	O

into	eng	N	N	O	O

account	eng	N	N	O	O

when	eng	N	N	O	O

ranking	eng	N	N	O	O

teams	eng	N	N	O	O
.	m	N	N	O	O

Teams	eng	N	N	O	O

with	eng	N	N	O	O

equal	eng	N	N	O	O

rank	eng	N	N	O	O

according	eng	N	N	O	O

to	eng	N	N	O	O

the	eng	N	N	O	O

above	eng	N	N	O	O

rules	eng	N	N	O	O

must	eng	N	N	O	O

be	eng	Y	N	O	O

sorted	eng	N	N	O	O

by	eng	N	N	O	O

increasing	eng	N	N	O	O

team	eng	N	N	O	O

number	eng	N	N	O	O
.	m	N	N	O	O

Your	eng	N	N	O	O

task	eng	N	N	O	O

is	eng	N	N	O	O
,	x	N	N	O	O

given	eng	N	N	O	O

the	eng	N	N	O	O

list	eng	N	N	O	O

of	eng	N	N	O	O

N	x	N	N	O	O

runs	eng	N	N	O	O

with	eng	N	N	O	O

submission	eng	N	N	O	O

time	eng	N	N	O	O

and	eng	N	N	O	O

result	eng	N	N	O	O

of	eng	N	N	O	O

each	eng	N	N	O	O

run	eng	N	N	O	O
,	x	N	N	O	O

compute	eng	N	N	O	O

the	eng	N	N	O	O

rank	eng	N	N	O	O

table	eng	N	N	O	O

for	eng	Y	N	O	O

C	x	N	N	O	O

teams	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

Input	eng	N	N	O	O

contains	eng	N	N	O	O

integer	eng	N	N	O	O

numbers	eng	N	N	O	O

C	x	N	N	O	O

N	x	N	N	O	O
,	x	N	N	O	O

followed	eng	N	N	O	O

by	eng	N	N	O	O

N	x	N	N	O	O

quartets	eng	N	N	O	O

of	eng	N	N	O	O

integes	eng	N	N	O	O

ci	eng	N	N	O	O

pi	eng	N	N	O	O

ti	eng	N	N	O	O

ri	eng	Y	N	O	O
,	x	N	N	O	O

where	eng	N	N	O	O

ci	eng	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

team	eng	N	N	O	O

number	eng	N	N	O	O
,	x	N	N	O	O

pi	eng	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

problem	eng	N	N	O	O

number	eng	N	N	O	O
,	x	N	N	O	O

ti	eng	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

submission	eng	N	N	O	O

time	eng	N	N	O	O

in	eng	Y	N	O	O

seconds	eng	N	N	O	O
,	x	N	N	O	O

ri	eng	Y	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

if	eng	N	N	O	O

the	eng	N	N	O	O

run	eng	N	N	O	O

was	eng	N	N	O	O

accepted	eng	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O

otherwise	eng	N	N	O	O
.	m	N	N	O	O

1	x	N	N	O	O

≤	x	N	N	O	O

C	x	N	N	O	O
,	x	N	N	O	O

N	x	N	N	O	O

≤	x	N	N	O	O

1000	m	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O

≤	x	N	N	O	O

ci	eng	N	N	O	O

≤	x	N	N	O	O

C	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O

≤	x	N	N	O	O

pi	eng	N	N	O	O

≤	x	N	N	O	O

20	m	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O

≤	x	N	N	O	O

ti	eng	N	N	O	O

≤	x	N	N	O	O

36000.	m	N	N	O	O

Output	eng	N	N	O	O

Output	eng	N	N	O	O

must	eng	N	N	O	O

contain	eng	N	N	O	O

C	x	N	N	O	O

integers	eng	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

team	eng	N	N	O	O

numbers	eng	N	N	O	O

sorted	eng	N	N	O	O

by	eng	N	N	O	O

rank	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

3	x	N	N	O	O

3	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

3000	m	N	N	O	O

0	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

3100	m	N	N	O	I-OJ

1	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

4200	m	N	N	O	O

1	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

3	x	N	N	O	O

我	r	N	N	O	O
累	v	N	N	O	O
个	q	N	N	O	O
悲剧	n	N	N	O	O
诶	e	N	N	O	O
：	x	N	N	O	O
竟然	d	N	N	O	O
一直	d	N	N	O	O
都	d	N	N	O	O
理解	v	N	N	O	O
错题	n	N	N	O	O
意	n	N	N	O	O
：	x	N	N	O	O
关键	n	N	N	O	O
：	x	N	N	O	O
：	x	N	N	O	O
1	x	N	N	O	O
：	x	N	N	O	O
要	v	N	N	O	O
注意	v	N	N	O	O
输入	v	N	N	O	O
时间	n	N	N	O	O
并不一定	d	N	N	O	O
按	p	N	N	O	O
升序	n	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
要	v	N	N	O	O
对	p	N	N	O	O
输入	v	N	N	O	O
时间	n	N	N	O	O
排序	n	Y	N	O	O
！	x	N	N	O	O
！	x	N	N	O	O

2	x	N	N	O	O
：	x	N	N	O	O
如果	c	N	N	O	O
做	v	N	N	O	O
题	n	N	N	O	O
数目	n	N	N	O	O
相同	d	N	N	O	O
，	x	N	N	O	O
按	p	N	N	O	O
所有	b	N	N	O	O
做	v	N	N	O	O
对	p	N	N	O	O
题目	n	Y	N	O	O
的	uj	N	N	O	O
时间	n	N	N	O	O
总和	n	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE
，	x	N	N	O	O
这样	r	N	N	O	O
才	d	N	N	O	O
叫	v	N	N	O	O
公平	n	Y	N	O	O
！	x	N	N	O	O
！	x	N	N	O	O

3	x	N	N	O	O
：	x	N	N	O	O
只有	c	N	N	O	O
该	r	N	N	O	O
题	n	N	N	O	O
接受	v	N	N	O	O
时	n	N	N	O	O
加罚	vn	N	N	O	O
时	ng	N	N	O	O
才	d	N	N	O	O
有效	a	Y	N	O	O
；	x	N	N	O	O
所以	c	N	N	O	O
要	v	N	N	O	O
注意	v	N	N	O	O
去	v	N	N	O	O
找到	v	N	N	O	O
没有	v	N	N	O	O
接收	v	N	N	O	O
的	uj	N	N	O	O
题	n	N	N	O	O
的	uj	N	N	O	O
加罚	vn	N	N	O	O
时	n	N	N	O	O
，	x	N	N	O	O
并	c	N	N	O	O
加以	v	N	N	O	O
忽略	d	N	N	O	O
；	x	N	N	O	O

4	x	N	N	O	O
：	x	N	N	O	O
最后	f	N	N	O	O
还要	c	N	N	O	O
注意	v	N	N	O	O
一道	m	N	N	O	O
题	n	N	N	O	O
也	d	N	N	O	O
没有	v	N	N	O	O
提交	v	N	N	O	O
的	uj	N	N	O	O
队	n	N	N	O	O
的	uj	N	N	O	O
队号	n	N	N	O	O
存储	j	N	N	O	O
！	x	N	N	O	O
！	x	N	N	O	O
！	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdlib	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

struct	eng	N	N	O	O

stu1	eng	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

c1	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

p1	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

t1	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

r1	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
1150	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

stu2	eng	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

p	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
队号	n	N	N	O	O
；	x	N	N	O	O

int	eng	N	N	O	O

m	x	N	N	O	O
[	x	N	N	O	O
25	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
解决	v	N	N	O	O
的	uj	N	N	O	O
题号	n	N	N	O	O
；	x	N	N	O	O

int	eng	N	N	O	O

num	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
解决	v	N	N	O	O
的	uj	N	N	O	O
题目	n	Y	N	O	O
数	n	N	N	O	O
；	x	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
用	p	N	N	O	O
的	uj	N	N	O	O
时间	n	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

r	x	N	N	O	O
[	x	N	N	O	O
25	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
对应	vn	N	N	O	O
题号	n	N	N	O	O
的	uj	N	N	O	O
加罚	vn	N	N	O	O
时间	n	N	N	O	O
；	x	N	N	O	O

}	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
1150	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cmp1	eng	N	N	O	O
(	x	N	N	O	O
const	eng	N	N	O	O

void	eng	N	N	O	O
*	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
const	eng	N	N	O	O

void	eng	N	N	O	O
*	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

struct	eng	N	N	O	O

stu1	eng	N	N	O	O

*	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
d	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

stu1	eng	N	N	O	O

*	x	N	N	O	O
)	x	N	N	O	O
a	x	N	N	O	O
;	x	N	N	O	O

d	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

stu1	eng	N	N	O	O

*	x	N	N	O	O
)	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t1	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t1	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t1	eng	N	N	O	O
-	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t1	eng	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

return	eng	N	N	O	O

c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
r1	eng	N	N	O	O
-	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
r1	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

cmp2	eng	N	N	O	O
(	x	N	N	O	O
const	eng	N	N	O	O

void	eng	N	N	O	O
*	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
const	eng	N	N	O	O

void	eng	N	N	O	O
*	x	N	N	O	O
b	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

struct	eng	N	N	O	O

stu2	eng	N	N	O	O

*	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
*	x	N	N	O	O
d	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

stu2	eng	N	N	O	O

*	x	N	N	O	O
)	x	N	N	O	O
a	x	N	N	O	O
;	x	N	N	O	O

d	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
struct	eng	N	N	O	O

stu2	eng	N	N	O	O

*	x	N	N	O	O
)	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
-	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
num	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
按	p	N	N	O	O
解决	v	N	N	O	O
题目	n	Y	N	O	O
数	n	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE
；	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O

c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t	x	N	N	O	O
-	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
相同	d	N	N	O	O
题目	n	Y	N	O	O
数	m	N	N	O	O
按	p	N	N	O	O
时间	n	N	N	O	O
升序	n	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE
；	x	N	N	O	O

else	eng	N	N	O	O

return	eng	N	N	O	O

c	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
p	x	N	N	O	O
-	x	N	N	O	O
d	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
解决	v	N	N	O	O
题目	n	Y	N	O	O
数	n	N	N	O	O
相同	d	N	N	O	O
，	x	N	N	O	O
时间	n	N	N	O	O
也	d	N	N	O	O
相同	d	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
按	p	N	N	O	O
队号	n	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE
；	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
c	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
n	eng	N	N	O	O
此	r	N	N	O	O
输入	v	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t1	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

qsort	eng	N	N	O	O
(	x	N	N	O	O
s1	eng	N	N	O	O
,	x	N	N	O	O
n	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
cmp1	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r1	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
没有	v	N	N	O	O
AC	eng	N	N	O	O
；	x	N	N	O	O

{	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
对应	vn	N	N	O	O
队号	n	N	N	O	O
的	uj	N	N	O	O
队号	n	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
m	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
1200	m	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
对应	vn	N	N	O	O
题号	n	N	N	O	O
加上	v	N	N	O	O
加罚	vn	N	N	O	O
时	n	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如	v	N	N	O	O
接受	v	N	N	O	O
；	x	N	N	O	O

{	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
m	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
如	v	N	N	O	O
本	r	N	N	O	O
对	p	N	N	O	O
本题	n	N	N	O	O
是	v	N	N	O	O
第一次	m	N	N	O	O
提交	v	N	N	O	O
成功	a	N	N	O	O
；	x	N	N	O	O

{	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
m	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
输入	v	N	N	O	O
对应	vn	N	N	O	O
题号	n	N	N	O	O
；	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t1	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
t1	eng	N	N	O	O
+	x	N	N	O	O
s	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r	eng	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p1	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
当前	t	N	N	O	O
时间	n	N	N	O	O
加上	v	N	N	O	O
加罚	vn	N	N	O	O
时	n	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
s1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c1	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
num	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
解决	v	N	N	O	O
题目	n	Y	N	O	O
数	m	N	N	O	O
加	v	N	N	O	O
一	m	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
c	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
将	d	N	N	O	O
没有	v	N	N	O	O
提交	v	N	N	O	O
过	ug	N	N	O	O
的	uj	N	N	O	O
队	n	N	N	O	O
的	uj	N	N	O	O
队号	n	N	N	O	O
打上	v	N	N	O	O
；	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
=	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

qsort	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
cmp2	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

"	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
c	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
p	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

Poj	eng	N	Y	B-OJ	O
.	m	N	N	O	O
Grids	eng	N	N	O	O

2764	m	N	N	O	O

数根	m	N	N	O	I-OJ
_	x	N	N	O	O
朗	nr	N	N	O	O
弦	n	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
@	x	N	N	O	O
author	eng	N	N	O	O

langx	eng	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
G	eng	N	N	O	O
++	x	N	N	O	O
4.4	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

char	eng	N	N	O	O

chr	eng	N	N	O	O
[	x	N	N	O	O
1005	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
1005	m	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

alen	eng	N	N	O	O
,	x	N	N	O	O

broot	eng	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O

~	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
s	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
chr	eng	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

chr	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

alen	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

chr	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

'	x	N	N	O	O
\	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
alen	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

chr	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

broot	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O

alen	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

broot	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
计算	v	Y	N	O	O
完	v	N	N	O	O
以后	f	N	N	O	O
broot	eng	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

9	x	N	N	O	O

*	x	N	N	O	O

1000	m	N	N	O	O

=	x	N	N	O	O

9000	m	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
if	eng	N	N	O	O
(	x	N	N	O	O
broot	eng	N	N	O	O

>	x	N	N	O	O

9	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

n	x	N	N	O	O

=	x	N	N	O	O

broot	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O

true	eng	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

broot	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O

n	x	N	N	O	O

)	x	N	N	O	O
{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

broot	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O

%	x	N	N	O	O

10	m	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

n	x	N	N	O	O

/	x	N	N	O	O
=	x	N	N	O	O

10	m	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
broot	eng	N	N	O	O

<	x	N	N	O	O

10	m	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

n	x	N	N	O	O

=	x	N	N	O	O

broot	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
}	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
注意	v	N	N	O	O
到	v	N	N	O	O
任何	r	N	N	O	O
移位	n	N	N	O	O
相加	v	N	N	O	O
前后	f	N	N	O	O
，	x	N	N	O	O
模	n	N	N	O	O
9	m	N	N	O	O
余数	m	N	N	O	O
都	d	N	N	O	O
不变	v	N	N	O	O
。	x	N	N	O	O

broot	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
broot	eng	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

%	x	N	N	O	O

9	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
broot	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

北大	j	N	N	O	O
ACM	eng	N	N	O	O

poj2301	eng	N	Y	B-OJ	B-OJ

-	x	N	N	O	O

gubojun	eng	N	N	O	O
的	uj	N	N	O	O
专栏	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
解方程	nr	N	N	O	O

x	x	N	N	O	O
=	x	N	N	O	O
a	eng	N	N	O	O
+	x	N	N	O	O
b	eng	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
=	x	N	N	O	O
|	x	N	N	O	O
a	x	N	N	O	O
-	x	N	N	O	O
b	x	N	N	O	O
|	x	N	N	O	O
,	x	N	N	O	O
求	v	N	N	O	O
a	eng	N	N	O	O

b	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
time	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

c	x	N	N	O	O
=	x	N	N	O	O
x	x	N	N	O	O
-	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
y	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
c	x	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

puts	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
impossible	eng	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

c	x	N	N	O	O
/	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
c	eng	N	N	O	O
+	x	N	N	O	O
y	eng	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
f	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
(	x	N	N	O	O
float	eng	N	N	O	O
)	x	N	N	O	O
clock	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
CLOCKS	eng	N	N	O	O
_	x	N	N	O	O
PER	eng	N	N	O	O
_	x	N	N	O	O
SEC	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

poj1674	eng	N	Y	B-OJ	B-OJ

-	x	N	N	O	O

Rainy	eng	N	N	O	O

Days	eng	N	N	O	O

-	x	N	N	O	O

博客园	nr	N	N	O	O

简单	a	N	N	O	O
题	n	N	N	O	O

View	eng	N	N	O	O

Code	eng	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O

iostream	eng	N	N	O	O

>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O

cstdlib	eng	N	N	O	O

>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O

cstring	eng	N	N	O	O

>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O

cstdio	eng	N	N	O	O

>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

maxn	eng	N	N	O	O

10005	m	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cnt	eng	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

findit	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O

;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

++	x	N	N	O	O

)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

freopen	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
D	x	N	N	O	O
:	x	N	N	O	O
\	x	N	N	O	O
\	x	N	N	O	O
t	eng	N	N	O	O
.	m	N	N	O	O
txt	eng	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

"	x	N	N	O	O
r	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

stdin	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O

"	x	N	N	O	O

,	x	N	N	O	O

&	x	N	N	O	O

t	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
t	x	N	N	O	O

-	x	N	N	O	O
-	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O

"	x	N	N	O	O

,	x	N	N	O	O

&	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O

;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

++	x	N	N	O	O

)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O

"	x	N	N	O	O

,	x	N	N	O	O

&	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cnt	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O

;	x	N	N	O	O

int	eng	N	N	O	O

temp	eng	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O

;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O

1	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
temp	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

temp	eng	N	N	O	O
)	x	N	N	O	O

temp	eng	N	N	O	O

=	x	N	N	O	O

findit	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
temp	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O

)	x	N	N	O	O

break	eng	N	N	O	O

;	x	N	N	O	O

swap	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
temp	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

a	x	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
[	x	N	N	O	O
temp	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

cnt	eng	N	N	O	O

++	x	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O

"	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O

"	x	N	N	O	O

,	x	N	N	O	O

cnt	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O

;	x	N	N	O	O

}	x	N	N	O	O

