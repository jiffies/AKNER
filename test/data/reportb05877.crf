pku1274	eng	N	Y	B-OJ
（	x	N	N	O
基本	n	N	N	O
的	uj	N	N	O
二分	m	Y	N	B-KNOWLEDGE
图	n	N	N	I-KNOWLEDGE
最大	a	Y	N	O
匹配	v	Y	N	O
）	x	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
弓	n	N	N	O
虽	c	N	N	O
子	n	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
博客	nr	N	N	O
频道	n	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
CSDN	eng	N	N	O
.	m	N	N	O
NET	eng	N	N	O

	x	N	N	O

	x	N	N	O
http	eng	N	N	O
:	x	N	N	O
/	x	N	N	O
/	x	N	N	O
162.105.81.212	m	N	N	O
/	x	N	N	O
JudgeOnline	eng	N	N	O
/	x	N	N	O
problem	eng	N	N	O
?	x	N	N	O
id	eng	N	N	O
=	x	N	N	O
1274	m	N	N	O

	x	N	N	O
题意	n	N	N	O
：	x	N	N	O
有	v	N	N	O
m	eng	N	N	O
头	n	N	N	O
奶牛	n	N	N	O
和	c	N	N	O
n	eng	N	N	O
个	m	N	N	O
牛棚	n	N	N	O
，	x	N	N	O
其中	r	N	N	O
每	r	N	N	O
头	n	N	N	O
奶牛	n	N	N	O
只	d	N	N	O
愿意	v	N	N	O
进	v	N	N	O
它	r	N	N	O
愿意	v	N	N	O
进	v	N	N	O
的	uj	N	N	O
牛棚	n	N	N	O
。	x	N	N	O

也许	d	N	N	O
每	zg	N	N	O
头牛	n	N	N	O
只	d	N	N	O
愿进	v	N	N	O
一个	m	N	N	O
棚	n	N	N	O
，	x	N	N	O
也许	d	N	N	O
一个	m	N	N	O
棚	n	N	N	O
只	d	N	N	O
容纳	nr	N	N	O
一头	m	N	N	O
牛	n	N	N	O
。	x	N	N	O

现在	t	N	N	O
给定	v	N	N	O
m	eng	N	N	O
头年	n	N	N	O
和	c	N	N	O
n	eng	N	N	O
个	m	N	N	O
牛棚	n	N	N	O
，	x	N	N	O
并且	c	N	N	O
给定	v	N	N	O
每	zg	N	N	O
头牛	n	N	N	O
愿意	v	N	N	O
进	v	N	N	O
的	uj	N	N	O
牛棚	n	N	N	O
编号	n	N	N	O
，	x	N	N	O
请	v	N	N	O
让	v	N	N	O
你	r	N	N	O
设计	vn	N	N	O
一种	m	N	N	O
牛	n	N	N	O
对	p	N	N	O
棚	n	N	N	O
的	uj	N	N	O
方案	n	N	N	O
，	x	N	N	O
使	v	N	N	O
牛	n	N	N	O
—	x	N	N	O
—	x	N	N	O
棚	n	N	N	O
的	uj	N	N	O
匹配	v	Y	N	O
数	n	N	N	O
最大	a	Y	N	O
，	x	N	N	O
并	c	N	N	O
输出	v	Y	N	O
这个	r	N	N	O
最大	a	Y	N	O
匹配	v	Y	N	O
值	n	N	N	O
。	x	N	N	O


	x	N	N	O
思路	n	N	N	O
：	x	N	N	O
其实	d	N	N	O
这	r	N	N	O
题	n	N	N	O
就是	d	N	N	O
求	v	N	N	O
一个	m	N	N	O
二分	m	Y	N	B-KNOWLEDGE
图	n	N	N	I-KNOWLEDGE
最大	a	Y	N	O
匹配	v	Y	N	O
。	x	N	N	O


	x	N	N	O
下面	f	N	N	O
是	v	N	N	O
用	p	N	N	O
邻接矩阵	nz	N	N	B-KNOWLEDGE
写	v	N	N	O
的	uj	N	N	O
AC	eng	N	N	O
~	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
iostream	eng	N	N	O
>	x	N	N	O

	x	N	N	O
using	eng	N	N	O
 	x	N	N	O
namespace	eng	N	N	O
 	x	N	N	O
std	eng	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
maxn	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
201	m	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
maxm	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
201	m	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
uN	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
vN	eng	N	N	O
;	x	N	N	O

	x	N	N	O
bool	eng	N	N	O
 	x	N	N	O
g	x	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
xM	eng	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
yM	eng	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
bool	eng	N	N	O
 	x	N	N	O
chk	eng	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
bool	eng	N	N	O
 	x	N	N	O
find	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
u	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
v	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
v	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
v	x	N	N	O
<	x	N	N	O
=	x	N	N	O
vN	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
v	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
g	x	N	N	O
[	x	N	N	O
u	x	N	N	O
]	x	N	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
 	x	N	N	O
&&	x	N	N	O
 	x	N	N	O
!	x	N	N	O
chk	eng	N	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
chk	eng	N	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
true	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
yM	eng	N	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
1	x	N	N	O
 	x	N	N	O
|	x	N	N	O
|	x	N	N	O
 	x	N	N	O
find	eng	N	N	O
(	x	N	N	O
yM	eng	N	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
)	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
yM	eng	N	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
u	x	N	N	O
;	x	N	N	O
 	x	N	N	O
xM	eng	N	N	O
[	x	N	N	O
u	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
v	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
true	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
false	eng	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
MaxMatch	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
u	x	N	N	O
,	x	N	N	O
 	x	N	N	O
ret	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
xM	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
 	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
xM	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
yM	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
 	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
yM	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
u	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
u	x	N	N	O
<	x	N	N	O
=	x	N	N	O
uN	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
u	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
xM	eng	N	N	O
[	x	N	N	O
u	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
chk	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
false	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
chk	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
find	eng	N	N	O
(	x	N	N	O
u	x	N	N	O
)	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
ret	eng	N	N	O
++	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
ret	eng	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
,	x	N	N	O
 	x	N	N	O
j	x	N	N	O
,	x	N	N	O
 	x	N	N	O
k	x	N	N	O
,	x	N	N	O
 	x	N	N	O
x	x	N	N	O
,	x	N	N	O
 	x	N	N	O
y	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
ans	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
cin	eng	N	N	O
>	x	N	N	O
>	x	N	N	O
uN	eng	N	N	O
>	x	N	N	O
>	x	N	N	O
vN	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
0	m	N	N	O
ms	eng	N	N	O

	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
uN	eng	N	N	O
,	x	N	N	O
&	x	N	N	O
vN	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
EOF	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
16	m	N	N	O
ms	eng	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
g	x	N	N	O
,	x	N	N	O
 	x	N	N	O
false	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
g	x	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
x	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
x	x	N	N	O
<	x	N	N	O
=	x	N	N	O
uN	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
x	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
cin	eng	N	N	O
>	x	N	N	O
>	x	N	N	O
k	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
k	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
j	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
j	x	N	N	O
<	x	N	N	O
=	x	N	N	O
k	x	N	N	O
;	x	N	N	O
 	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
cin	eng	N	N	O
>	x	N	N	O
>	x	N	N	O
y	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
y	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
g	x	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
[	x	N	N	O
y	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
true	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
ans	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
MaxMatch	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
cout	eng	N	N	O
<	x	N	N	O
<	x	N	N	O
ans	eng	N	N	O
<	x	N	N	O
<	x	N	N	O
endl	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
ans	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O
 	x	N	N	O

	x	N	N	O
但是	c	N	N	O
用	p	N	N	O
链表	n	Y	N	B-KNOWLEDGE
写	v	N	N	O
的	uj	N	N	O
就	d	N	N	O
超时	b	N	N	O
：	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
iostream	eng	N	N	O
>	x	N	N	O

	x	N	N	O
using	eng	N	N	O
 	x	N	N	O
namespace	eng	N	N	O
 	x	N	N	O
std	eng	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
maxn	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
201	m	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
maxm	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
201	m	N	N	O
;	x	N	N	O

	x	N	N	O
struct	eng	N	N	O
 	x	N	N	O
gtype	eng	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
x	x	N	N	O
,	x	N	N	O
 	x	N	N	O
y	x	N	N	O
,	x	N	N	O
 	x	N	N	O
next	eng	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O
;	x	N	N	O

	x	N	N	O
gtype	eng	N	N	O
 	x	N	N	O
g	x	N	N	O
[	x	N	N	O
maxm	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
first	eng	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
link	eng	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
bool	eng	N	N	O
 	x	N	N	O
used	eng	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
,	x	N	N	O
 	x	N	N	O
m	x	N	N	O
,	x	N	N	O
 	x	N	N	O
tot	eng	N	N	O
;	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
add	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
x	x	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
y	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
tot	eng	N	N	O
++	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
g	x	N	N	O
[	x	N	N	O
tot	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
x	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
x	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
g	x	N	N	O
[	x	N	N	O
tot	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
y	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
y	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
g	x	N	N	O
[	x	N	N	O
tot	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
next	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
first	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
first	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
tot	eng	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
bool	eng	N	N	O
 	x	N	N	O
find	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
s	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
temp	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
temp	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
first	eng	N	N	O
[	x	N	N	O
s	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
temp	eng	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
!	x	N	N	O
used	eng	N	N	O
[	x	N	N	O
g	x	N	N	O
[	x	N	N	O
temp	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
y	eng	N	N	O
]	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
used	eng	N	N	O
[	x	N	N	O
g	x	N	N	O
[	x	N	N	O
temp	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
y	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
true	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
link	eng	N	N	O
[	x	N	N	O
g	x	N	N	O
[	x	N	N	O
temp	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
y	eng	N	N	O
]	x	N	N	O
=	x	N	N	O
=	x	N	N	O
0	x	N	N	O
 	x	N	N	O
|	x	N	N	O
|	x	N	N	O
 	x	N	N	O
find	eng	N	N	O
(	x	N	N	O
link	eng	N	N	O
[	x	N	N	O
g	x	N	N	O
[	x	N	N	O
temp	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
y	eng	N	N	O
]	x	N	N	O
)	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
link	eng	N	N	O
[	x	N	N	O
g	x	N	N	O
[	x	N	N	O
temp	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
y	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
s	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
true	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
temp	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
g	x	N	N	O
[	x	N	N	O
temp	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
next	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
false	eng	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
,	x	N	N	O
 	x	N	N	O
j	x	N	N	O
,	x	N	N	O
 	x	N	N	O
k	x	N	N	O
,	x	N	N	O
 	x	N	N	O
x	x	N	N	O
,	x	N	N	O
 	x	N	N	O
y	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
ans	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
n	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
m	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
EOF	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
x	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
x	x	N	N	O
<	x	N	N	O
=	x	N	N	O
n	x	N	N	O
;	x	N	N	O
 	x	N	N	O
x	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
k	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
j	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
j	x	N	N	O
<	x	N	N	O
=	x	N	N	O
k	x	N	N	O
;	x	N	N	O
 	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
y	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
add	eng	N	N	O
(	x	N	N	O
x	x	N	N	O
,	x	N	N	O
 	x	N	N	O
y	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
link	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
0	x	N	N	O
,	x	N	N	O
 	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
link	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	x	N	N	O
<	x	N	N	O
=	x	N	N	O
n	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
used	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
false	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
used	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
find	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
ans	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	x	N	N	O
<	x	N	N	O
=	x	N	N	O
n	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
link	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
ans	eng	N	N	O
++	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
ans	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O
 	x	N	N	O

	x	N	N	O