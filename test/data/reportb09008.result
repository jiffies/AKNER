又	d	N	N	O	O
一线	m	N	N	O	O
段树	nr	Y	N	O	O

PKU	eng	N	Y	O	B-OJ

2464	m	N	N	O	I-OJ
_	x	N	N	O	O
下雪	v	N	N	O	O
的	uj	N	N	O	O
天空	n	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

题目	n	Y	N	O	O
的	uj	N	N	O	O
意思	n	N	N	O	O
是	v	N	N	O	O
Stan	eng	N	N	O	O
和	c	N	N	O	O
Ollie	eng	N	N	O	O
玩	n	N	N	O	O
一个	m	N	N	O	O
游戏	n	Y	N	O	O
，	x	N	N	O	O
在	p	N	N	O	O
一个	m	N	N	O	O
平面	n	Y	N	O	O
上	f	N	N	O	O
有	v	N	N	O	O
很多	m	N	N	O	O
点	m	N	N	O	O
，	x	N	N	O	O
Stan	eng	N	N	O	O
选择	v	N	N	O	O
一个点	m	N	N	O	O
，	x	N	N	O	O
通过	p	N	N	O	O
这个	r	N	N	O	O
点	m	N	N	O	O
作	n	N	N	O	O
y	eng	N	N	O	O
轴	n	N	N	O	O
，	x	N	N	O	O
在	p	N	N	O	O
这条	mq	N	N	O	O
直线	n	Y	N	O	O
通过	p	N	N	O	O
的	uj	N	N	O	O
点中	v	N	N	O	O
选择	v	N	N	O	O
一个点	m	N	N	O	O
（	x	N	N	O	O
有	v	N	N	O	O
可能	v	N	N	O	O
会	v	N	N	O	O
多个	m	N	N	O	O
，	x	N	N	O	O
因为	c	N	N	O	O
x	eng	N	N	O	O
会	v	N	N	O	O
一样	r	N	N	O	O
）	x	N	N	O	O
,	x	N	N	O	O

然后	c	N	N	O	O
Ollie	eng	N	N	O	O
通过	p	N	N	O	O
这个	r	N	N	O	O
点	m	N	N	O	O
作	n	N	N	O	O
一个	m	N	N	O	O
x	eng	N	N	O	O
轴	n	N	N	O	O
,	x	N	N	O	O
于是	c	N	N	O	O
Stan	eng	N	N	O	O
的	uj	N	N	O	O
分数	n	Y	N	O	O
就是	d	N	N	O	O
第一	m	N	N	O	O
象限	n	N	N	O	O
然	r	N	N	O	O
和	c	N	N	O	O
第三	m	N	N	O	O
象限	n	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
，	x	N	N	O	O
Ollie	eng	N	N	O	O
的	uj	N	N	O	O
分数	n	Y	N	O	O
是	v	N	N	O	O
第二	m	Y	N	O	O
和	c	N	N	O	O
第四	m	N	N	O	O
象限	n	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O
。	x	N	N	O	O

由于	c	N	N	O	O
2	x	N	N	O	O
个人	n	N	N	O	O
都	d	N	N	O	O
想	v	N	N	O	O
分数	n	Y	N	O	O
最高	a	N	N	O	O
，	x	N	N	O	O
Stan	eng	N	N	O	O
会	v	N	N	O	O
让	v	N	N	O	O
所取	v	N	N	O	O
y	eng	N	N	O	O
轴	n	N	N	O	O
通过	p	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
的	uj	N	N	O	O
分数	n	Y	N	O	O
的	uj	N	N	O	O
最小值	l	N	N	O	O
，	x	N	N	O	O
在	p	N	N	O	O
这些	r	N	N	O	O
所有	b	N	N	O	O
的	uj	N	N	O	O
最小值	l	N	N	O	O
中	f	N	N	O	O
取	v	N	N	O	O
最大值	l	N	N	O	O
，	x	N	N	O	O
同样	d	N	N	O	O
Ollie	eng	N	N	O	O
会	v	N	N	O	O
在	p	N	N	O	O
Stan	eng	N	N	O	O
取到	v	N	N	O	O
的	uj	N	N	O	O
y	eng	N	N	O	O
轴	n	N	N	O	O
中选	j	N	N	O	O
自己	r	N	N	O	O
分数	n	Y	N	O	O
最大	a	Y	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
，	x	N	N	O	O
现在	t	N	N	O	O
要求	v	N	N	O	O
输出	v	Y	N	O	O
Stan	eng	N	N	O	O
和	c	N	N	O	O
Ollie	eng	N	N	O	O
能	v	N	N	O	O
取到	v	N	N	O	O
的	uj	N	N	O	O
最大值	l	N	N	O	O
。	x	N	N	O	O

似乎	d	N	N	O	O
，	x	N	N	O	O
这样	r	N	N	O	O
分析	vn	N	N	O	O
下来	t	N	N	O	O
，	x	N	N	O	O
这个	r	N	N	O	O
题	n	N	N	O	O
不难	d	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
只要	c	N	N	O	O
对	p	N	N	O	O
x	eng	N	N	O	O
排序	n	Y	N	O	B-KNOWLEDGE
,	x	N	N	O	O
然后	c	N	N	O	O
遍历	v	Y	N	O	O
一遍	m	N	N	O	O
，	x	N	N	O	O
每次	r	N	N	O	O
算出	v	N	N	O	O
它	r	N	N	O	O
所得	v	N	N	O	O
的	uj	N	N	O	O
分数	n	Y	N	O	O
，	x	N	N	O	O
注意	v	N	N	O	O
上述	b	N	N	O	O
中	f	N	N	O	O
说	v	N	N	O	O
的	uj	N	N	O	O
在	p	N	N	O	O
同一	b	N	N	O	O
直线	n	Y	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O
，	x	N	N	O	O
但是	c	N	N	O	O
再	d	N	N	O	O
一看	u	N	N	O	O
数据	n	N	N	O	O
是	v	N	N	O	O
200000	m	N	N	O	O
，	x	N	N	O	O
5	m	N	N	O	O
S	eng	N	N	O	O
,	x	N	N	O	O
普通	nz	N	N	O	O
的	uj	N	N	O	O
查询	v	N	N	O	O
肯定	v	N	N	O	O
是	v	N	N	O	O
不	d	N	N	O	O
可以	c	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
肯定	v	N	N	O	O
会	v	N	N	O	O
卡	n	N	N	O	O
时间	n	N	N	O	O
，	x	N	N	O	O
于是	c	N	N	O	O
想	v	N	N	O	O
某种	r	N	N	O	O
结构	n	Y	N	O	O
，	x	N	N	O	O
可以	c	N	N	O	O
快速	d	Y	N	O	O
查询	v	N	N	O	O
以及	c	N	N	O	O
维护	v	Y	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
最终	d	N	N	O	O
应该	v	N	N	O	O
可以	c	N	N	O	O
是	v	N	N	O	O
查找	v	Y	N	O	B-KNOWLEDGE
树	v	N	N	O	I-KNOWLEDGE
，	x	N	N	O	O
不过	c	N	N	O	O
我	r	N	N	O	O
用	p	N	N	O	O
了	ul	N	N	O	O
线段	n	Y	N	O	B-KNOWLEDGE
树来	v	N	N	O	I-KNOWLEDGE
实现	v	N	N	O	O
，	x	N	N	O	O
还有	v	N	N	O	O
考虑	v	N	N	O	O
有	v	N	N	O	O
负数	n	N	N	O	O
，	x	N	N	O	O
而且	c	N	N	O	O
没有	v	N	N	O	O
给	p	N	N	O	O
数	m	N	N	O	O
的	uj	N	N	O	O
范围	n	N	N	O	O
，	x	N	N	O	O
于是	c	N	N	O	O
考虑	v	N	N	O	O
给	p	N	N	O	O
y	eng	N	N	O	O
离散	v	Y	N	O	B-KNOWLEDGE
化	n	N	N	O	I-KNOWLEDGE
。	x	N	N	O	O

代码	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
vector	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

inf	eng	N	N	O	O

1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
30	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

max	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
x	x	N	N	O	O
>	x	N	N	O	O
y	x	N	N	O	O
?	x	N	N	O	O
x	x	N	N	O	O
:	x	N	N	O	O
y	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

min	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
)	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
y	x	N	N	O	O
?	x	N	N	O	O
x	x	N	N	O	O
:	x	N	N	O	O
y	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

maxn	eng	N	N	O	O

200020	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

maxt	eng	N	N	O	O

1000000	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

l	x	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
)	x	N	N	O	O

a	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

r	x	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
)	x	N	N	O	O

(	x	N	N	O	O
a	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

tmp	eng	N	N	O	O
,	x	N	N	O	O
tt	eng	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
t1	eng	N	N	O	O
,	x	N	N	O	O
t2	eng	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
,	x	N	N	O	O
pos	eng	N	N	O	O
,	x	N	N	O	O
ans1	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
ans2	eng	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

vector	eng	N	N	O	O
<	x	N	N	O	O
int	eng	N	N	O	O
>	x	N	N	O	O

mm	eng	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

point	eng	N	N	O	O

{	x	N	N	O	O

bool	eng	N	N	O	O

operator	eng	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
const	eng	N	N	O	O

point	eng	N	N	O	O
&	x	N	N	O	O

t	x	N	N	O	O
)	x	N	N	O	O
const	eng	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

x	x	N	N	O	O
<	x	N	N	O	O
t	eng	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

point	eng	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

py	eng	N	N	O	O

{	x	N	N	O	O

bool	eng	N	N	O	O

operator	eng	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
const	eng	N	N	O	O

py	eng	N	N	O	O
&	x	N	N	O	O

t	x	N	N	O	O
)	x	N	N	O	O
const	eng	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

y	x	N	N	O	O
<	x	N	N	O	O
t	eng	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

id	eng	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

py	eng	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
maxn	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

segment	eng	N	N	O	O
_	x	N	N	O	O
tree	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
,	x	N	N	O	O
count	eng	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
count	eng	N	N	O	O
用来	v	N	N	O	O
记录	n	Y	N	O	O
值	n	N	N	O	O

}	x	N	N	O	O
;	x	N	N	O	O

segment	eng	N	N	O	O
_	x	N	N	O	O
tree	eng	N	N	O	O

tree	eng	N	N	O	O
[	x	N	N	O	O
maxt	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

node	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
l	eng	N	N	O	O
=	x	N	N	O	O
l	x	N	N	O	O
;	x	N	N	O	O

tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r	eng	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O

tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
count	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

node	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
if	eng	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
maxt	eng	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
l	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
l	eng	N	N	O	O
&&	x	N	N	O	O
tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
count	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
r	eng	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
update	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
>	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
update	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
count	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
更新	d	N	N	O	O
出比	v	N	N	O	O
查询	v	N	N	O	O
值	n	N	N	O	O
小	a	N	N	O	O
的	uj	N	N	O	O
数	m	N	N	O	O
的	uj	N	N	O	O
个数	n	Y	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

query	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

node	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

r	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
if	eng	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
maxt	eng	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

segment	eng	N	N	O	O
_	x	N	N	O	O
tree	eng	N	N	O	O

*	x	N	N	O	O
tt	eng	N	N	O	O
=	x	N	N	O	O
&	x	N	N	O	O
tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tt	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
l	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
l	eng	N	N	O	O
&&	x	N	N	O	O
tt	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
r	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

tree	eng	N	N	O	O
[	x	N	N	O	O
node	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
count	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

mid	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
tt	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
l	eng	N	N	O	O
+	x	N	N	O	O
tt	eng	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
>	x	N	N	O	O
>	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

query	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
>	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
return	eng	N	N	O	O

query	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

return	eng	N	N	O	O

query	eng	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
l	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
query	eng	N	N	O	O
(	x	N	N	O	O
r	x	N	N	O	O
(	x	N	N	O	O
node	eng	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
mid	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
&&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
p	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
y	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
对	p	N	N	O	O
y	eng	N	N	O	O
排序	n	Y	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
++	x	N	N	O	O
j	eng	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
id	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
对	p	N	N	O	O
y	eng	N	N	O	O
离散	v	Y	N	O	B-KNOWLEDGE
化	n	N	N	O	I-KNOWLEDGE

++	x	N	N	O	O
j	eng	N	N	O	O
;	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O
p	eng	N	N	O	O
+	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

p	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
inf	eng	N	N	O	O
;	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
先正	d	N	N	O	O
方向	n	N	N	O	O
查	v	N	N	O	O
一次	m	N	N	O	O
，	x	N	N	O	O
记录	n	Y	N	O	O
了	ul	N	N	O	O
第二	m	Y	N	O	O
三	m	N	N	O	O
象限	n	N	N	O	O
的	uj	N	N	O	O
值	n	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

ans1	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

ans2	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

t1	eng	N	N	O	O
=	x	N	N	O	O
t2	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	m	N	N	O	O
&&	x	N	N	O	O
p	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
>	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
++	x	N	N	O	O
t1	eng	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
<	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
++	x	N	N	O	O
t2	eng	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

ans1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
query	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
t1	eng	N	N	O	O
;	x	N	N	O	O

ans2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
query	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
t2	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

build	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
反	zg	N	N	O	O
方向	n	N	N	O	O
一次	m	N	N	O	O
，	x	N	N	O	O
记录	n	Y	N	O	O
一	m	N	N	O	O
四	m	N	N	O	O
象限	n	N	N	O	O
的	uj	N	N	O	O
值	n	N	N	O	O

t1	eng	N	N	O	O
=	x	N	N	O	O
t2	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
t	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

t1	eng	N	N	O	O
=	x	N	N	O	O
t2	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
t	eng	N	N	O	O
&&	x	N	N	O	O
p	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
>	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
++	x	N	N	O	O
t1	eng	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
<	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
++	x	N	N	O	O
t2	eng	N	N	O	O
;	x	N	N	O	O

k	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

update	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

ans1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
query	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
t2	eng	N	N	O	O
;	x	N	N	O	O

ans2	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
query	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
t1	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
inf	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

tt	eng	N	N	O	O
=	x	N	N	O	O
ans1	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
p	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tt	eng	N	N	O	O
>	x	N	N	O	O
ans1	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
tt	eng	N	N	O	O
=	x	N	N	O	O
ans1	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
j	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tt	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
ans	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
tmp	eng	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
,	x	N	N	O	O
ans2	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

mm	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
tt	eng	N	N	O	O
>	x	N	N	O	O
ans	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
tt	eng	N	N	O	O
;	x	N	N	O	O

mm	eng	N	N	O	O
.	m	N	N	O	O
clear	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tmp	eng	N	N	O	O
=	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
k	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O
tmp	eng	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
,	x	N	N	O	O
ans2	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

mm	eng	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
tmp	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
Stan	eng	N	N	O	O
:	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
;	x	N	N	O	O

Ollie	eng	N	N	O	O
:	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

sort	eng	N	N	O	O
(	x	N	N	O	O
mm	eng	N	N	O	O
.	m	N	N	O	O
begin	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
mm	eng	N	N	O	O
.	m	N	N	O	O
end	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
mm	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tt	eng	N	N	O	O
=	x	N	N	O	O
mm	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
mm	eng	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
mm	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
tt	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
mm	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

tt	eng	N	N	O	O
=	x	N	N	O	O
mm	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
;	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

mm	eng	N	N	O	O
.	m	N	N	O	O
clear	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

