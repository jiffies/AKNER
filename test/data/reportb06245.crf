pku1178	eng	N	Y	B-OJ
解题	n	N	N	O
报告	n	N	N	O
_	x	N	N	O
.....	m	N	N	O
_	x	N	N	O
百度	n	N	N	O
空间	n	N	N	O

	x	N	N	O

	x	N	N	O
http	eng	N	N	O
:	x	N	N	O
/	x	N	N	O
/	x	N	N	O
162.105.81.212	m	N	N	O
/	x	N	N	O
JudgeOnline	eng	N	N	O
/	x	N	N	O
problem	eng	N	N	O
?	x	N	N	O
id	eng	N	N	O
=	x	N	N	O
1178	m	N	N	O

	x	N	N	O
题意	n	N	N	O
：	x	N	N	O
一个	m	N	N	O
棋盘	n	Y	N	O
（	x	N	N	O
8	x	N	N	O
*	x	N	N	O
8	x	N	N	O
）	x	N	N	O
，	x	N	N	O
一个	m	N	N	O
王	nr	N	N	O
，	x	N	N	O
还有	v	N	N	O
n	eng	N	N	O
个	m	N	N	O
马	n	N	N	O
（	x	N	N	O
n	eng	N	N	O
不	c	N	N	O
确定	v	N	N	O
）	x	N	N	O
，	x	N	N	O
马有马	nr	N	N	O
的	uj	N	N	O
走法	n	N	N	O
，	x	N	N	O
王有王	nr	N	N	O
的	uj	N	N	O
走法	n	N	N	O
，	x	N	N	O
还有	v	N	N	O
当	p	N	N	O
王和马	nr	N	N	O
走到	v	N	N	O
一个	m	N	N	O
格子	n	N	N	O
上时	t	N	N	O
，	x	N	N	O
马	n	N	N	O
可以	c	N	N	O
带	v	N	N	O
着	uz	N	N	O
王	nr	N	N	O
走	v	N	N	O
，	x	N	N	O
输入	v	N	N	O
一串	m	N	N	O
字符	n	Y	N	O
，	x	N	N	O
字母	n	Y	N	O
代表	n	N	N	O
x	x	N	N	O
坐标	v	Y	N	O
，	x	N	N	O
数字	n	Y	N	O
代表	n	N	N	O
y	x	N	N	O
坐标	v	Y	N	O
，	x	N	N	O
问	n	N	N	O
最少	d	N	N	O
经过	p	N	N	O
多少	m	N	N	O
步	n	N	N	O
可以	c	N	N	O
使	v	N	N	O
棋盘	n	Y	N	O
上	f	N	N	O
的	uj	N	N	O
棋子	n	N	N	O
都	d	N	N	O
到达	v	N	N	O
同一个	b	N	N	O
格子	n	N	N	O
？	x	N	N	O

	x	N	N	O
分析	vn	N	N	O
：	x	N	N	O
先	d	N	N	O
按照	p	N	N	O
马	n	N	N	O
走	v	N	N	O
的	uj	N	N	O
线路	n	N	N	O
建图	n	Y	N	O
，	x	N	N	O
然后	c	N	N	O
用	p	N	N	O
floyd	eng	Y	N	B-KNOWLEDGE
算出	v	N	N	O
每	r	N	N	O
两个	m	N	N	O
点	m	N	N	O
之间	f	N	N	O
的	uj	N	N	O
最小	a	Y	N	O
步数	n	N	N	O
，	x	N	N	O
接着就是	l	N	N	O
枚举	nz	Y	N	O
，	x	N	N	O
第一步	m	N	N	O
枚举	nz	Y	N	O
可能	v	N	N	O
的	uj	N	N	O
汇聚	v	N	N	O
点	m	N	N	O
，	x	N	N	O
第二步	m	N	N	O
枚举	nz	Y	N	O
一个	m	N	N	O
马	n	N	N	O
带走	v	N	N	O
王	nr	N	N	O
的	uj	N	N	O
点	m	N	N	O
，	x	N	N	O
最后	f	N	N	O
就是	d	N	N	O
枚举	nz	Y	N	O
每个	r	N	N	O
马	n	N	N	O
的	uj	N	N	O
位置	v	N	N	O
，	x	N	N	O
计算	v	Y	N	O
出	v	N	N	O
最小	a	Y	N	O
的	uj	N	N	O
步数	n	N	N	O
。	x	N	N	O


	x	N	N	O
代码	n	N	N	O
及	c	N	N	O
部分	n	Y	N	O
注释	v	N	N	O
：	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
stdio	eng	N	N	O
.	m	N	N	O
h	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
string	eng	N	N	O
.	m	N	N	O
h	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
math	eng	N	N	O
.	m	N	N	O
h	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
define	eng	N	N	O
 	x	N	N	O
MAX	eng	N	N	O
 	x	N	N	O
70	m	N	N	O

	x	N	N	O
#	x	N	N	O
define	eng	N	N	O
 	x	N	N	O
INF	eng	N	N	O
 	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
29	m	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
sx	eng	N	N	O
,	x	N	N	O
sy	eng	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
dx	eng	N	N	O
[	x	N	N	O
MAX	eng	N	N	O
]	x	N	N	O
,	x	N	N	O
dy	eng	N	N	O
[	x	N	N	O
MAX	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
char	eng	N	N	O
 	x	N	N	O
ch	eng	Y	N	O
[	x	N	N	O
MAX	eng	N	N	O
*	x	N	N	O
2	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
ix	eng	N	N	O
[	x	N	N	O
]	x	N	N	O
=	x	N	N	O
{	x	N	N	O
1	x	N	N	O
,	x	N	N	O
1	x	N	N	O
,	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
2	x	N	N	O
,	x	N	N	O
2	x	N	N	O
,	x	N	N	O
-	x	N	N	O
2	x	N	N	O
,	x	N	N	O
-	x	N	N	O
2	x	N	N	O
}	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
iy	eng	N	N	O
[	x	N	N	O
]	x	N	N	O
=	x	N	N	O
{	x	N	N	O
2	x	N	N	O
,	x	N	N	O
-	x	N	N	O
2	x	N	N	O
,	x	N	N	O
2	x	N	N	O
,	x	N	N	O
-	x	N	N	O
2	x	N	N	O
,	x	N	N	O
1	x	N	N	O
,	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
1	x	N	N	O
,	x	N	N	O
-	x	N	N	O
1	x	N	N	O
}	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
MAX	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
MAX	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
,	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
b	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
a	x	N	N	O
>	x	N	N	O
b	x	N	N	O
)	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
b	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
bool	eng	N	N	O
 	x	N	N	O
check	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
x	x	N	N	O
,	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
y	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
(	x	N	N	O
x	x	N	N	O
>	x	N	N	O
=	x	N	N	O
0	m	N	N	O
&&	x	N	N	O
y	eng	N	N	O
>	x	N	N	O
=	x	N	N	O
0	m	N	N	O
&&	x	N	N	O
x	eng	N	N	O
<	x	N	N	O
8	m	N	N	O
&&	x	N	N	O
y	eng	N	N	O
<	x	N	N	O
8	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
init	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
/	x	N	N	O
/	x	N	N	O
建图	n	Y	N	O
 	x	N	N	O
以	p	N	N	O
马	n	N	N	O
走	v	N	N	O
的	uj	N	N	O
路线	n	N	N	O
建图	n	Y	N	O
 	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
,	x	N	N	O
j	x	N	N	O
,	x	N	N	O
k	x	N	N	O
,	x	N	N	O
x	x	N	N	O
,	x	N	N	O
y	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
dis	eng	N	N	O
,	x	N	N	O
0	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
dis	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
64	m	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
j	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
j	x	N	N	O
<	x	N	N	O
64	m	N	N	O
;	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
=	x	N	N	O
INF	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
8	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
j	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
j	x	N	N	O
<	x	N	N	O
8	x	N	N	O
;	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
k	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
k	x	N	N	O
<	x	N	N	O
8	x	N	N	O
;	x	N	N	O
k	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
x	x	N	N	O
=	x	N	N	O
ix	eng	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
+	x	N	N	O
i	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
y	x	N	N	O
=	x	N	N	O
iy	eng	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
+	x	N	N	O
j	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
!	x	N	N	O
check	eng	N	N	O
(	x	N	N	O
x	x	N	N	O
,	x	N	N	O
y	x	N	N	O
)	x	N	N	O
)	x	N	N	O
continue	eng	N	N	O
;	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
*	x	N	N	O
8	m	N	N	O
+	x	N	N	O
j	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
x	x	N	N	O
*	x	N	N	O
8	m	N	N	O
+	x	N	N	O
y	eng	N	N	O
]	x	N	N	O
=	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
*	x	N	N	O
8	m	N	N	O
+	x	N	N	O
y	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
*	x	N	N	O
8	m	N	N	O
+	x	N	N	O
j	eng	N	N	O
]	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
floyd	eng	Y	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
,	x	N	N	O
j	x	N	N	O
,	x	N	N	O
k	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
k	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
k	x	N	N	O
<	x	N	N	O
64	m	N	N	O
;	x	N	N	O
k	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
64	m	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
j	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
j	x	N	N	O
<	x	N	N	O
64	m	N	N	O
;	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
>	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
+	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
=	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
+	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
;	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O
 	x	N	N	O

	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
64	m	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
fun	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
,	x	N	N	O
j	x	N	N	O
,	x	N	N	O
c	x	N	N	O
,	x	N	N	O
k	x	N	N	O
,	x	N	N	O
tmp	eng	N	N	O
,	x	N	N	O
ans	eng	N	N	O
=	x	N	N	O
INF	eng	N	N	O
,	x	N	N	O
min	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
64	m	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
/	x	N	N	O
/	x	N	N	O
枚举	nz	Y	N	O
可能	v	N	N	O
的	uj	N	N	O
汇集点	n	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
j	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
j	x	N	N	O
<	x	N	N	O
64	m	N	N	O
;	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
/	x	N	N	O
/	x	N	N	O
枚举	nz	Y	N	O
可能	v	N	N	O
的	uj	N	N	O
带走	v	N	N	O
王	nr	N	N	O
的	uj	N	N	O
位置	v	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
tmp	eng	N	N	O
=	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
abs	eng	N	N	O
(	x	N	N	O
j	x	N	N	O
%	x	N	N	O
8	x	N	N	O
-	x	N	N	O
sx	eng	N	N	O
)	x	N	N	O
,	x	N	N	O
abs	eng	N	N	O
(	x	N	N	O
j	x	N	N	O
/	x	N	N	O
8	x	N	N	O
-	x	N	N	O
sy	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
王	nr	N	N	O
走	v	N	N	O
的	uj	N	N	O
步数	n	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
min	eng	N	N	O
=	x	N	N	O
INF	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
c	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
c	x	N	N	O
<	x	N	N	O
cnt	eng	N	N	O
;	x	N	N	O
c++	nz	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
k	x	N	N	O
=	x	N	N	O
dx	eng	N	N	O
[	x	N	N	O
c	x	N	N	O
]	x	N	N	O
+	x	N	N	O
dy	eng	N	N	O
[	x	N	N	O
c	x	N	N	O
]	x	N	N	O
*	x	N	N	O
8	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
tmp	eng	N	N	O
+	x	N	N	O
=	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
每个	r	N	N	O
马	n	N	N	O
到	v	N	N	O
汇集点	n	N	N	O
的	uj	N	N	O
距离	n	Y	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
+	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
-	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
<	x	N	N	O
min	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
min	eng	N	N	O
=	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
+	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
-	x	N	N	O
dis	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
选择	v	N	N	O
最少	d	N	N	O
的	uj	N	N	O
带走	v	N	N	O
王	nr	N	N	O
的	uj	N	N	O
马	n	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
tmp	eng	N	N	O
+	x	N	N	O
=	x	N	N	O
min	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
ans	eng	N	N	O
>	x	N	N	O
tmp	eng	N	N	O
)	x	N	N	O
ans	eng	N	N	O
=	x	N	N	O
tmp	eng	N	N	O
;	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
ans	eng	N	N	O
=	x	N	N	O
=	x	N	N	O
INF	eng	N	N	O
)	x	N	N	O
ans	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
\	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
ans	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
s	x	N	N	O
"	x	N	N	O
,	x	N	N	O
ch	eng	Y	N	O
)	x	N	N	O
!	x	N	N	O
=	x	N	N	O
EOF	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
sx	eng	N	N	O
=	x	N	N	O
ch	eng	Y	N	O
[	x	N	N	O
0	x	N	N	O
]	x	N	N	O
-	x	N	N	O
'	x	N	N	O
A	x	N	N	O
'	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
sy	eng	N	N	O
=	x	N	N	O
ch	eng	Y	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
-	x	N	N	O
'	x	N	N	O
1	x	N	N	O
'	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
2	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
strlen	eng	N	N	O
(	x	N	N	O
ch	eng	Y	N	O
)	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
+	x	N	N	O
=	x	N	N	O
2	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dx	eng	N	N	O
[	x	N	N	O
cnt	eng	N	N	O
]	x	N	N	O
=	x	N	N	O
ch	eng	Y	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
-	x	N	N	O
'	x	N	N	O
A	x	N	N	O
'	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dy	eng	N	N	O
[	x	N	N	O
cnt	eng	N	N	O
++	x	N	N	O
]	x	N	N	O
=	x	N	N	O
ch	eng	Y	N	O
[	x	N	N	O
i	eng	N	N	O
+	x	N	N	O
1	m	N	N	O
]	x	N	N	O
-	x	N	N	O
'	x	N	N	O
1	x	N	N	O
'	x	N	N	O
;	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
init	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
floyd	eng	Y	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
fun	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
/	x	N	N	O
*	x	N	N	O

	x	N	N	O
Sample	eng	N	N	O
 	x	N	N	O
Input	eng	N	N	O

	x	N	N	O
D4A3A8H1H8	eng	N	N	O

	x	N	N	O
Sample	eng	N	N	O
 	x	N	N	O
Output	eng	N	N	O

	x	N	N	O
10	m	N	N	O

	x	N	N	O
A1A2A3H2H5H6H7H8C1C2C5C6C7E2E3E4E5E6E7E8	eng	N	N	O

	x	N	N	O
42	m	N	N	O

	x	N	N	O
*	x	N	N	O
/	x	N	N	O

	x	N	N	O