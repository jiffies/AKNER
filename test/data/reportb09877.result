POJ	eng	N	Y	O	B-OJ

3585	m	N	N	O	I-OJ

一道	m	N	N	O	O
很好	a	N	N	O	O
的	uj	N	N	O	O
树	n	N	N	O	O
DP	eng	N	N	O	B-KNOWLEDGE

-	x	N	N	O	O

ronaflx	eng	N	N	O	O

-	x	N	N	O	O

博客园	nr	N	N	O	O

题目	n	Y	N	O	O
要求	v	N	N	O	O
给	p	N	N	O	O
一棵	m	N	N	O	O
加权	v	N	N	O	O
无向	d	Y	N	O	O
树	v	N	N	O	O
，	x	N	N	O	O
求	v	N	N	O	O
每个	r	N	N	O	O
点	m	N	N	O	O
到	v	N	N	O	O
叶子	nr	N	N	O	O
节点	n	N	N	O	O
的	uj	N	N	O	O
最大	a	Y	N	O	O
流量	n	N	N	O	O
。	x	N	N	O	O

范围	n	N	N	O	O
20	m	N	N	O	O
万	m	N	N	O	O
。	x	N	N	O	O

必须	d	N	N	O	O
是	v	N	N	O	O
O	eng	N	N	O	O
(	x	N	N	O	O
N	x	N	N	O	O
)	x	N	N	O	O
的	uj	N	N	O	O
树	n	N	N	O	O
DP	eng	N	N	O	B-KNOWLEDGE
才	d	N	N	O	O
行	v	N	N	O	O
。	x	N	N	O	O

首先	d	N	N	O	O
固定	a	Y	N	O	O
一个	m	N	N	O	O
为	p	N	N	O	O
根	a	N	N	O	O
，	x	N	N	O	O
做	v	N	N	O	O
一次	m	N	N	O	O
DFS	eng	N	N	O	B-KNOWLEDGE
，	x	N	N	O	O
求	v	N	N	O	O
每个	r	N	N	O	O
节点	n	N	N	O	O
到	v	N	N	O	O
其子	r	N	N	O	O
树	v	N	N	O	O
的	uj	N	N	O	O
叶子	nr	N	N	O	O
节点	n	N	N	O	O
的	uj	N	N	O	O
流量	n	N	N	O	O
和	c	N	N	O	O
son	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
，	x	N	N	O	O
以及	c	N	N	O	O
每个	r	N	N	O	O
节点	n	N	N	O	O
对	p	N	N	O	O
其	r	N	N	O	O
父亲	n	N	N	O	O
节点	n	N	N	O	O
的	uj	N	N	O	O
贡献	n	N	N	O	O
belong	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
，	x	N	N	O	O
还有	v	N	N	O	O
每个	r	N	N	O	O
点	m	N	N	O	O
和	c	N	N	O	O
他	r	N	N	O	O
父亲	n	N	N	O	O
节点	n	N	N	O	O
的	uj	N	N	O	O
边权	n	N	N	O	O
edge	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
。	x	N	N	O	O

然后	c	N	N	O	O
对	p	N	N	O	O
每个	r	N	N	O	O
节点	n	N	N	O	O
做	v	N	N	O	O
一次	m	N	N	O	O
记忆	n	Y	N	O	B-KNOWLEDGE
化	n	N	N	O	I-KNOWLEDGE
搜索	v	Y	N	O	I-KNOWLEDGE
，	x	N	N	O	O
顺着	p	N	N	O	O
第一次	m	N	N	O	O
搜索	v	Y	N	O	O
的	uj	N	N	O	O
边	n	N	N	O	O
反向	v	N	N	O	O
搜索	v	Y	N	O	O
。	x	N	N	O	O

DP	eng	N	N	O	B-KNOWLEDGE
的	uj	N	N	O	O
转移	v	N	N	O	O
方程	n	Y	N	O	O
是	v	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

min	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
father	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O

-	x	N	N	O	O

belong	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

dege	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

+	x	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

解题	n	N	N	O	O
的	uj	N	N	O	O
过程	n	N	N	O	O
比较	d	N	N	O	O
坎坷	a	N	N	O	O
。	x	N	N	O	O

首先	d	N	N	O	O
状态	n	Y	N	O	O
转移	v	N	N	O	O
方程	n	Y	N	O	O
多次	m	N	N	O	O
修改	v	N	N	O	O
，	x	N	N	O	O
导致	v	N	N	O	O
第一次	m	N	N	O	O
DFS	eng	N	N	O	B-KNOWLEDGE
所	c	N	N	O	O
要求	v	N	N	O	O
的	uj	N	N	O	O
东西	ns	N	N	O	O
不	d	N	N	O	O
明确	ad	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
改	v	N	N	O	O
了	ul	N	N	O	O
好	a	N	N	O	O
多次	m	N	N	O	O
。	x	N	N	O	O

这	r	N	N	O	O
是	v	N	N	O	O
写	v	N	N	O	O
DP	eng	N	N	O	B-KNOWLEDGE
的	uj	N	N	O	O
一大	a	N	N	O	O
忌讳	v	N	N	O	O
…	x	N	N	O	O
…	x	N	N	O	O
没	v	N	N	O	O
确定	v	N	N	O	O
转移	v	N	N	O	O
过程	n	N	N	O	O
就	d	N	N	O	O
开始	v	N	N	O	O
写题	n	N	N	O	O

确定	v	N	N	O	O
转移	v	N	N	O	O
方程	n	Y	N	O	O
以后	f	N	N	O	O
，	x	N	N	O	O
有	v	N	N	O	O
一种	m	N	N	O	O
特殊	a	N	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O
没有	v	N	N	O	O
处理	v	N	N	O	O
好	a	N	N	O	O
，	x	N	N	O	O
就是	d	N	N	O	O
当	t	N	N	O	O
固定	a	Y	N	O	O
的	uj	N	N	O	O
根是	n	N	N	O	O
个度	n	N	N	O	O
为	p	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
点	m	N	N	O	O
时	ng	N	N	O	O
，	x	N	N	O	O
需要	v	N	N	O	O
特殊	a	N	N	O	O
处理	v	N	N	O	O
。	x	N	N	O	O

思考问题	n	N	N	O	O
需要	v	N	N	O	O
群面	n	N	N	O	O
。	x	N	N	O	O

一下	m	N	N	O	O
为此	r	N	N	O	O
题	n	N	N	O	O
的	uj	N	N	O	O
代码	n	N	N	O	O
：	x	N	N	O	O

POJ	eng	N	Y	O	B-OJ

3585	m	N	N	O	I-OJ

1	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

2	x	N	N	O	O

*	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O

3	x	N	N	O	O

*	x	N	N	O	O

4	x	N	N	O	O

*	x	N	N	O	O

Filename	eng	N	N	O	O
:	x	N	N	O	O

dp	eng	Y	N	O	O
.	m	N	N	O	O
cpp	eng	N	N	O	O

5	x	N	N	O	O

*	x	N	N	O	O

6	x	N	N	O	O

*	x	N	N	O	O

Description	eng	N	N	O	O
:	x	N	N	O	O

tree	eng	N	N	O	O

dp	eng	Y	N	O	O

problem	eng	N	N	O	O

7	x	N	N	O	O

*	x	N	N	O	O

8	x	N	N	O	O

*	x	N	N	O	O

Version	eng	N	N	O	O
:	x	N	N	O	O

1.0	m	N	N	O	O

9	x	N	N	O	O

*	x	N	N	O	O

Created	eng	N	N	O	O
:	x	N	N	O	O

2011	m	N	N	O	O
年	m	N	N	O	O
07	m	N	N	O	O
月	m	N	N	O	O
22	m	N	N	O	O
日	m	N	N	O	O

13	m	N	N	O	O
时	n	N	N	O	O
41	m	N	N	O	O
分	v	N	N	O	O
18	m	N	N	O	O
秒	m	N	N	O	O

10	m	N	N	O	O

*	x	N	N	O	O

Revision	eng	N	N	O	O
:	x	N	N	O	O

none	eng	N	N	O	O

11	m	N	N	O	O

*	x	N	N	O	O

Compiler	eng	N	N	O	O
:	x	N	N	O	O

gcc	eng	N	N	O	O

12	m	N	N	O	O

*	x	N	N	O	O

13	m	N	N	O	O

*	x	N	N	O	O

Author	eng	N	N	O	O
:	x	N	N	O	O

ronaflx	eng	N	N	O	O

14	m	N	N	O	O

*	x	N	N	O	O

Company	eng	N	N	O	O
:	x	N	N	O	O

hit	eng	N	N	O	O
-	x	N	N	O	O
ACM	eng	N	N	O	O
-	x	N	N	O	O
Group	eng	N	N	O	O

15	m	N	N	O	O

*	x	N	N	O	O

16	m	N	N	O	O

*	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O

17	m	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

18	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdlib	eng	N	N	O	O
>	x	N	N	O	O

19	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cctype	eng	N	N	O	O
>	x	N	N	O	O

20	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

21	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

22	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cmath	eng	N	N	O	O
>	x	N	N	O	O

23	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
ctime	eng	N	N	O	O
>	x	N	N	O	O

24	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
climits	eng	N	N	O	O
>	x	N	N	O	O

25	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
algorithm	eng	N	N	O	O
>	x	N	N	O	O

26	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
functional	eng	N	N	O	O
>	x	N	N	O	O

27	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
numeric	eng	N	N	O	O
>	x	N	N	O	O

28	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
vector	eng	N	N	O	O
>	x	N	N	O	O

29	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
map	eng	N	N	O	O
>	x	N	N	O	O

30	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
set	eng	N	N	O	O
>	x	N	N	O	O

31	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
queue	eng	N	N	O	O
>	x	N	N	O	O

32	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stack	eng	N	N	O	O
>	x	N	N	O	O

33	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
bitset	eng	N	N	O	O
>	x	N	N	O	O

34	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
list	eng	N	N	O	O
>	x	N	N	O	O

35	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
>	x	N	N	O	O

36	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

37	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
sstream	eng	N	N	O	O
>	x	N	N	O	O

38	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
fstream	eng	N	N	O	O
>	x	N	N	O	O

39	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iomanip	eng	N	N	O	O
>	x	N	N	O	O

40	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdexcept	eng	N	N	O	O
>	x	N	N	O	O

41	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
utility	eng	N	N	O	O
>	x	N	N	O	O

42	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
cassert	eng	N	N	O	O
>	x	N	N	O	O

43	m	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
complex	eng	N	N	O	O
>	x	N	N	O	O

44	m	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

45	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

LEFT	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

46	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

RIGHT	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

<	x	N	N	O	O
<	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

|	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

47	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MID	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O

(	x	N	N	O	O
(	x	N	N	O	O
l	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

r	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

>	x	N	N	O	O
>	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

48	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

CC	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O

v	x	N	N	O	O
)	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O

v	x	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

49	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

REP	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O

l	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

l	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O

int	eng	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

50	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

FOREACH	eng	N	N	O	O
(	x	N	N	O	O
con	eng	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
__	x	N	N	O	O
typeof	eng	N	N	O	O
(	x	N	N	O	O
con	eng	N	N	O	O
.	m	N	N	O	O
begin	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

con	eng	N	N	O	O
.	m	N	N	O	O
begin	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

con	eng	N	N	O	O
.	m	N	N	O	O
end	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

51	m	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

N	x	N	N	O	O

=	x	N	N	O	O

200000	m	N	N	O	O
;	x	N	N	O	O

52	m	N	N	O	O

const	eng	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

INF	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
long	eng	N	N	O	O

long	eng	N	N	O	O
)	x	N	N	O	O

N	x	N	N	O	O

*	x	N	N	O	O

N	x	N	N	O	O
;	x	N	N	O	O

53	m	N	N	O	O

vector	eng	N	N	O	O
<	x	N	N	O	O
pair	eng	N	N	O	O
<	x	N	N	O	O
int	eng	N	N	O	O
,	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O
>	x	N	N	O	O

>	x	N	N	O	O

adj	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

54	m	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

belong	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

55	m	N	N	O	O

int	eng	N	N	O	O

father	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

56	m	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

DP	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O

57	m	N	N	O	O

{	x	N	N	O	O

58	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

59	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O

&&	x	N	N	O	O

x	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

60	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

61	m	N	N	O	O

{	x	N	N	O	O

62	m	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

63	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
adj	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
size	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

adj	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
second	eng	N	N	O	O

*	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

64	m	N	N	O	O

else	eng	N	N	O	O

return	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

65	m	N	N	O	O

}	x	N	N	O	O

66	m	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

ans	eng	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
min	eng	N	N	O	O
(	x	N	N	O	O
DP	eng	N	N	O	O
(	x	N	N	O	O
father	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

-	x	N	N	O	O

belong	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

father	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O

?	x	N	N	O	O

0	x	N	N	O	O

:	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

+	x	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

67	m	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

ans	eng	N	N	O	O
;	x	N	N	O	O

68	m	N	N	O	O

return	eng	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

69	m	N	N	O	O

}	x	N	N	O	O

70	m	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

pre	eng	N	N	O	O
)	x	N	N	O	O

71	m	N	N	O	O

{	x	N	N	O	O

72	m	N	N	O	O

father	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

pre	eng	N	N	O	O
;	x	N	N	O	O

73	m	N	N	O	O

int	eng	N	N	O	O

isLeaf	eng	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

74	m	N	N	O	O

FOREACH	eng	N	N	O	O
(	x	N	N	O	O
adj	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O

75	m	N	N	O	O

{	x	N	N	O	O

76	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
first	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

pre	eng	N	N	O	O
)	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

i	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
second	eng	N	N	O	O
;	x	N	N	O	O

77	m	N	N	O	O

else	eng	N	N	O	O

78	m	N	N	O	O

{	x	N	N	O	O

79	m	N	N	O	O

isLeaf	eng	N	N	O	O

=	x	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

80	m	N	N	O	O

int	eng	N	N	O	O

score	eng	N	N	O	O

=	x	N	N	O	O

min	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
second	eng	N	N	O	O
,	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
first	eng	N	N	O	O
,	x	N	N	O	O

x	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

81	m	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

score	eng	N	N	O	O
;	x	N	N	O	O

82	m	N	N	O	O

belong	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
>	x	N	N	O	O
first	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

score	eng	N	N	O	O
;	x	N	N	O	O

83	m	N	N	O	O

}	x	N	N	O	O

84	m	N	N	O	O

}	x	N	N	O	O

85	m	N	N	O	O

return	eng	N	N	O	O

(	x	N	N	O	O
isLeaf	eng	N	N	O	O

?	x	N	N	O	O

edge	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

:	x	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

86	m	N	N	O	O

}	x	N	N	O	O

87	m	N	N	O	O

88	m	N	N	O	O

89	m	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

90	m	N	N	O	O

{	x	N	N	O	O

91	m	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

v	x	N	N	O	O
,	x	N	N	O	O

u	x	N	N	O	O
,	x	N	N	O	O

c	x	N	N	O	O
;	x	N	N	O	O

92	m	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

93	m	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
t	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

94	m	N	N	O	O

{	x	N	N	O	O

95	m	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

96	m	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

adj	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
clear	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

97	m	N	N	O	O

CC	eng	N	N	O	O
(	x	N	N	O	O
son	eng	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

98	m	N	N	O	O

CC	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
,	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

99	m	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

100	m	N	N	O	O

{	x	N	N	O	O

101	m	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
v	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
u	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
c	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

102	m	N	N	O	O

v	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
,	x	N	N	O	O

u	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

103	m	N	N	O	O

adj	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
make	eng	N	N	O	O
_	x	N	N	O	O
pair	eng	N	N	O	O
(	x	N	N	O	O
u	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
long	eng	N	N	O	O

long	eng	N	N	O	O
)	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

104	m	N	N	O	O

adj	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
push	eng	N	N	O	O
_	x	N	N	O	O
back	eng	N	N	O	O
(	x	N	N	O	O
make	eng	N	N	O	O
_	x	N	N	O	O
pair	eng	N	N	O	O
(	x	N	N	O	O
v	x	N	N	O	O
,	x	N	N	O	O

(	x	N	N	O	O
long	eng	N	N	O	O

long	eng	N	N	O	O
)	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

105	m	N	N	O	O

}	x	N	N	O	O

106	m	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

107	m	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

108	m	N	N	O	O

DP	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

109	m	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O

<	x	N	N	O	O

n	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
lld	eng	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
lld	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

son	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

father	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

dp	eng	Y	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

110	m	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
lld	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

*	x	N	N	O	O
max	eng	N	N	O	O
_	x	N	N	O	O
element	eng	N	N	O	O
(	x	N	N	O	O
dp	eng	Y	N	O	O
,	x	N	N	O	O

dp	eng	Y	N	O	O

+	x	N	N	O	O

n	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

111	m	N	N	O	O

}	x	N	N	O	O

112	m	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

113	m	N	N	O	O

}	x	N	N	O	O

