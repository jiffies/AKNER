2	x	N	N	B-KNOWLEDGE
-	x	N	N	I-KNOWLEDGE
SAT	eng	N	N	I-KNOWLEDGE
—	x	N	N	O
—	x	N	N	O
3.0	m	N	N	O
（	x	N	N	O
poj3207	eng	N	Y	B-OJ
）	x	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
laoda	eng	N	N	O
扯	v	N	N	O
一	m	N	N	O
扯	v	N	N	O
 	x	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
博客	nr	N	N	O
频道	n	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
CSDN	eng	N	N	O
.	m	N	N	O
NET	eng	N	N	O

	x	N	N	O

	x	N	N	O
poj3207	eng	N	Y	B-OJ
 	x	N	N	O
Ikki	eng	N	N	O
'	x	N	N	O
s	x	N	N	O
 	x	N	N	O
Story	eng	N	N	O
 	x	N	N	O
IV	eng	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
Panda	eng	N	N	O
'	x	N	N	O
s	x	N	N	O
 	x	N	N	O
Trick	eng	N	N	O

	x	N	N	O
这个	r	N	N	O
题卡	n	N	N	O
的	uj	N	N	O
是	v	N	N	O
建图	v	Y	N	O
，	x	N	N	O
我	r	N	N	O
开始	v	N	N	O
一直	d	N	N	O
没想到	l	N	N	O
怎么	r	N	N	O
建图	n	Y	N	O
，	x	N	N	O
后来	t	N	N	O
看	v	N	N	O
了	ul	N	N	O
报告	n	N	N	O
才	d	N	N	O
明白	nr	N	N	O
的	uj	N	N	O
，	x	N	N	O
=	x	N	N	O
 	x	N	N	O
=	x	N	N	O
！	x	N	N	O

	x	N	N	O
题意	n	N	N	O
是	v	N	N	O
说	v	N	N	O
给出	v	N	N	O
一个	m	N	N	O
圆	vg	N	N	O
上	f	N	N	O
的	uj	N	N	O
 	x	N	N	O
n	x	N	N	O
 	x	N	N	O
个	m	N	N	O
点	m	N	N	O
（	x	N	N	O
0	x	N	N	O
~	x	N	N	O
n	x	N	N	O
-	x	N	N	O
1	x	N	N	O
编号	n	N	N	O
）	x	N	N	O
，	x	N	N	O
然后	c	N	N	O
在	p	N	N	O
指定	v	N	N	O
的	uj	N	N	O
 	x	N	N	O
m	x	N	N	O
 	x	N	N	O
对	p	N	N	O
点	m	N	N	O
之间	f	N	N	O
各	r	N	N	O
连	u	N	N	O
一条线	l	N	N	O
（	x	N	N	O
可以	c	N	N	O
在	p	N	N	O
圆	n	N	N	O
内	f	N	N	O
，	x	N	N	O
也	d	N	N	O
可以	c	N	N	O
在	p	N	N	O
圆外	a	N	N	O
，	x	N	N	O
可以	c	N	N	O
是	v	N	N	O
曲线	n	N	N	O
，	x	N	N	O
这点	mq	N	N	O
真心	d	N	N	O
坑	n	N	N	O
爹	n	N	N	O
，	x	N	N	O
开始	v	N	N	O
一直	d	N	N	O
木	n	N	N	O
有	v	N	N	O
看	v	N	N	O
明白	nr	N	N	O
）	x	N	N	O
，	x	N	N	O
然后	c	N	N	O
问	v	N	N	O
你	r	N	N	O
是否	v	N	N	O
能	v	N	N	O
使	v	N	N	O
这些	r	N	N	O
线	n	N	N	O
都	d	N	N	O
不	d	N	N	O
相交	v	Y	N	O
。	x	N	N	O


	x	N	N	O
以	p	N	N	O
每	r	N	N	O
条	q	N	N	O
线段	n	Y	N	O
为	p	N	N	O
点	m	N	N	O
，	x	N	N	O
那么	r	N	N	O
对于	p	N	N	O
两点	m	N	N	O
之间	f	N	N	O
的	uj	N	N	O
一条	m	N	N	O
位于	v	N	N	O
圆	n	N	N	O
内部	f	Y	N	O
的	uj	N	N	O
曲线	n	N	N	O
 	x	N	N	O
B	x	N	N	O
，	x	N	N	O
肯定	v	N	N	O
有	v	N	N	O
一条	m	N	N	O
对应	vn	N	N	O
的	uj	N	N	O
位于	v	N	N	O
圆	n	N	N	O
外部	f	N	N	O
的	uj	N	N	O
曲线	n	N	N	O
 	x	N	N	O
B	x	N	N	O
‘	x	N	N	O
，	x	N	N	O
显然	ad	N	N	O
这	r	N	N	O
两个	m	N	N	O
点	m	N	N	O
满足	v	N	N	O
 	x	N	N	O
2	x	N	N	B-KNOWLEDGE
-	x	N	N	I-KNOWLEDGE
SAT	eng	N	N	I-KNOWLEDGE
 	x	N	N	O
问题	n	N	N	O
模型	n	Y	N	O
中	f	N	N	O
的	uj	N	N	O
 	x	N	N	O
“	x	N	N	O
B	x	N	N	O
 	x	N	N	O
与	p	N	N	O
 	x	N	N	O
非	d	N	N	O
B	eng	N	N	O
”	x	N	N	O
 	x	N	N	O
的	uj	N	N	O
关系	n	N	N	O
，	x	N	N	O
然后	c	N	N	O
对于	p	N	N	O
每	r	N	N	O
对	p	N	N	O
两条	m	N	N	O
同	p	N	N	O
在	p	N	N	O
圆	n	N	N	O
内部	f	Y	N	O
（	x	N	N	O
或者	c	N	N	O
外部	f	N	N	O
）	x	N	N	O
的	uj	N	N	O
曲线	n	N	N	O
来说	u	N	N	O
，	x	N	N	O
通过	p	N	N	O
他们	r	N	N	O
的	uj	N	N	O
起点	n	N	N	O
，	x	N	N	O
终点	d	N	N	O
坐标	v	Y	N	O
就	d	N	N	O
可以	c	N	N	O
判断	v	Y	N	O
2	m	N	N	O
者	k	N	N	O
是否	v	N	N	O
矛盾	an	N	N	O
了	ul	N	N	O
，	x	N	N	O
从而	c	N	N	O
依赖	v	N	N	O
这个	r	N	N	O
关系	n	N	N	O
建图	n	Y	N	O
，	x	N	N	O
剩下	v	N	N	O
的	uj	N	N	O
就是	d	N	N	O
塞	v	N	N	O
模板	n	Y	N	O
了	ul	N	N	O
。	x	N	N	O


	x	N	N	O
代码	n	N	N	O
：	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
cstdio	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
cstring	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
stack	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
climits	eng	N	N	O
>	x	N	N	O

	x	N	N	O
using	eng	N	N	O
 	x	N	N	O
namespace	eng	N	N	O
 	x	N	N	O
std	eng	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
N	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
250010	m	N	N	O
;	x	N	N	O

	x	N	N	O
struct	eng	N	N	O
 	x	N	N	O
Edge	eng	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
s	x	N	N	O
,	x	N	N	O
e	x	N	N	O
,	x	N	N	O
next	eng	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O
edge	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
,	x	N	N	O
m	x	N	N	O
,	x	N	N	O
e	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
,	x	N	N	O
vis	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
,	x	N	N	O
cnt	eng	N	N	O
,	x	N	N	O
head	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
,	x	N	N	O
instack	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
,	x	N	N	O
tim	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
,	x	N	N	O
low	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
,	x	N	N	O
belong	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
AddEdge	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
,	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
b	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
edge	eng	N	N	O
[	x	N	N	O
e	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
s	eng	N	N	O
=	x	N	N	O
a	x	N	N	O
;	x	N	N	O
 	x	N	N	O
edge	eng	N	N	O
[	x	N	N	O
e	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
e	eng	N	N	O
=	x	N	N	O
b	x	N	N	O
;	x	N	N	O
 	x	N	N	O
edge	eng	N	N	O
[	x	N	N	O
e	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
next	eng	N	N	O
=	x	N	N	O
head	eng	N	N	O
[	x	N	N	O
a	x	N	N	O
]	x	N	N	O
;	x	N	N	O
 	x	N	N	O
head	eng	N	N	O
[	x	N	N	O
a	x	N	N	O
]	x	N	N	O
=	x	N	N	O
e	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
++	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
getmap	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
,	x	N	N	O
j	x	N	N	O
,	x	N	N	O
tmp	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
510	m	N	N	O
]	x	N	N	O
,	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
510	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
px	eng	N	N	O
,	x	N	N	O
0	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
px	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
py	eng	N	N	O
,	x	N	N	O
0	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
py	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
=	x	N	N	O
m	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
,	x	N	N	O
&	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
>	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
{	x	N	N	O
tmp	eng	N	N	O
=	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O
 	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
=	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O
 	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
=	x	N	N	O
tmp	eng	N	N	O
;	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
e	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
head	eng	N	N	O
,	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
head	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
=	x	N	N	O
m	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
j	x	N	N	O
=	x	N	N	O
i	eng	N	N	O
+	x	N	N	O
1	m	N	N	O
;	x	N	N	O
j	x	N	N	O
<	x	N	N	O
=	x	N	N	O
m	x	N	N	O
;	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
>	x	N	N	O
=	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
&&	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
<	x	N	N	O
=	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
&&	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
>	x	N	N	O
=	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
 	x	N	N	O
|	x	N	N	O
|	x	N	N	O
 	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
>	x	N	N	O
=	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
&&	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
<	x	N	N	O
=	x	N	N	O
py	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
&&	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
<	x	N	N	O
=	x	N	N	O
px	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
AddEdge	eng	N	N	O
(	x	N	N	O
2	x	N	N	O
*	x	N	N	O
i	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
2	x	N	N	O
*	x	N	N	O
j	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
AddEdge	eng	N	N	O
(	x	N	N	O
2	x	N	N	O
*	x	N	N	O
j	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
2	x	N	N	O
*	x	N	N	O
i	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
AddEdge	eng	N	N	O
(	x	N	N	O
2	x	N	N	O
*	x	N	N	O
j	x	N	N	O
,	x	N	N	O
2	x	N	N	O
*	x	N	N	O
i	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
AddEdge	eng	N	N	O
(	x	N	N	O
2	x	N	N	O
*	x	N	N	O
i	x	N	N	O
,	x	N	N	O
2	x	N	N	O
*	x	N	N	O
j	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
stack	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
int	eng	N	N	O
>	x	N	N	O
st	eng	Y	N	O
;	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
tarjan	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
x	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
tim	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
=	x	N	N	O
low	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
=	x	N	N	O
++	x	N	N	O
vis	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
instack	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
st	eng	Y	N	O
.	m	N	N	O
push	eng	N	N	O
(	x	N	N	O
x	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
head	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
;	x	N	N	O
i	x	N	N	O
!	x	N	N	O
=	x	N	N	O
-	x	N	N	O
1	x	N	N	O
;	x	N	N	O
i	x	N	N	O
=	x	N	N	O
edge	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
.	m	N	N	O
next	eng	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
u	x	N	N	O
=	x	N	N	O
edge	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
.	m	N	N	O
e	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
tim	eng	N	N	O
[	x	N	N	O
u	x	N	N	O
]	x	N	N	O
=	x	N	N	O
=	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
tarjan	eng	Y	N	O
(	x	N	N	O
u	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
low	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
>	x	N	N	O
low	eng	N	N	O
[	x	N	N	O
u	x	N	N	O
]	x	N	N	O
)	x	N	N	O
low	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
=	x	N	N	O
low	eng	N	N	O
[	x	N	N	O
u	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
instack	eng	N	N	O
[	x	N	N	O
u	x	N	N	O
]	x	N	N	O
 	x	N	N	O
&&	x	N	N	O
 	x	N	N	O
low	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
>	x	N	N	O
tim	eng	N	N	O
[	x	N	N	O
u	x	N	N	O
]	x	N	N	O
)	x	N	N	O
low	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
=	x	N	N	O
tim	eng	N	N	O
[	x	N	N	O
u	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
low	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
=	x	N	N	O
=	x	N	N	O
tim	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
++	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
do	eng	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
st	eng	Y	N	O
.	m	N	N	O
top	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
st	eng	Y	N	O
.	m	N	N	O
pop	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
instack	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
belong	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
=	x	N	N	O
cnt	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
!	x	N	N	O
=	x	N	N	O
x	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
solve	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
vis	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
=	x	N	N	O
cnt	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
instack	eng	N	N	O
,	x	N	N	O
0	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
instack	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
belong	eng	N	N	O
,	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
belong	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
tim	eng	N	N	O
,	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
tim	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
low	eng	N	N	O
,	x	N	N	O
0	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
low	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
=	x	N	N	O
2	x	N	N	O
*	x	N	N	O
m	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
tim	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
=	x	N	N	O
=	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
tarjan	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
flag	eng	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
2	x	N	N	O
*	x	N	N	O
m	x	N	N	O
;	x	N	N	O
i	x	N	N	O
=	x	N	N	O
i	eng	N	N	O
+	x	N	N	O
2	m	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
belong	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
=	x	N	N	O
=	x	N	N	O
belong	eng	N	N	O
[	x	N	N	O
i	eng	N	N	O
+	x	N	N	O
1	m	N	N	O
]	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
flag	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
break	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
flag	eng	N	N	O
)	x	N	N	O
puts	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
panda	eng	N	N	O
 	x	N	N	O
is	eng	N	N	O
 	x	N	N	O
telling	eng	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
truth	eng	N	N	O
...	m	N	N	O
"	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
puts	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
evil	eng	N	N	O
 	x	N	N	O
panda	eng	N	N	O
 	x	N	N	O
is	eng	N	N	O
 	x	N	N	O
lying	eng	N	N	O
 	x	N	N	O
again	eng	N	N	O
"	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
~	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
n	eng	N	N	O
,	x	N	N	O
&	x	N	N	O
m	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
getmap	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
solve	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O

	x	N	N	O