PKU	eng	N	Y	B-OJ
 	x	N	N	I-OJ
2750	m	N	N	I-OJ
 	x	N	N	O
Potted	eng	N	N	O
 	x	N	N	O
Flower	eng	N	N	O
 	x	N	N	O
解题	n	N	N	O
报告	n	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
ldyhot	eng	N	N	O
的	uj	N	N	O
专栏	n	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
博客	nr	N	N	O
频道	n	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
CSDN	eng	N	N	O
.	m	N	N	O
NET	eng	N	N	O

	x	N	N	O

	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
*	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Title	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
Potted	eng	N	N	O
 	x	N	N	O
Flower	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Author	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
Jeff	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Time	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
 	x	N	N	O
2008	m	N	N	O
/	x	N	N	O
10	m	N	N	O
/	x	N	N	O
28	m	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Complexity	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
O	x	N	N	O
(	x	N	N	O
nlog	eng	N	N	O
(	x	N	N	O
n	x	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Result	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
7884	m	N	N	O
K	eng	N	N	O
 	x	N	N	O
344	m	N	N	O
MS	eng	N	N	O
/	x	N	N	O
 	x	N	N	O
AC	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Reference	eng	N	N	O
:	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
http	eng	N	N	O
:	x	N	N	O
/	x	N	N	O
/	x	N	N	O
203.208.39.99	m	N	N	O
/	x	N	N	O
search	eng	N	N	O
?	x	N	N	O
q	x	N	N	O
=	x	N	N	O
cache	eng	N	N	O
:	x	N	N	O
bZTSBU3KVGUJ	eng	N	N	O
:	x	N	N	O
hi	eng	N	N	O
.	m	N	N	O
baidu	eng	N	N	O
.	m	N	N	O
com	eng	N	N	O
/	x	N	N	O
fandywang	eng	N	N	O
_	x	N	N	O
jlu	eng	N	N	O
/	x	N	N	O
blog	eng	N	N	O
/	x	N	N	O
item	eng	N	N	O
/	x	N	N	O
505	m	N	N	O
b40f4c864bddff3d38574	eng	N	N	O
.	m	N	N	O
html	eng	N	N	O
+	x	N	N	O
poj	eng	N	Y	O
+	x	N	N	O
2750	m	N	N	O
&	x	N	N	O
hl	eng	N	N	O
=	x	N	N	O
zh	eng	N	N	O
-	x	N	N	O
CN	eng	N	N	O
&	x	N	N	O
lr	eng	N	N	O
=	x	N	N	O
lang	eng	N	N	O
_	x	N	N	O
zh	eng	N	N	O
-	x	N	N	O
CN	eng	N	N	O
|	x	N	N	O
lang	eng	N	N	O
_	x	N	N	O
zh	eng	N	N	O
-	x	N	N	O
TW	eng	N	N	O
&	x	N	N	O
newwindow	eng	N	N	O
=	x	N	N	O
1	m	N	N	O
&	x	N	N	O
gl	eng	N	N	O
=	x	N	N	O
cn	eng	N	N	O
&	x	N	N	O
st	eng	Y	N	O
_	x	N	N	O
usg	eng	N	N	O
=	x	N	N	O
ALhdy29PmISlzFU8Pg	eng	N	N	O
-	x	N	N	O
GsftyKbxS8Nqc6A	eng	N	N	O
&	x	N	N	O
strip	eng	N	N	O
=	x	N	N	O
1	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Description	eng	N	N	O
:	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
给定	v	N	N	O
一个	m	N	N	O
环形	n	Y	N	O
序列	n	Y	N	O
，	x	N	N	O
进行	v	N	N	O
在线	b	N	N	O
操作	v	Y	N	O
，	x	N	N	O
每次	r	N	N	O
修改	v	N	N	O
一个	m	N	N	O
元素	n	N	N	O
，	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
输出	v	Y	N	O
环上	n	Y	N	O
的	uj	N	N	O
最大	a	Y	N	O
连续	a	Y	N	O
子列	n	N	N	O
的	uj	N	N	O
和	c	N	N	O
。	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Tips	eng	N	N	O
:	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
线段	n	Y	N	B-KNOWLEDGE
树	n	N	N	I-KNOWLEDGE
+	x	N	N	O
DP	eng	N	N	B-KNOWLEDGE
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
出题者	n	N	N	O
的	uj	N	N	O
简单	a	N	N	O
解题	n	N	N	O
报告	n	N	N	O
：	x	N	N	O
把	p	N	N	O
环	v	N	N	O
从	p	N	N	O
一个	m	N	N	O
地方	n	N	N	O
，	x	N	N	O
切断	v	N	N	O
拉	v	N	N	O
成	n	N	N	O
一条	m	N	N	O
直线	n	Y	N	O
，	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
用	p	N	N	O
线段	n	Y	N	O
树	v	N	N	O
记录	n	Y	N	O
当前	t	N	N	O
区间	n	Y	N	O
的	uj	N	N	O
非	h	N	N	O
空	n	N	N	O
最大	a	Y	N	O
子列	n	N	N	O
和	c	N	N	O
当前	t	N	N	O
区间	n	Y	N	O
的	uj	N	N	O
非	h	N	N	O
空	n	N	N	O
最小	a	Y	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
子列	nr	N	N	O
。	x	N	N	O

如果	c	N	N	O
环上	n	Y	N	O
的	uj	N	N	O
数都	n	N	N	O
是	v	N	N	O
正整数	n	N	N	O
，	x	N	N	O
答案	n	N	N	O
是	v	N	N	O
：	x	N	N	O
环上数	n	N	N	O
的	uj	N	N	O
总和	n	N	N	O
－	x	N	N	O
根	p	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
结点	n	Y	N	O
的	uj	N	N	O
非空	n	N	N	O
最	d	N	N	O
小子	n	N	N	O
列	v	N	N	O
；	x	N	N	O
否则	c	N	N	O
，	x	N	N	O
答案	n	N	N	O
是	v	N	N	O
：	x	N	N	O
max	eng	N	N	O
{	x	N	N	O
根	p	N	N	O
结点	n	Y	N	O
的	uj	N	N	O
非	h	N	N	O
空	n	N	N	O
最大	a	Y	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
子列	nr	N	N	O
,	x	N	N	O
 	x	N	N	O
环上数	n	N	N	O
的	uj	N	N	O
总和	n	N	N	O
－	x	N	N	O
根	p	N	N	O
结点	n	Y	N	O
的	uj	N	N	O
非空	n	N	N	O
最	d	N	N	O
小子	n	N	N	O
列	v	N	N	O
}	x	N	N	O
，	x	N	N	O
每次	r	N	N	O
问答	v	N	N	O
的	uj	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
复杂度	n	N	N	O
是	v	N	N	O
O	eng	N	N	O
(	x	N	N	O
logN	eng	N	N	O
)	x	N	N	O
。	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
p	eng	N	N	O
.	m	N	N	O
s	eng	N	N	O
.	m	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
/	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
cstdio	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
cstring	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
using	eng	N	N	O
 	x	N	N	O
namespace	eng	N	N	O
 	x	N	N	O
std	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
MAX	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
100000	m	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
struct	eng	N	N	O
 	x	N	N	O
Node	eng	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
sum	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
该	r	N	N	O
区间	n	Y	N	O
数	m	N	N	O
的	uj	N	N	O
总和	n	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
maxSum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
minSum	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
该	r	N	N	O
区间	n	Y	N	O
 	x	N	N	O
最大	a	Y	N	O
子列	n	N	N	O
和	c	N	N	O
 	x	N	N	O
与	p	N	N	O
 	x	N	N	O
最	d	N	N	O
小子	n	N	N	O
列	v	N	N	O
和	c	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
maxl	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
maxr	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
该	r	N	N	O
区间	n	Y	N	O
 	x	N	N	O
从	p	N	N	O
左	m	N	N	O
端点	n	N	N	O
开始	v	N	N	O
的	uj	N	N	O
最大	a	Y	N	O
子列	n	N	N	O
和	c	N	N	O
 	x	N	N	O
与	p	N	N	O
 	x	N	N	O
到	v	N	N	O
右	f	N	N	O
端点	n	N	N	O
结束	v	N	N	O
的	uj	N	N	O
最	a	N	N	O
小子	n	N	N	O
列	v	N	N	O
和	c	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
minl	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
minr	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
该	r	N	N	O
区间	n	Y	N	O
 	x	N	N	O
从	p	N	N	O
左	m	N	N	O
端点	n	N	N	O
开始	v	N	N	O
的	uj	N	N	O
最	a	N	N	O
小子	n	N	N	O
列	v	N	N	O
和	c	N	N	O
 	x	N	N	O
与	p	N	N	O
 	x	N	N	O
到	v	N	N	O
右	f	N	N	O
端点	n	N	N	O
结束	v	N	N	O
的	uj	N	N	O
最	a	N	N	O
小子	n	N	N	O
列	v	N	N	O
和	c	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
Num	eng	N	N	O
[	x	N	N	O
MAX	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Node	eng	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
 	x	N	N	O
<	x	N	N	O
<	x	N	N	O
 	x	N	N	O
18	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
inline	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
min	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
b	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
<	x	N	N	O
 	x	N	N	O
b	x	N	N	O
 	x	N	N	O
?	x	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
:	x	N	N	O
 	x	N	N	O
b	x	N	N	O
;	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
inline	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
b	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
>	x	N	N	O
 	x	N	N	O
b	x	N	N	O
 	x	N	N	O
?	x	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
:	x	N	N	O
 	x	N	N	O
b	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
根据	p	N	N	O
左右	m	N	N	O
子	ng	N	N	O
节点	n	N	N	O
更新	d	N	N	O
父亲	n	N	N	O
节点	n	N	N	O
 	x	N	N	O
(	x	N	N	O
DP	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
update	eng	N	N	O
_	x	N	N	O
node	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
parent	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
left	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
right	eng	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
parent	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
parent	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxSum	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxSum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxSum	eng	N	N	O
)	x	N	N	O
,	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxr	eng	N	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxl	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
parent	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minSum	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
min	eng	N	N	O
(	x	N	N	O
min	eng	N	N	O
(	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minSum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minSum	eng	N	N	O
)	x	N	N	O
,	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minr	eng	N	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minl	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
parent	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxl	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxl	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
+	x	N	N	O
M	eng	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxl	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
parent	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxr	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxr	eng	N	N	O
+	x	N	N	O
M	eng	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxr	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
parent	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minl	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
min	eng	N	N	O
(	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minl	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
+	x	N	N	O
M	eng	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minl	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
parent	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minr	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
min	eng	N	N	O
(	x	N	N	O
M	x	N	N	O
[	x	N	N	O
left	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minr	eng	N	N	O
+	x	N	N	O
M	eng	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
right	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minr	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
初始化	l	N	N	O
线段	n	Y	N	B-KNOWLEDGE
树	v	N	N	I-KNOWLEDGE
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
init	eng	N	N	O
_	x	N	N	O
tree	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
node	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
l	x	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
r	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
l	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
r	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxSum	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minSum	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
Num	eng	N	N	O
[	x	N	N	O
l	x	N	N	O
]	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxl	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxr	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minl	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minr	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
Num	eng	N	N	O
[	x	N	N	O
l	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O
else	eng	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
init	eng	N	N	O
_	x	N	N	O
tree	eng	N	N	O
(	x	N	N	O
node	eng	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
2	x	N	N	O
,	x	N	N	O
 	x	N	N	O
l	x	N	N	O
,	x	N	N	O
 	x	N	N	O
(	x	N	N	O
l	eng	N	N	O
+	x	N	N	O
r	eng	N	N	O
)	x	N	N	O
/	x	N	N	O
2	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
init	eng	N	N	O
_	x	N	N	O
tree	eng	N	N	O
(	x	N	N	O
node	eng	N	N	O
*	x	N	N	O
2	m	N	N	O
+	x	N	N	O
1	m	N	N	O
,	x	N	N	O
 	x	N	N	O
(	x	N	N	O
l	eng	N	N	O
+	x	N	N	O
r	eng	N	N	O
)	x	N	N	O
/	x	N	N	O
2	m	N	N	O
+	x	N	N	O
1	m	N	N	O
,	x	N	N	O
 	x	N	N	O
r	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
update	eng	N	N	O
_	x	N	N	O
node	eng	N	N	O
(	x	N	N	O
node	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
node	eng	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
2	x	N	N	O
,	x	N	N	O
 	x	N	N	O
node	eng	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
2	x	N	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
(	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
)	x	N	N	O
:	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
l	x	N	N	O
,	x	N	N	O
 	x	N	N	O
r	x	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxSum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minSum	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
改变	v	N	N	O
一个	m	N	N	O
叶子	nr	N	N	O
节点	n	N	N	O
的	uj	N	N	O
值	n	N	N	O
，	x	N	N	O
从	p	N	N	O
叶子	nr	N	N	O
到	v	N	N	O
树根	n	N	N	O
更新	d	N	N	O
各个	r	N	N	O
节点	n	N	N	O
值	n	N	N	O
 	x	N	N	O
log	eng	N	N	O
(	x	N	N	O
n	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
change	eng	N	N	O
_	x	N	N	O
query	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
node	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
l	x	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
r	x	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
pos	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
value	eng	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
l	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
pos	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
r	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
l	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
r	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
l	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
pos	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxSum	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minSum	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
value	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxl	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxr	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minl	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minr	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
value	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O
else	eng	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
l	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
pos	eng	N	N	O
 	x	N	N	O
&&	x	N	N	O
 	x	N	N	O
pos	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
(	x	N	N	O
l	eng	N	N	O
+	x	N	N	O
r	eng	N	N	O
)	x	N	N	O
/	x	N	N	O
2	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
change	eng	N	N	O
_	x	N	N	O
query	eng	N	N	O
(	x	N	N	O
node	eng	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
2	x	N	N	O
,	x	N	N	O
 	x	N	N	O
l	x	N	N	O
,	x	N	N	O
 	x	N	N	O
(	x	N	N	O
l	eng	N	N	O
+	x	N	N	O
r	eng	N	N	O
)	x	N	N	O
/	x	N	N	O
2	x	N	N	O
,	x	N	N	O
 	x	N	N	O
pos	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
value	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
change	eng	N	N	O
_	x	N	N	O
query	eng	N	N	O
(	x	N	N	O
node	eng	N	N	O
*	x	N	N	O
2	m	N	N	O
+	x	N	N	O
1	m	N	N	O
,	x	N	N	O
 	x	N	N	O
(	x	N	N	O
l	eng	N	N	O
+	x	N	N	O
r	eng	N	N	O
)	x	N	N	O
/	x	N	N	O
2	m	N	N	O
+	x	N	N	O
1	m	N	N	O
,	x	N	N	O
 	x	N	N	O
r	x	N	N	O
,	x	N	N	O
 	x	N	N	O
pos	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
value	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
update	eng	N	N	O
_	x	N	N	O
node	eng	N	N	O
(	x	N	N	O
node	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
node	eng	N	N	O
*	x	N	N	O
2	x	N	N	O
,	x	N	N	O
 	x	N	N	O
node	eng	N	N	O
*	x	N	N	O
2	m	N	N	O
+	x	N	N	O
1	m	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
(	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
)	x	N	N	O
:	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
l	x	N	N	O
,	x	N	N	O
 	x	N	N	O
r	x	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
maxSum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
node	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
minSum	eng	N	N	O
)	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
freopen	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
in	eng	Y	N	O
.	m	N	N	O
txt	eng	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
"	x	N	N	O
r	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
stdin	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
freopen	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
out	eng	N	N	O
.	m	N	N	O
txt	eng	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
"	x	N	N	O
w	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
stdout	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
N	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
N	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
EOF	eng	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
 	x	N	N	O
N	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
Num	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
init	eng	N	N	O
_	x	N	N	O
tree	eng	N	N	O
(	x	N	N	O
1	x	N	N	O
,	x	N	N	O
 	x	N	N	O
0	x	N	N	O
,	x	N	N	O
 	x	N	N	O
N	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
K	x	N	N	O
,	x	N	N	O
 	x	N	N	O
A	x	N	N	O
,	x	N	N	O
 	x	N	N	O
B	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
K	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
 	x	N	N	O
K	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
A	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
B	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
change	eng	N	N	O
_	x	N	N	O
query	eng	N	N	O
(	x	N	N	O
1	x	N	N	O
,	x	N	N	O
 	x	N	N	O
0	x	N	N	O
,	x	N	N	O
 	x	N	N	O
N	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
 	x	N	N	O
A	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
 	x	N	N	O
B	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
.	m	N	N	O
maxSum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
.	m	N	N	O
minSum	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
.	m	N	N	O
maxSum	eng	N	N	O
)	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
.	m	N	N	O
minSum	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
.	m	N	N	O
maxSum	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
.	m	N	N	O
sum	eng	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
.	m	N	N	O
minSum	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O