POJ	eng	N	Y	O	B-OJ

1632	m	N	N	O	O

Vase	eng	N	N	O	O

collection	eng	N	N	O	O

-	x	N	N	O	O

bobten2008	eng	N	N	O	O
的	uj	N	N	O	O
专栏	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

Vase	eng	N	N	O	O

collection	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

1000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

10000	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

1536	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

552	m	N	N	O	O

Description	eng	N	N	O	O

Mr	eng	N	N	O	O

Cheng	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

collector	eng	N	N	O	O

of	eng	N	N	O	O

old	eng	N	N	O	O

Chinese	eng	N	N	O	O

porcelain	eng	N	N	O	O
,	x	N	N	O	O

more	eng	N	N	O	O

specifically	eng	N	N	O	O

late	eng	N	N	O	O

15	m	N	N	O	O
th	eng	N	N	O	O

century	eng	N	N	O	O

Feng	eng	N	N	O	O

dynasty	eng	N	N	O	O

vases	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

art	eng	N	N	O	O

of	eng	N	N	O	O

vase	eng	N	N	O	O
-	x	N	N	O	O
making	eng	N	N	O	O

at	eng	N	N	O	O

this	eng	N	N	O	O

time	eng	N	N	O	O

followed	eng	N	N	O	O

very	eng	N	N	O	O

strict	eng	N	N	O	O

artistic	eng	N	N	O	O

rules	eng	N	N	O	O
.	m	N	N	O	O

There	eng	N	N	O	O

was	eng	N	N	O	O

a	x	N	N	O	O

limited	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

accepted	eng	N	N	O	O

styles	eng	N	N	O	O
,	x	N	N	O	O

each	eng	N	N	O	O

defined	eng	N	N	O	O

by	eng	N	N	O	O

its	eng	N	N	O	O

shape	eng	N	N	O	O

and	eng	N	N	O	O

decoration	eng	N	N	O	O
.	m	N	N	O	O

More	eng	N	N	O	O

specifically	eng	N	N	O	O
,	x	N	N	O	O

there	eng	N	N	O	O

were	eng	N	N	O	O

36	m	N	N	O	O

vase	eng	N	N	O	O

shapes	eng	N	N	O	O

and	eng	N	N	O	O

36	m	N	N	O	O

different	eng	N	N	O	O

patterns	eng	N	N	O	O

of	eng	N	N	O	O

decoration	eng	N	N	O	O

?	x	N	N	O	O

in	eng	Y	N	O	O

all	eng	N	N	O	O

1296	m	N	N	O	O

different	eng	N	N	O	O

styles	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

a	x	N	N	O	O

collector	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

obvious	eng	N	N	O	O

goal	eng	N	N	O	O

is	eng	N	N	O	O

to	eng	N	N	O	O

own	eng	N	N	O	O

a	x	N	N	O	O

sample	eng	N	N	O	O

of	eng	N	N	O	O

each	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

1296	m	N	N	O	O

styles	eng	N	N	O	O
.	m	N	N	O	O

Mr	eng	N	N	O	O

Cheng	eng	N	N	O	O

however	eng	N	N	O	O
,	x	N	N	O	O
like	eng	N	N	O	O

so	eng	N	N	O	O

many	eng	N	N	O	O

other	eng	N	N	O	O

collectors	eng	N	N	O	O
,	x	N	N	O	O

could	eng	N	N	O	O

never	eng	N	N	O	O

afford	eng	N	N	O	O

a	x	N	N	O	O

complete	eng	N	N	O	O

collection	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

instead	eng	N	N	O	O

concentrates	eng	N	N	O	O

on	eng	N	N	O	O

some	eng	N	N	O	O

shapes	eng	N	N	O	O

and	eng	N	N	O	O

some	eng	N	N	O	O

decorations	eng	N	N	O	O
.	m	N	N	O	O

As	eng	N	N	O	O

symmetry	eng	N	N	O	O

between	eng	N	N	O	O

shape	eng	N	N	O	O

and	eng	N	N	O	O

decoration	eng	N	N	O	O

was	eng	N	N	O	O

one	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

main	eng	N	N	O	O

aestheathical	eng	N	N	O	O

paradigms	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

Feng	eng	N	N	O	O

dynasty	eng	N	N	O	O
,	x	N	N	O	O

Mr	eng	N	N	O	O

Cheng	eng	N	N	O	O

wants	eng	N	N	O	O

to	eng	N	N	O	O

have	eng	N	N	O	O

a	x	N	N	O	O

full	eng	N	N	O	O

collection	eng	N	N	O	O

of	eng	N	N	O	O

all	eng	N	N	O	O

combinations	eng	N	N	O	O

of	eng	N	N	O	O

k	x	N	N	O	O

shapes	eng	N	N	O	O

and	eng	N	N	O	O

k	x	N	N	O	O

decorations	eng	N	N	O	O
,	x	N	N	O	O

for	eng	Y	N	O	O

as	eng	Y	N	O	O

large	eng	N	N	O	O

a	x	N	N	O	O

k	x	N	N	O	O

as	eng	Y	N	O	O

possible	eng	N	N	O	O
.	m	N	N	O	O

However	eng	N	N	O	O
,	x	N	N	O	O

he	eng	Y	N	O	O

has	eng	Y	N	O	O

discovered	eng	N	N	O	O

that	eng	N	N	O	O

determining	eng	N	N	O	O

this	eng	N	N	O	O

k	x	N	N	O	O

for	eng	Y	N	O	O

a	x	N	N	O	O

given	eng	N	N	O	O

collection	eng	N	N	O	O

is	eng	N	N	O	O

not	eng	N	N	O	O

always	eng	N	N	O	O

trivial	eng	N	N	O	O
.	m	N	N	O	O

This	eng	N	N	O	O

means	eng	N	N	O	O

that	eng	N	N	O	O

his	eng	N	N	O	O

collection	eng	N	N	O	O

might	eng	N	N	O	O

actually	eng	N	N	O	O

be	eng	Y	N	O	O

better	eng	N	N	O	O

than	eng	N	N	O	O

he	eng	Y	N	O	O

thinks	eng	N	N	O	O
.	m	N	N	O	O

Can	eng	N	N	O	O

you	eng	N	N	O	O

help	eng	N	N	O	O

him	eng	N	N	O	O
?	x	N	N	O	O

Input	eng	N	N	O	O

On	eng	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O

of	eng	N	N	O	O

the	eng	N	N	O	O

input	eng	N	N	O	O
,	x	N	N	O	O

there	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

positive	eng	N	N	O	O

integer	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

telling	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

test	eng	N	N	O	O

scenarios	eng	N	N	O	O

to	eng	N	N	O	O

follow	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

test	eng	N	N	O	O

scenario	eng	N	N	O	O

begins	eng	N	N	O	O

with	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

containing	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

positive	eng	N	N	O	O

integer	eng	N	N	O	O

m	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

100	m	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

vases	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

collection	eng	N	N	O	O
.	m	N	N	O	O

Then	eng	N	N	O	O

follow	eng	N	N	O	O

m	x	N	N	O	O

lines	eng	N	N	O	O
,	x	N	N	O	O

one	eng	N	N	O	O

per	eng	N	N	O	O

vase	eng	N	N	O	O
,	x	N	N	O	O

each	eng	N	N	O	O

with	eng	N	N	O	O

a	x	N	N	O	O

pair	eng	N	N	O	O

of	eng	N	N	O	O

numbers	eng	N	N	O	O
,	x	N	N	O	O

si	eng	N	N	O	O

and	eng	N	N	O	O

di	eng	Y	N	O	O
,	x	N	N	O	O

separated	eng	N	N	O	O

by	eng	N	N	O	O

a	x	N	N	O	O

single	eng	N	N	O	O

space	eng	N	N	O	O
,	x	N	N	O	O

where	eng	N	N	O	O

si	eng	N	N	O	O

(	x	N	N	O	O

0	x	N	N	O	O

<	x	N	N	O	O

si	eng	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

36	m	N	N	O	O

)	x	N	N	O	O

indicates	eng	N	N	O	O

the	eng	N	N	O	O

shape	eng	N	N	O	O

of	eng	N	N	O	O

Mr	eng	N	N	O	O

Cheng	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

i	x	N	N	O	O
:	x	N	N	O	O
th	eng	N	N	O	O

vase	eng	N	N	O	O
,	x	N	N	O	O

and	eng	N	N	O	O

di	eng	Y	N	O	O

(	x	N	N	O	O

0	x	N	N	O	O

<	x	N	N	O	O

di	eng	Y	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

36	m	N	N	O	O

)	x	N	N	O	O

indicates	eng	N	N	O	O

its	eng	N	N	O	O

decoration	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

test	eng	N	N	O	O

scenario	eng	N	N	O	O
,	x	N	N	O	O

output	eng	N	N	O	O

one	eng	N	N	O	O

line	eng	N	N	O	O

containing	eng	N	N	O	O

the	eng	N	N	O	O

maximum	eng	N	N	O	O

k	x	N	N	O	O
,	x	N	N	O	O

such	eng	N	N	O	O

that	eng	N	N	O	O

there	eng	N	N	O	O

are	eng	N	N	O	O

k	x	N	N	O	O

shapes	eng	N	N	O	O

and	eng	N	N	O	O

k	x	N	N	O	O

decorations	eng	N	N	O	O

for	eng	Y	N	O	O

which	eng	N	N	O	O

Mr	eng	N	N	O	O

Cheng	eng	N	N	O	O
'	x	N	N	O	O
s	x	N	N	O	O

collection	eng	N	N	O	O

contains	eng	N	N	O	O

all	eng	N	N	O	O

k	x	N	N	O	O
*	x	N	N	O	O
k	x	N	N	O	O

combined	eng	N	N	O	O

styles	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

2	x	N	N	O	O

5	x	N	N	O	O

11	m	N	N	O	O

13	m	N	N	O	O

23	m	N	N	O	O

5	x	N	N	O	O

17	m	N	N	O	O

36	m	N	N	O	O

11	m	N	N	O	O

5	x	N	N	O	O

23	m	N	N	O	O

13	m	N	N	O	O

2	x	N	N	O	O

23	m	N	N	O	O

15	m	N	N	O	O

15	m	N	N	O	O

23	m	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

Source	eng	N	N	O	O

Northwestern	eng	N	N	O	O

Europe	eng	N	N	O	O

2003	m	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O

搜索	v	Y	N	O	O
的	uj	N	N	O	O
好题	n	N	N	O	O

数据结构	n	N	N	O	O
与	p	N	N	O	O
状态	n	Y	N	O	O
的	uj	N	N	O	O
表示	v	Y	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
对于	p	N	N	O	O
输入	v	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	eng	N	N	O	O
置	v	N	N	O	O
graph	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
,	x	N	N	O	O

称作	v	N	N	O	O
j	eng	N	N	O	O
和	c	N	N	O	O
i	eng	N	N	O	O
存在	v	N	N	O	O
映射	v	N	N	O	O
关系	n	N	N	O	O

2	x	N	N	O	O
)	x	N	N	O	O
为了	p	N	N	O	O
节省	n	N	N	O	O
搜索	v	Y	N	O	O
时间	n	N	N	O	O
将	d	N	N	O	O
收入	v	N	N	O	O
中	f	N	N	O	O
出现	v	N	N	O	O
过	ug	N	N	O	O
的	uj	N	N	O	O
数据	n	N	N	O	O
，	x	N	N	O	O
分别	d	N	N	O	O
顺序	n	N	N	O	O
存入	v	N	N	O	O
setsf	eng	N	N	O	O
,	x	N	N	O	O

setst	eng	N	N	O	O
,	x	N	N	O	O
并	c	N	N	O	O
统计	v	Y	N	O	O
数目	n	N	N	O	O
setsfn	eng	N	N	O	O
,	x	N	N	O	O
setstn	eng	N	N	O	O

3	x	N	N	O	O
)	x	N	N	O	O
状态	n	Y	N	O	O
利用	n	N	N	O	O
bit	eng	N	N	O	O
位来	v	N	N	O	O
表示	v	Y	N	O	O
，	x	N	N	O	O
每	zg	N	N	O	O
一个	m	N	N	O	O
shape	eng	N	N	O	O
占	v	N	N	O	O
一位	m	N	N	O	O
，	x	N	N	O	O
用来	v	N	N	O	O
表示	v	Y	N	O	O
当前	t	N	N	O	O
的	uj	N	N	O	O
shape	eng	N	N	O	O
是否	v	N	N	O	O
处在	v	N	N	O	O
可	v	N	N	O	O
选	zg	N	N	O	O
集合	v	N	N	O	O
中	f	N	N	O	O
，	x	N	N	O	O
一共	j	N	N	O	O
可能	v	N	N	O	O

有	v	N	N	O	O
36	m	N	N	O	O
种	m	N	N	O	O
shape	eng	N	N	O	O
，	x	N	N	O	O
所以	c	N	N	O	O
需要	v	N	N	O	O
用到	v	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O
，	x	N	N	O	O
普通	nz	N	N	O	O
int	eng	N	N	O	O
已经	d	N	N	O	O
无法	n	N	N	O	O
容纳	nr	N	N	O	O

搜索	v	Y	N	O	O
策略	n	N	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O
采用	v	N	N	O	O
DFS	eng	N	N	O	B-KNOWLEDGE
搜索	v	Y	N	O	O
，	x	N	N	O	O
搜索	v	Y	N	O	O
从	p	N	N	O	O
第一个	m	N	N	O	O
decoration	eng	N	N	O	O
开始	v	N	N	O	O
，	x	N	N	O	O
依次	d	N	N	O	O
往	zg	N	N	O	O
下	f	N	N	O	O
遍历	v	Y	N	O	O
，	x	N	N	O	O
每	zg	N	N	O	O
处理	v	N	N	O	O
一个	m	N	N	O	O
decoration	eng	N	N	O	O
时	n	N	N	O	O

需要	v	N	N	O	O
判断	v	Y	N	O	O
当前	t	N	N	O	O
decoration	eng	N	N	O	O
能否	v	N	N	O	O
被	p	N	N	O	O
选	v	N	N	O	O
，	x	N	N	O	O
如果	c	N	N	O	O
可以	c	N	N	O	O
被	p	N	N	O	O
选	v	N	N	O	O
那么	r	N	N	O	O
下	f	N	N	O	O
一步	m	N	N	O	O
可以	c	N	N	O	O
有	v	N	N	O	O
两种	m	N	N	O	O
选择	v	N	N	O	O
，	x	N	N	O	O
选择	v	N	N	O	O
该	r	N	N	O	O
decoration	eng	N	N	O	O
和	c	N	N	O	O
不选	v	N	N	O	O

该	r	N	N	O	O
decoration	eng	N	N	O	O

假设	vn	N	N	O	O
当前	t	N	N	O	O
可	v	N	N	O	O
选	zg	N	N	O	O
集合	v	N	N	O	O
中	ns	N	N	O	O
decoration	eng	N	N	O	O
的	uj	N	N	O	O
数量	n	N	N	O	O
是	v	N	N	O	O
num	eng	N	N	O	O
,	x	N	N	O	O
则	d	N	N	O	O
判断	v	Y	N	O	O
当前	t	N	N	O	O
decoration	eng	N	N	O	O
可不可以	c	N	N	O	O
被	p	N	N	O	O
选	v	N	N	O	O
的	uj	N	N	O	O
方法	n	Y	N	O	O
如下	t	N	N	O	O
：	x	N	N	O	O
对于	p	N	N	O	O
当前	t	N	N	O	O

状态	n	Y	N	O	O
state	eng	N	N	O	O
中	ns	N	N	O	O
，	x	N	N	O	O
必须	d	N	N	O	O
存在	v	N	N	O	O
至少	d	N	N	O	O
num	eng	N	N	O	O

+	x	N	N	O	O

1	m	N	N	O	O
种	m	N	N	O	O
shape	eng	N	N	O	O
是	v	N	N	O	O
当前	t	N	N	O	O
decoration	eng	N	N	O	O
在	p	N	N	O	O
输入	v	N	N	O	O
数据	n	N	N	O	O
中	f	N	N	O	O
映射	v	N	N	O	O
到	v	N	N	O	O
的	uj	N	N	O	O
,	x	N	N	O	O
注意	v	N	N	O	O
要	v	N	N	O	O
特殊	a	N	N	O	O
处理	v	N	N	O	O
起	v	N	N	O	O

始	d	N	N	O	O
情况	n	N	N	O	O
即	c	N	N	O	O
num	eng	N	N	O	O
为	p	N	N	O	O
0	m	N	N	O	O
的	uj	N	N	O	O
情况	n	N	N	O	O

6095577	m	N	N	O	O

bobten2008	eng	N	N	O	O

1632	m	N	N	O	O

Accepted	eng	N	N	O	O

168	m	N	N	O	O
K	eng	N	N	O	O

16	m	N	N	O	O
MS	eng	N	N	O	O

C++	nz	N	N	O	O

1428	m	N	N	O	O
B	eng	N	N	O	O

2009	m	N	N	O	O
-	x	N	N	O	O
11	m	N	N	O	O
-	x	N	N	O	O
06	m	N	N	O	O

13	m	N	N	O	O
:	x	N	N	O	O
53	m	N	N	O	O
:	x	N	N	O	O
17	m	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAX	eng	N	N	O	O
_	x	N	N	O	O
N	eng	N	N	O	O

36	m	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

graph	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
_	x	N	N	O	O
N	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
_	x	N	N	O	O
N	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

setsf	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
_	x	N	N	O	O
N	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

setsfn	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

setst	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
_	x	N	N	O	O
N	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

setstn	eng	N	N	O	O
;	x	N	N	O	O

__	x	N	N	O	O
int64	eng	N	N	O	O

expv	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
_	x	N	N	O	O
N	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

maxK	eng	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
curState	eng	N	N	O	O
表示	v	Y	N	O	O
当前	t	N	N	O	O
状态	n	Y	N	O	O
,	x	N	N	O	O
即	v	N	N	O	O
当前	t	N	N	O	O
被	p	N	N	O	O
选	v	N	N	O	O
的	uj	N	N	O	O
shapes	eng	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
curPos	eng	N	N	O	O
表示	v	Y	N	O	O
当前	t	N	N	O	O
需要	v	N	N	O	O
考虑	v	N	N	O	O
的	uj	N	N	O	O
decoration	eng	N	N	O	O
的	uj	N	N	O	O
序号	n	N	N	O	O
，	x	N	N	O	O
即	v	N	N	O	O
考虑	v	N	N	O	O
改	v	N	N	O	O
decoration	eng	N	N	O	O
是否	v	N	N	O	O
被	p	N	N	O	O
选	v	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
num	eng	N	N	O	O
表示	v	Y	N	O	O
当前	t	N	N	O	O
已	d	N	N	O	O
选	v	N	N	O	O
decoration	eng	N	N	O	O
值	n	N	N	O	O

void	eng	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
__	x	N	N	O	O
int64	eng	N	N	O	O

curState	eng	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

curPos	eng	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

num	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
已经	d	N	N	O	O
遍历	v	Y	N	O	O
完	v	N	N	O	O
所有	b	N	N	O	O
decoration	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
curPos	eng	N	N	O	O

>	x	N	N	O	O

setstn	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
更新	d	N	N	O	O
最大	a	Y	N	O	O
成员数	n	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O

>	x	N	N	O	O

maxK	eng	N	N	O	O
)	x	N	N	O	O

maxK	eng	N	N	O	O

=	x	N	N	O	O

num	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

countv	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

tid	eng	N	N	O	O

=	x	N	N	O	O

setst	eng	N	N	O	O
[	x	N	N	O	O
curPos	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

newState	eng	N	N	O	O

=	x	N	N	O	O

curState	eng	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
遍历	v	Y	N	O	O
所有	b	N	N	O	O
的	uj	N	N	O	O
shapes	eng	N	N	O	O
，	x	N	N	O	O
统计	v	Y	N	O	O
当前	t	N	N	O	O
decoration	eng	N	N	O	O
在	p	N	N	O	O
curState	eng	N	N	O	O
中	ns	N	N	O	O
可以	c	N	N	O	O
找到	v	N	N	O	O
多少	m	N	N	O	O
自己	r	N	N	O	O
对应	vn	N	N	O	O
的	uj	N	N	O	O
shapes	eng	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

setsfn	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

fid	eng	N	N	O	O

=	x	N	N	O	O

setsf	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
输入	v	N	N	O	O
中	f	N	N	O	O
存在	v	N	N	O	O
fid	eng	N	N	O	O

tid	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
graph	eng	N	N	O	O
[	x	N	N	O	O
tid	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
fid	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
如果	c	N	N	O	O
当前	t	N	N	O	O
已	d	N	N	O	O
选	v	N	N	O	O
shapes	eng	N	N	O	O
中	ns	N	N	O	O
已经	d	N	N	O	O
存在	v	N	N	O	O
，	x	N	N	O	O
则	d	N	N	O	O
统计	v	Y	N	O	O
值	n	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
curState	eng	N	N	O	O

&	x	N	N	O	O

expv	eng	N	N	O	O
[	x	N	N	O	O
fid	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

countv	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
初始状态	l	N	N	O	O
特殊	a	N	N	O	O
处理	v	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

countv	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
需要	v	N	N	O	O
加入	v	N	N	O	O
初始	v	N	N	O	O
decoration	eng	N	N	O	O
所有	b	N	N	O	O
对应	vn	N	N	O	O
的	uj	N	N	O	O
shapes	eng	N	N	O	O
到	v	N	N	O	O
状态	n	Y	N	O	O
中	f	N	N	O	O

newState	eng	N	N	O	O

|	x	N	N	O	O
=	x	N	N	O	O

expv	eng	N	N	O	O
[	x	N	N	O	O
fid	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
不是	c	N	N	O	O
初始状态	l	N	N	O	O
的话	u	N	N	O	O
需要	v	N	N	O	O
从	p	N	N	O	O
当前	t	N	N	O	O
状态	n	Y	N	O	O
中	f	N	N	O	O
去除	v	N	N	O	O
当前	t	N	N	O	O
当前	t	N	N	O	O
decoration	eng	N	N	O	O
无法	n	N	N	O	O
映射	v	N	N	O	O
的	uj	N	N	O	O
shapes	eng	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
num	eng	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

0	x	N	N	O	O

&&	x	N	N	O	O

(	x	N	N	O	O
curState	eng	N	N	O	O

&	x	N	N	O	O

expv	eng	N	N	O	O
[	x	N	N	O	O
fid	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

newState	eng	N	N	O	O

-	x	N	N	O	O
=	x	N	N	O	O

expv	eng	N	N	O	O
[	x	N	N	O	O
fid	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
curState	eng	N	N	O	O
,	x	N	N	O	O

curPos	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

num	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
countv	eng	N	N	O	O

>	x	N	N	O	O
=	x	N	N	O	O

num	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
newState	eng	N	N	O	O
,	x	N	N	O	O

curPos	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

num	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

caseN	eng	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
;	x	N	N	O	O

expv	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

MAX	eng	N	N	O	O
_	x	N	N	O	O
N	eng	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

expv	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

expv	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O

-	x	N	N	O	O

1	x	N	N	O	O
]	x	N	N	O	O

*	x	N	N	O	O

2	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
caseN	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
caseN	eng	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

maxK	eng	N	N	O	O

=	x	N	N	O	O

INT	eng	N	N	O	O
_	x	N	N	O	O
MIN	eng	N	N	O	O
;	x	N	N	O	O

setstn	eng	N	N	O	O

=	x	N	N	O	O

setsfn	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
graph	eng	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
graph	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

from	eng	N	N	O	O
,	x	N	N	O	O

to	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
from	eng	N	N	O	O
,	x	N	N	O	O

&	x	N	N	O	O
to	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

graph	eng	N	N	O	O
[	x	N	N	O	O
to	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
from	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

setsfn	eng	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
setsf	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

from	eng	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

setsfn	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

setsf	eng	N	N	O	O
[	x	N	N	O	O
++	x	N	N	O	O
setsfn	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

from	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

<	x	N	N	O	O
=	x	N	N	O	O

setstn	eng	N	N	O	O
;	x	N	N	O	O

j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
setst	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

to	eng	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

setstn	eng	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
)	x	N	N	O	O

setst	eng	N	N	O	O
[	x	N	N	O	O
++	x	N	N	O	O
setstn	eng	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

to	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

1	x	N	N	O	O
,	x	N	N	O	O

0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
/	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O

maxK	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

