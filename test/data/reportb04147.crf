poj	eng	N	Y	B-OJ
 	x	N	N	I-OJ
2754	m	N	N	I-OJ
 	x	N	N	O
Similarity	eng	N	N	O
 	x	N	N	O
of	eng	N	N	O
 	x	N	N	O
necklaces	eng	N	N	O
 	x	N	N	O
2	x	N	N	O
 	x	N	N	O
转换成	i	N	N	O
多重	m	Y	N	O
背包	n	Y	N	B-KNOWLEDGE
，	x	N	N	O
单调	n	Y	N	B-KNOWLEDGE
队列	n	Y	N	I-KNOWLEDGE
优化	vn	Y	N	O
/	x	N	N	O
 	x	N	N	O
二进制	n	N	N	O
优化	vn	Y	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
yefeng1627	eng	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
博客园	nr	N	N	O

	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
贴	v	N	N	O
个	q	N	N	O
官方	n	N	N	O
解题	n	N	N	O
报告	n	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
Similarity	eng	N	N	O
 	x	N	N	O
of	eng	N	N	O
 	x	N	N	O
necklaces	eng	N	N	O
 	x	N	N	O
2	x	N	N	O

	x	N	N	O
这个	r	N	N	O
问题	n	N	N	O
是	v	N	N	O
一个	m	N	N	O
012	m	N	N	O
背包	n	Y	N	B-KNOWLEDGE
问题	n	N	N	O
。	x	N	N	O

我们	r	N	N	O
知道	v	N	N	O
01	m	N	N	O
背包	n	Y	N	B-KNOWLEDGE
只要	c	N	N	O
逆向	n	Y	N	O
线性	n	Y	N	O
检索	vn	N	N	O
，	x	N	N	O
无限	v	Y	N	O
背包	n	Y	N	B-KNOWLEDGE
只要	c	N	N	O
正向	d	N	N	O
检索	vn	N	N	O
。	x	N	N	O

012	m	N	N	O
背包	n	Y	N	B-KNOWLEDGE
就是说	c	N	N	O
，	x	N	N	O
每个	r	N	N	O
物品	n	N	N	O
有	v	N	N	O
一个	m	N	N	O
数量	n	N	N	O
上限	v	N	N	O
。	x	N	N	O

这个	r	N	N	O
问题	n	N	N	O
可以	c	N	N	O
用	p	N	N	O
log	eng	N	N	O
方法	n	Y	N	O
，	x	N	N	O
也	d	N	N	O
存在	v	N	N	O
线性	n	Y	N	O
方法	n	Y	N	O
，	x	N	N	O
需要	v	N	N	O
维护	v	Y	N	O
一个	m	N	N	O
递增	v	Y	N	O
/	x	N	N	O
递减	v	N	N	O
序列	n	Y	N	O
。	x	N	N	O


	x	N	N	O
我们	r	N	N	O
先	d	N	N	O
把	p	N	N	O
所有	b	N	N	O
的	uj	N	N	O
Table	eng	N	N	O
都	d	N	N	O
放成	v	N	N	O
下限	v	N	N	O
，	x	N	N	O
接下来	l	N	N	O
我们	r	N	N	O
可以	c	N	N	O
算出	v	N	N	O
它	r	N	N	O
距离	n	Y	N	O
总和	n	N	N	O
为	p	N	N	O
0	m	N	N	O
还	d	N	N	O
需要	v	N	N	O
增加	v	N	N	O
多少	m	N	N	O
。	x	N	N	O

对于	p	N	N	O
1	x	N	N	O
<	x	N	N	O
=	x	N	N	O
i	x	N	N	O
<	x	N	N	O
=	x	N	N	O
M	x	N	N	O
，	x	N	N	O
它	r	N	N	O
可以	c	N	N	O
看成	v	N	N	O
这样	r	N	N	O
一个	m	N	N	O
物品	n	N	N	O
：	x	N	N	O
体积	n	Y	N	O
为	p	N	N	O
Multi	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
，	x	N	N	O
费用	n	N	N	O
为	p	N	N	O
Pairs	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
，	x	N	N	O
数量	n	N	N	O
为	p	N	N	O
Up	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
-	x	N	N	O
Low	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
。	x	N	N	O

然后	c	N	N	O
就	d	N	N	O
得到	v	N	N	O
一个	m	N	N	O
012	m	N	N	O
背包	n	Y	N	B-KNOWLEDGE
问题	n	N	N	O
了	ul	N	N	O
。	x	N	N	O


	x	N	N	O
复杂度	n	N	N	O
约	d	N	N	O
为	p	N	N	O
：	x	N	N	O
O	x	N	N	O
(	x	N	N	O
M	x	N	N	O
*	x	N	N	O
背包	n	Y	N	O
大小	b	N	N	O
)	x	N	N	O
。	x	N	N	O

其中	r	N	N	O
背包	n	Y	N	O
大小	b	N	N	O
不	d	N	N	O
超过	v	N	N	O
M	x	N	N	O
*	x	N	N	O
20	m	N	N	O
*	x	N	N	O
25	m	N	N	O
=	x	N	N	O
200	m	N	N	O
*	x	N	N	O
20	m	N	N	O
*	x	N	N	O
25	m	N	N	O
=	x	N	N	O
100000	m	N	N	O
。	x	N	N	O

 	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
单调	n	Y	N	B-KNOWLEDGE
队列	n	Y	N	I-KNOWLEDGE
优化	vn	Y	N	O
解法	v	Y	N	O
：	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
多重	m	Y	N	O
背包	n	Y	N	B-KNOWLEDGE
状态方程	n	N	N	O
：	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
令	v	N	N	O
 	x	N	N	O
 	x	N	N	O
转换	v	Y	N	O
下	f	N	N	O
得到	v	N	N	O
：	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
因为	c	N	N	O
 	x	N	N	O
，	x	N	N	O
 	x	N	N	O
当	t	N	N	O
 	x	N	N	O
j	x	N	N	O
 	x	N	N	O
确定	v	N	N	O
时	n	N	N	O
，	x	N	N	O
 	x	N	N	O
则	d	N	N	O
x	eng	N	N	O
的	uj	N	N	O
取值	v	N	N	O
范围	n	N	N	O
为	p	N	N	O
，	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
也就是说	l	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
，	x	N	N	O
 	x	N	N	O
 	x	N	N	O
也	d	N	N	O
可看	v	N	N	O
作为	v	N	N	O
 	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
则	d	N	N	O
可	v	N	N	O
得	ud	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
，	x	N	N	O
其中	r	N	N	O
 	x	N	N	O
j	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
k	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
那么	r	N	N	O
意味着	v	N	N	O
，	x	N	N	O
对于	p	N	N	O
确定	v	N	N	O
的	uj	N	N	O
 	x	N	N	O
j	x	N	N	O
，	x	N	N	O
 	x	N	N	O
求	v	N	N	O
 	x	N	N	O
Xk	eng	N	N	O
 	x	N	N	O
时候	n	N	N	O
，	x	N	N	O
我们	r	N	N	O
只	d	N	N	O
需要	v	N	N	O
对	p	N	N	O
 	x	N	N	O
 	x	N	N	O
维护	v	Y	N	O
一个	m	N	N	O
单调	n	Y	N	B-KNOWLEDGE
队列	n	Y	N	I-KNOWLEDGE
即可	d	N	N	O
。	x	N	N	O


	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
对于	p	N	N	O
任意	v	Y	N	O
的	uj	N	N	O
 	x	N	N	O
Xi	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
 	x	N	N	O
Xj	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
若	c	N	N	O
 	x	N	N	O
Xb	eng	N	N	O
 	x	N	N	O
优于	v	N	N	O
 	x	N	N	O
Xa	eng	N	N	O
,	x	N	N	O
则	d	N	N	O
必将	d	N	N	O
满足	v	N	N	O
如下	t	N	N	O
要求	v	N	N	O
，	x	N	N	O
 	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
这种	r	N	N	O
写法	v	N	N	O
 	x	N	N	O
AC	eng	N	N	O
时间	n	N	N	O
是	v	N	N	O
 	x	N	N	O
1500	m	N	N	O
ms	eng	N	N	O
，	x	N	N	O
有点	n	N	N	O
慢	a	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
View	eng	N	N	O
 	x	N	N	O
Code	eng	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
stdio	eng	N	N	O
.	m	N	N	O
h	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
stdlib	eng	N	N	O
.	m	N	N	O
h	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
string	eng	N	N	O
.	m	N	N	O
h	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
algorithm	eng	N	N	O
>	x	N	N	O

	x	N	N	O
using	eng	N	N	O
 	x	N	N	O
namespace	eng	N	N	O
 	x	N	N	O
std	eng	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
maxn	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
210	m	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
N	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
100000	m	N	N	O
+	x	N	N	O
10	m	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
inf	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
2139062144	m	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
2	x	N	N	O
]	x	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
P	x	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
Low	eng	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
Up	eng	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
,	x	N	N	O
 	x	N	N	O
m	x	N	N	O
,	x	N	N	O
 	x	N	N	O
Q	x	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
val	eng	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
,	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
b	x	N	N	O
)	x	N	N	O
 	x	N	N	O
{	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
>	x	N	N	O
b	x	N	N	O
?	x	N	N	O
a	x	N	N	O
:	x	N	N	O
b	x	N	N	O
;	x	N	N	O
}	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
n	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
EOF	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
m	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
 	x	N	N	O
val	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
n	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
P	eng	N	N	O
+	x	N	N	O
i	eng	N	N	O
,	x	N	N	O
M	eng	N	N	O
+	x	N	N	O
i	eng	N	N	O
,	x	N	N	O
Low	eng	N	N	O
+	x	N	N	O
i	eng	N	N	O
,	x	N	N	O
Up	eng	N	N	O
+	x	N	N	O
i	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
m	x	N	N	O
 	x	N	N	O
+	x	N	N	O
=	x	N	N	O
 	x	N	N	O
Low	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
*	x	N	N	O
M	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
val	eng	N	N	O
 	x	N	N	O
+	x	N	N	O
=	x	N	N	O
 	x	N	N	O
Low	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
*	x	N	N	O
P	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
Up	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
-	x	N	N	O
Low	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
dp	eng	Y	N	O
,	x	N	N	O
 	x	N	N	O
0	m	N	N	O
x80	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
dp	eng	Y	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
0	x	N	N	O
]	x	N	N	O
[	x	N	N	O
0	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
m	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
m	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
cur	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
n	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
nxt	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
cur	eng	N	N	O
^	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
 	x	N	N	O
枚举	nz	Y	N	O
剩余	v	N	N	O
系	n	N	N	O
j	eng	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
j	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
 	x	N	N	O
j	x	N	N	O
 	x	N	N	O
<	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O
 	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
单调	n	Y	N	O
队列	n	Y	N	O
队首	n	N	N	O
指针	n	N	N	O
qh	eng	N	N	O
,	x	N	N	O
队尾	n	N	N	O
指针	n	N	N	O
qe	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
当前	t	N	N	O
最大	a	Y	N	O
长度	ns	Y	N	O
len	eng	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
qh	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
,	x	N	N	O
 	x	N	N	O
qe	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
1	x	N	N	O
,	x	N	N	O
 	x	N	N	O
len	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
*	x	N	N	O
M	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
k	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
j	x	N	N	O
;	x	N	N	O
 	x	N	N	O
k	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
m	x	N	N	O
;	x	N	N	O
 	x	N	N	O
k	x	N	N	O
 	x	N	N	O
+	x	N	N	O
=	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
 	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
cur	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
inf	eng	N	N	O
 	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
(	x	N	N	O
qh	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
qe	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
&&	x	N	N	O
 	x	N	N	O
(	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
cur	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
 	x	N	N	O
Q	x	N	N	O
[	x	N	N	O
qe	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
]	x	N	N	O
+	x	N	N	O
(	x	N	N	O
k	x	N	N	O
-	x	N	N	O
Q	x	N	N	O
[	x	N	N	O
qe	eng	N	N	O
]	x	N	N	O
)	x	N	N	O
*	x	N	N	O
P	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
/	x	N	N	O
M	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
cur	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
 	x	N	N	O
)	x	N	N	O
 	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
qe	eng	N	N	O
-	x	N	N	O
-	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Q	x	N	N	O
[	x	N	N	O
++	x	N	N	O
qe	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
k	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
(	x	N	N	O
qh	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
qe	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
&&	x	N	N	O
 	x	N	N	O
(	x	N	N	O
k	x	N	N	O
-	x	N	N	O
Q	x	N	N	O
[	x	N	N	O
qh	eng	N	N	O
]	x	N	N	O
>	x	N	N	O
len	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
)	x	N	N	O
 	x	N	N	O
qh	eng	N	N	O
++	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
qh	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
qe	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
nxt	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
cur	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
 	x	N	N	O
Q	x	N	N	O
[	x	N	N	O
qh	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
]	x	N	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
(	x	N	N	O
k	x	N	N	O
-	x	N	N	O
Q	x	N	N	O
[	x	N	N	O
qh	eng	N	N	O
]	x	N	N	O
)	x	N	N	O
*	x	N	N	O
P	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
/	x	N	N	O
M	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
nxt	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
k	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
inf	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
cur	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
nxt	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
\	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
cur	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
m	x	N	N	O
]	x	N	N	O
+	x	N	N	O
val	eng	N	N	O
 	x	N	N	O
)	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
将	d	N	N	O
其	r	N	N	O
转换成	i	N	N	O
 	x	N	N	O
01	m	N	N	O
背包	n	Y	N	B-KNOWLEDGE
：	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
套用	n	N	N	O
 	x	N	N	O
背包	n	Y	N	B-KNOWLEDGE
九	m	N	N	O
讲	v	N	N	O
 	x	N	N	O
的	uj	N	N	O
二进制	n	N	N	O
写法	v	N	N	O
就	d	N	N	O
可以	c	N	N	O
了	ul	N	N	O
，	x	N	N	O
一样	r	N	N	O
将	d	N	N	O
Table	eng	N	N	O
取	v	N	N	O
下限	v	N	N	O
，	x	N	N	O
转换	v	Y	N	O
出	v	N	N	O
一个	m	N	N	O
物品	n	N	N	O
数量	n	N	N	O
。	x	N	N	O


	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
模板	n	Y	N	O
是	v	N	N	O
处理	v	N	N	O
第	m	N	N	O
i	eng	N	N	O
种	m	N	N	O
物品	n	N	N	O
时	n	N	N	O
，	x	N	N	O
 	x	N	N	O
若其	c	N	N	O
 	x	N	N	O
体积	n	Y	N	O
*	x	N	N	O
数量	n	N	N	O
 	x	N	N	O
>	x	N	N	O
=	x	N	N	O
 	x	N	N	O
总	b	N	N	O
背包	n	Y	N	O
大小	b	N	N	O
，	x	N	N	O
 	x	N	N	O
则	d	N	N	O
当作	v	N	N	O
完全	ad	Y	N	O
背包	n	Y	N	B-KNOWLEDGE
处理	v	N	N	O
，	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
否则	c	N	N	O
 	x	N	N	O
将	d	N	N	O
其	r	N	N	O
按照	p	N	N	O
 	x	N	N	O
二进制	n	N	N	O
表示	v	Y	N	O
的	uj	N	N	O
形式	n	N	N	O
，	x	N	N	O
当作	v	N	N	O
一次	m	N	N	O
 	x	N	N	O
01	m	N	N	O
背包	n	Y	N	O
来	v	N	N	O
处理	v	N	N	O
。	x	N	N	O

代码	n	N	N	O
400	m	N	N	O
MS	eng	N	N	O
左右	m	N	N	O
，	x	N	N	O
比	p	N	N	O
上面	f	N	N	O
写法	v	N	N	O
快	a	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
View	eng	N	N	O
 	x	N	N	O
Code	eng	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
stdio	eng	N	N	O
.	m	N	N	O
h	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
string	eng	N	N	O
.	m	N	N	O
h	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
<	x	N	N	O
stdlib	eng	N	N	O
.	m	N	N	O
h	eng	N	N	O
>	x	N	N	O

	x	N	N	O
using	eng	N	N	O
 	x	N	N	O
namespace	eng	N	N	O
 	x	N	N	O
std	eng	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
inf	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	m	N	N	O
x80808080	eng	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
N	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
100010	m	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
,	x	N	N	O
 	x	N	N	O
V	x	N	N	O
,	x	N	N	O
 	x	N	N	O
val	eng	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
P	x	N	N	O
[	x	N	N	O
210	m	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
210	m	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
210	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
,	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
b	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
>	x	N	N	O
b	x	N	N	O
?	x	N	N	O
a	x	N	N	O
:	x	N	N	O
b	x	N	N	O
;	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
ZeroOnePack	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
cost	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
weight	eng	N	N	O
 	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
v	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
V	x	N	N	O
;	x	N	N	O
 	x	N	N	O
v	x	N	N	O
 	x	N	N	O
>	x	N	N	O
=	x	N	N	O
 	x	N	N	O
cost	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
v	x	N	N	O
-	x	N	N	O
-	x	N	N	O
 	x	N	N	O
)	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
v	x	N	N	O
-	x	N	N	O
cost	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
weight	eng	N	N	O
 	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
CompletePack	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
cost	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
weight	eng	N	N	O
 	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
v	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
cost	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
v	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
V	x	N	N	O
;	x	N	N	O
 	x	N	N	O
v	eng	N	N	O
++	x	N	N	O
 	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
v	x	N	N	O
-	x	N	N	O
cost	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
weight	eng	N	N	O
 	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
MultiplePack	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
cost	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
weight	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
num	eng	N	N	O
 	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
cost	eng	N	N	O
*	x	N	N	O
num	eng	N	N	O
 	x	N	N	O
>	x	N	N	O
=	x	N	N	O
 	x	N	N	O
V	x	N	N	O
 	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
CompletePack	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
cost	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
weight	eng	N	N	O
 	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
k	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
k	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
num	eng	N	N	O
 	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
ZeroOnePack	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
k	x	N	N	O
*	x	N	N	O
cost	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
k	x	N	N	O
*	x	N	N	O
weight	eng	N	N	O
 	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
num	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
num	eng	N	N	O
-	x	N	N	O
k	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
k	x	N	N	O
 	x	N	N	O
<	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
ZeroOnePack	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
num	eng	N	N	O
*	x	N	N	O
cost	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
num	eng	N	N	O
*	x	N	N	O
weight	eng	N	N	O
 	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
n	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
EOF	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
V	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
 	x	N	N	O
val	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
up	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
low	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
n	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
P	eng	N	N	O
+	x	N	N	O
i	eng	N	N	O
,	x	N	N	O
M	eng	N	N	O
+	x	N	N	O
i	eng	N	N	O
,	x	N	N	O
&	x	N	N	O
low	eng	N	N	O
,	x	N	N	O
&	x	N	N	O
up	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
V	x	N	N	O
 	x	N	N	O
+	x	N	N	O
=	x	N	N	O
 	x	N	N	O
low	eng	N	N	O
*	x	N	N	O
M	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
val	eng	N	N	O
 	x	N	N	O
+	x	N	N	O
=	x	N	N	O
 	x	N	N	O
low	eng	N	N	O
*	x	N	N	O
P	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
up	eng	N	N	O
-	x	N	N	O
low	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
V	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
V	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
,	x	N	N	O
 	x	N	N	O
0	m	N	N	O
x80	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
dp	eng	Y	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
0	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
1	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
=	x	N	N	O
 	x	N	N	O
n	x	N	N	O
;	x	N	N	O
 	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
MultiplePack	eng	N	N	O
(	x	N	N	O
 	x	N	N	O
M	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
P	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
 	x	N	N	O
)	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
\	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
V	x	N	N	O
]	x	N	N	O
+	x	N	N	O
val	eng	N	N	O
 	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O

	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O
　	x	N	N	O

	x	N	N	O