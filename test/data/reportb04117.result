http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
pku	eng	N	Y	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
JudgeOnline	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
3597	m	N	N	O	O

-	x	N	N	O	O

Ivy	eng	N	N	O	O
的	uj	N	N	O	O
日志	ns	N	N	O	O

-	x	N	N	O	O

网易	n	N	N	O	O
博客	nr	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
pku	eng	N	Y	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
JudgeOnline	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
3597	m	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
Polygon	eng	N	N	O	O

Division	eng	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
2008.8.29	m	N	N	O	O

import	eng	N	N	O	O

java	eng	N	N	O	O
.	m	N	N	O	O
io	eng	N	N	O	O
.	m	N	N	O	O
*	x	N	N	O	O
;	x	N	N	O	O

import	eng	N	N	O	O

java	eng	N	N	O	O
.	m	N	N	O	O
util	eng	N	N	O	O
.	m	N	N	O	O
*	x	N	N	O	O
;	x	N	N	O	O

import	eng	N	N	O	O

java	eng	N	N	O	O
.	m	N	N	O	O
lang	eng	N	N	O	O
.	m	N	N	O	O
Math	eng	N	N	O	O
;	x	N	N	O	O

import	eng	N	N	O	O

java	eng	N	N	O	O
.	m	N	N	O	O
math	eng	N	N	O	O
.	m	N	N	O	O
BigInteger	eng	N	N	O	O
;	x	N	N	O	O

public	eng	N	N	O	O

class	eng	N	N	O	O

lxjava	eng	N	N	O	O
{	x	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O

*	x	N	N	O	O

@	x	N	N	O	O
param	eng	N	N	O	O

args	eng	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

public	eng	N	N	O	O

static	eng	N	N	O	O

void	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
String	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O

args	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

TODO	eng	N	N	O	O

Auto	eng	N	N	O	O
-	x	N	N	O	O
generated	eng	N	N	O	O

method	eng	N	N	O	O

stub	eng	N	N	O	O

BigInteger	eng	N	N	O	O

[	x	N	N	O	O
]	x	N	N	O	O
arry	eng	N	N	O	O

=	x	N	N	O	O

new	eng	N	N	O	O

BigInteger	eng	N	N	O	O
[	x	N	N	O	O
5001	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

check	eng	N	N	O	O
(	x	N	N	O	O
arry	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

Scanner	eng	N	N	O	O

cin	eng	N	N	O	O

=	x	N	N	O	O

new	eng	N	N	O	O

Scanner	eng	N	N	O	O
(	x	N	N	O	O
System	eng	N	N	O	O
.	m	N	N	O	O
in	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
;	x	N	N	O	O

BigInteger	eng	N	N	O	O

mod	eng	N	N	O	O

=	x	N	N	O	O

BigInteger	eng	N	N	O	O
.	m	N	N	O	O
valueOf	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
long	eng	N	N	O	O
)	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

mod	eng	N	N	O	O

=	x	N	N	O	O

mod	eng	N	N	O	O
.	m	N	N	O	O
pow	eng	N	N	O	O
(	x	N	N	O	O
64	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
cin	eng	N	N	O	O
.	m	N	N	O	O
hasNext	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

n	x	N	N	O	O
=	x	N	N	O	O
cin	eng	N	N	O	O
.	m	N	N	O	O
nextInt	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

System	eng	N	N	O	O
.	m	N	N	O	O
out	eng	N	N	O	O
.	m	N	N	O	O
println	eng	N	N	O	O
(	x	N	N	O	O
arry	eng	N	N	O	O
[	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
mod	eng	N	N	O	O
(	x	N	N	O	O
mod	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

static	eng	N	N	O	O

void	eng	N	N	O	O

check	eng	N	N	O	O
(	x	N	N	O	O
BigInteger	eng	N	N	O	O

arry	eng	N	N	O	O
[	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

arry	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

BigInteger	eng	N	N	O	O
.	m	N	N	O	O
valueOf	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
long	eng	N	N	O	O
)	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

arry	eng	N	N	O	O
[	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

BigInteger	eng	N	N	O	O
.	m	N	N	O	O
valueOf	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
long	eng	N	N	O	O
)	x	N	N	O	O
3	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
3	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
5001	m	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

BigInteger	eng	N	N	O	O

an1	eng	N	N	O	O

=	x	N	N	O	O

BigInteger	eng	N	N	O	O
.	m	N	N	O	O
valueOf	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
long	eng	N	N	O	O
)	x	N	N	O	O
(	x	N	N	O	O
11	m	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

BigInteger	eng	N	N	O	O

an	eng	Y	N	O	O

=	x	N	N	O	O

BigInteger	eng	N	N	O	O
.	m	N	N	O	O
valueOf	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
long	eng	N	N	O	O
)	x	N	N	O	O
(	x	N	N	O	O
5	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

BigInteger	eng	N	N	O	O

an2	eng	N	N	O	O

=	x	N	N	O	O

BigInteger	eng	N	N	O	O
.	m	N	N	O	O
valueOf	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
long	eng	N	N	O	O
)	x	N	N	O	O
(	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
4	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

arry	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

(	x	N	N	O	O
an1	eng	N	N	O	O
.	m	N	N	O	O
multiply	eng	N	N	O	O
(	x	N	N	O	O
arry	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
.	m	N	N	O	O
add	eng	N	N	O	O
(	x	N	N	O	O
an2	eng	N	N	O	O
.	m	N	N	O	O
multiply	eng	N	N	O	O
(	x	N	N	O	O
arry	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
.	m	N	N	O	O
divide	eng	N	N	O	O
(	x	N	N	O	O
an	eng	Y	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

题目	n	Y	N	O	O
大意	d	N	N	O	O
：	x	N	N	O	O
有	v	N	N	O	O
多边形	n	Y	N	O	O
。	x	N	N	O	O

将	d	N	N	O	O
她	r	N	N	O	O
进行	v	N	N	O	O
三角	m	Y	N	O	O
剖分	n	N	N	O	O
或者	c	N	N	O	O
四边形	n	Y	N	O	O
剖分	n	N	N	O	O
。	x	N	N	O	O

给	p	N	N	O	O
你	r	N	N	O	O
一个	m	N	N	O	O
凸多边形	l	Y	N	O	O
的边	d	N	N	O	O
的	uj	N	N	O	O
数目	n	N	N	O	O
。	x	N	N	O	O

输出	v	Y	N	O	O
剖	n	N	N	O	O
分数	n	Y	N	O	O
。	x	N	N	O	O

算法	n	Y	N	O	O
分析	vn	N	N	O	O
：	x	N	N	O	O
有	v	N	N	O	O
公式	n	Y	N	O	O
的	uj	N	N	O	O
。	x	N	N	O	O

f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
11	m	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
2	x	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
+	x	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
3	x	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
4	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
*	x	N	N	O	O
f	x	N	N	O	O
(	x	N	N	O	O
n	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
(	x	N	N	O	O
5	x	N	N	O	O
*	x	N	N	O	O
n	x	N	N	O	O
*	x	N	N	O	O
(	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

有	v	N	N	O	O
f	eng	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
f	x	N	N	O	O
(	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
=	x	N	N	O	O
3	x	N	N	O	O
;	x	N	N	O	O
相当于	v	N	N	O	O
三	m	N	N	O	O
变形	n	Y	N	O	O
有	v	N	N	O	O
一种	m	N	N	O	O
，	x	N	N	O	O
四边形	n	Y	N	O	O
3	m	N	N	O	O
种	m	N	N	O	O
。	x	N	N	O	O

这个	r	N	N	O	O
用	p	N	N	O	O
高精度	n	Y	N	O	O
写	v	N	N	O	O
，	x	N	N	O	O
代码	n	N	N	O	O
将	d	N	N	O	O
会	v	N	N	O	O
非常	d	N	N	O	O
长	a	N	N	O	O
。	x	N	N	O	O

但是	c	N	N	O	O
用	p	N	N	O	O
JAVA	eng	N	N	O	O
的	uj	N	N	O	O
BigInteger	eng	N	N	O	O
将	d	N	N	O	O
会	v	N	N	O	O
简单	a	N	N	O	O
的	uj	N	N	O	O
多	m	N	N	O	O
。	x	N	N	O	O

时间	n	N	N	O	O
也	d	N	N	O	O
不是	c	N	N	O	O
很	d	N	N	O	O
长	a	N	N	O	O
。	x	N	N	O	O

