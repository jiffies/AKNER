POJ3249	eng	N	Y	B-OJ
（	x	N	N	O
Test	eng	N	N	O
 	x	N	N	O
for	eng	Y	N	O
 	x	N	N	O
Job	eng	N	N	O
）	x	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
Oi	eng	N	N	O
不	c	N	N	O
回头	v	N	N	O
，	x	N	N	O
菜鸟	n	N	N	O
变大牛	nz	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
博客	nr	N	N	O
频道	n	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
CSDN	eng	N	N	O
.	m	N	N	O
NET	eng	N	N	O

	x	N	N	O

	x	N	N	O
拓扑	v	Y	N	B-KNOWLEDGE
排序	n	Y	N	I-KNOWLEDGE
+	x	N	N	O
打擂台	v	N	N	O

	x	N	N	O
找	v	N	N	O
一个	m	N	N	O
入度	ns	N	N	O
为	p	N	N	O
0	m	N	N	O
的	uj	N	N	O
结点	n	Y	N	O
进行	v	N	N	O
DFS	eng	N	N	B-KNOWLEDGE
，	x	N	N	O
直到	v	N	N	O
找到	v	N	N	O
一个	m	N	N	O
出度	n	N	N	O
为	p	N	N	O
0	m	N	N	O
的	uj	N	N	O
结点	n	Y	N	O
结束	v	N	N	O
并	c	N	N	O
更新	d	N	N	O
ans	eng	N	N	O
。	x	N	N	O


	x	N	N	O
数据结构	n	N	N	O
使用	v	N	N	O
边	d	N	N	O
表	v	N	N	O
。	x	N	N	O


	x	N	N	O

	x	N	N	O
program	eng	N	N	O
 	x	N	N	O
POJ3249	eng	N	Y	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O

	x	N	N	O
 	x	N	N	O
maxn	eng	N	N	O
=	x	N	N	O
100001	m	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
maxm	eng	N	N	O
=	x	N	N	O
1000001	m	N	N	O
;	x	N	N	O

	x	N	N	O
type	eng	N	N	O

	x	N	N	O
 	x	N	N	O
gta	eng	N	N	O
=	x	N	N	O
record	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
x	x	N	N	O
,	x	N	N	O
y	x	N	N	O
,	x	N	N	O
next	eng	N	N	O
:	x	N	N	O
longint	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
end	eng	N	N	O
;	x	N	N	O

	x	N	N	O
var	eng	N	N	O

	x	N	N	O
 	x	N	N	O
b	x	N	N	O
:	x	N	N	O
array	eng	N	N	O
 	x	N	N	O
[	x	N	N	O
0..	m	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
of	eng	N	N	O
 	x	N	N	O
boolean	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
map	eng	N	N	O
:	x	N	N	O
array	eng	N	N	O
 	x	N	N	O
[	x	N	N	O
0..	m	N	N	O
maxm	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
of	eng	N	N	O
 	x	N	N	O
gta	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
c	x	N	N	O
,	x	N	N	O
into	eng	N	N	O
,	x	N	N	O
first	eng	N	N	O
,	x	N	N	O
f	x	N	N	O
:	x	N	N	O
array	eng	N	N	O
 	x	N	N	O
[	x	N	N	O
0..	m	N	N	O
maxn	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
of	eng	N	N	O
 	x	N	N	O
longint	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
n	x	N	N	O
,	x	N	N	O
m	x	N	N	O
,	x	N	N	O
ans	eng	N	N	O
,	x	N	N	O
tot	eng	N	N	O
:	x	N	N	O
longint	eng	N	N	O
;	x	N	N	O

	x	N	N	O
procedure	eng	N	N	O
 	x	N	N	O
init	eng	N	N	O
;	x	N	N	O

	x	N	N	O
var	eng	N	N	O

	x	N	N	O
 	x	N	N	O
i	x	N	N	O
,	x	N	N	O
x1	eng	N	N	O
,	x	N	N	O
x2	eng	N	N	O
:	x	N	N	O
longint	eng	N	N	O
;	x	N	N	O

	x	N	N	O
begin	eng	N	N	O

	x	N	N	O
 	x	N	N	O
ans	eng	N	N	O
:	x	N	N	O
=	x	N	N	O
-	x	N	N	O
maxlongint	eng	N	N	O
;	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
fillchar	eng	N	N	O
(	x	N	N	O
b	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
b	x	N	N	O
)	x	N	N	O
,	x	N	N	O
false	eng	N	N	O
)	x	N	N	O
;	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
fillchar	eng	N	N	O
(	x	N	N	O
f	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
f	x	N	N	O
)	x	N	N	O
,	x	N	N	O
200	m	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
fillchar	eng	N	N	O
(	x	N	N	O
map	eng	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
map	eng	N	N	O
)	x	N	N	O
,	x	N	N	O
0	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
fillchar	eng	N	N	O
(	x	N	N	O
first	eng	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
first	eng	N	N	O
)	x	N	N	O
,	x	N	N	O
0	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
fillchar	eng	N	N	O
(	x	N	N	O
into	eng	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
into	eng	N	N	O
)	x	N	N	O
,	x	N	N	O
0	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
tot	eng	N	N	O
:	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
readln	eng	N	N	O
(	x	N	N	O
n	x	N	N	O
,	x	N	N	O
m	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
 	x	N	N	O
i	x	N	N	O
:	x	N	N	O
=	x	N	N	O
1	x	N	N	O
 	x	N	N	O
to	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
 	x	N	N	O
do	eng	N	N	O
 	x	N	N	O
readln	eng	N	N	O
(	x	N	N	O
c	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
 	x	N	N	O
i	x	N	N	O
:	x	N	N	O
=	x	N	N	O
1	x	N	N	O
 	x	N	N	O
to	eng	N	N	O
 	x	N	N	O
m	x	N	N	O
 	x	N	N	O
do	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
begin	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
readln	eng	N	N	O
(	x	N	N	O
x1	eng	N	N	O
,	x	N	N	O
x2	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
inc	eng	N	N	O
(	x	N	N	O
into	eng	N	N	O
[	x	N	N	O
x2	eng	N	N	O
]	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
inc	eng	N	N	O
(	x	N	N	O
tot	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
tot	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
x	eng	N	N	O
:	x	N	N	O
=	x	N	N	O
x1	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
tot	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
y	eng	N	N	O
:	x	N	N	O
=	x	N	N	O
x2	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
tot	eng	N	N	O
]	x	N	N	O
.	m	N	N	O
next	eng	N	N	O
:	x	N	N	O
=	x	N	N	O
first	eng	N	N	O
[	x	N	N	O
x1	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
first	eng	N	N	O
[	x	N	N	O
x1	eng	N	N	O
]	x	N	N	O
:	x	N	N	O
=	x	N	N	O
tot	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
end	eng	N	N	O
;	x	N	N	O

	x	N	N	O
end	eng	N	N	O
;	x	N	N	O

	x	N	N	O
procedure	eng	N	N	O
 	x	N	N	O
DFS	eng	N	N	O
(	x	N	N	O
x	x	N	N	O
:	x	N	N	O
longint	eng	N	N	O
)	x	N	N	O
;	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
var	eng	N	N	O

	x	N	N	O
 	x	N	N	O
t	x	N	N	O
,	x	N	N	O
now	eng	N	N	O
,	x	N	N	O
y	x	N	N	O
:	x	N	N	O
longint	eng	N	N	O
;	x	N	N	O

	x	N	N	O
begin	eng	N	N	O

	x	N	N	O
 	x	N	N	O
b	x	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
:	x	N	N	O
=	x	N	N	O
true	eng	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
先	d	N	N	O
标记	n	N	N	O
这个	r	N	N	O
点	m	N	N	O
已	d	N	N	O
访问	v	N	N	O
过	ug	N	N	O
。	x	N	N	O


	x	N	N	O
 	x	N	N	O
now	eng	N	N	O
:	x	N	N	O
=	x	N	N	O
-	x	N	N	O
maxlongint	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
t	x	N	N	O
:	x	N	N	O
=	x	N	N	O
first	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
先	d	N	N	O
找	v	N	N	O
与	p	N	N	O
x	eng	N	N	O
相连	d	N	N	O
的	uj	N	N	O
第一个	m	N	N	O
结点	n	Y	N	O
。	x	N	N	O


	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
 	x	N	N	O
t	x	N	N	O
<	x	N	N	O
>	x	N	N	O
0	x	N	N	O
 	x	N	N	O
do	eng	N	N	O
/	x	N	N	O
/	x	N	N	O
把	p	N	N	O
与	p	N	N	O
x	eng	N	N	O
相连	d	N	N	O
的	uj	N	N	O
所有	b	N	N	O
点	m	N	N	O
遍历	v	Y	N	O
一遍	m	N	N	O
。	x	N	N	O


	x	N	N	O
 	x	N	N	O
 	x	N	N	O
begin	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
y	x	N	N	O
:	x	N	N	O
=	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
.	m	N	N	O
y	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
 	x	N	N	O
not	eng	N	N	O
 	x	N	N	O
b	x	N	N	O
[	x	N	N	O
y	x	N	N	O
]	x	N	N	O
 	x	N	N	O
then	eng	N	N	O
 	x	N	N	O
DFS	eng	N	N	O
(	x	N	N	O
y	x	N	N	O
)	x	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
如果	c	N	N	O
与	p	N	N	O
x	eng	N	N	O
相连	d	N	N	O
的	uj	N	N	O
这个	r	N	N	O
点	m	N	N	O
没有	v	N	N	O
访问	v	N	N	O
过	ug	N	N	O
就	d	N	N	O
访问	v	N	N	O
。	x	N	N	O


	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
 	x	N	N	O
f	x	N	N	O
[	x	N	N	O
y	x	N	N	O
]	x	N	N	O
>	x	N	N	O
now	eng	N	N	O
 	x	N	N	O
then	eng	N	N	O
 	x	N	N	O
now	eng	N	N	O
:	x	N	N	O
=	x	N	N	O
f	x	N	N	O
[	x	N	N	O
y	x	N	N	O
]	x	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
如果	c	N	N	O
＞	x	N	N	O
now	eng	N	N	O
就	d	N	N	O
更新	d	N	N	O
。	x	N	N	O


	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
t	x	N	N	O
:	x	N	N	O
=	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
.	m	N	N	O
next	eng	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
访问	v	N	N	O
下	f	N	N	O
一个点	m	N	N	O
。	x	N	N	O


	x	N	N	O
 	x	N	N	O
 	x	N	N	O
end	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
 	x	N	N	O
first	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
=	x	N	N	O
0	x	N	N	O
 	x	N	N	O
then	eng	N	N	O
 	x	N	N	O
f	x	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
:	x	N	N	O
=	x	N	N	O
c	x	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
f	x	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
:	x	N	N	O
=	x	N	N	O
now	eng	N	N	O
+	x	N	N	O
c	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
如果	c	N	N	O
这个	r	N	N	O
点	m	N	N	O
的	uj	N	N	O
出度	n	N	N	O
为	p	N	N	O
0	m	N	N	O
（	x	N	N	O
终点	d	N	N	O
）	x	N	N	O
，	x	N	N	O
值	n	N	N	O
返回	v	N	N	O
这个	r	N	N	O
点	m	N	N	O
的	uj	N	N	O
值	n	N	N	O
。	x	N	N	O


	x	N	N	O
end	eng	N	N	O
;	x	N	N	O
 	x	N	N	O

	x	N	N	O
procedure	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
;	x	N	N	O

	x	N	N	O
var	eng	N	N	O

	x	N	N	O
 	x	N	N	O
i	x	N	N	O
:	x	N	N	O
longint	eng	N	N	O
;	x	N	N	O

	x	N	N	O
begin	eng	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
 	x	N	N	O
i	x	N	N	O
:	x	N	N	O
=	x	N	N	O
1	x	N	N	O
 	x	N	N	O
to	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
 	x	N	N	O
do	eng	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
begin	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
 	x	N	N	O
into	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
=	x	N	N	O
0	x	N	N	O
 	x	N	N	O
then	eng	N	N	O
/	x	N	N	O
/	x	N	N	O
如果	c	N	N	O
入度	ns	N	N	O
为	p	N	N	O
0	m	N	N	O
，	x	N	N	O
则	d	N	N	O
这个	r	N	N	O
点	m	N	N	O
为	p	N	N	O
起点	n	N	N	O
。	x	N	N	O

进行	v	N	N	O
DFS	eng	N	N	O
。	x	N	N	O


	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
begin	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
DFS	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
 	x	N	N	O
f	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
>	x	N	N	O
ans	eng	N	N	O
 	x	N	N	O
then	eng	N	N	O
 	x	N	N	O
ans	eng	N	N	O
:	x	N	N	O
=	x	N	N	O
f	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
如果	c	N	N	O
以	p	N	N	O
当前	t	N	N	O
点	m	N	N	O
为	p	N	N	O
起点	n	N	N	O
得到	v	N	N	O
的	uj	N	N	O
结果	n	N	N	O
＞	x	N	N	O
ans	eng	N	N	O
就	d	N	N	O
更新	d	N	N	O
。	x	N	N	O

（	x	N	N	O
打擂台	v	N	N	O
）	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
end	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
end	eng	N	N	O
;	x	N	N	O

	x	N	N	O
end	eng	N	N	O
;	x	N	N	O
 	x	N	N	O

	x	N	N	O
begin	eng	N	N	O

	x	N	N	O
 	x	N	N	O
assign	eng	N	N	O
(	x	N	N	O
input	eng	N	N	O
,	x	N	N	O
'	x	N	N	O
POJ3249	eng	N	Y	O
.	m	N	N	O
in	eng	Y	N	O
'	x	N	N	O
)	x	N	N	O
;	x	N	N	O
 	x	N	N	O
reset	eng	N	N	O
(	x	N	N	O
input	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
assign	eng	N	N	O
(	x	N	N	O
output	eng	N	N	O
,	x	N	N	O
'	x	N	N	O
POJ3249	eng	N	Y	O
.	m	N	N	O
out	eng	N	N	O
'	x	N	N	O
)	x	N	N	O
;	x	N	N	O
 	x	N	N	O
rewrite	eng	N	N	O
(	x	N	N	O
output	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
 	x	N	N	O
not	eng	N	N	O
 	x	N	N	O
eof	eng	N	N	O
 	x	N	N	O
do	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
begin	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
init	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
main	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
writeln	eng	N	N	O
(	x	N	N	O
ans	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
end	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
close	eng	N	N	O
(	x	N	N	O
input	eng	N	N	O
)	x	N	N	O
;	x	N	N	O
 	x	N	N	O
close	eng	N	N	O
(	x	N	N	O
output	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
end	eng	N	N	O
.	m	N	N	O

	x	N	N	O

	x	N	N	O