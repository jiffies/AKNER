POJ	eng	N	Y	O	B-OJ
-	x	N	N	O	O
2946	m	N	N	O	O
-	x	N	N	O	O
The	eng	N	N	O	O

Warehouse	eng	N	N	O	O

-	x	N	N	O	O

z309241990	eng	N	N	O	O
的	uj	N	N	O	O
专栏	n	N	N	O	O

-	x	N	N	O	O

博客	nr	N	N	O	O
频道	n	N	N	O	O

-	x	N	N	O	O

CSDN	eng	N	N	O	O
.	m	N	N	O	O
NET	eng	N	N	O	O

唉	zg	N	N	O	O
，	x	N	N	O	O
终于	d	N	N	O	O
做到	v	N	N	O	O
书	n	N	N	O	O
中	f	N	N	O	O
图	n	N	N	O	O
遍历	v	Y	N	O	O
系列	q	N	N	O	O
的	uj	N	N	O	O
最后	f	N	N	O	O
一个	m	N	N	O	O
题	n	N	N	O	O
了	ul	N	N	O	O
。	x	N	N	O	O

题目	n	Y	N	O	O
的	uj	N	N	O	O
大意	d	N	N	O	O
是	v	N	N	O	O
说	v	N	N	O	O
，	x	N	N	O	O
你	r	N	N	O	O
所	u	N	N	O	O
处	n	N	N	O	O
的	uj	N	N	O	O
一个	m	N	N	O	O
迷宫	n	N	N	O	O
，	x	N	N	O	O
你	r	N	N	O	O
只能	v	N	N	O	O
走	v	N	N	O	O
在	p	N	N	O	O
有	v	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
方格	n	N	N	O	O
（	x	N	N	O	O
坐标	v	Y	N	O	O
）	x	N	N	O	O
上	f	N	N	O	O
，	x	N	N	O	O
方格	n	N	N	O	O
按照	p	N	N	O	O
题目	n	Y	N	O	O
的	uj	N	N	O	O
意思	n	N	N	O	O
是	v	N	N	O	O
箱子	n	N	N	O	O
，	x	N	N	O	O
其	r	N	N	O	O
为	p	N	N	O	O
长方体	n	Y	N	O	O
（	x	N	N	O	O
1	x	N	N	O	O
*	x	N	N	O	O
1	x	N	N	O	O
*	x	N	N	O	O
h	x	N	N	O	O
)	x	N	N	O	O
，	x	N	N	O	O
h	eng	N	N	O	O
即为	c	N	N	O	O
其	r	N	N	O	O
上面	f	N	N	O	O
的	uj	N	N	O	O
数字	n	Y	N	O	O
。	x	N	N	O	O

当然	d	N	N	O	O
这里	r	N	N	O	O
给	p	N	N	O	O
你	r	N	N	O	O
2	m	N	N	O	O
种	m	N	N	O	O
操作	v	Y	N	O	O
（	x	N	N	O	O
方向	n	N	N	O	O
都	d	N	N	O	O
只有	c	N	N	O	O
上下左右	m	N	N	O	O
）	x	N	N	O	O
：	x	N	N	O	O

1	x	N	N	O	O
、	x	N	N	O	O
走	v	N	N	O	O
到	v	N	N	O	O
旁边	f	N	N	O	O
的	uj	N	N	O	O
数字	n	Y	N	O	O
方格	n	N	N	O	O
上面	f	N	N	O	O
去	v	N	N	O	O
。	x	N	N	O	O

2	x	N	N	O	O
、	x	N	N	O	O
推到	v	N	N	O	O
你	r	N	N	O	O
现在	t	N	N	O	O
所站	n	N	N	O	O
的	uj	N	N	O	O
方格	n	N	N	O	O
，	x	N	N	O	O
其	r	N	N	O	O
向前	t	N	N	O	O
倒下	v	N	N	O	O
高度	n	Y	N	O	O
变为	v	N	N	O	O
1.	m	N	N	O	O
，	x	N	N	O	O
当然	d	N	N	O	O
前提	n	N	N	O	O
是	v	N	N	O	O
前面	f	N	N	O	O
有	v	N	N	O	O
足够	v	N	N	O	O
多	m	N	N	O	O
的	uj	N	N	O	O
'	x	N	N	O	O
.	x	N	N	O	O
'	x	N	N	O	O
（	x	N	N	O	O
出口	vn	N	N	O	O
E	x	N	N	O	O
不能	v	N	N	O	O
算作	v	N	N	O	O
'	x	N	N	O	O
.	x	N	N	O	O
'	x	N	N	O	O
）	x	N	N	O	O
即	v	N	N	O	O
不能	v	N	N	O	O
将	d	N	N	O	O
箱子	n	N	N	O	O
推到	v	N	N	O	O
到	v	N	N	O	O
E	eng	N	N	O	O
上面	f	N	N	O	O
去	v	N	N	O	O
。	x	N	N	O	O

题目	n	Y	N	O	O
所	c	N	N	O	O
要求	v	N	N	O	O
箱子	n	N	N	O	O
只能	v	N	N	O	O
被	p	N	N	O	O
推到	v	N	N	O	O
一次	m	N	N	O	O
，	x	N	N	O	O
即	v	N	N	O	O
在	p	N	N	O	O
做	v	N	N	O	O
的	uj	N	N	O	O
过程	n	N	N	O	O
中	f	N	N	O	O
只能	v	N	N	O	O
推	v	N	N	O	O
到	v	N	N	O	O
数字	n	Y	N	O	O
大于	d	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
等于	v	N	N	O	O
1	m	N	N	O	O
的	uj	N	N	O	O
就	d	N	N	O	O
只能	v	N	N	O	O
行走	v	N	N	O	O
。	x	N	N	O	O

注意	v	N	N	O	O
：	x	N	N	O	O
非	h	N	N	O	O
数字	n	Y	N	O	O
的	uj	N	N	O	O
坐标	v	Y	N	O	O
是	v	N	N	O	O
不能	v	N	N	O	O
走	v	N	N	O	O
的	uj	N	N	O	O
，	x	N	N	O	O
要求	v	N	N	O	O
就是	d	N	N	O	O
求	v	N	N	O	O
起点	n	N	N	O	O
到	v	N	N	O	O
终点	d	N	N	O	O
的	uj	N	N	O	O
最小	a	Y	N	O	O
步数	n	N	N	O	O
。	x	N	N	O	O

这个	r	N	N	O	O
题	n	N	N	O	O
明显	a	N	N	O	O
是	v	N	N	O	O
个	q	N	N	O	O
BFS	eng	N	N	O	B-KNOWLEDGE
搜索	v	Y	N	O	O
题	n	N	N	O	O
，	x	N	N	O	O
关键	n	N	N	O	O
的	uj	N	N	O	O
问题	n	N	N	O	O
是	v	N	N	O	O
它	r	N	N	O	O
需要	v	N	N	O	O
记录	n	Y	N	O	O
的	uj	N	N	O	O
状态	n	Y	N	O	O
并	c	N	N	O	O
不	d	N	N	O	O
像	v	N	N	O	O
以往	t	N	N	O	O
那样	r	N	N	O	O
只	d	N	N	O	O
记录	n	Y	N	O	O
坐标	v	Y	N	O	O
即可	d	N	N	O	O
，	x	N	N	O	O
它	r	N	N	O	O
需要	v	N	N	O	O
把	p	N	N	O	O
整个	b	N	N	O	O
图	n	N	N	O	O
的	uj	N	N	O	O
状态	n	Y	N	O	O
也	d	N	N	O	O
要	v	N	N	O	O
记录下来	l	N	N	O	O
。	x	N	N	O	O

这	r	N	N	O	O
就	d	N	N	O	O
给	p	N	N	O	O
去	v	N	N	O	O
重复	d	Y	N	O	O
工作	vn	N	N	O	O
增添	v	N	N	O	O
了	ul	N	N	O	O
麻烦	an	N	N	O	O
，	x	N	N	O	O
这里	r	N	N	O	O
按	p	N	N	O	O
书上	s	N	N	O	O
的	uj	N	N	O	O
建议	n	N	N	O	O
我	r	N	N	O	O
采用	v	N	N	O	O
的	uj	N	N	O	O
也	d	N	N	O	O
是	v	N	N	O	O
哈希	nrt	Y	N	O	B-KNOWLEDGE
表	v	N	N	O	O
，	x	N	N	O	O
通过	p	N	N	O	O
一个	m	N	N	O	O
表达式	n	Y	N	O	O
进行	v	N	N	O	O
计算	v	Y	N	O	O
，	x	N	N	O	O
然后	c	N	N	O	O
得到	v	N	N	O	O
一个	m	N	N	O	O
状态值	n	N	N	O	O
，	x	N	N	O	O
判断	v	Y	N	O	O
这个	r	N	N	O	O
状态值	n	N	N	O	O
是否	v	N	N	O	O
出现	v	N	N	O	O
从而	c	N	N	O	O
得到	v	N	N	O	O
当前	t	N	N	O	O
状态	n	Y	N	O	O
是否	v	N	N	O	O
与	p	N	N	O	O
之前	f	N	N	O	O
的	uj	N	N	O	O
重复	d	Y	N	O	O
。	x	N	N	O	O

这个	r	N	N	O	O
表达式	n	Y	N	O	O
有点	n	N	N	O	O
侥幸	a	N	N	O	O
的	uj	N	N	O	O
感觉	n	N	N	O	O
~	x	N	N	O	O

做	v	N	N	O	O
后	f	N	N	O	O
觉得	v	N	N	O	O
这个	r	N	N	O	O
题	n	N	N	O	O
就是	d	N	N	O	O
我们	r	N	N	O	O
以前	f	N	N	O	O
一个	m	N	N	O	O
游戏	n	Y	N	O	O
的	uj	N	N	O	O
模型	n	Y	N	O	O
，	x	N	N	O	O
还	d	N	N	O	O
觉得	v	N	N	O	O
比较	d	N	N	O	O
有意思	l	N	N	O	O
。	x	N	N	O	O

代码	n	N	N	O	O
：	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstdio	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
cstring	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAX	eng	N	N	O	O

10	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

mod	eng	N	N	O	O

3000007	m	N	N	O	O

struct	eng	N	N	O	O

map	eng	N	N	O	O

{	x	N	N	O	O

char	eng	N	N	O	O

smap	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
y	x	N	N	O	O
,	x	N	N	O	O
moves	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O
q	x	N	N	O	O
[	x	N	N	O	O
1000000	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
movex	eng	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O
movey	eng	N	N	O	O
[	x	N	N	O	O
4	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
1	x	N	N	O	O
}	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

ipos	eng	N	N	O	O
[	x	N	N	O	O
mod	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

isborder	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

y	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O
<	x	N	N	O	O
0	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
x	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
y	x	N	N	O	O
<	x	N	N	O	O
0	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
y	x	N	N	O	O
>	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

true	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

false	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

GetHash	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

index	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
*	x	N	N	O	O
131	m	N	N	O	O
+	x	N	N	O	O
q	eng	N	N	O	O
[	x	N	N	O	O
index	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
mod	eng	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
ans	eng	N	N	O	O
+	x	N	N	O	O
q	eng	N	N	O	O
[	x	N	N	O	O
index	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
*	x	N	N	O	O
33	m	N	N	O	O
+	x	N	N	O	O
q	eng	N	N	O	O
[	x	N	N	O	O
index	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
*	x	N	N	O	O
131	m	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
mod	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

ans	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
q	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
q	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
&&	x	N	N	O	O
n	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
ipos	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
ipos	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

front	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
last	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O
pos	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
moves	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

getchar	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
c	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
q	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

ipos	eng	N	N	O	O
[	x	N	N	O	O
GetHash	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

flag	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
front	eng	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
last	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

char	eng	N	N	O	O

smap	eng	N	N	O	O
[	x	N	N	O	O
8	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
8	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

smap	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
q	x	N	N	O	O
[	x	N	N	O	O
front	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

itx	eng	N	N	O	O
=	x	N	N	O	O
q	x	N	N	O	O
[	x	N	N	O	O
front	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ity	eng	N	N	O	O
=	x	N	N	O	O
q	x	N	N	O	O
[	x	N	N	O	O
front	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

moves	eng	N	N	O	O
=	x	N	N	O	O
q	x	N	N	O	O
[	x	N	N	O	O
front	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
moves	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
4	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

xx	eng	N	N	O	O
=	x	N	N	O	O
itx	eng	N	N	O	O
+	x	N	N	O	O
movex	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

yy	eng	N	N	O	O
=	x	N	N	O	O
ity	eng	N	N	O	O
+	x	N	N	O	O
movey	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
(	x	N	N	O	O
isborder	eng	N	N	O	O
(	x	N	N	O	O
xx	eng	N	N	O	O
,	x	N	N	O	O
yy	eng	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
xx	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
yy	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
.	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
xx	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
yy	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
E	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

flag	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

ans	eng	N	N	O	O
=	x	N	N	O	O
moves	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

hash	eng	Y	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

hash	eng	Y	N	O	O
=	x	N	N	O	O
(	x	N	N	O	O
hash	eng	Y	N	O	O
*	x	N	N	O	O
131	m	N	N	O	O
+	x	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
mod	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
ipos	eng	N	N	O	O
[	x	N	N	O	O
(	x	N	N	O	O
hash	eng	Y	N	O	O
+	x	N	N	O	O
xx	eng	N	N	O	O
*	x	N	N	O	O
33	m	N	N	O	O
+	x	N	N	O	O
yy	eng	N	N	O	O
*	x	N	N	O	O
131	m	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
mod	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
last	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
last	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
=	x	N	N	O	O
xx	eng	N	N	O	O
;	x	N	N	O	O
q	x	N	N	O	O
[	x	N	N	O	O
last	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
=	x	N	N	O	O
yy	eng	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
last	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
moves	eng	N	N	O	O
=	x	N	N	O	O
moves	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

last	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

ipos	eng	N	N	O	O
[	x	N	N	O	O
(	x	N	N	O	O
hash	eng	Y	N	O	O
+	x	N	N	O	O
xx	eng	N	N	O	O
*	x	N	N	O	O
33	m	N	N	O	O
+	x	N	N	O	O
yy	eng	N	N	O	O
*	x	N	N	O	O
131	m	N	N	O	O
)	x	N	N	O	O
%	x	N	N	O	O
mod	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
itx	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ity	eng	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
.	x	N	N	O	O
'	x	N	N	O	O
&&	x	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
itx	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ity	eng	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
1	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

flaga	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
mx	eng	N	N	O	O
=	x	N	N	O	O
itx	eng	N	N	O	O
,	x	N	N	O	O
my	eng	N	N	O	O
=	x	N	N	O	O
ity	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
itx	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ity	eng	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

mx	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
movex	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

my	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
movey	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
isborder	eng	N	N	O	O
(	x	N	N	O	O
mx	eng	N	N	O	O
,	x	N	N	O	O
my	eng	N	N	O	O
)	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
mx	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
my	eng	N	N	O	O
]	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
.	x	N	N	O	O
'	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

flaga	eng	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
flaga	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

k	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
k	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
k	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
last	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

mx	eng	N	N	O	O
=	x	N	N	O	O
itx	eng	N	N	O	O
,	x	N	N	O	O
my	eng	N	N	O	O
=	x	N	N	O	O
ity	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
itx	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ity	eng	N	N	O	O
]	x	N	N	O	O
-	x	N	N	O	O
'	x	N	N	O	O
0	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

mx	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
movex	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

my	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
movey	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
last	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
mx	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
my	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
1	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
last	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
smap	eng	N	N	O	O
[	x	N	N	O	O
itx	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
ity	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
'	x	N	N	O	O
.	x	N	N	O	O
'	x	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
last	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
=	x	N	N	O	O
xx	eng	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
last	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
=	x	N	N	O	O
yy	eng	N	N	O	O
;	x	N	N	O	O

q	x	N	N	O	O
[	x	N	N	O	O
last	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
moves	eng	N	N	O	O
=	x	N	N	O	O
moves	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O

ipos	eng	N	N	O	O
[	x	N	N	O	O
GetHash	eng	N	N	O	O
(	x	N	N	O	O
last	eng	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

last	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
flag	eng	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
flag	eng	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
ans	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
Impossible	eng	N	N	O	O
.	m	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

