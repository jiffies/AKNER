http	eng	N	N	O
:	x	N	N	O
/	x	N	N	O
/	x	N	N	O
acm	eng	N	N	O
.	m	N	N	O
pku	eng	N	Y	O
.	m	N	N	O
edu	eng	N	N	O
.	m	N	N	O
cn	eng	N	N	O
/	x	N	N	O
JudgeOnline	eng	N	N	O
/	x	N	N	O
problem	eng	N	N	O
?	x	N	N	O
id	eng	N	N	O
=	x	N	N	O
3597	m	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
Ivy	eng	N	N	O
的	uj	N	N	O
日志	ns	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
网易	n	N	N	O
博客	nr	N	N	O

	x	N	N	O

	x	N	N	O
/	x	N	N	O
/	x	N	N	O
http	eng	N	N	O
:	x	N	N	O
/	x	N	N	O
/	x	N	N	O
acm	eng	N	N	O
.	m	N	N	O
pku	eng	N	Y	O
.	m	N	N	O
edu	eng	N	N	O
.	m	N	N	O
cn	eng	N	N	O
/	x	N	N	O
JudgeOnline	eng	N	N	O
/	x	N	N	O
problem	eng	N	N	O
?	x	N	N	O
id	eng	N	N	O
=	x	N	N	O
3597	m	N	N	O

	x	N	N	O
/	x	N	N	O
/	x	N	N	O
Polygon	eng	N	N	O
 	x	N	N	O
Division	eng	N	N	O

	x	N	N	O
/	x	N	N	O
/	x	N	N	O
2008.8.29	m	N	N	O

	x	N	N	O
import	eng	N	N	O
 	x	N	N	O
java	eng	N	N	O
.	m	N	N	O
io	eng	N	N	O
.	m	N	N	O
*	x	N	N	O
;	x	N	N	O

	x	N	N	O
import	eng	N	N	O
 	x	N	N	O
java	eng	N	N	O
.	m	N	N	O
util	eng	N	N	O
.	m	N	N	O
*	x	N	N	O
;	x	N	N	O

	x	N	N	O
import	eng	N	N	O
 	x	N	N	O
java	eng	N	N	O
.	m	N	N	O
lang	eng	N	N	O
.	m	N	N	O
Math	eng	N	N	O
;	x	N	N	O

	x	N	N	O
import	eng	N	N	O
 	x	N	N	O
java	eng	N	N	O
.	m	N	N	O
math	eng	N	N	O
.	m	N	N	O
BigInteger	eng	N	N	O
;	x	N	N	O

	x	N	N	O
public	eng	N	N	O
 	x	N	N	O
class	eng	N	N	O
 	x	N	N	O
lxjava	eng	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
/	x	N	N	O
*	x	N	N	O
*	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
@	x	N	N	O
param	eng	N	N	O
 	x	N	N	O
args	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
/	x	N	N	O

	x	N	N	O
 	x	N	N	O
public	eng	N	N	O
 	x	N	N	O
static	eng	N	N	O
 	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
String	eng	N	N	O
[	x	N	N	O
]	x	N	N	O
 	x	N	N	O
args	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
 	x	N	N	O
TODO	eng	N	N	O
 	x	N	N	O
Auto	eng	N	N	O
-	x	N	N	O
generated	eng	N	N	O
 	x	N	N	O
method	eng	N	N	O
 	x	N	N	O
stub	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
 	x	N	N	O
[	x	N	N	O
]	x	N	N	O
arry	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
new	eng	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
[	x	N	N	O
5001	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
check	eng	N	N	O
(	x	N	N	O
arry	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Scanner	eng	N	N	O
 	x	N	N	O
cin	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
new	eng	N	N	O
 	x	N	N	O
Scanner	eng	N	N	O
(	x	N	N	O
System	eng	N	N	O
.	m	N	N	O
in	eng	Y	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
 	x	N	N	O
mod	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
.	m	N	N	O
valueOf	eng	N	N	O
(	x	N	N	O
(	x	N	N	O
long	eng	N	N	O
)	x	N	N	O
2	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
mod	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
mod	eng	N	N	O
.	m	N	N	O
pow	eng	N	N	O
(	x	N	N	O
64	m	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
cin	eng	N	N	O
.	m	N	N	O
hasNext	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
n	x	N	N	O
=	x	N	N	O
cin	eng	N	N	O
.	m	N	N	O
nextInt	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
System	eng	N	N	O
.	m	N	N	O
out	eng	N	N	O
.	m	N	N	O
println	eng	N	N	O
(	x	N	N	O
arry	eng	N	N	O
[	x	N	N	O
n	x	N	N	O
-	x	N	N	O
2	x	N	N	O
]	x	N	N	O
.	m	N	N	O
mod	eng	N	N	O
(	x	N	N	O
mod	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
static	eng	N	N	O
 	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
check	eng	N	N	O
(	x	N	N	O
BigInteger	eng	N	N	O
 	x	N	N	O
arry	eng	N	N	O
[	x	N	N	O
]	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
arry	eng	N	N	O
[	x	N	N	O
1	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
.	m	N	N	O
valueOf	eng	N	N	O
(	x	N	N	O
(	x	N	N	O
long	eng	N	N	O
)	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
arry	eng	N	N	O
[	x	N	N	O
2	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
.	m	N	N	O
valueOf	eng	N	N	O
(	x	N	N	O
(	x	N	N	O
long	eng	N	N	O
)	x	N	N	O
3	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
3	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
5001	m	N	N	O
;	x	N	N	O
++	x	N	N	O
i	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
 	x	N	N	O
an1	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
.	m	N	N	O
valueOf	eng	N	N	O
(	x	N	N	O
(	x	N	N	O
long	eng	N	N	O
)	x	N	N	O
(	x	N	N	O
11	m	N	N	O
*	x	N	N	O
i	x	N	N	O
*	x	N	N	O
(	x	N	N	O
2	x	N	N	O
*	x	N	N	O
i	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
 	x	N	N	O
an	eng	Y	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
.	m	N	N	O
valueOf	eng	N	N	O
(	x	N	N	O
(	x	N	N	O
long	eng	N	N	O
)	x	N	N	O
(	x	N	N	O
5	x	N	N	O
*	x	N	N	O
i	x	N	N	O
*	x	N	N	O
(	x	N	N	O
i	eng	N	N	O
+	x	N	N	O
1	m	N	N	O
)	x	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
 	x	N	N	O
an2	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
BigInteger	eng	N	N	O
.	m	N	N	O
valueOf	eng	N	N	O
(	x	N	N	O
(	x	N	N	O
long	eng	N	N	O
)	x	N	N	O
(	x	N	N	O
3	x	N	N	O
*	x	N	N	O
(	x	N	N	O
3	x	N	N	O
*	x	N	N	O
i	x	N	N	O
-	x	N	N	O
2	x	N	N	O
)	x	N	N	O
*	x	N	N	O
(	x	N	N	O
3	x	N	N	O
*	x	N	N	O
i	x	N	N	O
-	x	N	N	O
4	x	N	N	O
)	x	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
arry	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
(	x	N	N	O
an1	eng	N	N	O
.	m	N	N	O
multiply	eng	N	N	O
(	x	N	N	O
arry	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
-	x	N	N	O
1	x	N	N	O
]	x	N	N	O
)	x	N	N	O
.	m	N	N	O
add	eng	N	N	O
(	x	N	N	O
an2	eng	N	N	O
.	m	N	N	O
multiply	eng	N	N	O
(	x	N	N	O
arry	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
-	x	N	N	O
2	x	N	N	O
]	x	N	N	O
)	x	N	N	O
)	x	N	N	O
)	x	N	N	O
.	m	N	N	O
divide	eng	N	N	O
(	x	N	N	O
an	eng	Y	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
题目	n	Y	N	O
大意	d	N	N	O
：	x	N	N	O
有	v	N	N	O
多边形	n	Y	N	O
。	x	N	N	O

将	d	N	N	O
她	r	N	N	O
进行	v	N	N	O
三角	m	Y	N	O
剖分	n	N	N	O
或者	c	N	N	O
四边形	n	Y	N	O
剖分	n	N	N	O
。	x	N	N	O

给	p	N	N	O
你	r	N	N	O
一个	m	N	N	O
凸多边形	l	Y	N	O
的边	d	N	N	O
的	uj	N	N	O
数目	n	N	N	O
。	x	N	N	O

输出	v	Y	N	O
剖	n	N	N	O
分数	n	Y	N	O
。	x	N	N	O


	x	N	N	O
算法	n	Y	N	O
分析	vn	N	N	O
：	x	N	N	O
有	v	N	N	O
公式	n	Y	N	O
的	uj	N	N	O
。	x	N	N	O

f	x	N	N	O
(	x	N	N	O
n	x	N	N	O
)	x	N	N	O
=	x	N	N	O
(	x	N	N	O
(	x	N	N	O
(	x	N	N	O
11	m	N	N	O
*	x	N	N	O
n	x	N	N	O
*	x	N	N	O
(	x	N	N	O
2	x	N	N	O
*	x	N	N	O
n	x	N	N	O
-	x	N	N	O
)	x	N	N	O
)	x	N	N	O
*	x	N	N	O
f	x	N	N	O
(	x	N	N	O
n	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
)	x	N	N	O
+	x	N	N	O
(	x	N	N	O
(	x	N	N	O
3	x	N	N	O
*	x	N	N	O
(	x	N	N	O
3	x	N	N	O
*	x	N	N	O
n	x	N	N	O
-	x	N	N	O
2	x	N	N	O
)	x	N	N	O
*	x	N	N	O
(	x	N	N	O
3	x	N	N	O
*	x	N	N	O
n	x	N	N	O
-	x	N	N	O
4	x	N	N	O
)	x	N	N	O
)	x	N	N	O
*	x	N	N	O
f	x	N	N	O
(	x	N	N	O
n	x	N	N	O
-	x	N	N	O
2	x	N	N	O
)	x	N	N	O
)	x	N	N	O
)	x	N	N	O
/	x	N	N	O
(	x	N	N	O
5	x	N	N	O
*	x	N	N	O
n	x	N	N	O
*	x	N	N	O
(	x	N	N	O
n	eng	N	N	O
+	x	N	N	O
1	m	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
有	v	N	N	O
f	eng	N	N	O
(	x	N	N	O
1	x	N	N	O
)	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
f	x	N	N	O
(	x	N	N	O
2	x	N	N	O
)	x	N	N	O
=	x	N	N	O
3	x	N	N	O
;	x	N	N	O
相当于	v	N	N	O
三	m	N	N	O
变形	n	Y	N	O
有	v	N	N	O
一种	m	N	N	O
，	x	N	N	O
四边形	n	Y	N	O
3	m	N	N	O
种	m	N	N	O
。	x	N	N	O

这个	r	N	N	O
用	p	N	N	O
高精度	n	Y	N	O
写	v	N	N	O
，	x	N	N	O
代码	n	N	N	O
将	d	N	N	O
会	v	N	N	O
非常	d	N	N	O
长	a	N	N	O
。	x	N	N	O

但是	c	N	N	O
用	p	N	N	O
JAVA	eng	N	N	O
的	uj	N	N	O
BigInteger	eng	N	N	O
将	d	N	N	O
会	v	N	N	O
简单	a	N	N	O
的	uj	N	N	O
多	m	N	N	O
。	x	N	N	O

时间	n	N	N	O
也	d	N	N	O
不是	c	N	N	O
很	d	N	N	O
长	a	N	N	O
。	x	N	N	O


	x	N	N	O