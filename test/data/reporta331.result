POJ	eng	N	Y	O	B-OJ

2394	m	N	N	O	I-OJ

-	x	N	N	O	O
-	x	N	N	O	O

Checking	eng	N	N	O	O

an	eng	Y	N	O	O

Alibi	eng	N	N	O	O
_	x	N	N	O	O
snuc	eng	N	N	O	O
_	x	N	N	O	O
新浪	nz	N	N	O	O
博客	nr	N	N	O	O

http	eng	N	N	O	O
:	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
acm	eng	N	N	O	O
.	m	N	N	O	O
pku	eng	N	Y	O	O
.	m	N	N	O	O
edu	eng	N	N	O	O
.	m	N	N	O	O
cn	eng	N	N	O	O
/	x	N	N	O	O
JudgeOnline	eng	N	N	O	O
/	x	N	N	O	O
problem	eng	N	N	O	O
?	x	N	N	O	O
id	eng	N	N	O	O
=	x	N	N	O	O
2394	m	N	N	O	O

单源	n	Y	N	O	B-KNOWLEDGE
最	d	N	N	O	I-KNOWLEDGE
短	a	N	N	O	I-KNOWLEDGE
路径	n	Y	N	O	I-KNOWLEDGE
(	x	N	N	O	O
无	v	N	N	O	O
负权	n	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
dijkstra	eng	Y	N	O	B-KNOWLEDGE
算法	n	Y	N	O	O
.	x	N	N	O	O

程序	n	N	N	O	O
如下	t	N	N	O	O
:	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O
<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAX	eng	N	N	O	O

500	m	N	N	O	O

#	x	N	N	O	O
define	eng	N	N	O	O

MAXVALUE	eng	N	N	O	O

100000000	m	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
表示	v	Y	N	O	O
两点	m	N	N	O	O
之间	f	N	N	O	O
无边	d	N	N	O	O
连通	a	Y	N	O	O

int	eng	N	N	O	O

Cost	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
Dist	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
Prev	eng	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

void	eng	N	N	O	O

Dijkstra	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

v	x	N	N	O	O
)	x	N	N	O	O
/	x	N	N	O	O
/	x	N	N	O	O
求	v	N	N	O	O
n	eng	N	N	O	O
个	m	N	N	O	O
结点	n	Y	N	O	O
的	uj	N	N	O	O
图	n	N	N	O	O
中	f	N	N	O	O
(	x	N	N	O	O
邻接矩阵	nz	N	N	O	O
存储	j	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
顶点	n	Y	N	O	O
v	eng	N	N	O	O
到	v	N	N	O	O
其他	r	N	N	O	O
各	r	N	N	O	O
点	q	N	N	O	O
的	uj	N	N	O	O
最短	a	Y	N	O	O
路径	n	Y	N	O	O
,	x	N	N	O	O
Dist	eng	N	N	O	O
数组	n	Y	N	O	O
保存	v	N	N	O	O
最	d	N	N	O	O
短	a	N	N	O	O
路径	n	Y	N	O	O
的	uj	N	N	O	O
值	n	N	N	O	O
,	x	N	N	O	O
Prev	eng	N	N	O	O
数组	n	Y	N	O	O
保存	v	N	N	O	O
路径	n	Y	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

newdist	eng	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
temp	eng	N	N	O	O
,	x	N	N	O	O
u	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
MAX	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

Dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
Cost	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
false	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
Dist	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
MAXVALUE	eng	N	N	O	O
)	x	N	N	O	O

Prev	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

Prev	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

Dist	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

temp	eng	N	N	O	O
=	x	N	N	O	O
MAXVALUE	eng	N	N	O	O
;	x	N	N	O	O

u	x	N	N	O	O
=	x	N	N	O	O
v	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

(	x	N	N	O	O
Dist	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
temp	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

u	x	N	N	O	O
=	x	N	N	O	O
j	x	N	N	O	O
;	x	N	N	O	O

temp	eng	N	N	O	O
=	x	N	N	O	O
Dist	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

s	x	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
s	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

&&	x	N	N	O	O

(	x	N	N	O	O
Cost	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
MAXVALUE	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

newdist	eng	N	N	O	O
=	x	N	N	O	O
Dist	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
Cost	eng	N	N	O	O
[	x	N	N	O	O
u	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
newdist	eng	N	N	O	O
<	x	N	N	O	O
Dist	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

Dist	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
newdist	eng	N	N	O	O
;	x	N	N	O	O

Prev	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
u	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

f	x	N	N	O	O
,	x	N	N	O	O
p	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
,	x	N	N	O	O
cow	eng	N	N	O	O
[	x	N	N	O	O
100	m	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
{	x	N	N	O	O
0	x	N	N	O	O
}	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O
j	x	N	N	O	O
,	x	N	N	O	O
k	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
f	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
p	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
c	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
f	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
j	x	N	N	O	O
<	x	N	N	O	O
f	x	N	N	O	O
;	x	N	N	O	O
j	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

Cost	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
MAXVALUE	eng	N	N	O	O
;	x	N	N	O	O

Cost	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
p	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
j	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
k	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
t	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
Cost	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
t	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

Cost	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

Cost	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
t	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

Dijkstra	eng	N	N	O	O
(	x	N	N	O	O
f	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
j	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
Dist	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
)	x	N	N	O	O

cow	eng	N	N	O	O
[	x	N	N	O	O
r	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
i	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
r	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
r	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
cow	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

