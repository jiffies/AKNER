POJ	eng	N	Y	B-OJ
 	x	N	N	I-OJ
3585	m	N	N	I-OJ
 	x	N	N	O
一道	m	N	N	O
很好	a	N	N	O
的	uj	N	N	O
树	n	N	N	O
DP	eng	N	N	B-KNOWLEDGE
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
ronaflx	eng	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
博客园	nr	N	N	O

	x	N	N	O

	x	N	N	O
题目	n	Y	N	O
要求	v	N	N	O
给	p	N	N	O
一棵	m	N	N	O
加权	v	N	N	O
无向	d	Y	N	O
树	v	N	N	O
，	x	N	N	O
求	v	N	N	O
每个	r	N	N	O
点	m	N	N	O
到	v	N	N	O
叶子	nr	N	N	O
节点	n	N	N	O
的	uj	N	N	O
最大	a	Y	N	O
流量	n	N	N	O
。	x	N	N	O

范围	n	N	N	O
20	m	N	N	O
万	m	N	N	O
。	x	N	N	O


	x	N	N	O
必须	d	N	N	O
是	v	N	N	O
O	eng	N	N	O
(	x	N	N	O
N	x	N	N	O
)	x	N	N	O
的	uj	N	N	O
树	n	N	N	O
DP	eng	N	N	B-KNOWLEDGE
才	d	N	N	O
行	v	N	N	O
。	x	N	N	O


	x	N	N	O
首先	d	N	N	O
固定	a	Y	N	O
一个	m	N	N	O
为	p	N	N	O
根	a	N	N	O
，	x	N	N	O
做	v	N	N	O
一次	m	N	N	O
DFS	eng	N	N	B-KNOWLEDGE
，	x	N	N	O
求	v	N	N	O
每个	r	N	N	O
节点	n	N	N	O
到	v	N	N	O
其子	r	N	N	O
树	v	N	N	O
的	uj	N	N	O
叶子	nr	N	N	O
节点	n	N	N	O
的	uj	N	N	O
流量	n	N	N	O
和	c	N	N	O
son	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
，	x	N	N	O
以及	c	N	N	O
每个	r	N	N	O
节点	n	N	N	O
对	p	N	N	O
其	r	N	N	O
父亲	n	N	N	O
节点	n	N	N	O
的	uj	N	N	O
贡献	n	N	N	O
belong	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
，	x	N	N	O
还有	v	N	N	O
每个	r	N	N	O
点	m	N	N	O
和	c	N	N	O
他	r	N	N	O
父亲	n	N	N	O
节点	n	N	N	O
的	uj	N	N	O
边权	n	N	N	O
edge	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
。	x	N	N	O

然后	c	N	N	O
对	p	N	N	O
每个	r	N	N	O
节点	n	N	N	O
做	v	N	N	O
一次	m	N	N	O
记忆	n	Y	N	B-KNOWLEDGE
化	n	N	N	I-KNOWLEDGE
搜索	v	Y	N	I-KNOWLEDGE
，	x	N	N	O
顺着	p	N	N	O
第一次	m	N	N	O
搜索	v	Y	N	O
的	uj	N	N	O
边	n	N	N	O
反向	v	N	N	O
搜索	v	Y	N	O
。	x	N	N	O

DP	eng	N	N	B-KNOWLEDGE
的	uj	N	N	O
转移	v	N	N	O
方程	n	Y	N	O
是	v	N	N	O

	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
min	eng	N	N	O
(	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
father	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
]	x	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
belong	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
dege	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
 	x	N	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
son	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
解题	n	N	N	O
的	uj	N	N	O
过程	n	N	N	O
比较	d	N	N	O
坎坷	a	N	N	O
。	x	N	N	O

首先	d	N	N	O
状态	n	Y	N	O
转移	v	N	N	O
方程	n	Y	N	O
多次	m	N	N	O
修改	v	N	N	O
，	x	N	N	O
导致	v	N	N	O
第一次	m	N	N	O
DFS	eng	N	N	B-KNOWLEDGE
所	c	N	N	O
要求	v	N	N	O
的	uj	N	N	O
东西	ns	N	N	O
不	d	N	N	O
明确	ad	N	N	O
，	x	N	N	O
所以	c	N	N	O
改	v	N	N	O
了	ul	N	N	O
好	a	N	N	O
多次	m	N	N	O
。	x	N	N	O

这	r	N	N	O
是	v	N	N	O
写	v	N	N	O
DP	eng	N	N	B-KNOWLEDGE
的	uj	N	N	O
一大	a	N	N	O
忌讳	v	N	N	O
…	x	N	N	O
…	x	N	N	O
没	v	N	N	O
确定	v	N	N	O
转移	v	N	N	O
过程	n	N	N	O
就	d	N	N	O
开始	v	N	N	O
写题	n	N	N	O

	x	N	N	O
确定	v	N	N	O
转移	v	N	N	O
方程	n	Y	N	O
以后	f	N	N	O
，	x	N	N	O
有	v	N	N	O
一种	m	N	N	O
特殊	a	N	N	O
的	uj	N	N	O
情况	n	N	N	O
没有	v	N	N	O
处理	v	N	N	O
好	a	N	N	O
，	x	N	N	O
就是	d	N	N	O
当	t	N	N	O
固定	a	Y	N	O
的	uj	N	N	O
根是	n	N	N	O
个度	n	N	N	O
为	p	N	N	O
1	m	N	N	O
的	uj	N	N	O
点	m	N	N	O
时	ng	N	N	O
，	x	N	N	O
需要	v	N	N	O
特殊	a	N	N	O
处理	v	N	N	O
。	x	N	N	O

思考问题	n	N	N	O
需要	v	N	N	O
群面	n	N	N	O
。	x	N	N	O


	x	N	N	O
一下	m	N	N	O
为此	r	N	N	O
题	n	N	N	O
的	uj	N	N	O
代码	n	N	N	O
：	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
POJ	eng	N	Y	B-OJ
 	x	N	N	I-OJ
3585	m	N	N	I-OJ
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
1	x	N	N	O
 	x	N	N	O
/	x	N	N	O
*	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
2	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
3	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
4	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Filename	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
.	m	N	N	O
cpp	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
5	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
6	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Description	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
 	x	N	N	O
tree	eng	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
 	x	N	N	O
problem	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
7	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
8	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Version	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
 	x	N	N	O
1.0	m	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
9	x	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Created	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
 	x	N	N	O
2011	m	N	N	O
年	m	N	N	O
07	m	N	N	O
月	m	N	N	O
22	m	N	N	O
日	m	N	N	O
 	x	N	N	O
13	m	N	N	O
时	n	N	N	O
41	m	N	N	O
分	v	N	N	O
18	m	N	N	O
秒	m	N	N	O

	x	N	N	O
 	x	N	N	O
10	m	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Revision	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
 	x	N	N	O
none	eng	N	N	O

	x	N	N	O
 	x	N	N	O
11	m	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Compiler	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
 	x	N	N	O
gcc	eng	N	N	O

	x	N	N	O
 	x	N	N	O
12	m	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O

	x	N	N	O
 	x	N	N	O
13	m	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Author	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
 	x	N	N	O
ronaflx	eng	N	N	O

	x	N	N	O
 	x	N	N	O
14	m	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
Company	eng	N	N	O
:	x	N	N	O
 	x	N	N	O
 	x	N	N	O
hit	eng	N	N	O
-	x	N	N	O
ACM	eng	N	N	O
-	x	N	N	O
Group	eng	N	N	O

	x	N	N	O
 	x	N	N	O
15	m	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O

	x	N	N	O
 	x	N	N	O
16	m	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O
=	x	N	N	O

	x	N	N	O
 	x	N	N	O
17	m	N	N	O
 	x	N	N	O
 	x	N	N	O
*	x	N	N	O
/	x	N	N	O

	x	N	N	O
 	x	N	N	O
18	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
cstdlib	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
19	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
cctype	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
20	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
cstring	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
21	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
cstdio	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
22	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
cmath	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
23	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
ctime	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
24	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
climits	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
25	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
algorithm	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
26	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
functional	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
27	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
numeric	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
28	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
vector	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
29	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
map	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
30	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
set	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
31	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
queue	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
32	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
stack	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
33	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
bitset	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
34	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
list	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
35	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
string	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
36	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
iostream	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
37	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
sstream	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
38	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
fstream	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
39	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
iomanip	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
40	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
stdexcept	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
41	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
utility	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
42	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
cassert	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
43	m	N	N	O
 	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
complex	eng	N	N	O
>	x	N	N	O

	x	N	N	O
 	x	N	N	O
44	m	N	N	O
 	x	N	N	O
using	eng	N	N	O
 	x	N	N	O
namespace	eng	N	N	O
 	x	N	N	O
std	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
45	m	N	N	O
 	x	N	N	O
#	x	N	N	O
define	eng	N	N	O
 	x	N	N	O
LEFT	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
)	x	N	N	O
 	x	N	N	O
(	x	N	N	O
(	x	N	N	O
i	x	N	N	O
)	x	N	N	O
 	x	N	N	O
<	x	N	N	O
<	x	N	N	O
 	x	N	N	O
1	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
46	m	N	N	O
 	x	N	N	O
#	x	N	N	O
define	eng	N	N	O
 	x	N	N	O
RIGHT	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
)	x	N	N	O
 	x	N	N	O
(	x	N	N	O
(	x	N	N	O
(	x	N	N	O
i	x	N	N	O
)	x	N	N	O
 	x	N	N	O
<	x	N	N	O
<	x	N	N	O
 	x	N	N	O
1	x	N	N	O
)	x	N	N	O
 	x	N	N	O
|	x	N	N	O
 	x	N	N	O
1	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
47	m	N	N	O
 	x	N	N	O
#	x	N	N	O
define	eng	N	N	O
 	x	N	N	O
MID	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
)	x	N	N	O
 	x	N	N	O
(	x	N	N	O
(	x	N	N	O
l	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
r	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
 	x	N	N	O
>	x	N	N	O
>	x	N	N	O
 	x	N	N	O
1	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
48	m	N	N	O
 	x	N	N	O
#	x	N	N	O
define	eng	N	N	O
 	x	N	N	O
CC	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
,	x	N	N	O
 	x	N	N	O
v	x	N	N	O
)	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
,	x	N	N	O
 	x	N	N	O
v	x	N	N	O
,	x	N	N	O
 	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
)	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
49	m	N	N	O
 	x	N	N	O
#	x	N	N	O
define	eng	N	N	O
 	x	N	N	O
REP	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
,	x	N	N	O
 	x	N	N	O
l	x	N	N	O
,	x	N	N	O
 	x	N	N	O
n	x	N	N	O
)	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
l	x	N	N	O
;	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
(	x	N	N	O
n	x	N	N	O
)	x	N	N	O
;	x	N	N	O
++	x	N	N	O
i	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
50	m	N	N	O
 	x	N	N	O
#	x	N	N	O
define	eng	N	N	O
 	x	N	N	O
FOREACH	eng	N	N	O
(	x	N	N	O
con	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
i	x	N	N	O
)	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
__	x	N	N	O
typeof	eng	N	N	O
(	x	N	N	O
con	eng	N	N	O
.	m	N	N	O
begin	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
)	x	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
con	eng	N	N	O
.	m	N	N	O
begin	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O
i	x	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
con	eng	N	N	O
.	m	N	N	O
end	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O
++	x	N	N	O
i	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
51	m	N	N	O
 	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
N	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
200000	m	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
52	m	N	N	O
 	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
INF	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
(	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
long	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
N	x	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
N	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
53	m	N	N	O
 	x	N	N	O
vector	eng	N	N	O
<	x	N	N	O
pair	eng	N	N	O
<	x	N	N	O
int	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
long	eng	N	N	O
>	x	N	N	O
 	x	N	N	O
>	x	N	N	O
 	x	N	N	O
adj	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
54	m	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
son	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
belong	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
edge	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
55	m	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
father	eng	N	N	O
[	x	N	N	O
N	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
56	m	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
DP	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
x	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
57	m	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
58	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
x	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
59	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
1	x	N	N	O
 	x	N	N	O
&&	x	N	N	O
 	x	N	N	O
x	x	N	N	O
 	x	N	N	O
!	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
)	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
60	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
x	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
61	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
62	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
son	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
63	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
adj	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
.	m	N	N	O
size	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
1	x	N	N	O
)	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
adj	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
[	x	N	N	O
0	x	N	N	O
]	x	N	N	O
.	m	N	N	O
second	eng	N	N	O
 	x	N	N	O
*	x	N	N	O
 	x	N	N	O
2	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
64	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
65	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
66	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
ans	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
(	x	N	N	O
min	eng	N	N	O
(	x	N	N	O
DP	eng	N	N	O
(	x	N	N	O
father	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
)	x	N	N	O
 	x	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
belong	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
father	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
-	x	N	N	O
1	x	N	N	O
 	x	N	N	O
?	x	N	N	O
 	x	N	N	O
0	x	N	N	O
 	x	N	N	O
:	x	N	N	O
 	x	N	N	O
edge	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
)	x	N	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
son	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
67	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
ans	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
68	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
69	m	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
70	m	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
dfs	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
x	x	N	N	O
,	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
pre	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
71	m	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
72	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
father	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
pre	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
73	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
isLeaf	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
true	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
74	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
FOREACH	eng	N	N	O
(	x	N	N	O
adj	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
i	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
75	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
76	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
-	x	N	N	O
>	x	N	N	O
first	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
=	x	N	N	O
 	x	N	N	O
pre	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
edge	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
i	x	N	N	O
-	x	N	N	O
>	x	N	N	O
second	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
77	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O

	x	N	N	O
 	x	N	N	O
78	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
79	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
isLeaf	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
false	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
80	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
score	eng	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
min	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
-	x	N	N	O
>	x	N	N	O
second	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
dfs	eng	Y	N	O
(	x	N	N	O
i	x	N	N	O
-	x	N	N	O
>	x	N	N	O
first	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
x	x	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
81	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
son	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
 	x	N	N	O
+	x	N	N	O
=	x	N	N	O
 	x	N	N	O
score	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
82	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
belong	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
-	x	N	N	O
>	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
score	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
83	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
84	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
85	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
(	x	N	N	O
isLeaf	eng	N	N	O
 	x	N	N	O
?	x	N	N	O
 	x	N	N	O
edge	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
 	x	N	N	O
:	x	N	N	O
 	x	N	N	O
son	eng	N	N	O
[	x	N	N	O
x	x	N	N	O
]	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
86	m	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
87	m	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
88	m	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
89	m	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
90	m	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
91	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
t	x	N	N	O
,	x	N	N	O
 	x	N	N	O
n	x	N	N	O
,	x	N	N	O
 	x	N	N	O
v	x	N	N	O
,	x	N	N	O
 	x	N	N	O
u	x	N	N	O
,	x	N	N	O
 	x	N	N	O
c	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
92	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
t	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
93	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
t	x	N	N	O
-	x	N	N	O
-	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
94	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
95	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
n	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
96	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
 	x	N	N	O
n	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
 	x	N	N	O
adj	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
.	m	N	N	O
clear	eng	N	N	O
(	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
97	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
CC	eng	N	N	O
(	x	N	N	O
son	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
0	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
98	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
CC	eng	N	N	O
(	x	N	N	O
dp	eng	Y	N	O
,	x	N	N	O
 	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
99	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
1	x	N	N	O
;	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
 	x	N	N	O
n	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
100	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
101	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
v	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
u	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
&	x	N	N	O
c	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
102	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
v	x	N	N	O
-	x	N	N	O
-	x	N	N	O
,	x	N	N	O
 	x	N	N	O
u	x	N	N	O
-	x	N	N	O
-	x	N	N	O
;	x	N	N	O

	x	N	N	O
103	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
adj	eng	N	N	O
[	x	N	N	O
v	x	N	N	O
]	x	N	N	O
.	m	N	N	O
push	eng	N	N	O
_	x	N	N	O
back	eng	N	N	O
(	x	N	N	O
make	eng	N	N	O
_	x	N	N	O
pair	eng	N	N	O
(	x	N	N	O
u	x	N	N	O
,	x	N	N	O
 	x	N	N	O
(	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
long	eng	N	N	O
)	x	N	N	O
c	x	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
104	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
adj	eng	N	N	O
[	x	N	N	O
u	x	N	N	O
]	x	N	N	O
.	m	N	N	O
push	eng	N	N	O
_	x	N	N	O
back	eng	N	N	O
(	x	N	N	O
make	eng	N	N	O
_	x	N	N	O
pair	eng	N	N	O
(	x	N	N	O
v	x	N	N	O
,	x	N	N	O
 	x	N	N	O
(	x	N	N	O
long	eng	N	N	O
 	x	N	N	O
long	eng	N	N	O
)	x	N	N	O
c	x	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
105	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
106	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
dfs	eng	Y	N	O
(	x	N	N	O
0	x	N	N	O
,	x	N	N	O
 	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
107	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
 	x	N	N	O
n	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
108	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
DP	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
109	m	N	N	O
 	x	N	N	O
/	x	N	N	O
/	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
 	x	N	N	O
=	x	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
 	x	N	N	O
<	x	N	N	O
 	x	N	N	O
n	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
lld	eng	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
lld	eng	N	N	O
\	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
son	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
father	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
,	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
110	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
lld	eng	N	N	O
\	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
 	x	N	N	O
*	x	N	N	O
max	eng	N	N	O
_	x	N	N	O
element	eng	N	N	O
(	x	N	N	O
dp	eng	Y	N	O
,	x	N	N	O
 	x	N	N	O
dp	eng	Y	N	O
 	x	N	N	O
+	x	N	N	O
 	x	N	N	O
n	x	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
111	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
112	m	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
113	m	N	N	O
 	x	N	N	O
}	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O

	x	N	N	O