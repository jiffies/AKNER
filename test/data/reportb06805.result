pku	eng	N	Y	O	B-OJ

2987	m	N	N	O	I-OJ

Firing	eng	N	N	O	O

最大	a	Y	N	O	B-KNOWLEDGE
权	n	N	N	O	I-KNOWLEDGE
闭合	v	N	N	O	I-KNOWLEDGE
图	n	N	N	O	I-KNOWLEDGE

dinic	eng	Y	N	O	B-KNOWLEDGE
模板	n	Y	N	O	O
实现	v	N	N	O	O
最小	a	Y	N	O	B-KNOWLEDGE
割	v	N	N	O	I-KNOWLEDGE
_	x	N	N	O	O
SZW	eng	N	N	O	O
的	uj	N	N	O	O
空间	n	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

/	x	N	N	O	O
*	x	N	N	O	O
*	x	N	N	O	O

problem	eng	N	N	O	O
:	x	N	N	O	O

公司	n	N	N	O	O
要	v	N	N	O	O
炒	v	N	N	O	O
一些	m	N	N	O	O
员工	n	N	N	O	O
的	uj	N	N	O	O
鱿鱼	n	N	N	O	O
,	x	N	N	O	O

若	c	N	N	O	O
A	eng	N	N	O	O
被	p	N	N	O	O
炒	v	N	N	O	O
了	ul	N	N	O	O
,	x	N	N	O	O

那	r	N	N	O	O
A	eng	N	N	O	O
的	uj	N	N	O	O
所有	b	N	N	O	O
下属	v	N	N	O	O
也	d	N	N	O	O
会	v	N	N	O	O
跟着	v	N	N	O	O
被	p	N	N	O	O
炒	v	N	N	O	O
,	x	N	N	O	O

下属	v	N	N	O	O
关系	n	N	N	O	O
具有	v	N	N	O	O
传递性	n	N	N	O	O
,	x	N	N	O	O
且	zg	N	N	O	O
可能	v	N	N	O	O
构成	v	N	N	O	O
环	v	N	N	O	O
,	x	N	N	O	O

即	c	N	N	O	O
A	eng	N	N	O	O
是	v	N	N	O	O
B	eng	N	N	O	O
的	uj	N	N	O	O
下属	v	N	N	O	O
,	x	N	N	O	O

B	eng	N	N	O	O
又	d	N	N	O	O
间接	b	N	N	O	O
是	v	N	N	O	O
A	eng	N	N	O	O
的	uj	N	N	O	O
下属	v	N	N	O	O
,	x	N	N	O	O

炒掉	v	N	N	O	O
每个	r	N	N	O	O
人	n	N	N	O	O
公司	n	N	N	O	O
会	v	N	N	O	O
得到	v	N	N	O	O
一笔	m	N	N	O	O
收益	n	N	N	O	O
,	x	N	N	O	O

收益	n	N	N	O	O
可能	v	N	N	O	O
为	p	N	N	O	O
负	n	N	N	O	O
,	x	N	N	O	O

问	v	N	N	O	O
在	p	N	N	O	O
收益	n	N	N	O	O
最大	a	Y	N	O	O
的	uj	N	N	O	O
前提	n	N	N	O	O
下	f	N	N	O	O
,	x	N	N	O	O

最少	d	N	N	O	O
要	v	N	N	O	O
炒掉	v	N	N	O	O
哪些	r	N	N	O	O
人	n	N	N	O	O
,	x	N	N	O	O

以及	c	N	N	O	O
最大	a	Y	N	O	O
收益	n	N	N	O	O
是	v	N	N	O	O
多少	m	N	N	O	O
.	x	N	N	O	O

—	x	N	N	O	O
—	x	N	N	O	O
copy	eng	N	N	O	O

具体	a	N	N	O	O
解法	v	Y	N	O	O
我	r	N	N	O	O
就	d	N	N	O	O
不	d	N	N	O	O
说	v	N	N	O	O
了	ul	N	N	O	O
，	x	N	N	O	O
在	p	N	N	O	O
刘汝佳	nr	N	N	O	O
黑	a	N	N	O	O
书上	s	N	N	O	O
的	uj	N	N	O	O
“	x	N	N	O	O
航天	n	N	N	O	O
计划	n	N	N	O	O
”	x	N	N	O	O
是	v	N	N	O	O
一个	m	N	N	O	O
类型	n	Y	N	O	O
。	x	N	N	O	O

我	r	N	N	O	O
讲	v	N	N	O	O
一下	m	N	N	O	O
注意	v	N	N	O	O
点	m	N	N	O	O
：	x	N	N	O	O
首先	d	N	N	O	O
是	v	N	N	O	O
数据类型	n	N	N	O	O
，	x	N	N	O	O
中间	f	N	N	O	O
结果	n	N	N	O	O
会	v	N	N	O	O
超过	v	N	N	O	O
int	eng	N	N	O	O
，	x	N	N	O	O
可用	v	N	N	O	O
long	eng	N	N	O	O

long	eng	N	N	O	O

代替	v	N	N	O	O
；	x	N	N	O	O
其次	r	N	N	O	O
，	x	N	N	O	O
数据量	n	N	N	O	O
比较	d	N	N	O	O
大	a	N	N	O	O
，	x	N	N	O	O
宁可	nr	N	N	O	O
开	v	N	N	O	O
大点	m	N	N	O	O
，	x	N	N	O	O
也	d	N	N	O	O
不要	df	N	N	O	O
斤斤计较	i	N	N	O	O
.	m	N	N	O	O
我	r	N	N	O	O
就	d	N	N	O	O
为此	r	N	N	O	O
付出	v	N	N	O	O
了	ul	N	N	O	O
好	a	N	N	O	O
几次	m	N	N	O	O
tle	eng	N	N	O	O
，	x	N	N	O	O
我	r	N	N	O	O
也	d	N	N	O	O
不	d	N	N	O	O
知道	v	N	N	O	O
为什么	r	N	N	O	O
是	v	N	N	O	O
tle	eng	N	N	O	O
,	x	N	N	O	O
害得	v	N	N	O	O
我	r	N	N	O	O
找不出	v	N	N	O	O
错误	n	N	N	O	O
。	x	N	N	O	O

*	x	N	N	O	O
/	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
iostream	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
memory	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

using	eng	N	N	O	O

namespace	eng	N	N	O	O

std	eng	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

inf	eng	N	N	O	O

=	x	N	N	O	O

1000000000	m	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

max	eng	N	N	O	O

of	eng	N	N	O	O

cost	eng	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

N	x	N	N	O	O
=	x	N	N	O	O
5005	m	N	N	O	O
;	x	N	N	O	O

const	eng	N	N	O	O

int	eng	N	N	O	O

E	x	N	N	O	O
=	x	N	N	O	O
200005	m	N	N	O	O
;	x	N	N	O	O

struct	eng	N	N	O	O

edge	eng	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

y	x	N	N	O	O
,	x	N	N	O	O

nxt	eng	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

c	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
E	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

ne	eng	N	N	O	O
,	x	N	N	O	O

head	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

cur	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

ps	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

dep	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

bool	eng	N	N	O	O

flag	eng	N	N	O	O
[	x	N	N	O	O
N	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

inline	eng	N	N	O	O

void	eng	N	N	O	O

addedge	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

x	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

y	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

c	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O

add	eng	N	N	O	O

an	eng	Y	N	O	O

arc	eng	N	N	O	O
(	x	N	N	O	O
x	x	N	N	O	O

-	x	N	N	O	O
>	x	N	N	O	O

y	x	N	N	O	O
,	x	N	N	O	O

c	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

vertex	eng	N	N	O	O
:	x	N	N	O	O

0	x	N	N	O	O

~	x	N	N	O	O

n	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ne	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ne	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

=	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ne	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c	eng	N	N	O	O

=	x	N	N	O	O

c	x	N	N	O	O
;	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ne	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
nxt	eng	N	N	O	O

=	x	N	N	O	O

head	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

head	eng	N	N	O	O
[	x	N	N	O	O
x	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

ne	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ne	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O

=	x	N	N	O	O

y	x	N	N	O	O
;	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ne	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O

=	x	N	N	O	O

x	x	N	N	O	O
;	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ne	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ne	eng	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
nxt	eng	N	N	O	O

=	x	N	N	O	O

head	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

head	eng	N	N	O	O
[	x	N	N	O	O
y	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

ne	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

flow	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

s	x	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

t	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

res	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

tr	eng	Y	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O
,	x	N	N	O	O

k	x	N	N	O	O
,	x	N	N	O	O

f	x	N	N	O	O
,	x	N	N	O	O

r	x	N	N	O	O
,	x	N	N	O	O

top	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
dep	eng	N	N	O	O
,	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O

*	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
f	x	N	N	O	O

=	x	N	N	O	O

dep	eng	N	N	O	O
[	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

s	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

r	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

f	x	N	N	O	O

!	x	N	N	O	O
=	x	N	N	O	O

r	x	N	N	O	O
;	x	N	N	O	O

)	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

ps	eng	N	N	O	O
[	x	N	N	O	O
f	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

head	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
nxt	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
bf	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c	eng	N	N	O	O

&&	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

dep	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O

=	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

dep	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

dep	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

+	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

ps	eng	N	N	O	O
[	x	N	N	O	O
r	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

k	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

t	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

f	x	N	N	O	O

=	x	N	N	O	O

r	x	N	N	O	O
;	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
-	x	N	N	O	O
1	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

dep	eng	N	N	O	O
[	x	N	N	O	O
t	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

memcpy	eng	N	N	O	O
(	x	N	N	O	O
cur	eng	N	N	O	O
,	x	N	N	O	O

head	eng	N	N	O	O
,	x	N	N	O	O

n	x	N	N	O	O

*	x	N	N	O	O

sizeof	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O

s	x	N	N	O	O
,	x	N	N	O	O

top	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

;	x	N	N	O	O

)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
i	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

t	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
,	x	N	N	O	O

tr	eng	Y	N	O	O

=	x	N	N	O	O

inf	eng	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O

<	x	N	N	O	O

top	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
k	eng	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
bf	eng	N	N	O	O
[	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c	eng	N	N	O	O

<	x	N	N	O	O

tr	eng	Y	N	O	O
)	x	N	N	O	O

tr	eng	Y	N	O	O

=	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
f	x	N	N	O	O

=	x	N	N	O	O

k	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
k	x	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

k	x	N	N	O	O

<	x	N	N	O	O

top	eng	N	N	O	O
;	x	N	N	O	O

++	x	N	N	O	O
k	eng	N	N	O	O
)	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c	eng	N	N	O	O

-	x	N	N	O	O
=	x	N	N	O	O

tr	eng	Y	N	O	O
,	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
k	x	N	N	O	O
]	x	N	N	O	O
^	x	N	N	O	O
1	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

tr	eng	Y	N	O	O
;	x	N	N	O	O

res	eng	N	N	O	O

+	x	N	N	O	O
=	x	N	N	O	O

tr	eng	Y	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
top	eng	N	N	O	O

=	x	N	N	O	O

f	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O

(	x	N	N	O	O
j	x	N	N	O	O
=	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

j	x	N	N	O	O

=	x	N	N	O	O

cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
nxt	eng	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
bf	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c	eng	N	N	O	O

&&	x	N	N	O	O

dep	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

dep	eng	N	N	O	O
[	x	N	N	O	O
bf	eng	N	N	O	O
[	x	N	N	O	O
j	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

ps	eng	N	N	O	O
[	x	N	N	O	O
top	eng	N	N	O	O
++	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
cur	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O

(	x	N	N	O	O
0	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

top	eng	N	N	O	O
)	x	N	N	O	O

break	eng	N	N	O	O
;	x	N	N	O	O

dep	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O

-	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
ps	eng	N	N	O	O
[	x	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
top	eng	N	N	O	O
]	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
x	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

res	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

void	eng	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

v	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

flag	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
true	eng	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
head	eng	N	N	O	O
[	x	N	N	O	O
v	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
=	x	N	N	O	O
bf	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
nxt	eng	N	N	O	O
)	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
循环	vn	N	N	O	O
写错	v	N	N	O	O
，	x	N	N	O	O
错误	n	N	N	O	O
难	a	N	N	O	O
找	v	N	N	O	O
，	x	N	N	O	O
害人	n	N	N	O	O
阿	j	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
flag	eng	N	N	O	O
[	x	N	N	O	O
bf	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
]	x	N	N	O	O

&&	x	N	N	O	O

bf	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c	eng	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
d	x	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
bf	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
,	x	N	N	O	O
bf	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
c	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
bf	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
.	m	N	N	O	O
y	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

s	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

sum	eng	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
!	x	N	N	O	O
=	x	N	N	O	O
EOF	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
init	eng	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
head	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
head	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
flag	eng	N	N	O	O
,	x	N	N	O	O
false	eng	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
flag	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

ne	eng	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

/	x	N	N	O	O
/	x	N	N	O	O
build	eng	N	N	O	O

graph	eng	N	N	O	O

s	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
t	x	N	N	O	O
=	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
;	x	N	N	O	O
sum	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
c	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
c	x	N	N	O	O
>	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

addedge	eng	N	N	O	O
(	x	N	N	O	O
s	x	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
c	x	N	N	O	O
;	x	N	N	O	O

else	eng	N	N	O	O

addedge	eng	N	N	O	O
(	x	N	N	O	O
i	x	N	N	O	O
,	x	N	N	O	O
t	x	N	N	O	O
,	x	N	N	O	O
-	x	N	N	O	O
c	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
b	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

addedge	eng	N	N	O	O
(	x	N	N	O	O
a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
,	x	N	N	O	O
inf	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

rec	eng	N	N	O	O
=	x	N	N	O	O
flow	eng	N	N	O	O
(	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
n	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

cnt	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

dfs	eng	Y	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O
i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
i	eng	N	N	O	O
++	x	N	N	O	O
)	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
flag	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

cnt	eng	N	N	O	O
++	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O

%	x	N	N	O	O
lld	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
cnt	eng	N	N	O	O
,	x	N	N	O	O
sum	eng	N	N	O	O
-	x	N	N	O	O
rec	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

