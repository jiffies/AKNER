poj	eng	N	Y	O	B-OJ

2288	m	N	N	O	O

Islands	eng	N	N	O	O

and	eng	N	N	O	O

Bridges	eng	N	N	O	O
_	x	N	N	O	O
光辉	nr	N	N	O	O
岁月	t	N	N	O	O
_	x	N	N	O	O
百度	n	N	N	O	O
空间	n	N	N	O	O

Islands	eng	N	N	O	O

and	eng	N	N	O	O

Bridges	eng	N	N	O	O

Time	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

4000	m	N	N	O	O
MS	eng	N	N	O	O

Memory	eng	N	N	O	O

Limit	eng	N	N	O	O
:	x	N	N	O	O

65536	m	N	N	O	O
K	eng	N	N	O	O

Total	eng	N	N	O	O

Submissions	eng	N	N	O	O
:	x	N	N	O	O

4770	m	N	N	O	O

Accepted	eng	N	N	O	O
:	x	N	N	O	O

1170	m	N	N	O	O

Description	eng	N	N	O	O

Given	eng	N	N	O	O

a	x	N	N	O	O

map	eng	N	N	O	O

of	eng	N	N	O	O

islands	eng	N	N	O	O

and	eng	N	N	O	O

bridges	eng	N	N	O	O

that	eng	N	N	O	O

connect	eng	N	N	O	O

these	eng	N	N	O	O

islands	eng	N	N	O	O
,	x	N	N	O	O

a	x	N	N	O	O

Hamilton	eng	N	N	O	O

path	eng	N	N	O	O
,	x	N	N	O	O

as	eng	Y	N	O	O

we	eng	N	N	O	O

all	eng	N	N	O	O

know	eng	N	N	O	O
,	x	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

path	eng	N	N	O	O

along	eng	N	N	O	O

the	eng	N	N	O	O

bridges	eng	N	N	O	O

such	eng	N	N	O	O

that	eng	N	N	O	O

it	eng	N	N	O	O

visits	eng	N	N	O	O

each	eng	N	N	O	O

island	eng	N	N	O	O

exactly	eng	N	N	O	O

once	eng	N	N	O	O
.	m	N	N	O	O

On	eng	N	N	O	O

our	eng	N	N	O	O

map	eng	N	N	O	O
,	x	N	N	O	O

there	eng	N	N	O	O

is	eng	N	N	O	O

also	eng	N	N	O	O

a	x	N	N	O	O

positive	eng	N	N	O	O

integer	eng	N	N	O	O

value	eng	N	N	O	O

associated	eng	N	N	O	O

with	eng	N	N	O	O

each	eng	N	N	O	O

island	eng	N	N	O	O
.	m	N	N	O	O

We	eng	N	N	O	O

call	eng	N	N	O	O

a	x	N	N	O	O

Hamilton	eng	N	N	O	O

path	eng	N	N	O	O

the	eng	N	N	O	O

best	eng	N	N	O	O

triangular	eng	N	N	O	O

Hamilton	eng	N	N	O	O

path	eng	N	N	O	O

if	eng	N	N	O	O

it	eng	N	N	O	O

maximizes	eng	N	N	O	O

the	eng	N	N	O	O

value	eng	N	N	O	O

described	eng	N	N	O	O

below	eng	N	N	O	O
.	m	N	N	O	O

Suppose	eng	N	N	O	O

there	eng	N	N	O	O

are	eng	N	N	O	O

n	x	N	N	O	O

islands	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

value	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

Hamilton	eng	N	N	O	O

path	eng	N	N	O	O

C1C2	eng	N	N	O	O
...	m	N	N	O	O
Cn	eng	N	N	O	O

is	eng	N	N	O	O

calculated	eng	N	N	O	O

as	eng	Y	N	O	O

the	eng	N	N	O	O

sum	eng	N	N	O	O

of	eng	N	N	O	O

three	eng	N	N	O	O

parts	eng	N	N	O	O
.	m	N	N	O	O

Let	eng	N	N	O	O

Vi	eng	N	N	O	O

be	eng	Y	N	O	O

the	eng	N	N	O	O

value	eng	N	N	O	O

for	eng	Y	N	O	O

the	eng	N	N	O	O

island	eng	N	N	O	O

Ci	eng	N	N	O	O
.	m	N	N	O	O

As	eng	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

part	eng	N	N	O	O
,	x	N	N	O	O

we	eng	N	N	O	O

sum	eng	N	N	O	O

over	eng	N	N	O	O

all	eng	N	N	O	O

the	eng	N	N	O	O

Vi	eng	N	N	O	O

values	eng	N	N	O	O

for	eng	Y	N	O	O

each	eng	N	N	O	O

island	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

path	eng	N	N	O	O
.	m	N	N	O	O

For	eng	N	N	O	O

the	eng	N	N	O	O

second	eng	N	N	O	O

part	eng	N	N	O	O
,	x	N	N	O	O

for	eng	Y	N	O	O

each	eng	N	N	O	O

edge	eng	N	N	O	O

CiC	eng	N	N	O	O

i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

path	eng	N	N	O	O
,	x	N	N	O	O

we	eng	N	N	O	O

add	eng	N	N	O	O

the	eng	N	N	O	O

product	eng	N	N	O	O

Vi	eng	N	N	O	O
*	x	N	N	O	O
V	x	N	N	O	O

i	eng	N	N	O	O
+	x	N	N	O	O
1.	m	N	N	O	O

And	eng	N	N	O	O

for	eng	Y	N	O	O

the	eng	N	N	O	O

third	eng	N	N	O	O

part	eng	N	N	O	O
,	x	N	N	O	O

whenever	eng	N	N	O	O

three	eng	N	N	O	O

consecutive	eng	N	N	O	O

islands	eng	N	N	O	O

CiC	eng	N	N	O	O

i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
C	eng	N	N	O	O

i	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

path	eng	N	N	O	O

forms	eng	N	N	O	O

a	x	N	N	O	O

triangle	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

map	eng	N	N	O	O
,	x	N	N	O	O

i	eng	N	N	O	O
.	m	N	N	O	O
e	eng	N	N	O	O
.	m	N	N	O	O

there	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

bridge	eng	N	N	O	O

between	eng	N	N	O	O

Ci	eng	N	N	O	O

and	eng	N	N	O	O

C	x	N	N	O	O

i	eng	N	N	O	O
+	x	N	N	O	O
2	m	N	N	O	O
,	x	N	N	O	O

we	eng	N	N	O	O

add	eng	N	N	O	O

the	eng	N	N	O	O

product	eng	N	N	O	O

Vi	eng	N	N	O	O
*	x	N	N	O	O
V	x	N	N	O	O

i	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
*	x	N	N	O	O
V	x	N	N	O	O

i	eng	N	N	O	O
+	x	N	N	O	O
2.	m	N	N	O	O

Most	eng	N	N	O	O

likely	eng	N	N	O	O

but	eng	N	N	O	O

not	eng	N	N	O	O

necessarily	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

best	eng	N	N	O	O

triangular	eng	N	N	O	O

Hamilton	eng	N	N	O	O

path	eng	N	N	O	O

you	eng	N	N	O	O

are	eng	N	N	O	O

going	eng	N	N	O	O

to	eng	N	N	O	O

find	eng	N	N	O	O

contains	eng	N	N	O	O

many	eng	N	N	O	O

triangles	eng	N	N	O	O
.	m	N	N	O	O

It	eng	N	N	O	O

is	eng	N	N	O	O

quite	eng	N	N	O	O

possible	eng	N	N	O	O

that	eng	N	N	O	O

there	eng	N	N	O	O

might	eng	N	N	O	O

be	eng	Y	N	O	O

more	eng	N	N	O	O

than	eng	N	N	O	O

one	eng	N	N	O	O

best	eng	N	N	O	O

triangular	eng	N	N	O	O

Hamilton	eng	N	N	O	O

paths	eng	N	N	O	O
;	x	N	N	O	O

your	eng	N	N	O	O

second	eng	N	N	O	O

task	eng	N	N	O	O

is	eng	N	N	O	O

to	eng	N	N	O	O

find	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

such	eng	N	N	O	O

paths	eng	N	N	O	O
.	m	N	N	O	O

Input	eng	N	N	O	O

The	eng	N	N	O	O

input	eng	N	N	O	O

file	eng	N	N	O	O

starts	eng	N	N	O	O

with	eng	N	N	O	O

a	x	N	N	O	O

number	eng	N	N	O	O

q	x	N	N	O	O

(	x	N	N	O	O
q	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
20	m	N	N	O	O
)	x	N	N	O	O

on	eng	N	N	O	O

the	eng	N	N	O	O

first	eng	N	N	O	O

line	eng	N	N	O	O
,	x	N	N	O	O

which	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

test	eng	N	N	O	O

cases	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O

starts	eng	N	N	O	O

with	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

with	eng	N	N	O	O

two	eng	N	N	O	O

integers	eng	N	N	O	O

n	x	N	N	O	O

and	eng	N	N	O	O

m	x	N	N	O	O
,	x	N	N	O	O

which	eng	N	N	O	O

are	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

islands	eng	N	N	O	O

and	eng	N	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

bridges	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

map	eng	N	N	O	O
,	x	N	N	O	O

respectively	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

next	eng	N	N	O	O

line	eng	N	N	O	O

contains	eng	N	N	O	O

n	x	N	N	O	O

positive	eng	N	N	O	O

integers	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

i	x	N	N	O	O
-	x	N	N	O	O
th	eng	N	N	O	O

number	eng	N	N	O	O

being	eng	N	N	O	O

the	eng	N	N	O	O

Vi	eng	N	N	O	O

value	eng	N	N	O	O

of	eng	N	N	O	O

island	eng	N	N	O	O

i	eng	N	N	O	O
.	m	N	N	O	O

Each	eng	N	N	O	O

value	eng	N	N	O	O

is	eng	N	N	O	O

no	eng	N	N	O	O

more	eng	N	N	O	O

than	eng	N	N	O	O

100.	m	N	N	O	O

The	eng	N	N	O	O

following	eng	N	N	O	O

m	x	N	N	O	O

lines	eng	N	N	O	O

are	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

form	eng	N	N	O	O

x	x	N	N	O	O

y	x	N	N	O	O
,	x	N	N	O	O

which	eng	N	N	O	O

indicates	eng	N	N	O	O

there	eng	N	N	O	O

is	eng	N	N	O	O

a	x	N	N	O	O

(	x	N	N	O	O
two	eng	N	N	O	O

way	eng	N	N	O	O
)	x	N	N	O	O

bridge	eng	N	N	O	O

between	eng	N	N	O	O

island	eng	N	N	O	O

x	x	N	N	O	O

and	eng	N	N	O	O

island	eng	N	N	O	O

y	eng	N	N	O	O
.	m	N	N	O	O

Islands	eng	N	N	O	O

are	eng	N	N	O	O

numbered	eng	N	N	O	O

from	eng	N	N	O	O

1	x	N	N	O	O

to	eng	N	N	O	O

n	eng	N	N	O	O
.	m	N	N	O	O

You	eng	N	N	O	O

may	eng	N	N	O	O

assume	eng	N	N	O	O

there	eng	N	N	O	O

will	eng	N	N	O	O

be	eng	Y	N	O	O

no	eng	N	N	O	O

more	eng	N	N	O	O

than	eng	N	N	O	O

13	m	N	N	O	O

islands	eng	N	N	O	O
.	m	N	N	O	O

Output	eng	N	N	O	O

For	eng	N	N	O	O

each	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O
,	x	N	N	O	O

output	eng	N	N	O	O

a	x	N	N	O	O

line	eng	N	N	O	O

with	eng	N	N	O	O

two	eng	N	N	O	O

numbers	eng	N	N	O	O
,	x	N	N	O	O

separated	eng	N	N	O	O

by	eng	N	N	O	O

a	x	N	N	O	O

space	eng	N	N	O	O
.	m	N	N	O	O

The	eng	N	N	O	O

first	eng	N	N	O	O

number	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

maximum	eng	N	N	O	O

value	eng	N	N	O	O

of	eng	N	N	O	O

a	x	N	N	O	O

best	eng	N	N	O	O

triangular	eng	N	N	O	O

Hamilton	eng	N	N	O	O

path	eng	N	N	O	O
;	x	N	N	O	O

the	eng	N	N	O	O

second	eng	N	N	O	O

number	eng	N	N	O	O

should	eng	N	N	O	O

be	eng	Y	N	O	O

the	eng	N	N	O	O

number	eng	N	N	O	O

of	eng	N	N	O	O

different	eng	N	N	O	O

best	eng	N	N	O	O

triangular	eng	N	N	O	O

Hamilton	eng	N	N	O	O

paths	eng	N	N	O	O
.	m	N	N	O	O

If	eng	N	N	O	O

the	eng	N	N	O	O

test	eng	N	N	O	O

case	eng	N	N	O	O

does	eng	N	N	O	O

not	eng	N	N	O	O

contain	eng	N	N	O	O

a	x	N	N	O	O

Hamilton	eng	N	N	O	O

path	eng	N	N	O	O
,	x	N	N	O	O

the	eng	N	N	O	O

output	eng	N	N	O	O

must	eng	N	N	O	O

be	eng	Y	N	O	O

`	x	N	N	O	O
0	x	N	N	O	O

0	x	N	N	O	O
'	x	N	N	O	O
.	x	N	N	O	O

Note	eng	N	N	O	O
:	x	N	N	O	O

A	x	N	N	O	O

path	eng	N	N	O	O

may	eng	N	N	O	O

be	eng	Y	N	O	O

written	eng	N	N	O	O

down	eng	N	N	O	O

in	eng	Y	N	O	O

the	eng	N	N	O	O

reversed	eng	N	N	O	O

order	eng	N	N	O	O
.	m	N	N	O	O

We	eng	N	N	O	O

still	eng	N	N	O	O

think	eng	N	N	O	O

it	eng	N	N	O	O

is	eng	N	N	O	O

the	eng	N	N	O	O

same	eng	N	N	O	O

path	eng	N	N	O	O
.	m	N	N	O	O

Sample	eng	N	N	O	O

Input	eng	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

3	x	N	N	O	O

2	x	N	N	O	O

2	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

3	x	N	N	O	O

1	x	N	N	O	O

4	x	N	N	O	O

6	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

4	x	N	N	O	O

1	x	N	N	O	O

2	x	N	N	O	O

1	x	N	N	O	O

3	x	N	N	O	O

1	x	N	N	O	O

4	x	N	N	O	O

2	x	N	N	O	O

3	x	N	N	O	O

2	x	N	N	O	O

4	x	N	N	O	O

3	x	N	N	O	O

4	x	N	N	O	O

Sample	eng	N	N	O	O

Output	eng	N	N	O	O

22	m	N	N	O	O

3	x	N	N	O	O

69	m	N	N	O	O

1	x	N	N	O	O

要点	n	N	N	O	O
：	x	N	N	O	O

1	x	N	N	O	O

还是	c	N	N	O	O
状态	n	Y	N	O	O
压缩	v	Y	N	O	O
DP	eng	N	N	O	B-KNOWLEDGE
。	x	N	N	O	O

2	x	N	N	O	O

一定	d	N	N	O	O
要用	v	N	N	O	O
long	eng	N	N	O	O

long	eng	N	N	O	O

3	x	N	N	O	O

要	v	N	N	O	O
注意	v	N	N	O	O
结果	n	N	N	O	O
除	p	N	N	O	O
2	m	N	N	O	O
（	x	N	N	O	O
方向	n	N	N	O	O
相反	v	N	N	O	O
的	uj	N	N	O	O
路径	n	Y	N	O	O
只算	v	N	N	O	O
一条	m	N	N	O	O
）	x	N	N	O	O

4	x	N	N	O	O

把	p	N	N	O	O
递归	v	Y	N	O	B-KNOWLEDGE
取消	v	N	N	O	O
掉	zg	N	N	O	O
估计	v	N	N	O	O
会	v	N	N	O	O
快	a	N	N	O	O
不少	d	N	N	O	O
，	x	N	N	O	O
目前	t	N	N	O	O
1390	m	N	N	O	O
ms	eng	N	N	O	O

过	ug	N	N	O	O
，	x	N	N	O	O
算	v	N	N	O	O
很慢	a	N	N	O	O
了	ul	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
stdio	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

#	x	N	N	O	O
include	eng	N	N	O	O

<	x	N	N	O	O
string	eng	N	N	O	O
.	m	N	N	O	O
h	eng	N	N	O	O
>	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

mem	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
14	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
14	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
14	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

nways	eng	N	N	O	O
[	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
14	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
14	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
14	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
14	m	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
14	m	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

nisland	eng	N	N	O	O
,	x	N	N	O	O
nbridge	eng	N	N	O	O
;	x	N	N	O	O

inline	eng	N	N	O	O

int	eng	N	N	O	O

isset	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

state	eng	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

i	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

return	eng	N	N	O	O

state	eng	N	N	O	O
&	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

hamilton	eng	N	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

state	eng	N	N	O	O
,	x	N	N	O	O

int	eng	N	N	O	O

prev2	eng	N	N	O	O
,	x	N	N	O	O
int	eng	N	N	O	O

prev	eng	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
nways	eng	N	N	O	O
[	x	N	N	O	O
state	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O

return	eng	N	N	O	O

nways	eng	N	N	O	O
[	x	N	N	O	O
state	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

nw	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O

val	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
state	eng	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
(	x	N	N	O	O
nisland	eng	N	N	O	O
+	x	N	N	O	O
1	m	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
-	x	N	N	O	O
2	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

nw	eng	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

nways	eng	N	N	O	O
[	x	N	N	O	O
state	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
nw	eng	N	N	O	O
;	x	N	N	O	O

mem	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O
[	x	N	N	O	O
state	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

nw	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

long	eng	N	N	O	O

long	eng	N	N	O	O

max	eng	N	N	O	O
_	x	N	N	O	O
nw	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
max	eng	N	N	O	O
_	x	N	N	O	O
nv	eng	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O
=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
nisland	eng	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
isset	eng	N	N	O	O
(	x	N	N	O	O
state	eng	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
&&	x	N	N	O	O
(	x	N	N	O	O
prev	eng	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
|	x	N	N	O	O
|	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

val	eng	N	N	O	O
=	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
val	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
prev2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
val	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
*	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
prev2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev2	eng	N	N	O	O
]	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

w	x	N	N	O	O

=	x	N	N	O	O

hamilton	eng	N	N	O	O
(	x	N	N	O	O
state	eng	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
,	x	N	N	O	O
prev	eng	N	N	O	O
,	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
w	x	N	N	O	O
>	x	N	N	O	O
0	m	N	N	O	O
&&	x	N	N	O	O
val	eng	N	N	O	O
+	x	N	N	O	O
mem	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O
[	x	N	N	O	O
state	eng	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
>	x	N	N	O	O
max	eng	N	N	O	O
_	x	N	N	O	O
nv	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

max	eng	N	N	O	O
_	x	N	N	O	O
nv	eng	N	N	O	O

=	x	N	N	O	O

mem	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O
[	x	N	N	O	O
state	eng	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
+	x	N	N	O	O
val	eng	N	N	O	O
;	x	N	N	O	O

max	eng	N	N	O	O
_	x	N	N	O	O
nw	eng	N	N	O	O

=	x	N	N	O	O

w	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

else	eng	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
w	x	N	N	O	O
>	x	N	N	O	O
0	m	N	N	O	O
&&	x	N	N	O	O

val	eng	N	N	O	O
+	x	N	N	O	O
mem	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O
[	x	N	N	O	O
state	eng	N	N	O	O
|	x	N	N	O	O
(	x	N	N	O	O
1	x	N	N	O	O
<	x	N	N	O	O
<	x	N	N	O	O
i	x	N	N	O	O
)	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O

=	x	N	N	O	O
=	x	N	N	O	O

max	eng	N	N	O	O
_	x	N	N	O	O
nv	eng	N	N	O	O
)	x	N	N	O	O

max	eng	N	N	O	O
_	x	N	N	O	O
nw	eng	N	N	O	O
+	x	N	N	O	O
=	x	N	N	O	O
w	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

}	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
!	x	N	N	O	O
max	eng	N	N	O	O
_	x	N	N	O	O
nw	eng	N	N	O	O
)	x	N	N	O	O
max	eng	N	N	O	O
_	x	N	N	O	O
nv	eng	N	N	O	O

=	x	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

mem	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O
[	x	N	N	O	O
state	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
_	x	N	N	O	O
nv	eng	N	N	O	O
;	x	N	N	O	O

nways	eng	N	N	O	O
[	x	N	N	O	O
state	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev2	eng	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
prev	eng	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
max	eng	N	N	O	O
_	x	N	N	O	O
nw	eng	N	N	O	O
;	x	N	N	O	O

return	eng	N	N	O	O

max	eng	N	N	O	O
_	x	N	N	O	O
nw	eng	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

int	eng	N	N	O	O

main	eng	N	N	O	O
(	x	N	N	O	O
)	x	N	N	O	O

{	x	N	N	O	O

int	eng	N	N	O	O

ncases	eng	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
ncases	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

while	eng	N	N	O	O
(	x	N	N	O	O
ncases	eng	N	N	O	O
-	x	N	N	O	O
-	x	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
map	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
map	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

int	eng	N	N	O	O

n	x	N	N	O	O
,	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
n	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
m	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

nisland	eng	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
n	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
i	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

for	eng	Y	N	O	O
(	x	N	N	O	O
int	eng	N	N	O	O

i	x	N	N	O	O

=	x	N	N	O	O

1	x	N	N	O	O
;	x	N	N	O	O

i	x	N	N	O	O
<	x	N	N	O	O
=	x	N	N	O	O
m	x	N	N	O	O
;	x	N	N	O	O
++	x	N	N	O	O
i	eng	N	N	O	O
)	x	N	N	O	O
{	x	N	N	O	O

int	eng	N	N	O	O

a	x	N	N	O	O
,	x	N	N	O	O
b	x	N	N	O	O
;	x	N	N	O	O

scanf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
%	x	N	N	O	O
d	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
a	eng	N	N	O	O
,	x	N	N	O	O
&	x	N	N	O	O
b	eng	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

map	eng	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
b	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
map	eng	N	N	O	O
[	x	N	N	O	O
b	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
a	x	N	N	O	O
]	x	N	N	O	O
=	x	N	N	O	O
1	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
mem	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
mem	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

memset	eng	N	N	O	O
(	x	N	N	O	O
nways	eng	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
sizeof	eng	N	N	O	O
(	x	N	N	O	O
nways	eng	N	N	O	O
)	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

hamilton	eng	N	N	O	O
(	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
,	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

if	eng	N	N	O	O
(	x	N	N	O	O
nways	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
%	x	N	N	O	O
2	x	N	N	O	O
=	x	N	N	O	O
=	x	N	N	O	O
0	x	N	N	O	O
)	x	N	N	O	O

nways	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
/	x	N	N	O	O
=	x	N	N	O	O
2	x	N	N	O	O
;	x	N	N	O	O

printf	eng	N	N	O	O
(	x	N	N	O	O
"	x	N	N	O	O
%	x	N	N	O	O
lld	eng	N	N	O	O

%	x	N	N	O	O
lld	eng	N	N	O	O
\	x	N	N	O	O
n	x	N	N	O	O
"	x	N	N	O	O
,	x	N	N	O	O
mem	eng	N	N	O	O
_	x	N	N	O	O
value	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
,	x	N	N	O	O
nways	eng	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
[	x	N	N	O	O
0	x	N	N	O	O
]	x	N	N	O	O
)	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

return	eng	N	N	O	O

0	x	N	N	O	O
;	x	N	N	O	O

}	x	N	N	O	O

