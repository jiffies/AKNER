pku	eng	N	Y	O
 	x	N	N	O
2288	m	N	N	O
 	x	N	N	O
Islands	eng	N	N	O
 	x	N	N	O
and	eng	N	N	O
 	x	N	N	O
Bridges	eng	N	N	O
(	x	N	N	O
状态	n	Y	N	O
压缩	v	Y	N	O
DP	eng	N	N	O
)	x	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
low	eng	N	N	O
 	x	N	N	O
coder	eng	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
博客	nr	N	N	O
频道	n	N	N	O
 	x	N	N	O
-	x	N	N	O
 	x	N	N	O
CSDN	eng	N	N	O
.	m	N	N	O
NET	eng	N	N	O

	x	N	N	O

	x	N	N	O
 	x	N	N	O

	x	N	N	O
Description	eng	N	N	O

	x	N	N	O
Given	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
map	eng	N	N	O
 	x	N	N	O
of	eng	N	N	O
 	x	N	N	O
islands	eng	N	N	O
 	x	N	N	O
and	eng	N	N	O
 	x	N	N	O
bridges	eng	N	N	O
 	x	N	N	O
that	eng	N	N	O
 	x	N	N	O
connect	eng	N	N	O
 	x	N	N	O
these	eng	N	N	O
 	x	N	N	O
islands	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
Hamilton	eng	N	N	O
 	x	N	N	O
path	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
as	eng	Y	N	O
 	x	N	N	O
we	eng	N	N	O
 	x	N	N	O
all	eng	N	N	O
 	x	N	N	O
know	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
is	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
path	eng	N	N	O
 	x	N	N	O
along	eng	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
bridges	eng	N	N	O
 	x	N	N	O
such	eng	N	N	O
 	x	N	N	O
that	eng	N	N	O
 	x	N	N	O
it	eng	N	N	O
 	x	N	N	O
visits	eng	N	N	O
 	x	N	N	O
each	eng	N	N	O
 	x	N	N	O
island	eng	N	N	O
 	x	N	N	O
exactly	eng	N	N	O
 	x	N	N	O
once	eng	N	N	O
.	m	N	N	O
 	x	N	N	O
On	eng	N	N	O
 	x	N	N	O
our	eng	N	N	O
 	x	N	N	O
map	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
there	eng	N	N	O
 	x	N	N	O
is	eng	N	N	O
 	x	N	N	O
also	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
positive	eng	N	N	O
 	x	N	N	O
integer	eng	N	N	O
 	x	N	N	O
value	eng	N	N	O
 	x	N	N	O
associated	eng	N	N	O
 	x	N	N	O
with	eng	N	N	O
 	x	N	N	O
each	eng	N	N	O
 	x	N	N	O
island	eng	N	N	O
.	m	N	N	O
 	x	N	N	O
We	eng	N	N	O
 	x	N	N	O
call	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
Hamilton	eng	N	N	O
 	x	N	N	O
path	eng	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
best	eng	N	N	O
 	x	N	N	O
triangular	eng	N	N	O
 	x	N	N	O
Hamilton	eng	N	N	O
 	x	N	N	O
path	eng	N	N	O
 	x	N	N	O
if	eng	N	N	O
 	x	N	N	O
it	eng	N	N	O
 	x	N	N	O
maximizes	eng	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
value	eng	N	N	O
 	x	N	N	O
described	eng	N	N	O
 	x	N	N	O
below	eng	N	N	O
.	m	N	N	O
 	x	N	N	O

	x	N	N	O
Suppose	eng	N	N	O
 	x	N	N	O
there	eng	N	N	O
 	x	N	N	O
are	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
 	x	N	N	O
islands	eng	N	N	O
.	m	N	N	O
 	x	N	N	O
The	eng	N	N	O
 	x	N	N	O
value	eng	N	N	O
 	x	N	N	O
of	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
Hamilton	eng	N	N	O
 	x	N	N	O
path	eng	N	N	O
 	x	N	N	O
C1C2	eng	N	N	O
...	m	N	N	O
Cn	eng	N	N	O
 	x	N	N	O
is	eng	N	N	O
 	x	N	N	O
calculated	eng	N	N	O
 	x	N	N	O
as	eng	Y	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
sum	eng	N	N	O
 	x	N	N	O
of	eng	N	N	O
 	x	N	N	O
three	eng	N	N	O
 	x	N	N	O
parts	eng	N	N	O
.	m	N	N	O
 	x	N	N	O
Let	eng	N	N	O
 	x	N	N	O
Vi	eng	N	N	O
 	x	N	N	O
be	eng	Y	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
value	eng	N	N	O
 	x	N	N	O
for	eng	Y	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
island	eng	N	N	O
 	x	N	N	O
Ci	eng	N	N	O
.	m	N	N	O
 	x	N	N	O
As	eng	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
first	eng	N	N	O
 	x	N	N	O
part	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
we	eng	N	N	O
 	x	N	N	O
sum	eng	N	N	O
 	x	N	N	O
over	eng	N	N	O
 	x	N	N	O
all	eng	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
Vi	eng	N	N	O
 	x	N	N	O
values	eng	N	N	O
 	x	N	N	O
for	eng	Y	N	O
 	x	N	N	O
each	eng	N	N	O
 	x	N	N	O
island	eng	N	N	O
 	x	N	N	O
in	eng	Y	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
path	eng	N	N	O
.	m	N	N	O
 	x	N	N	O
For	eng	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
second	eng	N	N	O
 	x	N	N	O
part	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
 	x	N	N	O
each	eng	N	N	O
 	x	N	N	O
edge	eng	N	N	O
 	x	N	N	O
CiCi	eng	N	N	O
+	x	N	N	O
1	m	N	N	O
 	x	N	N	O
in	eng	Y	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
path	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
we	eng	N	N	O
 	x	N	N	O
add	eng	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
product	eng	N	N	O
 	x	N	N	O
Vi	eng	N	N	O
*	x	N	N	O
Vi	eng	N	N	O
+	x	N	N	O
1	m	N	N	O
 	x	N	N	O
.	x	N	N	O
 	x	N	N	O
And	eng	N	N	O
 	x	N	N	O
for	eng	Y	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
third	eng	N	N	O
 	x	N	N	O
part	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
whenever	eng	N	N	O
 	x	N	N	O
three	eng	N	N	O
 	x	N	N	O
consecutive	eng	N	N	O
 	x	N	N	O
islands	eng	N	N	O
 	x	N	N	O
CiCi	eng	N	N	O
+	x	N	N	O
1	m	N	N	O
 	x	N	N	O
Ci	eng	N	N	O
+	x	N	N	O
2	m	N	N	O
 	x	N	N	O
in	eng	Y	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
path	eng	N	N	O
 	x	N	N	O
forms	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
triangle	eng	N	N	O
 	x	N	N	O
in	eng	Y	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
map	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
i	eng	N	N	O
.	m	N	N	O
e	eng	N	N	O
.	m	N	N	O
 	x	N	N	O
there	eng	N	N	O
 	x	N	N	O
is	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
 	x	N	N	O
bridge	eng	N	N	O
 	x	N	N	O
between	eng	N	N	O
 	x	N	N	O
Ci	eng	N	N	O
 	x	N	N	O
and	eng	N	N	O
 	x	N	N	O
Ci	eng	N	N	O
+	x	N	N	O
2	m	N	N	O
 	x	N	N	O
,	x	N	N	O
 	x	N	N	O
we	eng	N	N	O
 	x	N	N	O
add	eng	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
product	eng	N	N	O
 	x	N	N	O
Vi	eng	N	N	O
*	x	N	N	O
Vi	eng	N	N	O
+	x	N	N	O
1	m	N	N	O
 	x	N	N	O
*	x	N	N	O
Vi	eng	N	N	O
+	x	N	N	O
2	m	N	N	O
 	x	N	N	O
.	x	N	N	O
 	x	N	N	O

	x	N	N	O
Most	eng	N	N	O
 	x	N	N	O
likely	eng	N	N	O
 	x	N	N	O
but	eng	N	N	O
 	x	N	N	O
not	eng	N	N	O
 	x	N	N	O
necessarily	eng	N	N	O
,	x	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
best	eng	N	N	O
 	x	N	N	O
triangular	eng	N	N	O
 	x	N	N	O
Hamilton	eng	N	N	O
 	x	N	N	O
path	eng	N	N	O
 	x	N	N	O
you	eng	N	N	O
 	x	N	N	O
are	eng	N	N	O
 	x	N	N	O
going	eng	N	N	O
 	x	N	N	O
to	eng	N	N	O
 	x	N	N	O
find	eng	N	N	O
 	x	N	N	O
contains	eng	N	N	O
 	x	N	N	O
many	eng	N	N	O
 	x	N	N	O
triangles	eng	N	N	O
.	m	N	N	O
 	x	N	N	O
It	eng	N	N	O
 	x	N	N	O
is	eng	N	N	O
 	x	N	N	O
quite	eng	N	N	O
 	x	N	N	O
possible	eng	N	N	O
 	x	N	N	O
that	eng	N	N	O
 	x	N	N	O
there	eng	N	N	O
 	x	N	N	O
might	eng	N	N	O
 	x	N	N	O
be	eng	Y	N	O
 	x	N	N	O
more	eng	N	N	O
 	x	N	N	O
than	eng	N	N	O
 	x	N	N	O
one	eng	N	N	O
 	x	N	N	O
best	eng	N	N	O
 	x	N	N	O
triangular	eng	N	N	O
 	x	N	N	O
Hamilton	eng	N	N	O
 	x	N	N	O
paths	eng	N	N	O
;	x	N	N	O
 	x	N	N	O
your	eng	N	N	O
 	x	N	N	O
second	eng	N	N	O
 	x	N	N	O
task	eng	N	N	O
 	x	N	N	O
is	eng	N	N	O
 	x	N	N	O
to	eng	N	N	O
 	x	N	N	O
find	eng	N	N	O
 	x	N	N	O
the	eng	N	N	O
 	x	N	N	O
number	eng	N	N	O
 	x	N	N	O
of	eng	N	N	O
 	x	N	N	O
such	eng	N	N	O
 	x	N	N	O
paths	eng	N	N	O
.	m	N	N	O
 	x	N	N	O

	x	N	N	O
[	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
,	x	N	N	O
state	eng	N	N	O
表示	v	Y	N	O
已经	d	N	N	O
到达	v	N	N	O
过	ug	N	N	O
的	uj	N	N	O
顶点	n	Y	N	O
，	x	N	N	O
i	x	N	N	O
记录	n	Y	N	O
倒数第	l	N	N	O
2	m	N	N	O
个	m	N	N	O
顶点	n	Y	N	O
，	x	N	N	O
j	x	N	N	O
记录	n	Y	N	O
倒数	n	N	N	O
第一个	m	N	N	O
顶点	n	Y	N	O
。	x	N	N	O


	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
]	x	N	N	O
[	x	N	N	O
]	x	N	N	O
[	x	N	N	O
]	x	N	N	O
记录	n	Y	N	O
最大值	l	N	N	O
,	x	N	N	O
way	eng	N	N	O
[	x	N	N	O
]	x	N	N	O
[	x	N	N	O
]	x	N	N	O
[	x	N	N	O
]	x	N	N	O
记录	n	Y	N	O
最大值	l	N	N	O
对应	vn	N	N	O
的	uj	N	N	O
路径	n	Y	N	O
数	n	N	N	O
。	x	N	N	O


	x	N	N	O
做	v	N	N	O
这	r	N	N	O
题	n	N	N	O
，	x	N	N	O
才	d	N	N	O
注意	v	N	N	O
到位	v	N	N	O
运算	vn	Y	N	O
的	uj	N	N	O
<	x	N	N	O
<	x	N	N	O
>	x	N	N	O
>	x	N	N	O
左移	nr	N	N	O
右移	n	N	N	O
优先级	b	Y	N	O
好	a	N	N	O
低	a	N	N	O
，	x	N	N	O
不如	c	N	N	O
+	x	N	N	O
-	x	N	N	O
加减	v	N	N	O
，	x	N	N	O
得加	v	N	N	O
括号	n	N	N	O
。	x	N	N	O


	x	N	N	O
要	v	N	N	O
注意	v	N	N	O
的	uj	N	N	O
地方	n	N	N	O
有	v	N	N	O
两个	m	N	N	O

	x	N	N	O
1.	m	N	N	O
一个点	m	N	N	O
的	uj	N	N	O
情况	n	N	N	O

	x	N	N	O
2.	m	N	N	O
用	p	N	N	O
__	x	N	N	O
int64	eng	N	N	O

	x	N	N	O
我	r	N	N	O
的	uj	N	N	O
代码	n	N	N	O
用	p	N	N	O
的	uj	N	N	O
是	v	N	N	O
最	d	N	N	O
直观	n	N	N	O
的	uj	N	N	O
DP	eng	N	N	O
，	x	N	N	O
跑	v	N	N	O
了	ul	N	N	O
2500	m	N	N	O
ms	eng	N	N	O
。	x	N	N	O


	x	N	N	O
假设	vn	N	N	O
state1	eng	N	N	O
可以	c	N	N	O
由	c	N	N	O
state2	eng	N	N	O
转化	v	Y	N	O
得到	v	N	N	O
，	x	N	N	O
通过	p	N	N	O
分析	vn	N	N	O
可以	c	N	N	O
发现	v	N	N	O
0	x	N	N	O
<	x	N	N	O
=	x	N	N	O
state2	eng	N	N	O
<	x	N	N	O
state1	eng	N	N	O
。	x	N	N	O

于是	c	N	N	O
可以	c	N	N	O
在	p	N	N	O
最	a	N	N	O
外层	n	N	N	O
循环	vn	N	N	O
用	p	N	N	O
state	eng	N	N	O
递增	v	Y	N	O
。	x	N	N	O


	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
iostream	eng	N	N	O
>	x	N	N	O

	x	N	N	O
using	eng	N	N	O
 	x	N	N	O
namespace	eng	N	N	O
 	x	N	N	O
std	eng	N	N	O
;	x	N	N	O

	x	N	N	O
const	eng	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
max	eng	N	N	O
_	x	N	N	O
n	eng	N	N	O
=	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
13	m	N	N	O
;	x	N	N	O

	x	N	N	O
__	x	N	N	O
int64	eng	N	N	O
 	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
max	eng	N	N	O
_	x	N	N	O
n	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
13	m	N	N	O
]	x	N	N	O
[	x	N	N	O
13	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
__	x	N	N	O
int64	eng	N	N	O
 	x	N	N	O
way	eng	N	N	O
[	x	N	N	O
max	eng	N	N	O
_	x	N	N	O
n	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
13	m	N	N	O
]	x	N	N	O
[	x	N	N	O
13	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
bool	eng	N	N	O
 	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
13	m	N	N	O
]	x	N	N	O
[	x	N	N	O
13	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
13	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
NumOfOne	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
ans	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
n	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
ans	eng	N	N	O
+	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
n	x	N	N	O
=	x	N	N	O
n	eng	N	N	O
&	x	N	N	O
(	x	N	N	O
n	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
ans	eng	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
DP	eng	N	N	O
_	x	N	N	O
Fun	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
way	eng	N	N	O
,	x	N	N	O
0	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
way	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
DP	eng	N	N	O
,	x	N	N	O
0	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
DP	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
/	x	N	N	O
/	x	N	N	O
初始化	l	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
j	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
j	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
!	x	N	N	O
=	x	N	N	O
j	eng	N	N	O
&&	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
i	x	N	N	O
)	x	N	N	O
+	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
j	x	N	N	O
)	x	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
=	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
+	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
+	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
*	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
way	eng	N	N	O
[	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
i	x	N	N	O
)	x	N	N	O
+	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
j	x	N	N	O
)	x	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
k	x	N	N	O
=	x	N	N	O
2	x	N	N	O
;	x	N	N	O
k	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O
k	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
/	x	N	N	O
/	x	N	N	O
寻找	v	N	N	O
第	m	N	N	O
（	x	N	N	O
k	eng	N	N	O
+	x	N	N	O
1	m	N	N	O
）	x	N	N	O
个	q	N	N	O
节点	n	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
/	x	N	N	O
/	x	N	N	O
枚举	nz	Y	N	O
倒数	n	N	N	O
两个	m	N	N	O
节点	n	N	N	O
的	uj	N	N	O
组合	v	Y	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
j	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
j	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
=	x	N	N	O
=	x	N	N	O
j	x	N	N	O
)	x	N	N	O
 	x	N	N	O
continue	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
end	eng	N	N	O
=	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
state	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
state	eng	N	N	O
<	x	N	N	O
end	eng	N	N	O
;	x	N	N	O
state	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
/	x	N	N	O
/	x	N	N	O
寻找	v	N	N	O
合适	a	N	N	O
的	uj	N	N	O
状态	n	Y	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
way	eng	N	N	O
[	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
&&	x	N	N	O
NumOfOne	eng	N	N	O
(	x	N	N	O
state	eng	N	N	O
)	x	N	N	O
=	x	N	N	O
=	x	N	N	O
k	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
t	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
t	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O
t	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
!	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
|	x	N	N	O
|	x	N	N	O
(	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
t	x	N	N	O
)	x	N	N	O
&	x	N	N	O
state	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
 	x	N	N	O
continue	eng	N	N	O
;	x	N	N	O
/	x	N	N	O
/	x	N	N	O
寻找	v	N	N	O
合适	a	N	N	O
的	uj	N	N	O
下	f	N	N	O
一	m	N	N	O
节点	n	N	N	O
，	x	N	N	O
不	d	N	N	O
连通	a	Y	N	O
或者	c	N	N	O
已经	d	N	N	O
出现	v	N	N	O
则	d	N	N	O
跳	v	N	N	O
过	ug	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
=	x	N	N	O
state	eng	N	N	O
+	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
t	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
value	eng	N	N	O
=	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
+	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
+	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
*	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
+	x	N	N	O
(	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
?	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
*	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
*	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
:	x	N	N	O
0	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
value	eng	N	N	O
>	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
=	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
value	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
way	eng	N	N	O
[	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
=	x	N	N	O
way	eng	N	N	O
[	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
value	eng	N	N	O
=	x	N	N	O
=	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
way	eng	N	N	O
[	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
[	x	N	N	O
t	x	N	N	O
]	x	N	N	O
+	x	N	N	O
=	x	N	N	O
way	eng	N	N	O
[	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
t	x	N	N	O
,	x	N	N	O
island	eng	N	N	O
,	x	N	N	O
bridge	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
t	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
while	eng	N	N	O
(	x	N	N	O
t	x	N	N	O
-	x	N	N	O
-	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
island	eng	N	N	O
,	x	N	N	O
&	x	N	N	O
bridge	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
island	eng	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
map	eng	N	N	O
,	x	N	N	O
0	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
map	eng	N	N	O
)	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
start	eng	N	N	O
,	x	N	N	O
end	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
bridge	eng	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
start	eng	N	N	O
,	x	N	N	O
&	x	N	N	O
end	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
end	eng	N	N	O
-	x	N	N	O
1	x	N	N	O
]	x	N	N	O
[	x	N	N	O
start	eng	N	N	O
-	x	N	N	O
1	x	N	N	O
]	x	N	N	O
=	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
start	eng	N	N	O
-	x	N	N	O
1	x	N	N	O
]	x	N	N	O
[	x	N	N	O
end	eng	N	N	O
-	x	N	N	O
1	x	N	N	O
]	x	N	N	O
=	x	N	N	O
true	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
island	eng	N	N	O
=	x	N	N	O
=	x	N	N	O
1	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
value	eng	N	N	O
[	x	N	N	O
0	x	N	N	O
]	x	N	N	O
,	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
continue	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
DP	eng	N	N	O
_	x	N	N	O
Fun	eng	N	N	O
(	x	N	N	O
island	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
__	x	N	N	O
int64	eng	N	N	O
 	x	N	N	O
max	eng	N	N	O
_	x	N	N	O
value	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
,	x	N	N	O
way	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
,	x	N	N	O
end	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
=	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
island	eng	N	N	O
)	x	N	N	O
-	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
island	eng	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
j	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
j	x	N	N	O
<	x	N	N	O
island	eng	N	N	O
;	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
end	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
>	x	N	N	O
max	eng	N	N	O
_	x	N	N	O
value	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
max	eng	N	N	O
_	x	N	N	O
value	eng	N	N	O
=	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
end	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
way	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
=	x	N	N	O
way	eng	N	N	O
[	x	N	N	O
end	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
end	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
=	x	N	N	O
=	x	N	N	O
max	eng	N	N	O
_	x	N	N	O
value	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
way	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
+	x	N	N	O
=	x	N	N	O
way	eng	N	N	O
[	x	N	N	O
end	eng	N	N	O
_	x	N	N	O
state	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
I64d	eng	N	N	O
 	x	N	N	O
%	x	N	N	O
I64d	eng	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
max	eng	N	N	O
_	x	N	N	O
value	eng	N	N	O
,	x	N	N	O
way	eng	N	N	O
_	x	N	N	O
num	eng	N	N	O
/	x	N	N	O
2	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
用	p	N	N	O
记忆	n	Y	N	O
化	n	N	N	O
搜索	v	Y	N	O
重新	a	N	N	O
写	v	N	N	O
了	ul	N	N	O
一遍	m	N	N	O
。	x	N	N	O

本	r	N	N	O
以为	c	N	N	O
可以	c	N	N	O
很快	d	N	N	O
搞定	v	N	N	O
，	x	N	N	O
但	c	N	N	O
WA	eng	N	N	O
了	ul	N	N	O
差不多	l	N	N	O
10	m	N	N	O
次	t	N	N	O
。	x	N	N	O

__	x	N	N	O
int64	eng	N	N	O
，	x	N	N	O
血	n	N	N	O
的	uj	N	N	O
教训	vn	N	N	O
。	x	N	N	O


	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
string	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
vector	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
cmath	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
queue	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
algorithm	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
include	eng	N	N	O
 	x	N	N	O
<	x	N	N	O
iostream	eng	N	N	O
>	x	N	N	O

	x	N	N	O
#	x	N	N	O
define	eng	N	N	O
 	x	N	N	O
_	x	N	N	O
clr	eng	N	N	O
(	x	N	N	O
a	x	N	N	O
,	x	N	N	O
b	x	N	N	O
)	x	N	N	O
 	x	N	N	O
memset	eng	N	N	O
(	x	N	N	O
a	x	N	N	O
,	x	N	N	O
b	x	N	N	O
,	x	N	N	O
sizeof	eng	N	N	O
(	x	N	N	O
a	x	N	N	O
)	x	N	N	O
)	x	N	N	O

	x	N	N	O
template	eng	N	N	O
<	x	N	N	O
class	eng	N	N	O
 	x	N	N	O
T	x	N	N	O
>	x	N	N	O
 	x	N	N	O
T	x	N	N	O
 	x	N	N	O
_	x	N	N	O
abs	eng	N	N	O
(	x	N	N	O
T	x	N	N	O
 	x	N	N	O
a	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
a	x	N	N	O
<	x	N	N	O
0	x	N	N	O
)	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
-	x	N	N	O
a	x	N	N	O
;	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
;	x	N	N	O
}	x	N	N	O

	x	N	N	O
template	eng	N	N	O
<	x	N	N	O
class	eng	N	N	O
 	x	N	N	O
T	x	N	N	O
>	x	N	N	O
 	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
get	eng	N	N	O
_	x	N	N	O
min	eng	N	N	O
(	x	N	N	O
T	eng	N	N	O
&	x	N	N	O
 	x	N	N	O
a	x	N	N	O
,	x	N	N	O
T	x	N	N	O
 	x	N	N	O
b	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
a	x	N	N	O
>	x	N	N	O
b	x	N	N	O
)	x	N	N	O
 	x	N	N	O
a	x	N	N	O
=	x	N	N	O
b	x	N	N	O
;	x	N	N	O
}	x	N	N	O

	x	N	N	O
template	eng	N	N	O
<	x	N	N	O
class	eng	N	N	O
 	x	N	N	O
T	x	N	N	O
>	x	N	N	O
 	x	N	N	O
void	eng	N	N	O
 	x	N	N	O
get	eng	N	N	O
_	x	N	N	O
max	eng	N	N	O
(	x	N	N	O
T	eng	N	N	O
&	x	N	N	O
 	x	N	N	O
a	x	N	N	O
,	x	N	N	O
T	x	N	N	O
 	x	N	N	O
b	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
a	x	N	N	O
<	x	N	N	O
b	x	N	N	O
)	x	N	N	O
 	x	N	N	O
a	x	N	N	O
=	x	N	N	O
b	x	N	N	O
;	x	N	N	O
}	x	N	N	O

	x	N	N	O
using	eng	N	N	O
 	x	N	N	O
namespace	eng	N	N	O
 	x	N	N	O
std	eng	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
n	x	N	N	O
,	x	N	N	O
m	x	N	N	O
,	x	N	N	O
end	eng	N	N	O
;	x	N	N	O

	x	N	N	O
bool	eng	N	N	O
 	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
14	m	N	N	O
]	x	N	N	O
[	x	N	N	O
14	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
14	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
__	x	N	N	O
int64	eng	N	N	O
 	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
14	m	N	N	O
]	x	N	N	O
[	x	N	N	O
14	m	N	N	O
]	x	N	N	O
[	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
13	m	N	N	O
]	x	N	N	O
,	x	N	N	O
maxn	eng	N	N	O
;	x	N	N	O

	x	N	N	O
__	x	N	N	O
int64	eng	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
14	m	N	N	O
]	x	N	N	O
[	x	N	N	O
14	m	N	N	O
]	x	N	N	O
[	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
13	m	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
__	x	N	N	O
int64	eng	N	N	O
 	x	N	N	O
travel	eng	N	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
first	eng	N	N	O
,	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
second	eng	N	N	O
,	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
mask	eng	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
>	x	N	N	O
=	x	N	N	O
0	x	N	N	O
)	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
mask	eng	N	N	O
=	x	N	N	O
=	x	N	N	O
end	eng	N	N	O
)	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
mask	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
__	x	N	N	O
int64	eng	N	N	O
 	x	N	N	O
ans	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
&&	x	N	N	O
(	x	N	N	O
(	x	N	N	O
mask	eng	N	N	O
&	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
i	x	N	N	O
)	x	N	N	O
)	x	N	N	O
=	x	N	N	O
=	x	N	N	O
0	x	N	N	O
)	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
mask	eng	N	N	O
=	x	N	N	O
mask	eng	N	N	O
|	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
i	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
ans	eng	N	N	O
=	x	N	N	O
travel	eng	N	N	O
(	x	N	N	O
second	eng	N	N	O
,	x	N	N	O
i	x	N	N	O
,	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
mask	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
ans	eng	N	N	O
<	x	N	N	O
0	x	N	N	O
)	x	N	N	O
 	x	N	N	O
continue	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
ans	eng	N	N	O
+	x	N	N	O
=	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
*	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
 	x	N	N	O
ans	eng	N	N	O
+	x	N	N	O
=	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
*	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
*	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
ans	eng	N	N	O
>	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
=	x	N	N	O
ans	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
=	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
ans	eng	N	N	O
=	x	N	N	O
=	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
)	x	N	N	O
 	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
+	x	N	N	O
=	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
new	eng	N	N	O
_	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
DP	eng	N	N	O
[	x	N	N	O
first	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
second	eng	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
main	eng	N	N	O
(	x	N	N	O
)	x	N	N	O

	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
T	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
sum	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
__	x	N	N	O
int64	eng	N	N	O
 	x	N	N	O
count	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
T	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
t	x	N	N	O
=	x	N	N	O
1	x	N	N	O
;	x	N	N	O
t	x	N	N	O
<	x	N	N	O
=	x	N	N	O
T	x	N	N	O
;	x	N	N	O
t	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
_	x	N	N	O
clr	eng	N	N	O
(	x	N	N	O
map	eng	N	N	O
,	x	N	N	O
0	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
_	x	N	N	O
clr	eng	N	N	O
(	x	N	N	O
DP	eng	N	N	O
,	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
_	x	N	N	O
clr	eng	N	N	O
(	x	N	N	O
cnt	eng	N	N	O
,	x	N	N	O
0	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
maxn	eng	N	N	O
=	x	N	N	O
-	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
sum	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
count	eng	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
n	eng	N	N	O
,	x	N	N	O
&	x	N	N	O
m	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
end	eng	N	N	O
=	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
n	x	N	N	O
)	x	N	N	O
-	x	N	N	O
1	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
sum	eng	N	N	O
+	x	N	N	O
=	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
m	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
a	x	N	N	O
,	x	N	N	O
b	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
scanf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
%	x	N	N	O
d	x	N	N	O
"	x	N	N	O
,	x	N	N	O
&	x	N	N	O
a	eng	N	N	O
,	x	N	N	O
&	x	N	N	O
b	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
b	x	N	N	O
-	x	N	N	O
1	x	N	N	O
]	x	N	N	O
[	x	N	N	O
a	x	N	N	O
-	x	N	N	O
1	x	N	N	O
]	x	N	N	O
=	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
a	x	N	N	O
-	x	N	N	O
1	x	N	N	O
]	x	N	N	O
[	x	N	N	O
b	x	N	N	O
-	x	N	N	O
1	x	N	N	O
]	x	N	N	O
=	x	N	N	O
true	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
n	x	N	N	O
>	x	N	N	O
=	x	N	N	O
2	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
i	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
i	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O
i	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
for	eng	Y	N	O
(	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
j	x	N	N	O
=	x	N	N	O
0	x	N	N	O
;	x	N	N	O
j	x	N	N	O
<	x	N	N	O
n	x	N	N	O
;	x	N	N	O
j	eng	N	N	O
++	x	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
!	x	N	N	O
map	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
)	x	N	N	O
 	x	N	N	O
continue	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
int	eng	N	N	O
 	x	N	N	O
mask	eng	N	N	O
=	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
i	x	N	N	O
)	x	N	N	O
|	x	N	N	O
(	x	N	N	O
1	x	N	N	O
<	x	N	N	O
<	x	N	N	O
j	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
__	x	N	N	O
int64	eng	N	N	O
 	x	N	N	O
ans	eng	N	N	O
=	x	N	N	O
travel	eng	N	N	O
(	x	N	N	O
i	x	N	N	O
,	x	N	N	O
j	x	N	N	O
,	x	N	N	O
mask	eng	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
ans	eng	N	N	O
>	x	N	N	O
=	x	N	N	O
0	x	N	N	O
)	x	N	N	O
 	x	N	N	O
ans	eng	N	N	O
+	x	N	N	O
=	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
*	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
ans	eng	N	N	O
>	x	N	N	O
maxn	eng	N	N	O
)	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
maxn	eng	N	N	O
=	x	N	N	O
ans	eng	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
count	eng	N	N	O
=	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
ans	eng	N	N	O
=	x	N	N	O
=	x	N	N	O
maxn	eng	N	N	O
)	x	N	N	O
 	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
count	eng	N	N	O
+	x	N	N	O
=	x	N	N	O
cnt	eng	N	N	O
[	x	N	N	O
i	x	N	N	O
]	x	N	N	O
[	x	N	N	O
j	x	N	N	O
]	x	N	N	O
[	x	N	N	O
mask	eng	N	N	O
]	x	N	N	O
;	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
if	eng	N	N	O
(	x	N	N	O
maxn	eng	N	N	O
=	x	N	N	O
=	x	N	N	O
-	x	N	N	O
1	x	N	N	O
)	x	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
0	x	N	N	O
 	x	N	N	O
0	x	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
I64d	eng	N	N	O
 	x	N	N	O
%	x	N	N	O
I64d	eng	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
maxn	eng	N	N	O
+	x	N	N	O
sum	eng	N	N	O
,	x	N	N	O
count	eng	N	N	O
/	x	N	N	O
2	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
else	eng	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
{	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
 	x	N	N	O
printf	eng	N	N	O
(	x	N	N	O
"	x	N	N	O
%	x	N	N	O
d	x	N	N	O
 	x	N	N	O
%	x	N	N	O
d	x	N	N	O
/	x	N	N	O
n	x	N	N	O
"	x	N	N	O
,	x	N	N	O
weight	eng	N	N	O
[	x	N	N	O
0	x	N	N	O
]	x	N	N	O
,	x	N	N	O
1	x	N	N	O
)	x	N	N	O
;	x	N	N	O

	x	N	N	O
 	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
}	x	N	N	O

	x	N	N	O
 	x	N	N	O
return	eng	N	N	O
 	x	N	N	O
0	x	N	N	O
;	x	N	N	O

	x	N	N	O
}	x	N	N	O

	x	N	N	O